Mon Not R Astron Soc 000 120 2015
Printed 23 April 2015
MN LATEX style le v22
Evolution of galaxy stellar masses and star formation rates
in the Eagle simulations
M Furlong 1cid63 R G Bower1 T Theuns12 J Schaye3 R A Crain3 M Schaller1
C Dalla Vecchia45 C S Frenk1 I G McCarthy6 J Helly1 A Jenkins1
and Y M Rosas-Guevara78
1Institute for Computational Cosmology Durham University South Road Durham DH1 3LE
2Department of Physics University of Antwerp Groenenborgerlaan 171 B-2020 Antwerp Belgium
3Leiden Observatory Leiden University PO Box 9513 2300 RA Leiden the Netherlands
4Instituto de Astrofsca de Canarias C Va Lactea sn38205 La Laguna Tenerife Spain
5Departamento de Astrofsca Universidad de La Laguna Av del Astrofscasico Franciso Sanchez sn 38206 La Laguna Tenerife Spain
6Astrophysics Research Institute Liverpool John Moores University 146 Brownlow Hill Liverpool L3 5RF
7 Universite de Lyon Lyon F-69003 France
8 CNRS UMR 5574 Centre de Recherche Astrophysique de Lyon Ecole Normale Superieure de Lyon Lyon F-69007 France
Accepted 15 April 2015
ABSTRACT
We investigate the evolution of galaxy masses and star formation rates in the Evo-
lution and Assembly of Galaxies and their Environment Eagle simulations These
comprise a suite of hydrodynamical simulations in a CDM cosmogony with sub-
grid models for radiative cooling star formation stellar mass loss and feedback from
stars and accreting black holes The subgrid feedback was calibrated to reproduce the
observed present-day galaxy stellar mass function and galaxy sizes Here we demon-
strate that the simulations reproduce the observed growth of the stellar mass density
to within 20 per cent The simulation also tracks the observed evolution of the galaxy
stellar mass function out to redshift z  7 with dierences comparable to the plausible
uncertainties in the interpretation of the data Just as with observed galaxies the spe-
cic star formation rates of simulated galaxies are bimodal with distinct star forming
and passive sequences The specic star formation rates of star forming galaxies are
typically 02 to 05 dex lower than observed but the evolution of the rates track the
observations closely The unprecedented level of agreement between simulation and
data across cosmic time makes Eagle a powerful resource to understand the physical
processes that govern galaxy formation
Key words galaxies abundances evolution formation high-redshift mass function
star formation
1 INTRODUCTION
Although the basic model for how galaxies form within the
framework of a cold dark matter cosmogony has been es-
tablished for many years eg White  Rees 1978 White
 Frenk 1991 many crucial aspects are still poorly un-
derstood For example what physical processes determine
galaxy stellar masses and galaxy sizes How do these prop-
erties evolve throughout cosmic history How do stars and
AGN regulate the evolution of galaxy properties Numeri-
cal simulations and theoretical models are a valuable tool
for exploring these questions but the huge dynamic range
cid63 E-mail michellefurlongdurhamacuk
ccid13 2015 RAS
involved and the complexity of the plausible underlying
physics limits the ab initio predictive power of such cal-
culations eg Schaye et al 2010 Scannapieco et al 2012
We recently presented the Eagle simulation project
Schaye et al 2015 hereafter S15 a suite of cosmolog-
ical hydrodynamical simulations in which subgrid models
parameterise our inability to faithfully compute the physics
of galaxy formation below the resolution of the calculations
Calibrating the parameters entering the subgrid model for
feedback by observations of the present-day galaxy stellar
mass function GSMF and galaxy sizes we showed that
Eagle also reproduces many other properties of observed
galaxies at z  0 to unprecedented levels The focus of this
paper is to explore whether the good agreement specically
2 M Furlong et al
that between the simulated and observed stellar masses and
star formation rates extends to higher redshifts
Compared with semi-analytic models hydrodynamical
simulations such as Eagle have fewer degrees of freedom
and have to make fewer simplifying assumptions to model
gas accretion and the crucial aspects of the feedback from
star formation and accreting black holes that is thought
to regulate galaxy formation They also allow the study
of properties of the circumgalactic and intergalactic media
providing important complementary tests of the realism of
the simulation Such a holistic approach is necessary to un-
cover possible degeneracies and inconsistencies in the model
Having a calibrated and well-tested subgrid model is of cru-
cial importance since it remains the dominant uncertainty
in current simulations Scannapieco et al 2012
S15 present and motivate the subgrid physics imple-
mented in Eagle An overriding consideration of the pa-
rameterisation is that subgrid physics should only depend on
local properties of the gas eg density metallicity in con-
trast to other implementations used in the literature which
for example depend explicitly on redshift or on properties
of the dark matter Nevertheless a physically reasonable set
of parameters of the subgrid model for feedback exists for
which the redshift z  0 GSMF and galaxy sizes agree to
within 02 dex with the observations This level of agreement
is unprecedented and similar to the systematic uncertainty
in deriving galaxy stellar masses from broad-band observa-
tions Other observations of the local Universe such as the
Tully-Fisher relation the mass-metallicity relation and the
column density distribution functions of intergalactic CIV
and OVI are also reproduced even though they were not
used in calibrating the model and hence could be consid-
ered predictions
In this paper we focus on the build-up of the stellar mass
density and the evolution of galaxy stellar masses and star
formation rates expanding the analysis of S15 beyond z 0
A similar analysis was presented by Genel et al 2014 for
the Illustris simulation Vogelsberger et al 2014 They
conclude that Illustris reproduces the observed evolution
of the GSMF from redshifts 0 to 7 well but we note that they
used the star formation history in their calibration process
Another dierence with respect to Genel et al 2014 is that
we compare with recent galaxy surveys which have dramat-
ically tightened observational constraints on these measures
of galaxy evolution For example primus Moustakas et al
2013 UltraVISTA Ilbert et al 2013 Muzzin et al 2013
and zfourge Tomczak et al 2014 provide improved con-
straints out to redshift 4 UV observations extend the com-
parison to even higher redshift with inferred GSMFs avail-
able up to redshift 7 Gonzalez et al 2011 Duncan et al
2014 Observations of star formation rates also span the
redshift range 0 to 7 with many dierent tracers of star
formation eg IR radio UV providing consistency checks
between data sets
This paper is organised as follows In Section 2 we pro-
vide a brief summary of Eagle in particular the subgrid
physics used In Section 3 we compare the evolution of the
stellar mass growth in the simulation to data out to red-
shift 7 We follow this with an analysis of the star formation
rate density and specic star formation rates in Section 4
In Section 5 we discuss the results and we summarise in
Section 6 We generally nd that the properties of the simu-
lated galaxies agree with the observations to the level of the
observational systematic uncertainties across all redshifts
The Eagle simulation suite adopts a at CDM cos-
mogony with parameters from Planck Planck Collabora-
tion et al 2014   0693 m  0307 b  0048
8  08288 ns  09611 and H0  6777 km s1 Mpc1
The Chabrier 2003 stellar initial mass function IMF is
assumed in the simulations Where necessary observational
stellar masses and star formation rate densities have been
renormalised to the Chabrier IMF1 and volumes have been
rescaled to the Planck cosmology Galaxy stellar masses are
computed within a spherical aperture of 30 proper kilopar-
secs pkpc from the centre of potential of the galaxy This
denition mimics a 2D Petrosian mass often used in obser-
vations as shown in S15 Star formation rates are computed
within the same aperture Distances and volumes are quoted
in comoving units eg comoving megaparsecs cMpc un-
less stated otherwise Note that unless explicitly stated val-
ues are not given in h1 units
2 SIMULATIONS
The Eagle simulation suite consists of a large number of
cosmological simulations with variations that include pa-
rameter changes relative to those of the reference subgrid
formulation other subgrid implementations dierent nu-
merical resolutions and a range of box sizes up to 100 cMpc
boxes S15 Crain et al 2015 Simulations are denoted as
for example L0100N1504 which corresponds to a simula-
tion volume of L 100 cMpc on a side using 15043 parti-
cles of dark matter and an equal number of baryonic parti-
cles A prex distinguishes subgrid variations for example
Ref-L100N1504 is our reference model These simulations
use advanced smoothed particle hydrodynamics SPH and
state-of-the-art subgrid models to capture the unresolved
physics Cooling metal enrichment energy input from stel-
lar feedback black hole growth and feedback from AGN are
included The free parameters for stellar and AGN feedback
contain considerable uncertainty see S15 and so are cali-
brated to the redshift 01 GSMF with consideration given
to galaxy sizes A complete description of the code subgrid
physics and parameters can be found in S15 while the mo-
tivation is given in S15 and Crain et al 2015 Here we
present a brief overview
CAMB Lewis Challinor  Lasenby 2000 version
Jan 12 was used to generate the transfer function for the
linear matter power spectrum with a Plank 1 Planck Col-
laboration et al 2014 cosmology The Gaussian initial con-
ditions were generated using the linear matter power spec-
trum and the random phases were taken from the pub-
lic multi-scale white noise Panphasia eld Jenkins 2013
Particle displacements and velocities are produced at red-
shift 127 using second-order Langrangian perturbation the-
ory Jenkins 2010 See Appendix B of S15 for more detail
The initial density eld is evolved in time using an ex-
tensively modied version of the parallel N-body SPH code
Gadget-3 Springel et al 2008 which is essentially a more
1 Specic star formation rates are not renormalised as the cor-
rection for star formation rates and stellar masses are similar and
cancel each other
ccid13 2015 RAS MNRAS 000 120
computationally ecient version of the public code Gadget-
2 described in detail by Springel 2005 In this Lagrangian
code a uid is represented by a discrete set of particles
from which the gravitational and hydrodynamic forces are
calculated SPH properties such as the density and pressure
gradients are computed by interpolating across neighbour-
ing particles
The code is modied to include updates to the hydro-
dynamics as described in Dalla Vecchia et al in prep see
also S15 Appendix A collectively referred to as Anarchy
The impact of these changes on cosmological simulations are
discussed in Schaller et al in prep Anarchy includes
Hopkins 2013
 The pressure-entropy formulation of SPH described in
 The articial viscosity switch of Cullen  Dehnen
2010 and an articial conduction switch described by Price
2008
 A C2 Wendland 1995 kernel with 58 neighbours to
 The time step limiter from Durier  Dalla Vecchia
2012 that ensures feedback events are accurately modelled
interpolate SPH properties across neighbouring particles
Two of the Eagle simulations are analysed in this pa-
per2 The rst Eagle simulation analysed in this paper is
Ref-L100N1504 a 100 cMpc3 periodic box with 2  15043
particles Initial masses for gas particles are 181  106 Mcid12
and masses of dark matter particles are 970106 Mcid12 Plum-
mer equivalent comoving gravitational softenings are set to
125 of the initial mean inter-particle spacing and are lim-
ited to a maximum physical size of 070 pkpc
We also use simulation Recal-L025N0752 which has 8
times better mass resolution and 2 times better spatial res-
olution in a 25 cMpc3 box The box sizes particle num-
bers and resolutions are summarised in Table 1 Note that
subgrid stellar feedback parameters and black hole growth
and feedback parameters are recalibrated in the Recal-
L025N0752 simulation as explained in Section 22
21 Subgrid physics
The baryonic subgrid physics included in these simulations
is broadly based on that used for the OWLS Schaye et al
2010 and GIMIC Crain et al 2009 projects although
many improvements in particular to the stellar feedback
scheme and black hole growth have been implemented We
emphasise that all subgrid physics models depend solely on
local inter-stellar medium ISM properties
 Radiative cooling and photo-heating in the simulation
are included as in Wiersma Schaye  Smith 2009 The
element-by-element radiative rates are computed in the pres-
ence of the cosmic microwave background CMB and the
Haardt  Madau 2001 model for UV and X-ray back-
ground radiation from quasars and galaxies The eleven el-
ements that dominate radiative cooling are tracked namely
H He C N O Ne Mg Si Fe Ca and Si The cooling
tables as a function of density temperature and redshift
are produced using Cloudy version 0702 Ferland et al
1998 assuming the gas is optically thin and in photoion-
ization equilibrium
2 Two further simulations are considered in Appendix B
ccid13 2015 RAS MNRAS 000 120
Galaxy evolution in the Eagle simulations
Above the redshift of reionization the CMB and a Haardt
 Madau 2001 UV-background up to 1 Ryd to account for
photo-dissociation of H2 are applied Hydrogen reionization
is implemented by switching on the full Haardt  Madau
2001 background at redshift 115
 Star formation is implemented following Schaye  Dalla
Vecchia 2008 Gas particles above a metallicity-dependent
density threshold n
HZ have a probability of forming stars
determined by their pressure The Kennicutt-Schmidt star
formation law Kennicutt 1998 under the assumption of
disks in vertical hydro-static equilibrium can be written as
m  mgA1Mcid12pc
fgP n12
where mg is the gas particle mass A and n are the nor-
malisation and power index of the Kennicutt-Schmidt star
formation law   53 is the ratio of specic heats G is
the gravitational constant fg  1 is the gas fraction of
the particle and P is its pressure As a result the imposed
star formation law is specied by the observational values
of A  1515  104 Mcid12yr1kpc2 and n  14 where we
have decreased the amplitude by a factor of 165 relative to
the value of Kennicutt 1998 to account for the use of a
Chabrier instead of Salpeter IMF
As we do not resolve the cold gas phase a star formation
threshold above which cold gas is expected to form is im-
posed The star formation threshold is metallicity dependent
and given by
cid18 Z
cid19064
HZ  01cm
where Z is the metallicity from Schaye 2004  eq 19 and 24
also used in SFTHRESHZ model of the OWLS project
A pressure oor as a function of density is imposed of
the form P  eff  for gas with density above n
HZ and
e  43 This models the unresolved multi-phase ISM
Our choice for e ensures that the Jeans mass is indepen-
dent of density and prevents spurious fragmentation pro-
vided the Jeans mass is resolved at n
HZ see Schaye 
Dalla Vecchia 2008 Gas particles selected for star forma-
tion are converted to collisionless star particles which rep-
resent a simple stellar population with a Chabrier 2003
IMF Stellar evolution and enrichment is based on Wiersma
et al 2009 and detailed in S15 Metal enrichment due to
mass loss from AGB stars winds from massive stars core
collapse supernovae and type Ia supernovae of the 11 ele-
ments that are important for radiative cooling are tracked
using the yield tables of Marigo 2001 Portinari Chiosi 
Bressan 1998 and Thielemann Argast  Brachwitz 2003
The total and metal mass lost from stars are added to the
gas particles that are within an SPH kernel of the star par-
ticle Stellar feedback is treated stochastically using the ther-
mal injection method described in Dalla Vecchia  Schaye
2012 The total available energy from core collapse su-
pernovae for a Chabrier IMF assumes all stars in the stel-
lar mass range 6100 Mcid123 release 1051 erg of energy into
the ISM and the energy is injected after a delay of 30
3 6 - 8 Mcid12 stars explode as electron capture supernovae in models
with convective overshoot eg Chiosi Bertelli  Bressan 1992
4 M Furlong et al
Table 1 Box size particle number baryonic and dark matter particle mass comoving and maximum proper gravitational softening for
Ref-L100N1504 and Recal-L025N0752 simulations
Simulation
Mcid12
Mcid12
Ref-L100N1504
Recal-L025N0752
2  15043
2  7523
181106
226105
970106
121106
Table 2 Values of parameters
L100N1504 and Recal-L025N0752
that dier between Ref-
Simulation Prex
cm3
TAGN
2ln10
1ln10
2  103
a Note that the subgrid scheme is not very sensitive to the changes
in Cvisc as shown in Appendix B of Rosas-Guevara et al 2013
Myr from the time the star particle is formed Rather than
heating all gas particle neighbours within the SPH kernel
neighbours are selected stochastically based on the avail-
able energy then heated by a xed temperature dierence
of T  1075K The stochastic heating distributes the en-
ergy over less mass than heating all neighbours This re-
sults in a longer cooling time relative to the sound cross-
ing time across a resolution element allowing the thermal
energy to be converted to kinetic energy thereby limiting
spurious losses Dalla Vecchia  Schaye 2012
In Eagle the fraction of this available energy injected
into the ISM depends on the local gas metallicity and den-
sity The stellar feedback fraction in units of the available
core collapse supernova energy is specied by a sigmoid
function
fth  fthmin 
cid16 Z
fthmax  fthmin
cid17nZcid16 nHbirth
cid17nn
01Zcid12
where Z is the metallicity of the star particle nHbirth is the
density of the star particles parent gas particle when the
star was formed and Zcid12  00127 is the solar metallicity
The values for fthmax and fthmin the parameters for the
maximum and minimum energy fractions are xed at 3 and
03 for both simulations analysed here At low Z and high
nHbirth fth asymptotes towards fthmax and at high Z and
low nHbirth asymptotes towards fthmin Applying up to 3
times the available energy can be justied by appealing to
the dierent forms of stellar feedback eg supernova radia-
tion pressure stellar winds which are not treated separately
here as we do not have the resolution to resolve these forms
of stellar feedback This also osets the remaining numerical
radiative losses Crain et al 2015
The power law indexes are nZ  nn  2 ln10 for the
Ref model with nn changed to 1 ln10 for the Recal model
resulting in weaker dependence of fth on the density in
the high resolution model The normalisation of the den-
sity term nH0 is set to 067 cm3 for the Ref model and to
025 cm3 for the Recal model The feedback dependence is
motivated in Crain et al 2015
 Black hole seeding and growth is implemented as fol-
lows Halos with a mass greater than 1010 h1Mcid12 are
seeded with a black hole of 105 h1Mcid12 using the method
of Springel Di Matteo  Hernquist 2005 Black holes can
grow through mergers and accretion Accretion of ambient
gas onto black holes follows a modied Bondi-Hoyle formula
that accounts for the angular momentum of the accreting gas
Rosas-Guevara et al 2013 Diering from eg Springel Di
Matteo  Hernquist 2005 Booth  Schaye 2009 Rosas-
Guevara et al 2013 the black hole accretion rate is not
increased relative to the standard Bondi accretion rate in
high-density regions
For the black hole growth there is one free parameter
Cvisc which is used to determine the accretion rate from
cid2C
visccsV3cid3  mbondi
maccr  min mbondi
where cs is the sound speed and V is the rotation speed of
the gas around the black hole The Bondi rate is given by
mbondi 
4G2m2
s  v232 
where v is the relative velocity of the black hole and the gas
The accretion rate is not allowed to exceed the Eddington
mEdd given by
mEdd 
4GmBHmp
where mp is the proton mass T is the Thomson scattering
cross section and r is the radiative eciency of the accre-
tion disc The free parameter Cvisc relates to the viscosity
of the subgrid accretion disc and csV3 Cvisc relates
the Bondi and viscous time scales see Rosas-Guevara et al
2013 for more detail
 AGN feedback follows the accretion of mass onto the
black hole A fraction of the accreted gas is released as ther-
mal energy into the surrounding gas Stochastic heating
similar to the supernova feedback scheme is implemented
with a xed heating temperature TAGN where TAGN
is a free parameter The method used is based on that of
Booth  Schaye 2009 and Dalla Vecchia  Schaye 2008
see S15 for more motivation
The eect of varying some of the subgrid parameters is
explored in Crain et al 2015 The values of the parameters
that dier between the two simulations used in this paper
Ref-L100N1504 and Recal-L025N0752 are listed in Table 2
ccid13 2015 RAS MNRAS 000 120
22 Resolution Tests
23 Halo and galaxy denition
Galaxy evolution in the Eagle simulations
We distinguish between the strong and weak numerical con-
vergence of our simulations as dened and motivated in S15
By strong convergence we mean that simulations of dier-
ent resolutions give numerically converged answer without
any change to the subgrid parameters In S15 it is argued
that strong convergence is not expected from current sim-
ulations as higher-resolution often implies changes in the
subgrid models for example energy injected by feedback
events often scales directly with the mass of the star par-
ticle formed In addition with higher resolution the physi-
cal conditions of the ISM and hence the computed radiative
losses will change Without turning o radiative cooling or
the hydrodynamics which could be sensitive to the point at
which they are turned back on the changes to the ISM and
radiative losses are expected to limit the strong convergence
of the simulation
The Eagle project instead focuses on demonstrating
that the simulations shows good weak convergence although
S15 shows that the strong convergence of the simulation
is on par with other hydrodynamical simulations Weak
convergence means that simulations of dierent resolutions
give numerically converged results after recalibrating one
or more of the subgrid parameters As it is argued in S15
that current simulations cannot make ab initio predictions
for galaxy properties due to the sensitivity of the results to
the parameters of the subgrid models for feedback and cal-
ibration is thus required the high-resolution Eagle simula-
tion subgrid parameters are recalibrated to the same observ-
able the present-day GSMF galaxy sizes and the stellar-
mass black hole mass correlation as the standard resolution
simulations This recalibrated high-resolution model Recal-
L025N0752 enables us to test the weak convergence be-
haviour of the simulation and to push our results for galaxy
properties to 8 times lower stellar mass In Table 2 we high-
light the parameters that are varied between the Ref and Re-
cal models In the main text of this paper we consider weak
convergence tests strong convergence tests can be found in
Appendix B
As a simulation with a factor of 8 better mass resolution
requires a minimum of 8 times the CPU time in practice the
increase in time is longer due to the higher-density regions
resulting in shorter time steps and diculties in producing
perfectly scalable algorithms we compare the 100 cMpc3
intermediate-resolution simulation to a 25 cMpc3 high-
resolution simulation Note that for volume averaged prop-
erties the 25 cMpc3 box diers from the 100 cMpc3 box
not only due to the resolution but also due to the absence of
larger objects and denser environments in the smaller vol-
ume As a result for volume averaged quantities we present
only the Ref-L100N1504 simulation in the following sections
and revisit the convergence of these quantities in Appendix
B For quantities as a function of stellar mass we present
both the Ref-L100N1504 and Recal-L025N0752 simulations
although the comparison at high redshifts is limited by the
small number of objects in the high-resolution simulation
which has a volume that is 64 times smaller
ccid13 2015 RAS MNRAS 000 120
Halo nding is carried out by applying the friends-of-friends
FoF method Davis et al 1985 on the dark matter with
a linking length of 02 times the mean inter-particle sepa-
ration Baryonic particles are assigned to the group of their
nearest dark matter particle Self-bound overdensities within
the group are found using Subfind Springel et al 2001
Dolag et al 2009 these substructures are the galaxies in
our simulation A central galaxy is the substructure with
the largest mass within a halo All other galaxies within a
halo are satellites Note that any FoF particles not associ-
ated with satellites are assigned to the central object thus
the mass of a central galaxy may extend throughout its halo
A galaxys stellar mass is dened as the stellar mass
associated with the subhalo within a 3D 30 pkpc radius
centred on the minimum of the subhalos centre of gravi-
tational potential Only mass that is bound to the subhalo
is considered thereby excluding mass from other subhalos
This denition is equivalent to the total subhalo mass for
low mass objects but excludes diuse mass around larger
subhalos which would contribute to the intra-cluster light
ICL S15 shows that this aperture yields results that are
close to a 2D Petrosian aperture often used in observations
eg Li  White 2009 The same 3D 30 pkpc aperture is
applied when computing the star formation rates in galax-
ies again considering only particles belonging to the sub-
halo The aperture constraint has only a minimal eect on
the star formation rates because the vast majority of star
formation occurs in the central 30 pkpc even for massive
galaxies
3 EVOLUTION OF GALAXY STELLAR
We will begin this section by comparing the growth in stellar
mass density across cosmic time in the largest Eagle sim-
ulation Ref-L100N1504 to a number of observational data
sets This is followed with a comparison of the evolution of
the galaxy stellar mass function GSMF from redshift 0 to
7 and a discussion on the impact of stellar mass errors in
the observations We also consider the convergence of the
GSMF in the simulation at dierent redshifts
31 The stellar mass density
We begin the study of the evolution in the primary Eagle
simulation Ref-L100N1504 by considering the build up of
stellar mass We present the stellar mass density  as a
function of lookback time in Figure 1 with redshift on the
upper axis Plotting the stellar mass density as a function
of time rather than redshift say gives a better visual im-
pression of how much dierent epochs contribute to the net
stellar build-up
We added to this gure recent observational estimates
of  from a number of galaxy surveys Around redshift 01
we show data from Baldry et al 2012 GAMA survey Li
 White 2009 SDSS Gilbank et al 2010a Stripe82
- SDSS and Moustakas et al 2013 primus The values
agree to within 055  108 Mcid12cMpc3 which is better than
01 dex The Moustakas et al 2013 data set extends to
6 M Furlong et al
Figure 1 The stellar mass density as a function of time on a log and linear scale top and bottom panels respectively The black
solid curve is the total stellar mass density from the Eagle simulation Ref-L0100N1504 and the blue curve is the stellar mass density in
galaxies in that simulation ie excluding intra-cluster light Observational data are plotted as symbols see the legend for the original
source Open symbols refer to observations that include extrapolations of the GSMF below the mass completeness of the survey lled
symbols are the raw data Where necessary data sets have been scaled to a Chabrier IMF and the Planck cosmology as used in the
simulation The top panel shows  for all galaxies in the simulation in blue and  for galaxies above the completeness limit of
observations by Ilbert et al 2013 and Muzzin et al 2013 in red and green respectively The corresponding data sets for Ilbert et al
2013 and Muzzin et al 2013 are coloured accordingly and simulation lines should be compared to corresponding lled red and green
symbols The bottom panel shows  on a linear scale From redshift 0 to 05  in galaxies agrees with the observations at the 20
level with the simulated  lower by around 01 dex At redshifts from 05 to 7 the model agrees well with the data although the level
of agreement above redshift 2 depends on the assumed incompleteness correction
ccid13 2015 RAS MNRAS 000 120
Lookback Time Gyr107108109   M cMpc3Total stellar mass30 pkpc apertureMass limits of IlbertMass limits of Muzzin000102030405060810121520305090zBaldry 2012Li and White 2009Gilbank 2010Ilbert 2013Muzzin 2013Moustakas 2013Tomczak 2014Gonzalez 2011107108109Fraction of Mean Bayron Density024681012Lookback Time Gyr0005101520253035   108 M cMpc3Total stellar mass30 pkpc aperture0005101520253035Fraction of Mean Bayron Density1e8Table 3 Mass completeness limit at redshifts 02 to 4 for GSMF
observations of Ilbert et al 2013 and Muzzin et al 2013
Redshift
Ilbert et al 2013 Muzzin et al 2013
log10M Mcid12
log10M Mcid12
02 - 05
05 - 08a
08 - 11
11 - 15
15 - 20
20 - 25
25 - 30
30 - 40
a Muzzin et al 2013 use redshift ranges 05 to 10 and 10 to
redshift one providing an estimate for  for galaxies with
masses greater than 1095 Mcid12 Note however that above
redshift 0725 the Moustakas et al 2013 measurements
of  are a lower limit as they only include galaxies with
stellar masses of 1010 Mcid12 or above Ilbert et al 2013 and
Muzzin et al 2013 estimate  from redshifts 02 to 4 from
the UltraVISTA survey These two data sets use the same
observations but apply dierent signal-to-noise limits and
analyses to infer stellar masses resulting in slightly dier-
ent results We include both studies in the gure to asses
the intrinsic systematics in the interpretation of the data
Both data sets extrapolate the observations to 108 Mcid12 to
estimate a total stellar mass density The data sets are
consistent within the estimated error bars up to redshift 3
Above redshift 3 they dier primarily because of the strong
dependence of  on how the extrapolation below the mass
completeness limit of the survey is performed The estimated
 from observed galaxies can be compared to the extrapo-
lated  for both data sets by comparing the lled and open
symbols in Figure 1 Tomczak et al 2014 estimate stel-
lar mass densities between redshifts 05 and 25 from the
zfourge survey The mass completeness limits for this sur-
vey are below 1095 Mcid12 at all redshifts probing lower masses
than other data sets at the same redshifts For this data
set no extrapolation is carried out in estimating  In the
simulations galaxies with masses below 109 Mcid12 contribute
only 12 to the stellar mass density at redshift 2 and their
contribution decreases with decreasing redshift due to the
attening of the GSMF see Section 32
At redshifts below two the various observational mea-
surements show agreement on the total stellar mass density
to better than 01 dex From redshift 2 to 4 the agreement is
poorer with dierences up to 04 dex primarily as a result of
applying dierent extrapolations to correct for incomplete-
ness At redshifts above four only the UV observations of
Gonzalez et al 2011 are shown Note that these do not in-
clude corrections for nebular emission lines and hence may
overestimate  eg Smit et al 2014 We therefore plot
these values for  as upper limits
The solid black line in each panel of Figure 1 shows
the build up of  in the simulation The log scale used
in the upper panel emphasises the rapid fractional increase
at high redshift There is a rapid growth in  from the
early universe until 8 Gyr ago around redshift 1 by which
ccid13 2015 RAS MNRAS 000 120
Galaxy evolution in the Eagle simulations
point 70 of the present day stellar mass has formed The
remaining 30 forms in the 8 Gyr from redshift 1 to 0 We
nd that 50 of the present day stellar mass was in place
975 Gyr ago by redshift 16
The simulation is in good agreement with the observed
growth of stellar mass across the whole of cosmic time
falling within the error bars of the observational data sets
We nd that 35 of the baryons are in stars at redshift
zero which is close to the values of 35 and 4 reported
by Li  White 2009 and Baldry et al 2012 respectively
However it should be noted that observed stellar mass
densities are determined by integrating the GSMF thereby
excluding stellar mass associated with intra-cluster light
ICL To carry out a fairer comparison we apply a 3D
30 pkpc aperture to the simulated galaxies to mimic a 2D
Petrosian aperture as applied to many observations see
Section 23 and S15 The aperture masses more accurately
represent the stellar light that can be detected in observa-
tions The result of the aperture correction is shown as a
solid blue line in both panels 4
In this more realistic comparison of the model to ob-
servations which excludes the ICL we nd that from high
redshift to redshift 2 there is little dierence between the to-
tal  and the aperture stellar mass density associated with
galaxies At these high redshifts the simulation curve lies
within the scatter of the total stellar mass density estimates
from the observations of Gonzalez et al 2011 inverted tri-
angles and Ilbert et al 2013 open diamonds although
the simulation data is above the estimates of Muzzin et al
2013 open circles above redshift 2 Between redshifts 2
and 01 the simulation data lies within the error bars from
dierent observational estimates although it is on the lower
side of all observed values below redshift 09 At redshift 01
where  can be determined most accurately from observa-
tions the simulation falls below the observations by a small
amount less than 01 dex or 20 per cent We will return to
the source of this decit in stellar mass at low redshift when
studying the shape of the GSMF
Returning to the agreement between redshifts 2 and 4
above redshift 2 the stellar mass density estimated from ob-
servations requires extrapolation below the mass complete-
ness limit of the survey as discussed To compare the simu-
lation with the stellar mass density that is observed without
extrapolation the red and green lines in the top panel show
 from the simulation after applying the mass complete-
ness limits of Ilbert et al 2013 and Muzzin et al 2013
respectively The mass completeness limits applied are listed
in Table 3 The red and green lines should be compared to
the lled red diamonds and lled green circles respectively
showing  from the observed galaxies without extrapolat-
ing below the mass completeness limit Note that 30 pkpc
apertures are still applied to the simulated galaxies for this
comparison When comparing with Ilbert et al 2013 we
nd agreement at the level of the observational error bars
from redshifts 02 to 4 However Muzzin et al 2013 nd
more stellar mass than the simulation after applying the
mass completeness limits between redshifts 15 and 4 This
can be understood by noting that the estimated mass com-
4 Note the mass in the simulation associated with the ICL resides
in the largest halos as will be shown in a future paper
8 M Furlong et al
pleteness limit of Muzzin et al 2013 is higher than that
of Ilbert et al 2013 although both groups use the same
survey data resulting in only the most massive objects be-
ing detected at a given redshift These objects are not suf-
ciently massive in the simulation when compared with the
inferred GSMF from observations without accounting for
random or systematic mass errors as will be shown next
32 The evolution of the galaxy stellar mass
function
The evolution of the stellar mass density of the Universe
provides a good overview of the growth of stellar mass in
the simulation However it does not test whether stars form
in galaxies of the right mass We now carry out a full com-
parison of the GSMFs in the simulation with those inferred
from observations at dierent epochs
The shape of the GSMF is often described by a
cid18 M
cid19
Schechter 1976 function
M dM  
where MC is the characteristic mass or knee  is the
normalisation and  is the power-law slope for M cid28 MC
We will refer to the slope and knee throughout this com-
parison In Appendix A we t the simulation GSMFs with
Schechter functions to provide a simple way of characterising
the simulated GSMFs
In Figure 2 we compare the GSMF to the same observa-
tional data sets that were presented in Figure 1 in terms of
the total stellar mass density The GSMFs from these dier-
ent observations are consistent with each other within their
estimated error bars up to redshift two Between redshifts 0
and 1 there is little evolution seen in the observational data
all show a reasonably at low-mass slope and a normalisa-
tion that varies by less than 02 dex at 1010 Mcid12 over this
redshift range From redshift 1 to 2 there is a steepening of
the slope at galaxy masses below 1010 Mcid12 and a drop in nor-
malisation of  04 dex The drop in normalisation appears
to continue above redshift two although the observations do
not probe below 1010 Mcid12 at redshifts two to four
Observational data at redshifts 5 6 and 7 from Gonzalez
et al 2011 and Duncan et al 2014 based on rest-frame
UV observations are shown in the bottom three panels of
Figure 2 There is no clear break in the GSMF at these high
redshifts so it is not clear that the distribution is described
by a Schechter function in either data set Both data sets
show similar slopes above 108 Mcid12 At low masses below 108
Mcid12 the data set of Gonzalez et al 2011 shows a attening
in the slope at all redshifts shown These low masses are not
probed by Duncan et al 2014 At redshift 5 the data sets
dier in amplitude by up to 08 dex This oset reduces to
 02 dex by redshift 7 A comparison of these data sets pro-
vides an impression of the systematic errors in determining
the GSMF from observations at redshifts greater than 5
We compare these observations to the evolution of the
GSMFs predicted by Ref-L100N1504 between redshift 01
and 7 spanning 13 Gyr The GSMF for Ref-L100N1504 is
shown as a blue curve in Figure 2 and to guide the eye
we repeat the redshift 01 GSMF in all panels in light blue
To facilitate a direct comparison with observational data
the GSMF from Ref-L100N1504 is convolved with an esti-
mate of the likely uncertainty in observed stellar masses
Random errors in observed masses will skew the shape of
the stellar mass function because more low-mass galaxies
are scattered to higher masses than vice versa We use the
uncertainty quoted by Behroozi Wechsler  Conroy 2013
z  0  zz dex where 0  007 and z  004 This
gives a fractional error in the galaxy stellar mass of 18 at
redshift 01 and 40 at redshift 2 Note that this error does
not account for any systematic uncertainties that arise when
inferring the stellar mass from observations which could
range from 01 to 06 dex depending on redshift see Sec-
tion 321
Recall that the observed GSMF at redshift 01 was used
to calibrate the free parameters of the simulation At this
redshift the simulation reproduces the reasonably at slope
of the observed GSMF below 10105 Mcid12 with an exponen-
tial turnover at higher masses between 10105 Mcid12 and 1011
Mcid12 Overall we nd agreement within 02 dex over the mass
range from 2  108 Mcid12 to over 1011 Mcid12 and a very similar
shape for the simulated and observed GSMF In our im-
plementation the interplay between the subgrid stellar and
AGN feedback models at the knee of the GSMF at galaxy
masses of around 10105 Mcid12 results in a slight underabun-
dance of galaxies relative to observations As the stellar mass
contained in this mass range dominates the stellar mass den-
sity of the Universe this small oset accounts for the short-
fall of stellar mass at the 20 level seen at redshift zero in
 in Figure 1 blue curve
In the simulation there is almost no evolution in the
GSMF from redshift zero to one apart from a small decrease
of 02 dex in galaxy masses at the very high-mass end This
can be seen by comparing the blue and light blue lines in the
top panels where the light blue line repeats the redshift 01
GSMF A similar minimal evolution was reported based on
the observational data of Moustakas et al 2013triangles
from redshift 0 to 1 and is also seen in the other data sets
From redshift one to two the simulation predicts strong
evolution in the GSMF in terms of its normalisation low-
mass slope and the location of the break Between these
redshifts spanning just 26 Gyr in time the stellar mass
density almost doubles from 075 to 14 108 Mcid12cMpc3
and the GSMF evolves signicantly From redshift two to
four the normalisation continues to drop and the mass cor-
responding to the break in the GSMF continues to decrease
Although the trend of a decrease in normalisation of the
GSMF between redshift one and two is qualitatively consis-
tent with what is seen in the observations the normalisation
at redshift two at 1095 Mcid12 is too high in the simulation by
around 02 dex There is also a suggestion that the normali-
sation of the GSMF in the simulation is too high at redshift
three although observations do not probe below 1010 Mcid12
at this redshift It is therefore dicult to draw a strong
conclusion from a comparison above redshift 2 without ex-
trapolating the observational data At redshift two there is
also an oset at the massive end of the GSMF The expo-
nential break occurs at a mass that is around 02 dex lower
than observed However the number of objects per bin in
the simulation at redshift two above 1011 Mcid12 falls below
10 providing a poor statistical sample of the massive galaxy
population Increasing the box size may systematically boost
ccid13 2015 RAS MNRAS 000 120
Galaxy evolution in the Eagle simulations
Figure 2 The galaxy stellar mass function at the redshifts shown in the upper left of each panel for simulation Ref-L100N1504 and
Recal-L025N0752 in blue and green respectively When the stellar mass falls below the mass of 100 baryonic particles curves are dotted
when there are fewer than 10 galaxies in a stellar mass bin curves are dashed The redshift 01 GSMF is reproduced in each panel as a
light blue curve to highlight the evolution Comparing Ref-L100N1504 to Recal-L025N0752 the simulations show good convergence over
the redshift range shown where there are more than 10 galaxies per bin The data points show observations as indicated in the legends
Where necessary observational data have been converted to a Chabrier IMF and Planck cosmology The black points represent the
observational redshift bin below the simulation redshift while the grey curves are from the redshift bin above the simulation snapshot
Within the expected mass errors we nd good agreement with observations of the GSMF from redshift 0 to 7 Between redshifts two
and four the model tends to underestimate the masses of the brightest galaxies by around 02 dex but these are very sensitive to the
stellar mass errors in the observations see text for discussion
the abundance of rare objects such as that of galaxies above
1011 Mcid12 at redshift two and above The break is also partic-
ularly sensitive to any errors in the stellar mass estimates
a point we will return to below
Comparing the simulated GSMF to observations at red-
shifts 5 6 and 7 we nd a similar shape to the observa-
tional data The simulation has a similar trend with mass
to Gonzalez et al 2011 however it is oset in stellar mass
from Duncan et al 2014 No break in the GSMF is vis-
ible neither in the simulation nor in the observations at
ccid13 2015 RAS MNRAS 000 120
654321log10dndlog10McMpc3z01Baldry  2012Li and White 2009Ref-L100N1504 z01Ref-L100N1504Recal-L025N0752789101112log10MMz05Ilbert 2013 02z05Ilbert 2013 05z08Muzzin 2013 02z05Muzzin 2013 05z10Tomczak 2014 050  z  075Moustakas 2013 04z05Moustakas 2013 05z07789101112log10MM654321log10dndlog10McMpc3z10Ilbert 2013 08z11Ilbert 2013 11z15Muzzin 2013 05z10Muzzin 2013 10z15Tomczak 2014 075  z  100Tomczak 2014 100  z  125Moustakas 2013 08z10789101112log10MM654321log10dndlog10McMpc3z20Ilbert 2013 15z20Ilbert 2013 20z25Muzzin 2013 15z20Muzzin 2013 20z25Tomczak 2014 150  z  200Tomczak 2014 200  z  250z30Ilbert 2013 25z30Ilbert 2013 30z40Muzzin 2013 25z30Muzzin 2013 30z40-6-5-4-3-2-1log10dndlog10McMpc3z40Ilbert 2013 30z40Muzzin 2013 30z40789101112log10MM654321log10dndlog10McMpc3z50Duncan 2014 z5Gonzalez 2011 z50789101112log10MMz60Duncan 2014 z6Gonzalez 2011 z59789101112log10MM-6-5-4-3-2-1log10dndlog10McMpc3z70Duncan 2014 z7Gonzalez 2011 z6810 M Furlong et al
Figure 3 The simulated GSMF at redshift two from Eagle with-
out random mass errors red convolved with the stellar mass
error of Behroozi Wechsler  Conroy 2013 used in Figure 2
blue and with random errors of a factor two green The ran-
dom errors have a signicant eect on the shape of the massive
end of the GSMF transforming the simulation from mildly dis-
crepant with the observational data to being in excellent agree-
ment with data The Gaussian convolution with a stellar mass
error is motivated by the random errors associated with the
Malmquist bias The horizontal black lines in the lower left of
the gure indicate the estimated magnitudes of systematic errors
in stellar masses according to Muzzin et al 2009 Conroy Gunn
 White 2009 and Behroozi Wechsler  Conroy 2013 at red-
shift two Systematic errors are expected to maintain the shape of
the GSMF but would shift it horizontally Within the estimated
level of uncertainty in observations the simulation shows agree-
ment with observations of the GSMF including the location of
the break although the low-mass slope may be slightly too steep
these high redshifts over the mass ranges considered here
Hence for redshifts above 5 a Schechter t may not be an
appropriate description of the data
321 Galaxy stellar mass errors
When comparing the simulation to observations it is impor-
tant to consider the role of stellar mass errors both random
and systematic We begin by considering the random errors
In Figure 3 the GSMF from Ref-L100N1504 is plotted at
redshift two assuming no stellar mass error red a random
mass error of 007  004z Behroozi Wechsler  Conroy
2013 as in Figure 2 blue resulting in an error of 40 in
galaxy stellar mass at redshift two and a mass error of a fac-
tor of two green ie 100 Where the GSMF is reasonably
at ie at masses below 10105 Mcid12 the impact of random
uncertainty is minimal However above this mass the shape
of the GSMF depends strongly on the random stellar mass
errors in the observations because more low-mass galaxies
are scattered to high masses than vice versa If we increase
the random errors the exponential break becomes less sharp
and the simulation agrees better with the observations
There are also systematic errors to consider in the de-
termination of stellar masses from observed ux or spectra
Fitting the spectral energy distribution SED of a galaxy is
sensitive to the choice of stellar population synthesis SPS
model eg due to the uncertainty in how to treat TP-AGB
stars the choice of dust model and the modelling of the star
formation histories eg Mitchell et al 2013 Systematic
variations in the stellar IMF would result in additional un-
certainties which are not considered here The systematic
uncertainties from SED modelling increase with redshift At
redshift zero Taylor et al 2011 quote  01 dex 1 errors
for GAMA data At redshift two the estimated systematic
error on stellar masses ranges from 03 dex Muzzin et al
2009 to 06 dex Conroy Gunn  White 2009 based on
uncertainties in SPS models dust and metallicities Figure
3 gives an impression of the size of these systematic errors
by plotting values from Muzzin et al 2009 Conroy Gunn
 White 2009 and Behroozi Wechsler  Conroy 2013
in the bottom left corner The Behroozi Wechsler  Con-
roy 2013 estimate is divided into star forming and passive
galaxies due to the reduced sensitivity of passive galaxies to
the assumed form of the star formation history The system-
atic stellar mass errors are expected to shift the GSMF along
the stellar mass axis Considering the extent of the system-
atic uncertainties we nd the GSMF from Eagle to be con-
sistent with the observational data although the low-mass
slope may be slightly too steep The observed evolutionary
trends in the normalisation and break are reproduced by
the simulation suggesting that the simulation is reasonably
representative of the observed Universe
322 Numerical convergence
Having found reasonable agreement between the evolution
in the Ref-L100N1504 simulation and the observations it is
important to ask if the results are sensitive to numerical res-
olution We consider only weak convergence tests here ie
we only examine the ability of the simulation to reproduce
the observed evolution after recalibrating the high-resolution
simulation to the same conditions namely the redshift 01
GSMF as used for the standard resolution simulation In
Figure 2 the high-resolution model Recal-L025N0752 is
shown in green
The 25 cMpc box is too small to sample the break in
the GSMF accurately To avoid box size issues we do not
consider the GSMF when there are fewer than 10 galaxies
per bin ie where the green curve is dashed The 25 cMpc
box also shows more uctuations due to poorer sampling
of the large-scale modes in a smaller computational volume
At masses below 108 Mcid12 when there are fewer than 100
star particles per galaxies in the Ref-L100N1504 simulation
blue dotted curve the slope of the high-resolution simula-
tion is atter than that of Ref-L100N1504 Where the solid
part of the blue and green curves overlap there is excellent
agreement to better than 01 dex between both resolutions
across all redshifts Overall this amounts to good weak
numerical convergence in the simulation across all redshifts
that can be probed given the limitations imposed on the
test due to the small volume of the high-resolution run
In summary we have found the stellar mass density in
the simulation to be close to the values estimated from ob-
servations with a maximum oset of  20 due to the slight
ccid13 2015 RAS MNRAS 000 120
89101112log10MM654321log10dndlog10McMpc3Muzzin 2009Conroy 2009Behroozi 2011 PassiveBehroozi 2001 SFz20No ErrorStd ErrorFactor of 2Galaxy evolution in the Eagle simulations
while the estimated SFR include error bars of about 015
dex with larger error bars above redshift two
At high redshift the simulated SFR solid black curve
increases with time peaks around redshift two followed by a
decline of almost an order of magnitude to redshift zero The
simulation reproduces the shape of the observed SFR as a
function of time very well but falls below the measurements
by an almost constant and small oset of 02 dex at z cid54 3
The grey dashed line in Fig 4 shows SFR increased by
02 dex While the simulation agrees reasonably well with
the observational data at redshifts above 3 we caution that
these measurements are reasonably uncertain For example
the dierence between open and lled symbols for Bouwens
et al 2012 data shows the estimated dust correction that
is applied to the observations
42 Specic star formation rates
Observationally a well dened star forming sequence as a
function of stellar mass has been found in the local Universe
which appears to hold up to a redshift of 3 eg Noeske et al
2007 Karim et al 2011 It is described by a relation of the
cid18 M
1010Mcid12
cid19
where  is the logarithmic slope  is the normalisation and
MM is the specic star formation rate SSFR Observa-
tions indicate that  is negative but close to zero and it is
often assumed to be constant with stellar mass
Figure 5 shows the SSFR for star forming galaxies as
a function of galaxy stellar mass at redshifts 01 1 and 2
The observational data sets for the SSFRs we compare to at
redshift 01 are from Gilbank et al 2010a stars and Bauer
et al 2013 squares These data sets show similar values
for the normalisation and slope and a similar scatter above
109 Mcid12 Below 109 Mcid12 only Gilbank et al 2010a data
is available This data shows an increase in the SSFR with
decreasing stellar mass below 1085 Mcid12 Rodighiero et al
2010 inverted triangles Karim et al 2011 circles and
Gilbank et al 2010b stars are shown at higher redshifts
Comparing these data sets Rodighiero et al 2010 and
Karim et al 2011 have similar slopes and normalisation at
redshifts one and two However the Gilbank et al 2010b
data is substantially 08 dex lower in normalisation over
the mass ranges where it overlaps with Rodighiero et al
2010 and Karim et al 2011 The ROLES data used by
Gilbank et al 2010b probes faint galaxies down to masses
below 109 Mcid12 but this deep survey covers only a small
area of sky The resulting small number statistics of massive
galaxies may be driving this oset in SSFR from the other
observational data sets
The median SSFRs for star forming galaxies from Ref-
L100N1504 and Recal-L025N0752 are shown as blue and
green curves respectively The horizontal dotted lines cor-
respond to the SSFR cut  1 dex below the observational
data used to separate star forming from passive galaxies
At redshift 01 the SSFR in the simulations is reason-
ably independent of stellar mass where well resolved up
to masses of 1010 Mcid12 Above this mass the SSFR decreases
slowly with stellar mass The simulations show a scatter of
around 06 dex across the stellar mass range resolved by
Figure 4 Evolution of the cosmic star formation rate density
The Eagle simulation Ref-L100N1504 is plotted as a solid black
curve observational data are plotted as symbols Open symbols
from Bouwens et al 2012 exclude a dust correction to the SFRs
giving an impression of the uncertainty in the measurement The
simulation tracks the evolution of the observed SFR very well
albeit with an almost constant 02 dex oset grey dashed line
below redshift z  3
undershooting of the Eagle GSMF around the knee of the
mass function The observed evolutionary trends in terms
of changes in the shape and normalisation of the GSMF
between redshift 01 to 7 are reproduced although the evo-
lution in the normalisation is not suciently strong in the
simulation from redshift 1 to 2 with an oset in normali-
sation at redshift 2 of  02 dex The break in the GSMF
occurs at too low a mass in the simulation compared to the
observations at redshifts 2 to 4 However the box size limits
the number of objects produced in the simulation and we
have shown that stellar mass errors play a signicant role
in dening the observed break of the GSMF As a result of
these uncertainties aecting the comparison the remaining
dierences between the simulation and observations do not
suggest signicant discrepancies in the model
4 EVOLUTION OF STAR FORMATION RATES
41 The cosmic star formation rate density
The star formation rate density SFR as a function of red-
shift is plotted for simulation Ref-L100N1504 in Figure 4
For comparison observations from Gilbank et al 2010a
H Rodighiero et al 2010 24m Karim et al 2011
Radio Cucciati et al 2012 FUV Bouwens et al 2012
UV  Robertson et al 2013 UV and Burgarella et al
2013 FUV  FIR are shown as well This compilation of
data covers a number of SFR tracers providing an overview
of SFR estimates from the literature as well as an indi-
cation of the range of scatter and uncertainty arising from
dierent methods of inferring SFR There is a spread in the
measured SFR of around 02 dex at redshifts less than two
ccid13 2015 RAS MNRAS 000 120
012345678910z00010010110SFR M yr1 Mpc3Karim 11 radioRodighiero 10 24mCucciati 12 FUVGilbank 10 HRefL100N150402 dex increase0079105117123126131133Lookback Time GyrBurgarella 13 FUVIRRobertson 13 UVBouwens 12 UVBouwens 12 UV no dust12 M Furlong et al
MM as a function of galaxy stellar mass for Ref-L100N1504 and Recal-L025N0752
Figure 5 The specic star formation rate SSFR
from left to right at redshifts 01 1 and 2 The solid curves show the median relation for star forming galaxies dened as those with a
SSFR above the limit specied by the horizontal dotted line in each panel The shaded region dot dashed curves encloses the 10th to
90th percentiles for Ref-L100N1504 Recal-L025N0752 Where there are fewer than 10 galaxies per bin individual data points are shown
Lines are dotted when the stellar mass falls below that corresponding to 100 star-forming particles for the median SSFR and the mass
of 100 baryonic particles to indicate that resolution eects may be important At redshift 01 the observational of Gilbank et al 2010a
and Bauer et al 2013 are shown as light blue stars and yellow squares respectively Error bars enclose the 10th to 90th percentiles At
higher redshift data from Gilbank et al 2010b Karim et al 2011 and Rodighiero et al 2010 are shown as light blue stars pink
circles and turquoise inverted triangles respectively The observed at slope with stellar mass and the increase in normalisation with
redshift are reproduced by the simulations but the simulation is lower in normalisation by 02 to 04 dex depending on redshift and the
observational data set
Figure 6 The passive fraction as a function of galaxy stellar mass for Ref-L100N1504 and Recal-L025N0752 in blue and green
respectively where galaxies with a SSFR below the horizontal dotted lines in Figure 5 are dened as passive Lines are dotted when the
stellar mass falls below that corresponding to 30 star-forming particles for the SSFR limit Data points show observations as indicated in
the legends The black points represent the observational redshift bin below the simulation redshift while the grey curves are from the
redshift bin above the simulation snapshot Above 109 Mcid12 the simulated passive fractions show similar normalisation and slope with
stellar mass to observations at all redshifts with a small decit of passive galaxies of around 15 in the mass range 10105 to 10115 Mcid12
The upturn at low masses below 109 Mcid12 is a numerical artefact
ccid13 2015 RAS MNRAS 000 120
789101112log10MM0010110SFRM  Gyr1z01Gilbank 2010 SFBauer 2013Gilbank 2010 SFBauer 2013789101112log10MMz10Gilbank 2010abKarim 2011Rodighiero 2010Ref-L100N1504Recal-L025N0752789101112log10MM0010110SFRM  Gyr1z20Karim 2011Rodighiero 2010Karim 2011Rodighiero 2010789101112log10MM000204060810Passive Fractionz01Gilbank 10aBauer 13Moustakas 13Ref-L100N1504Recal-L025N0752789101112log10MMz10Ilbert 13Moustakas 13Muzzin 13Ilbert 13Moustakas 13Muzzin 13789101112log10MM000204060810Passive Fractionz20Ilbert 13Muzzin 13Ilbert 13Muzzin 13Galaxy evolution in the Eagle simulations
Figure 7 Evolution of the specic star formation rate SSFR as a function of lookback time for stellar mass bins 1090 M  1095
Mcid12 left 1095 M  10100 Mcid12 middle and 10100 M  10105 Mcid12 right for Ref-L100N1504 and Recal-L025N0752 in blue and
green respectively Solid curves show the median SSFR from the simulation for star forming galaxies the shaded region dotted curves
enclose the 10th and 90th percentile values for Ref-L100N1504 Recal-L025N0752 Medians are only shown when there are more than
10 galaxies per bin Observational data from Gilbank et al 2011 Bauer et al 2013 Karim et al 2011 Rodighiero et al 2010
Gonzalez et al 2012 and Stark et al 2013 are shown The simulation shows good agreement with the observed shape of the SSFR
evolution but there is an oset in normalisation of 02 to 04 dex as seen in Figure 5
Ref-L100N1504 The normalisation of the Recal-L025N0752
simulation lies 02 dex above that of Ref-L100N1504 as was
already shown in S15 At low masses when there are fewer
than 100 star-forming particles per galaxy there is an in-
crease in SSFR with stellar mass in Ref-L100N1504 How-
ever by comparing with Recal-L025N0752 we see that this
is resolution driven
The trend with stellar mass above 109 Mcid12 is similar in
the simulations and the observations However there is an
oset in the normalisation from observations where Recal-
L025N0752 and Ref-L100N1504 are low by  01 and 03 dex
respectively The increase in SSFR at a stellar mass of 1085
Mcid12 reported by Gilbank et al 2010a is not seen in the
Recal-L025N0752 simulation which has sucient numerical
resolution to compare to observations at these low masses
This could indicate that stellar feedback is too strong in
low-mass galaxies or perhaps that the observational data is
not volume complete due to the diculty in detecting low-
mass galaxies with low star formation rates owing to their
low surface brightness see S15 for more discussion of the
redshift 01 properties
At higher redshifts the simulation SSFRs increase in
normalisation maintaining a at slope below 1010 Mcid12 with
a shallow negative slope above this stellar mass At red-
shifts between one and two the Recal-L025N0752 and Ref-
L100N1504 SSFRs lie within 01 dex of each other across
ccid13 2015 RAS MNRAS 000 120
the stellar mass ranges for which both are resolved The in-
crease in normalisation seen in the simulations reproduces
the observed trend although the oset in normalisation in-
creases to up to 05 dex when comparing to the data sets
of Rodighiero et al 2010 and Karim et al 2011 Rela-
tive to the Gilbank et al 2010b data at redshift one the
median SSFR from the simulation agrees to within around
02 dex Comparing the slope of the SSFR-M relation of
Gilbank et al 2010b to the simulations the simulation is
atter below 1010 Mcid12 but is in agreement with the slopes
of Karim et al 2011 and Rodighiero et al 2010
Observationally the galaxy population exhibits a bi-
modal colour distribution which may imply a bimodality
in the SSFR To study this bimodality in the simulation we
show in Figure 6 the passive fraction of galaxies as a func-
tion of mass at redshifts 01 1 and 2 At higher redshifts
the simulation volume does not provide suciently massive
galaxies to overlap with those detectable in observations In
the simulation we dene passive galaxies by a cut in SSFR
that is an order of magnitude below the median observed
SSFR dotted horizontal line in Figure 5 Varying this limit
while keeping it below the main star forming sequence has
negligible impact on the recovered median SSFR although
it can increase or decrease the passive fractions by around
For comparison passive fractions from Gilbank et al
024681012Lookback Time Gyr-2-101log10SFRMGyr190log10MM95Bauer 2013Gilbank 2010abGonzalez 2012Rodighiero 2010Stark 2013Ref-L100N1504Recal-L025N075200020406102030z024681012Lookback Time Gyr95log10MM100Bauer 2013Gilbank 2010abGonzalez 2012Karim 2011Rodighiero 2010Stark 2013Bauer 2013Gilbank 2010abGonzalez 2012Karim 2011Rodighiero 2010Stark 201300020406102030z024681012Lookback Time Gyr-2-101log10SFRMGyr1100log10MM105Bauer 2013Gilbank 2010abKarim 2011Rodighiero 2010Bauer 2013Gilbank 2010abKarim 2011Rodighiero 20100002040610203080z14 M Furlong et al
2010a Bauer et al 2013 and Moustakas et al 2013
are shown at redshift 01 and from Moustakas et al 2013
Muzzin et al 2013 and Ilbert et al 2013 at higher red-
shifts For most observational data sets shown the passive
fraction is determined based on a colour or SSFR cut as
applied in the published data sets Gilbank et al 2010a
provide tabulated stellar masses and SFRs for each galaxy
and we therefore apply the same SSFR cut as we use for the
simulation data At redshift 01 the dependence of passive
fraction on stellar mass is similar for all observational data
sets At redshift one each observational data set shows the
same trend but there is a dierence of up to 015 in the pas-
sive fraction for M cid46 1011 Mcid12 for dierent data sets and a
larger dierence above this mass At redshift two agreement
between data sets is poor
The passive fraction from Ref-L100N1504 and Recal-
L025N0752 are shown in blue and green respectively As
a resolution guide where the stellar mass is less than the
maximum of 100 baryonic particles and 30 gas particles for
the mass that corresponds to the SSFR cut lines are dotted
As the SSFR cut evolves with redshift this resolution guide
evolves with redshift The guide was chosen based on a com-
parison of the passive fractions for central galaxies in Ref-
L100N1504 and Recal-L025N0752 not shown Both feed-
back and environment can quench star formation in galaxies
As dierent environments are probed in simulations of dif-
ferent box size the passive fractions are expected to dier
between Ref-L100N1504 and Recal-L025N0752 not only be-
cause of the resolution but also due to the box size To over-
come this a comparison is carried out for central galaxies in
the two simulations which probe similar environments This
yields a dierence in the passive fractions when a galaxys
stellar mass is resolved by a minimum of 100 particles and
the SSFR for the passive threshold is resolved by a minimum
of 30 gas particles
Over the resolved mass range the passive fraction at
redshift 01 follows a similar trend to the observational data
although there are too few passive galaxies between 10105
and 10115 Mcid12 by around 15 In the simulations passive
fractions are lower at redshift 1 than at redshift 01 This
is consistent with what is seen in observational studies al-
though there are again fewer passive galaxies in the range of
10105 to 10115 Mcid12 than observed At redshift two there is a
further drop in the passive fraction of galaxies both in the
simulation and the observations Summarising the passive
fractions show the same trend as observations when galaxy
masses and SFRs are resolved although there are too few
passive galaxies by  15 in the stellar mass range 10105
to 10115 Mcid12
To better study the evolution of the SSFR and to ex-
tend the comparison to higher redshifts we show in Figure
7 the SSFR as a function of lookback time in three dier-
ent stellar mass bins of 05 dex centred on 10925 10975
and 101025 Mcid12 The median SSFR for star forming galax-
ies from Ref-L100N1504 and Recal-L025N0752 are shown
in blue and green respectively In all mass bins the SSFR
increases with lookback time Comparing the two simula-
tion above redshift one the SSFRs of the two simulations
are converged to within 01 dex At lower redshifts for stel-
lar masses below 1095 Mcid12 Recal-L025N0752 has a slightly
higher SSFR by up to 02 dex Similar trends are found
when considering other mass bins of 05 dex between 1085
and 10115 Mcid12
We compare the simulation data with the observations
presented in Figure 5 adding Gonzalez et al 2012 and
Stark et al 2013 at redshifts 4 and above The observed
trend with redshift is reproduced there is however an o-
set in normalisation of 02  05 dex at all times across all
mass ranges as seen in Figure 5 We found previously that
the global star formation rate density was low by  02 dex
across all redshifts relative to the values estimated from ob-
servations Section 41 An oset in SFR does not convert
directly into an oset in SSFR due to the potential increase
in stellar mass if SFRs were to increase The oset in SFR
thus can not fully account for the oset in SSFR If the
SFRs were boosted by 03 dex across all mass ranges at all
redshifts as required to produce more consistent results rel-
ative to the observational data the agreement for the stellar
mass density from Section 31 would be broken A possible
solution to the low SSFRs is that the star formation in the
simulated galaxies is not suciently bursty We will return
to this possibility in the discussion
As for the stellar mass there are also uncertainties in
the SFRs inferred from observations Dierences in the mea-
sured star formation rate density from dierent star forma-
tion tracers are of order 02 dex as in Figure 4 while Utomo
et al 2014 claim that SFRs inferred from UV and IR ob-
servations may be overestimated relative to those obtained
by simultaneously modelling of stellar and dust emission si-
multaneously A recent study by Boquien Buat  Perret
2014 also nd SFRs to be overestimated in FUV and U
bands Attempting to quantify the level of uncertainty in
SFRs is dicult owing to the dierent sensitivity of each
star formation tracer UV observations require a large cor-
rection for the light that is absorbed IR observations require
information about the peak of the SED to constrain the to-
tal infrared luminosity and must assume all star formation is
shrouded in dust if information from the UV is unavailable
Radio and IR observations can suer from contamination
by AGN and rely on an empirical calibration between the
ux and SFR At high redshift where stacking is often nec-
essary due to decreased ability to detect individual objects
there is a risk that the sample is incomplete biasing results
towards higher star formation rates Perez-Gonzalez et al
2008 quote a factor of two 03 dex in the uncertainty
of IR SFRs due to dust Muzzin et al 2009 nd a scat-
ter of a factor of 28 045 dex depending on the bands
available for tting the SED The SSFRs from the Eagle
Ref-L100N1504 model are only consistent with observations
if the values inferred from the data are systematically high
by about a factor of two
The systematic oset in SSFRs between models and
observations has been noted before Weinmann et al 2012
and Genel et al 2014 reported this issue for hydrodynam-
ical simulations while recent studies such as Mitchell et al
2014 and White Somerville  Ferguson 2014 revisited
the issue with semi-analytic models White Somerville 
Ferguson 2014 propose two plausible solutions to the is-
sue based on their semi-analytic modelling In the rst so-
lution star formation in low-mass galaxies forming at early
times is preferentially suppressed delaying star formation
and providing further fuel for stars to form at later times In
the simulations presented here Ref-L100N1504 and Recal-
ccid13 2015 RAS MNRAS 000 120
L025N0752 the dependence of the feedback on local gas
metallicity and density does indeed result in preferential
suppression of low mass galaxies at early times and this does
improve the behaviour of the SSFRs relative to Eagle sim-
ulations with constant feedback or velocity dispersion de-
pendent feedback presented in Crain et al 2015 However
to fully resolve the oset in SSFRs much stronger feedback
is required in low-mass high-redshift galaxies than the feed-
back that is implemented here Although the requirement
for more ecient feedback may in part be a result of nu-
merical radiative losses The second solution that White
Somerville  Ferguson 2014 appeal to with a similar solu-
tion proposed by Mitchell et al 2014 is limiting the cold
gas available for star formation by reducing the accretion
of gas from hot and ejected reservoirs onto halos see also
Bower Benson  Crain 2012 As our simulation follows the
gravity and hydrodynamics of the gas it is not a reasonable
solution to apply to the accretion of gas in hydrodynamical
simulation
In summary the simulation reproduces the shape of the
evolution of SFR with redshift seen in observations with
a 02 dex oset The bimodality in SSFR the slope with
mass and the shape of the evolution of the SSFRs as a func-
tion of time are also reproduced by the simulation However
the normalisation is 02-05 dex too low at all redshifts and
across all masses This oset cannot be resolved by a simple
systematic shift in SFRs in the simulation due to the impli-
cations such a shift would have for  However the level of
uncertainty in the data is such that the level of inconsistency
in the Eagle specic star formation rates may be smaller
than suggested by current observations
5 DISCUSSION
We have presented the evolution of the stellar masses and
star formation rates in two of the Eagle cosmological hydro-
dynamical simulations We have focused on Ref-L100N1504
a 100 cMpc3 box with baryonic particle masses of 181106
Mcid12 and Recal-L025N0752 a 25 cMpc3 box with baryonic
particle masses of 226 105 Mcid12 These simulations use ad-
vanced SPH techniques and state-of-the-art subgrid models
including cooling metal enrichment energy input from stel-
lar feedback black hole growth and feedback from AGN
The subgrid parameters depend only on local gas proper-
ties The free parameters of the model have been calibrated
to reproduce the observed local Universe GSMF with con-
sideration given to galaxy sizes Crain et al 2015 The re-
sulting model has been shown to reproduce many observa-
tions around redshift zero including the Tully-Fisher rela-
tion specic star formation rates the mass-metallicity rela-
tion black hole masses and the column density distribution
functions of intergalactic CIV and OVI S15
In this paper we extend the comparison with observa-
tions of galaxy stellar masses and star formation rates from
redshift zero to redshift seven This comparison with obser-
vations enables us to carry out a multi-epoch verication of
the Eagle galaxy formation model where the galaxy prop-
erties in this comparison are predictions of the model ie
ccid13 2015 RAS MNRAS 000 120
Galaxy evolution in the Eagle simulations
evolution histories were not considered during the calibra-
tion of model parameters
We began our comparison by nding a better than 20
per cent agreement with the evolution of the stellar mass
density across all epochs Figure 1 For the GSMF good
agreement was typically found for the evolution of the nor-
malisation and break when comparing the simulation to ob-
servationally inferred data Figure 2 The normalisation re-
mains reasonably constant from redshift 01 to 1 and then
decreases to redshift 2 The decrease continues at higher
redshifts Although this behaviour is qualitatively consis-
tent with observations at redshift 2 the normalisation be-
low 10105 Mcid12 is too high by  02 dex Semi-analytical
models have also reported normalisations that are too high
relative to observations at z  2 eg Weinmann et al 2012
although see Henriques et al 2014 for a possible solution
in semi-analytics In the current Eagle implementation of
stellar feedback galaxies with low metallicity and high den-
sity typical in the early universe experience strong feed-
back The available feedback energy can be up to three times
that available from core collapse supernova which compen-
sates for numerical radiative losses A comparison with the
normalisation of the observed GSMF at redshift 2 suggests
that even more ecient stellar feedback is required in low
mass objects at redshifts above two More ecient feedback
at high redshifts could provide surplus gas at later times
through recycling helping to boost the SSFRs  MM
as is required based on the comparison with observational
data in Figure 7
The break in the GSMF in the simulation evolves in a
similar way to that observed however between redshifts 2
and 4 there is too little mass in simulated galaxies above
1011 Mcid12 suggesting that less ecient AGN feedback or
stellar feedback in high mass objects at high redshifts is re-
quired to produce the observed evolution of the break in the
GSMF Less ecient AGN feedback at high redshifts would
also result in more star formation around the peak epoch
of star formation at redshift two as favoured by current
observational data for the star formation rate density The
requirement for weaker AGN feedback however is very sen-
sitive to the stellar mass errors that arise from inferring the
GSMF from observations While recent observations of the
GSMF are typically consistent with each other within their
error bars it is important to consider both random and sys-
tematic uncertainties in inferring stellar mass from observed
ux as shown in Figure 3 As a result of the sensitivity of
the exponential break in the GSMF to the stellar mass er-
rors it is dicult to determine if the AGN are indeed overly
eective in the simulation
The largest discrepancy we nd with observational data
is in the SSFRs of star forming galaxies which are 02 to
05 dex below the values inferred from observations across
all of cosmic time Figure 7 This discrepancy cannot be
explained as a simple systematic oset in the simulation
as we have shown the stellar mass density to be consistent
with observations to within 01 dex Applying a systematic
boost to the star formation rates of 03 dex would undo the
agreement in the stellar mass density It is puzzling that the
SSFRs are systematically low yet the stellar mass growth
is consistent with the observational data However we have
also found that the galaxy passive fractions appear too low
by up to 15 per cent between 10105 and 10115 Mcid12 Figure
16 M Furlong et al
5 Assuming that the observed star formation rates are ac-
curate a potential solution to the low SSFRs is that the star
formation is not suciently bursty More bursty episodes of
star formation could produce the same stellar mass with
higher star formation rates over shorter time periods than
in the current simulation This solution has the advantage
that it would also increase the passive fractions as galaxies
would be star forming for a smaller fraction of the time
Observed stellar masses and star formation rates are
uncertain at the 01 to 03 dex level across all observed
redshifts Until recently hydrodynamical simulations have
struggled to reproduce redshift zero galaxy populations
within the observational uncertainties not to mention the
evolution of the galaxy population The simultaneous com-
parison to stellar masses and star formation rates across
cosmic time thus provides a stringent test for the evolution
of galaxy properties in our galaxy formation model The
Eagle Ref-L100N1504 simulation performs relatively well
in this test verifying that the simulation produces galax-
ies with reasonable formation histories for a redshift zero
galaxy population that is representative of the observed Uni-
verse The agreement with observational data from redshifts
0 to 7 is at the level of the systematic uncertainties and fol-
lows the observed evolutionary trends This gives us con-
dence that the model can be used as a reliable tool for in-
terpreting observations and to explore the physics of galaxy
formation To give further condence our simulation shows
weak numerical convergence as dened in Section 22 of the
GSMF to within 01 dex for galaxies of stellar masses greater
than 100 baryonic particles5 and of the SSFRs to within 01
dex when star formation rates are resolved by a minimum of
100 star forming particles when going to a factor of 8 higher
resolution This level of convergence enables us to extend
the galaxy population to lower stellar masses by a factor of
8 using Recal-L025N0752 the higher-resolution simulation
While there is scope to improve agreement with ob-
servational data it is not clear that this should currently
be a priority for a number of reasons Given that the level
of systematic uncertainty in the observations are similar to
the level of agreement with the simulation better agree-
ment with observations would not automatically translate
into more condence in the model Secondly as hydrody-
namical simulations are computationally expensive full pa-
rameter space searches are unfeasible using current technol-
ogy Finally it is likely that achieving better agreement with
observations would require more complex parameterisation
of the subgrid models which would be better motivated if
changes were supported by small scale simulations modelling
ISM physics and smoothed to the resolution of current cos-
mological simulations While many studies of this kind are
underway eg Creasey Theuns  Bower 2013 they do
not yet model all the relevant physics and currently require
too much computational time to be incorporated into full
cosmological simulations
5 Strong numerical convergence tests are presented in Appendix
6 SUMMARY
We have compared the build-up of the stellar mass density
and the evolution of the galaxy stellar mass function and
galaxy star formation rates in the Eagle cosmological sim-
ulations to recent observations The Eagle suite includes
cosmologically representative volumes of up to 100 cMpc3
as well as smaller boxes run with higher numerical resolution
to assess convergence and to extend the results to lower-mass
galaxies The simulations include physically motivated sub-
grid models for processes that cannot be resolved with pa-
rameters calibrated to reproduce the observed redshift z  0
galaxy stellar mass function and galaxy sizes Eagle is de-
scribed in detail and compared with a variety of observations
of the present-day Universe in Schaye et al 2015 In this
paper we investigated whether the good agreement between
simulations and observations of galaxy masses and star for-
mation rates at z  0 extends to higher redshift z  0  7
Our main ndings are as follows
 The stellar mass density in the simulation tracks the ob-
served value to within 20 per cent across cosmic time Figure
1 Observed trends in the evolution of the galaxy stellar
mass function are reproduced to within plausible observa-
tional uncertainties over the full redshift range z  0  7
Figure 2
 The observed shape of the evolution of the star forma-
tion rate density Figure 4 and the trends of specic star
Mcid63Mcid63 as a function of stellar mass and
formation rate
lookback time Figure 5 7 are all reproduced accurately
The fraction of passive galaxies increases with stellar mass in
the simulation in agreement with the observed trend Fig-
ure 6
 Below stellar masses of  10105 Mcid12 the normalisation
of the galaxy stellar mass function is above the observa-
tions by  02 dex at redshift 2 There is a similar oset
in the normalisation of the specic star formation rates
which are low by 02-05 dex across all redshifts The re-
cent papers of Mitchell et al 2014 White Somerville 
Ferguson 2014 highlighted a similar discrepancy with the
data based on semi-analytical models These apparent dis-
crepancies may result from systematic uncertainties in the
observations However if they are real then this would im-
ply that even stronger feedback is required at high redshift
than what is currently implemented in Eagle Burstier star
formation histories could possibly also resolve the apparent
discrepancy
 Galaxy stellar mass functions and star formation rates
are reasonably well converged across all redshifts at which
the convergence can be tested Figure 2 5
ACKNOWLEDGEMENTS
The authors are very grateful for the endless technical sup-
port provided by Dr Lydia Heck during the preparation of
these simulations and during post processing MF thanks
Violeta Gonzalez-Perez and Peter Mitchell for providing ob-
servational data sets
RAC is a Royal Society University Research Fellow
This work used the DiRAC Data Centric system at Durham
University operated by the Institute for Computational
Cosmology on behalf of the STFC DiRAC HPC Facility
ccid13 2015 RAS MNRAS 000 120
wwwdiracacuk This equipment was funded by BIS Na-
tional E-infrastructure capital grant STK00042X1 STFC
capital grant STH0085191 and STFC DiRAC Opera-
tions grant STK0032671 and Durham University DiRAC
is part of the National E-Infrastructure We also grate-
fully acknowledge PRACE for awarding us access to the
resource Curie based in France at Tres Grand Centre de
Calcul This work was sponsored by the Dutch National
Computing Facilities Foundation NCF for the use of
supercomputer facilities with nancial support from the
Netherlands Organization for Scientic Research NWO
The research was supported in part by the European Re-
search Council under the European Unions Seventh Frame-
work Programme FP72007-2013  ERC Grant agree-
ments 278594-GasAroundGalaxies GA 267291 Cosmiway
and 321334 dustygal the Interuniversity Attraction Poles
Programme initiated by the Belgian Science Policy OWNce
AP P708 CHARM the National Science Foundation un-
der Grant No NSF PHY11-25915 the UK Science and Tech-
nology Facilities Council grant numbers STF0011661 and
STI0009761 Rolling and Consolidating Grants to the
ICC Marie Curie Reintegration Grant PERG06-GA-2009-
256573 Marie Curie Initial Training Network Cosmocomp
PITN-GA-2009-238356
REFERENCES
Baldry I K et al 2012 MNRAS 421 621
Bauer A E et al 2013 MNRAS 434 209
Behroozi P S Wechsler R H Conroy C 2013 ApJ 770
Booth C M Schaye J 2009 MNRAS 398 53
Boquien M Buat V Perret V 2014 AA 571 A72
Bouwens R J et al 2012 ApJ 754 83
Bower R G Benson A J Crain R A 2012 MNRAS
422 2816
Burgarella D et al 2013 AA 554 A70
Chabrier G 2003 PASP 115 763
Chiosi C Bertelli G Bressan A 1992 ARAA 30 235
Conroy C Gunn J E White M 2009 ApJ 699 486
Crain R A et al 2015 ArXiv e-prints arXiv150101311
Crain R A et al 2009 MNRAS 399 1773
Creasey P Theuns T Bower R G 2013 MNRAS 429
Cucciati O et al 2012 AA 539 A31
Cullen L Dehnen W 2010 MNRAS 408 669
Dalla Vecchia C Schaye J 2008 MNRAS 387 1431
Dalla Vecchia C Schaye J 2012 MNRAS 426 140
Davis M Efstathiou G Frenk C S White S D M 1985
ApJ 292 371
Dolag K Borgani S Murante G Springel V 2009 MN-
RAS 399 497
Duncan K et al 2014 MNRAS 444 2960
Durier F Dalla Vecchia C 2012 MNRAS 419 465
Ferland G J Korista K T Verner D A Ferguson J W
Kingdon J B Verner E M 1998 PASP 110 761
Genel S et al 2014 MNRAS 445 175
Gilbank D G Baldry I K Balogh M L Glazebrook K
Bower R G 2010a MNRAS 405 2594
Gilbank D G et al 2010b MNRAS 405 2419
Gilbank D G et al 2011 MNRAS 414 304
ccid13 2015 RAS MNRAS 000 120
Galaxy evolution in the Eagle simulations
Gonzalez V Bouwens R J Labbe I Illingworth G
Oesch P Franx M Magee D 2012 ApJ 755 148
Gonzalez V Labbe I Bouwens R J Illingworth G Franx
M Kriek M 2011 ApJ 735 L34
Haardt F Madau P 2001 in Clusters of Galaxies and
the High Redshift Universe Observed in X-rays Neumann
D M Tran J T V eds
Henriques B White S Thomas P Angulo R Guo Q
Lemson G Springel V Overzier R 2014 ArXiv e-prints
arXiv14010365
Hopkins P F 2013 MNRAS 428 2840
Ilbert O et al 2013 AA 556 A55
Jenkins A 2010 MNRAS 403 1859
Jenkins A 2013 MNRAS 434 2094
Karim A et al 2011 ApJ 730 61
Kennicutt Jr R C 1998 ApJ 498 541
Lewis A Challinor A Lasenby A 2000 ApJ 538 473
Li C White S D M 2009 MNRAS 398 2177
Marigo P 2001 AA 370 194
Mitchell P D Lacey C G Baugh C M Cole S 2013
MNRAS 435 87
Mitchell P D Lacey C G Cole S Baugh C M 2014
MNRAS 444 2637
Moustakas J et al 2013 ApJ 767 50
Muzzin A et al 2013 ApJ 777 18
Muzzin A Marchesini D van Dokkum P G Labbe I
Kriek M Franx M 2009 ApJ 701 1839
Noeske K G et al 2007 ApJ 660 L43
Perez-Gonzalez P G et al 2008 ApJ 675 234
Planck Collaboration et al 2014 AA 571 A16
Portinari L Chiosi C Bressan A 1998 AA 334 505
Price D J 2008 Journal of Computational Physics 227
Robertson B E et al 2013 ApJ 768 71
Rodighiero G et al 2010 AA 518 L25
Rosas-Guevara Y M et al 2013 ArXiv e-prints
arXiv13120598
Scannapieco C et al 2012 MNRAS 423 1726
Schaye J 2004 ApJ 609 667
Schaye J et al 2015 MNRAS 446 521
Schaye J Dalla Vecchia C 2008 MNRAS 383 1210
Schaye J et al 2010 MNRAS 402 1536
Schechter P 1976 ApJ 203 297
Smit R et al 2014 ApJ 784 58
Springel V 2005 MNRAS 364 1105
Springel V Di Matteo T Hernquist L 2005 MNRAS
361 776
Springel V et al 2008 MNRAS 391 1685
Springel V White S D M Tormen G Kaumann G
2001 MNRAS 328 726
Stark D P Schenker M A Ellis R Robertson B
McLure R Dunlop J 2013 ApJ 763 129
Taylor E N et al 2011 MNRAS 418 1587
Thielemann F K Argast D Brachwitz F 2003 From
Twilight to Highlight The Physics of Supernovae Hille-
brandt W Leibundgut B
Tomczak A R et al 2014 ApJ 783 85
Utomo D Kriek M Labbe I Conroy C Fumagalli M
2014 ApJ 783 L30
Vogelsberger M Genel S Sijacki D Torrey P Springel
V Hernquist L 2013 MNRAS 436 3031
Vogelsberger M et al 2014 MNRAS 444 1518
18 M Furlong et al
Weinmann S M Pasquali A Oppenheimer B D Finla-
tor K Mendel J T Crain R A Maccio A V 2012
MNRAS 426 2797
Wendland H 1995 Advances Comput Math 4 389
White C E Somerville R S Ferguson H C 2014 ArXiv
e-prints arxiv14071850
White S D M Frenk C S 1991 ApJ 379 52
White S D M Rees M J 1978 MNRAS 183 341
Wiersma R P C Schaye J Smith B D 2009 MNRAS
393 99
Wiersma R P C Schaye J Theuns T Dalla Vecchia C
Tornatore L 2009 MNRAS 399 574
APPENDIX A SCHECHTER FUNCTION FITS
To provide a simple way of reproducing the Eagle GSMFs
and to quantify the trends seen in the evolution of the nor-
malisation and the exponential break we have t the Eagle
GSMFs with Schechter functions We t the GSMFs of Ref-
L100N1504 from redshifts 01 to 4 that were shown in Figure
2 blue curves with single Schechter functions eq 7 and
double Schechter functions
M dM 
cid20
cid18 M
cid191
cid192cid21
cid18 M
MMC dM
which is the sum of two Schechter functions with the same
characteristic mass MC but dierent normalisations 
and 
2 and dierent low-mass slopes 1 and 2 Double
Schechter ts are increasingly used in observational studies
tting the GSMF We use least squares tting with bins of
width 02 dex in stellar mass Bins are weighted by their
Poisson error thereby down weighting the poorly sampled
galaxies in the most massive stellar mass bins The ts over
the mass range 108 to 1012 Mcid12 are presented in Table A1
These ts compared to the simulation data can be seen in
Fig A1
To understand the dependence of the Schechter function
parameters on the tted mass range we applied our tting
routine over three mass ranges from 108 109 and 1010 to
1012 Mcid12 Figure A2 shows the evolution of the Schechter
function parameters MC  and  for the single Schechter
function ts For the single Schechter t MC drops over the
redshift range zero to four for all mass ranges However the
extent of the decrease depends on the tting range For ex-
ample there is a decrease of 05 dex when tting above 108
Mcid12 compared to a 03 dex decrease for ts above 109 and
1010 Mcid12  is reasonably at until redshift one with a de-
crease at redshifts above one for all ts There is however an
obvious dierence in the value of  recovered for dierent
tting ranges and there is also a dierence in their varia-
tion with redshift The opposite changes in MC and  for
the dierent mass ranges highlight the degeneracy between
these two parameters
The  parameter becomes more negative with increas-
ing redshift for ts above 108 and 109 Mcid12 showing that the
low mass slope steepens with redshift However dierent
behaviour is seen for ts above 1010 Mcid12 where  increases
to redshift 1 then decreases This is not unexpected given
that tting for stellar masses above 1010 Mcid12 does not pro-
Figure A2 The Schechter function parameters MC  and 
for the Eagle GSMFs as shown in Figure 2 as a function of
redshift These panels show single Schechter function parameters
t from 108 109 and 1010 Mcid12 to 1012 Mcid12 in red blue and green
respectively with 1- error bars from the tting The Schechter
function tting is sensitive to the mass range over which the t-
ting is done and the values for both MC and  are degenerate
For double Schechter function parameters the agreement between
dierent stellar mass ranges is worse due to the increased freedom
not shown
vide enough information to constrain the slope for masses
cid28MC
We nd larger dierences between dierent mass ranges
and in particular larger error bars when tting dou-
ble Schechter functions than what is presented for single
Schechter functions in Figure A2 Due to the sensitivity of
the Schechter tting to the mass range over which it is done
it is very dicult to compare the tting parameters directly
to observations This is especially true when we consider
the evolving mass completeness limit for observations Any
trends with redshift could easily be a result of the changing
mass range The degeneracy between MC and  also makes
a comparison of Schechter parameters dicult to interpret
The nal issue with directly comparing Schechter parame-
ters from observations andor simulations is the sensitivity
ccid13 2015 RAS MNRAS 000 120
012345z100104108112log10MCM00051015202530 103 cMpc3Eagle log10MlimM10Eagle log10MlimM9Eagle log10MlimM8012345z2018161412100806Galaxy evolution in the Eagle simulations
Table A1 Single eq 7 and double eq A1 Schechter function parameters for the Eagle Ref-L100N1504 GSMFs presented in Figure
2 tting over the mass range 108 to 1012 Mcid12 One sigma errors determined from the covariance matrix are also listed The Schechter
function parameters provide a simple way of reproducing the GSMFs from the Eagle simulation over the range where the tting is
carried out
 103 cMpc3
Redshift
log10MC 
Mcid12
1114  009
1111  008
1106  008
1091  008
1078  011
1060  015
Redshift
log10MC 
084  013
084  012
074  010
045  007
022  005
012  004
-143  001
-145  001
-148  001
-157  001
-166  001
-174  002
-131  003
-124  008
-098  017
-025  029
023  037
089  058
 103 cMpc3
000  000
008  010
048  020
080  014
061  013
043  012
-222  022
-179  015
-162  005
-158  002
-164  002
-169  003
Mcid12
1095  003
1088  004
1074  005
1044  008
1019  009
1000  011
 103 cMpc3
145  012
161  013
151  018
106  024
063  013
024  008
Figure A1 The GSMF from the Ref-L100N1504 simulation blue using single Schechter ts red dashed and using double Schechter
ts green dotted at 6 redshifts The parameters for the tting functions can be found in Table A1
ccid13 2015 RAS MNRAS 000 120
654321log10dndlog10McMpc3z01Ref-L100N1504Single FitDouble Fit89101112log10MMz0589101112log10MM654321log10dndlog10McMpc3z1089101112log10MM89101112log10MM654321log10dndlog10McMpc3z2089101112log10MMz3089101112log10MM-6-5-4-3-2-1log10dndlog10McMpc3z4020 M Furlong et al
Figure B1 The star formation rate density and stellar mass
density as a function of redshift in the top and bottom panels
for Ref-L025N0376 using the same physics as for Ref-L100N1504
shown in all previous plots Ref-L025N0752 with eight times the
resolution and Recal-L025N0752 with eight times higher resolu-
tion and recalibrated subgrid parameters in blue red and green
respectively
of the break in the Schechter function to stellar mass errors
as shown in Section 321 As a result of these issues we
choose not to compare the Schechter function parameters to
those determined observationally and consider the compari-
son of the data presented in Figure 2 from which Schechter
parameters are derived to be sucient to determine the
agreement between observations and simulations However
the Schechter function parameter do provide a simple way
of representing the GSMFs from the Eagle simulation over
the range where the tting is carried out
APPENDIX B STRONG NUMERICAL
CONVERGENCE
Here we show strong and weak resolution tests for the evo-
lution of the global stellar mass and star formation rate
densities in Fig B1 Three models are considered Ref-
L025N0376 equivalent in resolution and model parameters
to Ref-L100N1504 except in a 25 cMpc box as opposed to
100 cMpc Ref-L025N0752 with the same subgrid parame-
ters as Ref-L100N1504 but with 8 times higher mass reso-
lution in a 25 cMpc box and Recal-L025N0752 with recal-
ibrated subgrid parameters and 8 times higher mass resolu-
tion than Ref-L100N1504 in a 25 cMpc box The 25 cMpc
boxes for which we have higher-resolution simulations are
too small to be representative To ensure we do not obscure
the eects of resolution with other eects such as box size
we compare the same box size for all models
Figure B1 shows SFR for all three 25 cMpc simula-
tions in the top panel Between redshifts 9 and 5 the Ref-
L025N0376 simulation has an excess of star formation rel-
ative to both higher-resolution simulations of less than 02
dex which results from the coarser minimum star formation
rate per particle at the standard resolution The largest dif-
ference between the 3 simulations is at redshift 01 where
the Ref-L025N0752 has a higher SFR by 03 dex The  is
shown in the bottom panel of Figure B1 As  is the inte-
gral of SFR modulo stellar mass loss the dierences seen
here at redshifts above 4 for Ref-L025N0376 and at redshift
zero for Ref-L025N0752 reect those seen in SFR
In Fig B2 again three models are compared in this case
Ref-L100N1504 Recal-L025N0752 and Ref-L025N0752 The
agreement between Ref-L100N1504 and Recal-L025N0752
testing weak convergence is around 01 dex at redshift 01
over the range of stellar masses that can be probed as
reported in Section 322 The agreement is similar across
all redshift ranges Comparing Ref-L100N1504 and Ref-
L025N0752 to test strong convergence the stellar mass
functions agree to within  02 dex at redshift 01 and
the agreement improves with increasing redshift At red-
shifts 4 and above the level of agreement is similar to Recal-
L025N0752 In S15 the redshift 01 strong convergence was
found to be similar to that obtained by simulations from
other groups eg Vogelsberger et al 2013 while the agree-
ment in Eagle improves at higher redshifts
Overall the level of agreement shown for the strong and
particularly for the weak convergence is good
This paper has been typeset from a TEX LATEX le prepared
by the author
ccid13 2015 RAS MNRAS 000 120
012345678910z00010010110SFR M yr1 Mpc3RefL025N0376RefL025N0752RecalL025N07520079105117123126131133Lookback Time Gyr012345678910z106107108109   M Mpc3RefL025N0376RefL025N0752RecalL025N07520079105117123126131133Time GyrGalaxy evolution in the Eagle simulations
Figure B2 The GSMF from Ref-L100N1504 blue Ref-L025N0752 red and Recal-L025N0752 green at 9 redshifts At redshift
01 the Recal-L025N0752 simulation is within 01 dex of Ref-L100N1504 while the Ref-L025N0752 simulation is within 02 dex The
agreement between intermediate and high resolution simulations improves with increasing redshift
ccid13 2015 RAS MNRAS 000 120
654321log10dndlog10McMpc3z01Ref-L100N1504Ref-L025N0752Recal-L025N0752789101112log10MMz05789101112log10MM654321log10dndlog10McMpc3z10789101112log10MM654321log10dndlog10McMpc3z20z30-6-5-4-3-2-1log10dndlog10McMpc3z40789101112log10MM654321log10dndlog10McMpc3z50789101112log10MMz60789101112log10MM-6-5-4-3-2-1log10dndlog10McMpc3z70