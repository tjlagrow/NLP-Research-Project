ON THE HAWKES PROCESS WITH DIFFERENT EXCITING
FUNCTIONS
BEHZAD MEHRDAD AND LINGJIONG ZHU
Abstract The Hawkes process is a simple point process whose intensity
function depends on the entire past history and is self-exciting and has the
clustering property The Hawkes process is in general non-Markovian The
linear Hawkes process has immigration-birth representation Based on that
Fierro et al recently introduced a generalized linear Hawkes model with dier-
ent exciting functions In this paper we study the convergence to equilibrium
large deviation principle and moderate deviation principle for this generalized
model This model also has connections to the multivariate linear Hawkes
process Some applications to nance are also discussed
Contents
Introduction
11 Hawkes Process
12 Hawkes Process with Dierent Exciting Functions
2 Convergence to Equilibrium
3 Connections to Multivariate Hawkes Processes
4 Moderate and Large Deviations
5 Applications to Finance
51 Microstructure Noise
52 Asymptotic Ruin Probabilities for a Risk Process with Hawkes
Arrivals with Dierent Exciting Functions
Acknowledgements
References
1 Introduction
11 Hawkes Process Let N be a simple point process on R and let F 
N C C  BR C   t be an increasing family of -algebras Any non-
negative F 
-progressively measurable process t with
Ecid2N a bF 
cid3  EZ b
sdscid12cid12F 
Date 26 August 2014 Revised 7 March 2015
2000 Mathematics Subject Classication 60G55 60F10
Key words and phrases point process Hawkes process self and mutually exciting process
large deviations moderate deviations convergence to equilibrium microstructure noise ruin
probabilities
BEHZAD MEHRDAD AND LINGJIONG ZHU
Nt  N 0 t to denote the number of points in the interval 0 t
for all intervals a b is called an F 
A Hawkes process is a simple point process N admitting an F 
-intensity of N  We use the notation
-intensity
t  cid18Z t
ht  sN dscid19 
0 htdt   In 12 R t
before time t
where   R  R is locally integrable left continuous h  R  R and we
always assume that khkL1  R 
 ht  sN ds stands
forRt ht sN ds P t ht   where  are the occurrences of the points
In the literature h and  are usually referred to as exciting function and
When  is linear the Hawkes process is said to be linear and it is named
after Hawkes 18 The linear Hawkes process can be studied via immigration-
birth representation see eg Hawkes and Oakes 19 When  is nonlinear the
Hawkes process is said to be nonlinear and the nonlinear Hawkes process was rst
introduced by Bremaud and Massoulie 6
rate function respectively
The law of large numbers and central limit theorems for linear Hawkes processes
were studied in eg Bacry et al 2 and the moderate deviations were studied in
Zhu 29 The central limit theorem for nonlinear Hawkes processes was obtained in
Zhu 32 Bordenave and Torrisi 5 obtained the large deviations for linear Hawkes
processes and the large deviations for nonlinear Hawkes processes were studied in
Zhu 33 and Zhu 34 The limit theorems of some generalizations of the classical
Hawkes processes have been studied in eg Karabash and Zhu 21 and Zhu 30
2 Bacry et al
The self-exciting and clutstering properties of the Hawkes process make it ideal
to characterize the correlations in some complex systems including nance Bacry
3 studied microstructure noise and Epps eect using the
Hawkes models Chavez-Demoulin et al 7 studied value-at-risk Errais et al 14
used Hawkes process to model the credit risk Embrechts et al 12 t the Hawkes
process to nancial data
The Hawkes process has also been applied to many other elds including seismol-
ogy see eg Hawkes and Adamopoulos 20 Ogata 23 sociology see eg Crane
and Sornette 9 and Blundell et al
4 and neuroscience see eg Chornoboy et
al 8 Pernice et al 24 Pernice et al 25 For a survey of the Hawkes process
and its applications we refer to Liniger 22 and Zhu 28
12 Hawkes Process with Dierent Exciting Functions In this paper we
are interested to study an extension of the linear Hawkes process proposed by
Fierro et al 15 It is based on the immigration-birth representation structure of
the linear Hawkes process The classical Hawkes process can be constructed from a
homogeneous Poisson process immigration and using the same exciting function
for dierent generations of ospring birth In some elds eg seismology where
main shocks produce aftershocks with possibly dierent intensities that naturally
leads to the study of a Hawkes process with dierent exciting functions as proposed
in Fierro et al 15
Let N nnN be a sequence of non-explosive simple point processes without com-
mon jumps so that
 N 0 is an inhomogeneous Poisson process with intensity 0t at time t
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
 For every n  N N n is a simple point process with intensity n
0 nt
sN n1ds where the integralR t
0 ntsN n1ds denotes forR0t nt
sN n1ds  P N n10 t nt    Note that by denition the in-
tensity is Ft-predictable
 For every n  N0 conditional on N 0     N n N n1 is a inhomogeneous
Poisson process with intensity n1
The existence of such a process was proved as Proposition 21 in Fierro et al 15
Using the notation of immigration-birth representation N 0 is called the immi-
grant process and N n the nth generation ospring process
Let N P
n0 N n N is said to be the Hawkes process with excitation functions
nnN0 If 0t  0  0 and nt  ht for any n  N then the model
reduces to the classical linear Hawkes process N with intensity at time t given by
ht  sN ds
t  0 Z t
Assumption 1 i 0  limt
0 ntdt  1
ii   supnNR 
Under Assumption 1 Fierro et al 15 showed that for any t  0
0 0sds exists and is nite
ENt Z t
0    nsds  
Fierro et al 15 proved the following law of large numbers result under Assump-
tion 1
t  m
almost surely as t  
where m P
n0 mn m0  0 and
mn  0
iudu
n  N
Yi1Z 
It is easy to check that in the case of classical linear Hawkes process 13
m  0
1  khkL1
which is consistent with the results in Hawkes 18
Assumption 2
t
tcid20 1
tZ 
t
0sds  0cid21  0
p    1sds  0
Further assume Assumption 2 Fierro et al 15 also obtained the central limit
theorem which is the main result of their paper
Nt  mt
t  N 0 2
BEHZAD MEHRDAD AND LINGJIONG ZHU
in distribution as t   where
Xj0 1 
Yij1Z 
0khkj
iudu
1  khkL13 
It is easy to check that in the case of classical linear Hawkes process 13
which is consistent with the results in Bacry et al 2
The paper is organized as the following In Section 2 we show that there exists
a stationary version of the Hawkes process with dierent exciting functions and we
will show the convergence to the equilibrium In Section 3 we will point out the
connections of the Hawkes process with dierent exciting functions to the classical
multivariate linear Hawkes process which has been well studied in the literature
In Section 4 we obtain both the large deviations and the moderate deviations for
the model Finally we discuss some applications to nance in Section 5
2 Convergence to Equilibrium
Assume that 0  0 is a positive constant and Assumption 1 ii holds then
there exists a stationary version of the Hawkes process N  with exciting functions
nnN  0 constructed as follows
n  N N n is an inhomogeneous Poisson process with intensity
Let N 0 be a homogeneous Poisson process with intesntiy 0 on R and for each
n
nt  sN n1ds
n0 N n
The space of integer-valued measures is endowed with the vague topology ie
N n converges to N if and only if for any continuous function  with compact
and N  P
support R xN ndx R xN dx
Given a simple point process N on R one can dene tN as the process shifted
by time t ie tN A  N A  t where A  t  s  t  s  A for any Borel set
A associated with the vague topology
We say a sequence of simple point processes N n converges to a simple point
process N in distribution if for any Borel set A associated with the vague topology
limn PN n  A  PN  A and the convergences is in variation if
A PN n  A  PN  A  0
n
This is the notation given in Bremaud and Massoulie 6
In Daley and Vere-Jones 10s terminology convergence in distribution varia-
tion is referred to as the weak strong convergence and the stationarity associated
with the stationary limit is referred to as the weak strong stationarity
For a given simple point process N on R let N  be its restriction to R
Theorem 1 Let N  P
n0 N n be the Hawkes process with exciting functions
nnN  0 with empty history ie N  0  0 and satises Assumption 1
ii Then the following is true
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
to N 
i sN converges to N  weakly as s   ie sN  converges in distribution
ii If we further assume that   supnNR 
tntdt   then sN converges
to N  strongly as s   ie sN  converges in variation to N 
Proof i For both N  and N  let sN  and sN be the shifted version obtained by
setting time s as the origin and shift the process backwards in times by s to bring the
origin back to 0 that is sN A  N A  s where A  s  t  s  t  A for any
Borel set A We can decompose sN  into two components one component has the
same dynamics as sN  being built from the points generated by the homogeneous
Poisson process 0 and its ospring N nn1 after time s the other component
s that consists of the ospring of the points generated by homogeneous Poisson
process 0 before time s Hence we have
Let us dene
1
st Z s
1t  uN 0
s du
t  s
n
s t Z t
nt  uN n1
t  s n  2
Hnt Z 
nsds
n  1
It is easy to compute that
E1
st Z s
1t  u0du  0Z 
1udu  0H1t  s
E2
st  0k1kL1Z 
2udu  0Z ts
 0k1kL1H2t  s  02  H1t  s
2t  s  uH1udu
Similarly we have
E3
st  0k1kL1k2kL1H3ts0k1kL13H2ts032H1ts
Iteratively we get
En
s t  0
where Q0
i1 kikL1  1
Xj0  j
kikL1 n    j2  Hj1 t  s
BEHZAD MEHRDAD AND LINGJIONG ZHU
Therefore for any T  0
PN 
s0 T   0  1  Eexp Z T
stdt
stdt
 EZ T
En
s tdt
n1 n
s t is the intensity of N 
s at time t
Since nt is integrable for any n Hnt  0 as t   Thus En
s t  0
where 
st P
as s   for any t Moreover
En
s t  0
Thus for any t
Xj0  j
kikL1 Hj10 n    j2  1 t  s
lim sup
s
En
s t  0n
kikL1  0nn
by Assumption 1 ii which is summable in n Therefore for any T  0
PN 
s0 T   0 Z T
tntdt   for any n  N
En
s tdt  0
as s   Hence we proved the weak asymptotic stationarity of N 
ii Since R 
n  n1   j2  Hj1t  sdt Z 
since kHj1kL1  R 
0 R 
t j1sdsdt  R 
s tdt  0
s0  0 Z 
sumption 1 ii and the proofs in part i we get
nn1  
s tdt  0
and therefore
En
En
PN 
n  n1   j2  Hj1tdt
 knkL1 kj2kL1kHj1kL1  
tj1tdt   Together with As-
as s   Hence we proved the strong asymptotic stationarity of N 
Remark 2 In Theorem 1 we assumed that 0t  0 being a constant It will
be interesting to extend the convergence to equilibrium results in Theorem 1 under
a weaker assumption
cid3
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
3 Connections to Multivariate Hawkes Processes
In this section we will show that the Hawkes process with dierent exciting
functions is related to the multivariate Hawkes process see eg Hawkes 18 Liniger
22 Bacry et al
2 A multivariate Hawkes process is multidimensional point
process N1t     Ndt such that for any 1  i  d Nit is a simple point
process with intensity
it  i 
Xj1Z t
ij t  sNjds
where i are non-negative constants and ij t are non-negative real-valued func-
tions and kijkL1   If the spectral radius of the matrix kijkL11ijd is less
than 1 then we have the law of large numbers see eg Bacry et al 2
N1t     Ndtt  I  1
as t   where   1     dt and   kijkL11ijd
Let us consider a special case of the Hawkes process with exciting functions
nnN0 by letting 0t  0 nt  ht if n  N is odd and nt  gt if
n  N is even We can consider two mutually exciting processes N even and N odd
dened as
N even 
N odd 
N 2n1
N even and N odd are mutually exciting since N n is generated based on N n1 and
a jump in N 2n will lead to more jumps for N 2n1 and a jump in N 2n1 will on
the other hand contribute to more jumps for N 2n2 By the law of large numbers
result due to Fierro et al 15
as as t   where
m  0
t  m
kikL1
1  khkL1
1  khkL1kgkL1
 0 khkL1  khkL1kgkL1  khkL1kgkL1   
Now let us point out the connections to the multivariate Hawkes process The
intensity of N even is given by
ht  sN 2n1ds
 0 
Xn1Z t
 0 Z t
ht  sN oddds
BEHZAD MEHRDAD AND LINGJIONG ZHU
Similarly the intensity of N odd is given by
Therefore N even
 N odd
gt  sN evends
 is a bivariate Hawkes process with
Thus by 32
 cid18 0
0 cid19
t cid18 N even
cid19 cid18
kgkL1
khkL1
as t   which is consistent with 35
N0 ie Ai  Aj   for any i 6 j and d
and nnN may not be homogeneous Dene
N2  XnA2
N1  XnA1
 cid18
cid191cid18 0
0 cid19  
cid19 
1khkL1 kgkL1  
1khkL1 kgkL1
0khkL1
Indeed we can work in a more generating setting Let Aid
i1 be a partition of
i1Ai  N0 Assume that 0  0

Nd  XnAd
Then the d-dimensional process N1     Nd has the mutually exciting property
and it is more general than the classical multivariate Hawkes process Since we
proved convergence to equilibrium in Theorem 1 by ergodic theorem
N1 N2     Nd  XnA1
mn XnA2
mn     XnAd
as as t   where mn is dened in 16
4 Moderate and Large Deviations
In this section we are interested to study the moderate and large deviations
for P Nt
t   The large deviations for classical Hawkes processes have been well
studied in the literature for both linear and nonlinear cases see eg Bordenave and
Torrisi 5 Zhu 33 and Zhu 34 The moderate deviations for classical Hawkes
processes have been studied for the linear case see eg Zhu 29
In the linear case let us assume that
deviation principle for  Nt
where khkL1  1 and R 
Ix x logcid16
ht  sN ds
t   Z t
thtdt   Bordenave and Torrisi 5 proved a large
t   with the rate function
xkhkL1cid17  x  xkhkL1  
if x  0
otherwise
Moreover Karabash and Zhu 21 obtained a large deviation principle for the linear
Hawkes process with random marks
For nonlinear Hawkes processes ie when  is nonlinear Zhu 33 rst consid-
ered the case that h is exponential ie when the Hawkes process is Markovian
and obtained a large deviation principle for Ntt   Then Zhu 33 also proved
the large deviation principle for the case when h is a sum of exponentials and
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
used that as an approximation to recover the result for the linear case proved in
Bordenave and Torrisi 5 and also for a special class of general nonlinear Hawkes
processes For the most general h and  Zhu 34 proved a process-level
level-3 large deviation principle for the Hawkes process and used contraction
principle to obtain a large deviation principle for Ntt  
The large deviations result for Ntt   is helpful to study the ruin probabilities
of a risk process when the claims arrivals follow a Hawkes process Stabile and
Torrisi 26 considered risk processes with non-stationary Hawkes claims arrivals
and studied the asymptotic behavior of innite and nite horizon ruin probabilities
under light-tailed conditions on the claims The corresponding result for heavy-
tailed claims was obtained by Zhu 31
Before we proceed let us recall that a sequence of probability measures PnnN
on a topological space X satises a large deviation principle with speed n and
rate function I  X  R if I is non-negative lower semicontinuous and for any
measurable set A
 inf
Ix  lim inf
n
log PnA  lim sup
n
log PnA   inf
Here Ao is the interior of A and A is its closure We refer to Dembo and Zeitouni
11 or Varadhan 27 for general background of large deviations and the applica-
Theorem 3 Under Assumption 1 and N  0  0 for any   R  
limt
t log EeNt exists and
  0ef  1
where f  limM fM  exists on the extended real line and fM is dened
recursively as fn    kM1nkL1efn1  1 1  n  M and f0  
Remark 4 It is easy to compute that
fM 
 1  k1kL1efM1 fM1
By iterating and setting   0 we can show that
mp  m

 cid12cid12cid12cid120
This veries the limit in the law of large numbers 15
Remark 5 In the case of classical linear Hawkes process say t   R t
0 ht 
sN ds it is easy to see that 0   and n  h for any n  N Thus  
f   1 where f  satises f   ekhkL1 f 1 Then it is easy to check
that Ix  supRx   gives 42 More generally for example if we
assume that n  h for odd n  N and n  g for even n  N then  
0f   1 where f  satises
f   ekhkL1 ekgkL1 f 1 1
BEHZAD MEHRDAD AND LINGJIONG ZHU
n0 N n
0 GtsN M ds PM1
Proof of Theorem 3 For any M  N   R and continuous deterministic function
Gs 0  s  t
 EhEheR t
 EheR t
 EheR t
 EheR t
 EheR t
0 GtsN M dscid12cid12N 0 N 1     N M1i e PM1
ueGts1M sudsN M1due PM1
eGtus1M sdsN M1due PM1
0 M suN M1dudse PM1
s dse PM1
0 eGts1M
0 eGts1 R s
n0 N n
n0 N n
n0 N n
n0 N n
0 R tu
n0 N n
0 eFM ts10sds
n0 N n
t i  eR t
where FM t  G0t  M  and
Therefore we have for any M  N and   R
Ehe PM
410 Gnt  M    Z t
It is easy to see that for any given M  N
and GM t  M   
eGn1tsM  1nsds
0  n  M  1
t
FM t  fM 
where fn    kM1nkL1efn1  1 1  n  M 
M  by monotone convergence theorem
Since for   0 e PM
n0 N n
is increasing in M and for   0 it is decreasing in
EeNt  lim
M
n0 N n
Ehe PM
t i  eR t
0 elimM FM ts10sds
Since for   0 FM t is increasing in both M and t and for   0 FM t is
decreasing in both M and t we have
t
M
FM t  lim
M
t
FM t  lim
M
and for any   0 fM  is decreasing in M and f  limM fM  exists
For any   0 fM  is increasing in M and the limit f  limM fM 
exists on extended positive real line 0 Hence we conclude that
log EeNt  0ef  1
t
exists on the extended real line
cid3
Theorem 6 Under Assumption 1 and N  0  0 PNtt   satises a large
deviation principle with rate function
Ix  sup
Rx  
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
Proof Because we already had Theorem 3 we can apply Gartner-Ellis theorem
to obtain the large deviation principle if we can check the essential smoothness
condition
Let us dened the set
D      
Recall that we assumed   supnNR 
0 ntdt  1 For a classical linear Hawkes
process with immigration rate  and exciting function ht and khkL1  1 The
t log EeNt exists and is nite for any   khkL1  1  log khkL1
limit limt
By comparing with the classical Hawkes process there exists some constant c 
  1  log   0 so that for any   c    More precisely let us dene
c  sup     Hence we showed that the interior of D contains a
nonempty neighborhood of the origin Next we need to show that for any   c
 is dierentiable at  By the denition of fM  for each M  N fM 
is dierentiable on  c Let B be the closure of an open ball of radius
  0 centered at  so that the closure of the ball is inside  c We know
that fM  converges to f at least pointwisely For xed M  by the deni-
tion fM  is smooth and hence dierentiable On the closure of B which is
a compact set f 
M  is increasing in  for any   c since we can show that
t  is convex in  For a sequence of increasing functions
limt
that converge pointwisely we have the uniform convergence Therefore f 
verges uniformly Together with the fact that fM  f pointwisely we conclude
that f is dierentiable for   c and f 
M  For any
0    c fM  is increasing in  for any M  N Thus
 1  k1kL1efM1 fM1
  limM f 
t log Ee PM
fM 
n0 N n
and thus
fM 
  1  k1kL1efM1  
as   c Thus we proved steepness The proof is complete
cid3
Let C1 C2    be a sequence of real-valued iid random variables with nite
mean EC1 and variance VarC1 independent of the point process Nt Fierro et
al 15 showed that
i1 Ci  EC1ENt
in distribution as t  
We have the following result
 Ncid00 mVarC1  EC12cid1 
Theorem 7 Assume N  0  0 and Assumption 1 Further assume that
EeC1   for     for some   0 Then the limit C   limt
exists and indeed C   log EeC1 where  is dened in Theorem 3 More-
over P 1
i1 Ci   satises a large deviation principle with rate function
t log Ee PNt
i1 Ci 
IC  sup
Rx  C 
BEHZAD MEHRDAD AND LINGJIONG ZHU
Proof For any   R so that Ehe PNt
i1 Cii   we have
i1 CiNtii
i1 Cii  EhEhe PNt
Ehe PNt
i1 CiPNt  k
ek log EeC1 PNt  k
Ee Pk
 Ehelog EeC1 Nti 
Hence by Theorem 3 we get C   limt
Following the proof of Theorem 6 we conclude that P 1
large deviation principle with rate function IC x given by 420
i1 Ci  log EeC1
i1 Ci   satises a
t log Ee PNt
cid3
Let X1     Xn be a sequence of real-valued iid random variables with mean
0 and variance 2 Assume that EeX1    for  in some ball around the origin
For any n  an  n a moderate deviation principle says that for any Borel set
 inf
22  lim inf
n
 lim sup
n
log P  1
log P  1
Xi  A
Xi  A   inf
In other words P 1
i1 Xi   satises a large deviation principle with the
speed a2
n  The above classical result can be found for example in Dembo and
Zeitouni 11 Moderate deviation principle lls in the gap between central limit
theorem and large deviation principle
The moderate deviation principle for classical linear Hawkes process has been
studied in Zhu 29 For the remaining of this section let us prove the moderate
deviation principle for the Hawkes process with dierent exciting functions
Theorem 8 Assume that Assumptions 1 and 2 hold For any Borel set A and time
sequence at such that t  at  t we have the following moderate deviation
principle
 inf
Jx  lim inf
t
at2 log Pcid18 Nt  mt
at2 log Pcid18 Nt  mt
j0cid161 P
ij1R 
p1Qpj
 Acid19
 Acid19   inf
0 iuducid172
t
 lim sup
22 and 2 P
where Jx  x2
Before we proceed to the proof of Theorem 8 let us prove a series of lemmas
Lemma 9 Consider the equation
x    ex  1
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
The equation has two distinct solutions if     1  log  and has one solution if
    1  log  Let x be the minimal solution of 424 if the solutions exist
Then x  0 if   0 and x  0 if   0
Proof Let F x  x    ex  1 It is easy to compute that F x  1  ex
and F x  ex Thus F x is strictly concave and its maximum is achieved at
x  log1 Therefore the equation 424 has no solutions if F log1  0
has one solution if F log1  0 and has two solutions if F log1  0 It is
easy to check that F log1  log 1 Now assume that   1log 
so that 424 has solutions Observe that if   0 then F 0    0 and
F log1  0 where log1  0 thus x  0 Similarly x  0 when
  0
Lemma 10 Given 0      1  log  if f t   x for any t  0 then
Fnt   x uniformly in t  0 and n  N where
0 ef ts 1nsds
Similarly given   0 if f t   x for any t  0 then Fnt   x
Proof Let us rst assume that 0      1  log  By the denition of x and
the assumption f t   x for any t  0 it is easy to see that
Fnt   eR t
0 ex1nsds
t  0
cid3
Fnt   eR t
0 nsds
 eex1 R t
 eex1knkL1
 eex1
 x
where we used the fact that x  0 for   0 in Lemma 9 Similarly one can
show that given   0 if f t   x for any t  0 then Fnt   x
Lemma 11 For any xed  there is some k1  1
large t
1 so that for any suciently
cid3
Gncid18s
cid12cid12cid12cid12
 Mcid19cid12cid12cid12cid12
uniformly for 1  n  M  M  N and s  0 where Gn was dened in 410
Proof Given   0 by Lemma 10 and 410 we have Gnt  M   x Notice
that in Lemma 9 x0  0 and x0  1
1  1 since   1 Therefore for
0    1 there exists some k1  1
1 so that 0  x  k1 Therefore
xcid16 at
t cid17  k1
t  for any suciently large t Hence for   0 for suciently
t  Mcid17  k1
large t Gncid16s at
 uniformly for 1  n  M  M  N and s  0
Similarly given   0 by Lemma 10 and the discussions above Gnt  M  
x  k1 for   0 and   1 Hence we proved the desired result
Lemma 12 Let us dene
cid3
ns M   1 Z s
n1s  r M nrdr
BEHZAD MEHRDAD AND LINGJIONG ZHU
ns M  Z s
M s M   1 and C2
n1s  r M  
0 cid18C2
M s M   0 s  0 n  M  and M  N Then we
n1s  r M 2cid19 nrdr
ns M  
1  
Proof Let us use induction on n For n  M  C1
Now assume C1
1  we get
n1s M   1
ns M  
1  3 
M s M   1  1
1 since   1
It is clear that C2
and apply the inequality C1
1 that we have just proved
n1s M   1
13
nrdr
1  
ns M   1 Z s
1  
 1  knkL1
1  
M s M   0  1
13  Now assume that C2
ns M  Z s
0 cid20
1  3 
 cid20
1  3 
1  3 
1  2cid21 nrdr
1  2cid21
n1s M   1
where C1
cid12cid12cid12cid12cid12
cid3
 
cid213
Lemma 13 Given any xed   R let t be suciently large so that k1
4  Then we have
Gncid18s
 Mcid19  C1
ns M 
  C2
where C1
ns M  and C2
ns M  are dened in Lemma 12 and
 k2cid20 at
ns M cid18 at
cid192cid12cid12cid12cid12cid12
1i  k3
t  M   at
213 hk1  1
4  1  
Proof Let us prove by induction For n  M  GM s at
1 and C2
M s M  
M s M   0 thus 433 holds Assume 433 is true for n  1 Notice
t  C1
 Z s
 Mcid19 
Gncid18s
Since ex  1  x  x2
2   x3 for x  1 and
 Mcid19cid12cid12cid12cid12
cid12cid12cid12cid12
Gn1cid18s
0 heGn1sr at
t M  1i nrdr
 
1  
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
we have
 Mcid19 cid20 at
0 cid20Gn1cid18s  r
 Z s
2cid18Gn1cid18s  r
cid213
 Mcid19
 Mcid19cid192cid21nrdrcid21cid12cid12cid12cid12
Gncid18s
cid12cid12cid12cid12
 k3
nrcid20k1
t cid193
1cid18 at
cid192cid12cid12cid12cid12cid12
ns  r M 2cid18 at
cid19cid12cid12cid12cid12
ns  r M cid18 at
ns  r M cid18 at
 Mcid19  C1
cid193
 k2cid18 at
 Mcid19cid12cid12cid12cid12
cid193cid20k1
ns  r M 
cid19cid12cid12cid12cid12
cid21 
1  
cid21 
Using the bounds in Lemma 12 we obtain
In addition by using the induction
 Mcid19cid212
 Mcid19  C1
ns  r M cid18 at
L cid12cid12cid12cid12cid12
cid20Gn1cid18s  r
cid12cid12cid12cid12
Gn1cid18s  r
cid12cid12cid12cid12
Gn1cid18s  r
cid192
cid20cid12cid12cid12cid12
Gn1cid18s  r
cid192
1  3 cid18 at
  1
4 and k1  1
cid193
cid193
cid193cid20
 k2cid18 at
1  we get
439 L 
Since k1
L cid18 at
cid18 at
cid18 at
Let us put 437 and 440 together and dene
cid193cid20k1
1  cid21  k2cid18 at
1  3 cid20k1 
cid193cid20 1  
1  cid21  k2cid18 at
1  3 cid20k1 
2 cid21 
1  cid21  k2
1  3 cid20k1 
1  
cid201 Z s
 Mcid19 
cid212cid20Z s
n1cid18s  r
0 cid20C2
n1cid18s  r
2cid20C1
n1cid18s  r
 Mcid19
 Mcid19cid212cid21nrdrcid21
I  Gncid18s
cid20 at
cid21
1  
4k1 cid21
1  
1  
 Mcid19 nrdrcid21
BEHZAD MEHRDAD AND LINGJIONG ZHU
Therefore
I Z s
k2cid20 at
0 cid20
nrdr
cid213
1  cid21  k2
1  3 cid20k1 
cid193
1cid18 at
cid193cid20k2 
2cid20
1  3 cid20k1 
cid193cid20cid20 1  
 cid21 k2 
cid193
cid18 at
cid18 at
 k2cid18 at
2 cid21cid18 at
1  
cid193
nrdr
1  cid21  k2
21  3 cid20k1 
2 cid21  k3
1cid21
1  
1cid21
1  cid21  k3
This proves the desired result
cid3
We observe that k1 and k2 only depend on  so our bound in Lemma 13 is
uniform in n  M  M  N and s  0 Now let us go back to the proof of Theorem
Proof of Theorem 8 We are interested to prove that the limit
t
exists and it can be computed explicitly
at2 log Ehe
t Ntmti
Notice that
t
at2 log Ehe
t Ntmti
t
M
t
M
t
M
t
M
t
 I1  I2  I3
at2 cid20Z t
at2cid20Z t
eFM ts  10sds  matcid21
0 cid16eC 1
1 trM at
1 trM at
t C 2
t 2O at
 1cid17 0rdr
 matcid21
at2 cid20Z t
1 t  r M 0rdr  mtcid21 at
0 cid20C2
cid193Z t
1 t  r M  
0rdr
at2 cid18Z t
O cid18 at
1 t  r M 2cid21 0rdrcid19cid18 at
cid192
where we used the Taylor expansion of ex for x  o1
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
The next step is to carry out careful analysis on I1 I2 I3 the last three terms
in 444
For the rst term I1 in 444 it is easy to see that
I1  lim
t
M
1 t  r M 0rdr  mcid21
cid20 1
cid20 1
1 t  r0rdr  mcid21 
t
where C1
1 t can be computed via iteration in 428 as
0 n1tdt
Therefore we have
Let us recall that m P
I1   lim sup
t
n    1  1t
1 t  1 
n0 mn where m0  0 and mn  0R 
atcid12cid12cid12cid12
  lim sup
0sds  0cid12cid12cid12cid12
atZ 
t Z 
hscid12cid12cid12cid12
  lim sup
n1n    1t and thus R 
t
atZ t
1   The rst two
terms in 447 are zero due to Assumption 2 and the third term in 447 is zero
by dominated convergence theorem
where ht P
0uducid12cid12cid12cid12
0 htdt  
Next let us consider the second term I2 in 444 In Lemma 12 we obtained a
uniform bound on C1
ns M  and C2
ns M  Hence we have
M
0 cid20C2
t Z 
cid20C2
1 t  r 
tcid20C2
1 t 
1 t  r M  
1 t2cid21 0
I2  lim
t
 2 lim
t
 2 lim
22
1 t  r M 2cid21 0rdr
1 t  r2cid21 0rdr
0cid20C2
1  
1 2cid21 
Yij1Z 
iudu
Let us verify 449 First x M  We will let M go to innity later We can
do that since all of our estimates for convergence in M are uniform in t so we can
interchange the two limits Let us dene i j t  i  i1  jt for i  j
Another look at 428 reveals that
ns M   1  C1
n1 M   ns
BEHZAD MEHRDAD AND LINGJIONG ZHU
Since C1
M s M   1 we get
ns M   1 
for n  M  Similarly
n k  1s
ns M   C2
n1 M   ns 
n1 M 2  ns
Therefore
ns M  
k 2  n k  1s
Let us dene
mi j 
Yki1Z 
kudu
for j  i and mi i  1 Hence m0 j  mj Moreover let us dene
I1M  cid20C2
1  M  
Xn1 1 
Xkn Z 
1  M 2cid21 0
n k sds2
m0 n  1
I2M t 
t cid20cid18C2
1  M  
2tM1
2cid0C1
1  M cid12cid19  0cid21 t
n2  1 n  1  0  C1
1 2  0 t
I1M   I2M t
n k  12
 1 n  1  0t
Xn11 
n k  12
cid200m0 n  1 
1 
cid21
1 n  1  0t
n k  12
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
We denote the rst sum by L1 and the second sum by L2 Since C1
for all n and t by Lemma 12
nt M   1
21  2 X 0m0 n  1 
21  2 cid12cid12cid12cid12
0sds  0cid12cid12cid12cid12
hsds Z 
 0Z 
1 n  1  0t
0ududs
The right hand side of the above equation goes to zero as t   since h is
integrable Next let us bound L2
Xn1 1 
1 
1  1 
1  Z t
1  cid20Z t
1  cid20Z 
n k  1 1 
n k  1 1 
 1 n  1  0t
 0t  n
0 cid20Z 
1 k sdscid21 0rdr
1 k sZ t
hsds0  1 Z 
n k  1
n k  1
n k  1 1 
n k  1
0rdrds Z 
1 k sZ t
0rdrcid21 
0rdrdscid21
which goes to zero by dominated convergence theorem The dierence in M is given
I1  I1M 
n k  1
m0 n  1
XnM1 
1  2
BEHZAD MEHRDAD AND LINGJIONG ZHU
and for suciently large t uniformly in M 
I2 t  I2M t
n k sds2
XnM1 
Xkn Z 
0rdr
21  2
0  1
21  2
Hence we proved 449
 1 n  1  0t
Finally let us show that the third term I3 in 444 is zero in the limit For some
universal constant K  0
I3  lim sup
t
0rdrcid19 t
Kcid18 at
cid193cid18Z t
3R t
30
0 0rdr
 lim sup
t
 lim sup
t
Hence we proved that
t
By Gatner-Ellis theorem the proof is complete
at2 log Ehe
t Ntmti 
22
cid3
Remark 14 Following the same proof of Theorem 8 we can show that for any
  R limt Ee
In other words our method gives an
altenative proof to the central limit theorem that was obtained in Fierro et al 15
Ntmt  e 2
it
Remark 15 Indeed one can also consider the moderate deviations in the pres-
ence of random marks ie
for a sequence of iid real-valued random variables
C1 C2    with mean EC1 and variance VarC1 independent of Nt we expect
that for a sequence at so that t  at  t P PNt
  fol-
lows a large deviation principle with rate function JC x  x2
mVarC1  EC12 The proofs are similar to the proofs of moderate deviations for
the unmarked case and we will not go into the details in this paper
i1 CiEC1ENt
 where 2
5 Applications to Finance
51 Microstructure Noise Let Xt stand for some asset price at time t The
signature plot can be dened for Xt over a time period 0 T  at the time scale  as
C  
T  
Xn1  Xn 2
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
This is also known as the realized volatility The microstructure noise eect is
described by an increase of the realized volatility when the time scale  decreases
This behavior is dierent from what one would expect if Xt is a Brownian motion
for which C  will be constant in  as T  
t are the prices of two assets we can dene
t and X 2
  
C12 
q C1  C2 
C12  
T  
n1  X 1
n X 2
n1  X 2
and C1  and C2  are dened similarly as in 51
The Epps eect named after Epps 13 describes the pheonomenon that the
correlation coecient   increases in  and it tends to zero as   0
Bacry et al 3 studied the signature plot C  as in 51 for the price model
Xt  N1t  N2t where N1 N2 is a bivariate Hawkes process and they also
studied correlation coecient   as in 52 for X 1
t  N3t
N4t where N1 N2 N3 N4 is a multivariate Hawkes process They considered
the case of long horizon ie the large T limit and hence studied the macroscopic
properties of a multivariate Hawkes process see eg 2 3 The large T limit can
correspond to a trading day realization of the price model In 3 they considered
for instance a realization of 20 hours Figure 2 in 3
t  N1tN2t X 2
Following the ideas in 2 3 one can do the same analysis for the Hawkes process
with diernt exciting functions For example we can x a partition A1 A2 for
N n Then we can study
N  0 and let N1  PnA1
the signature plot C  for Xt  N1t  N2t One can also x a partition
N n 1  i  4 Then we can
A1 A2 A3 A4 for N  0 and let Ni  PnAi
study the correlation coecient   for X 1
t  N3t  N4t
In the context of the Hawkes process with dierent exciting functions since we
already proved ergodicity in Theorem 1 by considering large T  ie letting T  
by ergodic theorem
N n and N2  PnA2
t  N1t  N2t X 2
C   C  
EX 2
pEX 1
     
 2EX 2
as T   where the expectations are taken over the stationary version of the
processes Heuristically as   0 EX 1
 2  O  and
 2  O  Thus as   0    O  and this explains the vanish-
ing correlation coecient as   0 in the Epps eect
 2
Our main result is that C  and   can be computed by evaluating EX 1
   O 2 EX 1
 2 and EX 1
BEHZAD MEHRDAD AND LINGJIONG ZHU
Proposition 16
i j s  udsdu
0mi  XijA1Z 
 2  XiA1
0mi  XijA2Z 
i j s  udsdu  2 XiA1jA2Z 
 XiA2
0mi  XijA3Z 
 2  XiA3
0mn  XijA4Z 
i j s  udsdu  2 XiA3jA4Z 
 XnA4
   XiA1jA3Z 
i j s  udsdu  XiA2jA4Z 
 XiA2jA3Z 
i j s  udsdu  XiA1jA4Z 
i j s  udsdu
i j s  udsdu
i j s  udsdu
i j s  udsdu
i j s  udsdu
where  are dened iteratively as  t    t t  0 and for t  s
i  1
i i t  s Z t
Z s
it  uis  vi  1 i  1u  vdudv
i j t  s Z s
it  uis  u0mi1du
js  ui j  1 t  udu
and 0 0 t  s  02 t  s and for j  i  1 t  s
and nally
511 i i  1 t s R s
 is  ui i t  udu
 is  ui i t  udu  is  t0mi
td  N i
First for any i  N  0
Proof Let N idt  N i
if t  s
if t  s
EN idt  0mi
where mi is dened in 16 for i  N and m0  1
Second since N i is a simple point process
EN idtN idt 
EN idt  0mi
Third for any t 6 s by stationarity we can dene
i j t  s 
EN idtN jds
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
Therefore we can compute that
N nds  XnA2Z t
 2  E
N nds2
 XnA1Z t
0mi  XijA1Z 
 XiA1
i j s  udsdu
0mi  XijA2Z 
 XiA2
i j s  udsdu  2 XiA1jA2Z 
i j s  udsdu
Similarly we can show 57 and 58
What remains is to compute  By symmetry
i i t  i it
  t  
Therefore for t  s and i  1
i i t  s  Ei
 Ecid20Z t
Z s
it  uN i1duZ s
is  vN i1dvcid21
it  uis  vi  1 i  1u  vdudv
it  uis  u0mi1du
It is clear that 0 0 t  s  02 for any t  s
Fourth for j  i  1
i j t  s 
EN idtN j ds
EN idtj
Ecid20N idtZ s
js  ui j  1 t  udu
js  uN j1ducid21
Fifth and nally
i i  1 t  s 
EN idtN i1ds
EN idti1
is  uN iducid21
Ecid20N idtZ s
 is  ui i t  udu
 is  ui i t  udu  is  t0mi
if t  s
if t  s
BEHZAD MEHRDAD AND LINGJIONG ZHU
cid3
52 Asymptotic Ruin Probabilities for a Risk Process with Hawkes Ar-
rivals with Dierent Exciting Functions In this section we study the ap-
plications to ruin probabilities The applications of the Hawkes processes to ruin
probabilities in insurnace have been studied in Stabile and Torrisi 26 Zhu 31
for instance The advantage of using a Hawkes processes than a standard Poisson
process is that the arrivals of the claims will have a contagion and clustering eect
We consider the following risk model for the surplus process Rt of an insurance
portfolio
Rt  u  pt 
where u  0 is the initial reserve p  0 is the constant premium and the Cis are
iid positive random variables with EeC1   for any   R Ci represents
the claim size at the ith arrival time these being independent of Nt the Hawkes
process with exciting functions nnN0
For u  0 let
and denote the innite and nite horizon ruin probabilities by
u  inft  0  Rt  0
u  Pu   u uz  Pu  uz
u z  0
We rst consider the case when the claim sizes have light-tails ie there exists
some   0 so that EeC1  
By the law of large numbers
t
By Theorem 7 C  limt
To exclude the trivial case we assume that
Ci  mEC1
t log Ee PNt
i1 Ci exists
mEC1  p 
C c
where the critical value c is dened as
c  sup  C   
The rst inequality in 524 is the usual net prot condition in ruin theory and the
second inequality in 524 guarantees that the equation C   p has a unique
positive solution   c
To see this let G  C   p Notice that G0  0 G   and that
G is convex We also have G0  mEC1 p  0 and C c c  0 by 524
Therefore there exists only one solution   0 c of C  p
Theorem 17 Innite Horizon Assume 524 we have limu
 where   0 c is the unique positive solution of C  p
Proof Let us rst quote a result from Glynn and Whitt 16 Let Sn be random
variables and u  infn  Sn  u and u  Pu   Assume that there
exist some    0 so that
u log u 
i n  log EeSn is well dened and nite for         
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
EeSnSn1   for     
n n exists and is nite for         
u log u  
ii lim supn
iii   limn
iv   0 and  is dierentiable at  with 0    
Then Glynn and Whitt 16 showed that limu
Take St  PNt
limt
hC  hp By checking the conditions i-iv we get
Snh  ucid19  
i1 Ci  pt and t  log EeSt By Theorem 7 we have
n nh 
t t  C   p Consider SnhnN We have limn
u
log Pcid18sup
Finally notice that
St  sup
Snh  sup
St  ph
Hence limu
u log u  
cid3
Theorem 18 Finite Horizon Under the same assumptions as in Theorem 17
we have
u
log u uz  wz
for any z  0
wz zICcid0 1
z  pcid1
if 0  z 
if z 
C p
C p
Proof The proof is similar to that in Stabile and Torrisi 26 and we omit it here cid3
Next we are interested to study the case when the claim sizes have heavy tails
ie EeC1   for any   0
A distribution function B is subexponential ie B  S if
x
PC1  C2  x
PC1  x
where C1 C2 are iid
random variables with distribution function B Let us
denote Bx  PC1  x and let us assume that EC1   and dene B0x 
ECR x
0 Bydy where F x  1  F x is the complement of any distribution
function F x The examples and properties of subexponential distributions can
be found in the book by Asmussen and Albrecher 1
Goldie and Resnick 17 showed that if B  S and satises some smoothness
conditions then B belongs to the maximum domain of attraction of either the
Frechet distribution or the Gumbel distribution In the former case B is regularly
varying ie Bx  Lxx1 for some   0 and we write it as B  R 1
  0
We assume that B0  S and either B  R  1 or B  G ie the maximum
domain of attraction of Gumbel distribution G includes Weibull and lognormal
distributions
When the arrival process Nt satises a large deviation result the probability
that it deviates away from its mean is exponentially small which is dominated
by subexonential distributions The results in Zhu 31 for the asymptotics of
ruin probabilities for risk processes with non-stationary non-renewal arrivals and
subexponential claims can be applied in the context of Hawkes arrivals with dierent
BEHZAD MEHRDAD AND LINGJIONG ZHU
exciting functions We have the following innite-horizon and nite-horizon ruin
probability estimates when the claim sizes are subexponential
Theorem 19 Assume the net prot condition p  mEC1
i Innite-Horizon
ii Finite-Horizon For any T  0
u
p  mEC1
u
u uz

pmEC1cid201 cid161 cid161  mEC1
pmEC1h1  e1 mEC1
Acknowledgements
cid17cid21 if B  R  1
cid17 T
if B  G
The authors are extremely grateful to the editor and the referees for a very
careful reading of the manuscript and also for the very helpful suggestions
References
1 Asmussen S and H Albrecher Ruin Probabilities Second Edition World Scientic Singa-
pore 2010
2 Bacry E Delattre S Homann M and J F Muzy 2013 Scaling limits for Hawkes
processes and application to nancial statistics Stochastic Processes and their Applications
123 2475-2499
3 Bacry E Delattre S Homann M and J F Muzy 2013 Modeling microstructure noise
with mutually exciting point processes Quantitative Finance 13 65-77
4 Blundell C Heller K A and J M Beck Modelling reciprocating relationships with Hawkes
processes 2012 Advances in Neural Information Processing Systems 25
5 Bordenave C and Torrisi G L 2007 Large deviations of Poisson cluster processes Sto-
chastic Models 23 593-625
6 Bremaud P and Massoulie L 1996 Stability of nonlinear Hawkes processes Ann Probab
24 1563-1588
7 Chavez-Demoulin V Davison A C and A J McNeil 2005 Estimating value-at-risk a
point process approach Quantitative Finance 5 227-234
8 Chornoboy E S Schramm L P and A F Karr 1988 Maximum likelihood identication
of neural point process systems Biol Cybern 59 265-275
9 Crane R and D Sornette 2008 Robust dynamic classes revealed by measuring the response
function of a social system Proc Nat Acad Sci USA 105 15649
10 Daley D J and Vere-Jones D An Introduction to the Theory of Point Processes Volume I
and II 2nd edition Springer-Verlag New York 2003
11 Dembo A and O Zeitouni Large Deviations Techniques and Applications 2nd Edition
Springer 1998
12 Embrechts P Liniger T and L Lin 2011 Multivariate Hawkes processes an application
to nancial data J Appl Prob Spec Vol 48A 367-378
13 Epps T W 1979 Comovements in stock prices in the very short run Journal of the
American Statistical Association 74 291-298
14 Errais E Giesecke K and Goldberg L 2010 Ane point processes and portfolio credit
risk SIAM J Financial Math 1 642-665
15 Fierro R Leiva V and J Mller 2015 The Hawkes process with dierent exciting func-
tions and its asymptotic behavior To appear in J Appl Probab
16 Glynn P W and W Whitt 1994 Logarithmic asymptotics for steady-state tail probabil-
ities in a single-server queue J Appl Probab 31A 131-156
17 Goldie C M and S Resnick 1988 Distributions that are both subexponential and in the
domain of attraction of an extreme value distribution Adv Appl Probab 20 706-718
ON THE HAWKES PROCESS WITH DIFFERENT EXCITING FUNCTIONS
18 Hawkes A G 1971 Spectra of some self-exciting and mutually exciting point processes
Biometrika 58 83-90
19 Hawkes A G and Oakes D 1974 A cluster process representation of a self-exciting
process J Appl Prob 11 493-503
20 Hawkes A G and L Adamopoulos 1973 Cluster models for earthquakes-regional com-
parisons Bull Int Statist Inst 45 454-461
21 Karabash D and L Zhu 2015 Limit theorems for marked Hawkes processes with appli-
cation to a risk model To appear in Stochastic Models
22 Liniger T 2009 Multivariate Hawkes Processes PhD thesis ETH
23 Ogata Y 1988 Statistical models for earthquake occurrences and residual analysis for
point processes J Amer Statist Assoc 83 9-27
24 Pernice V Staude B Carndanobile S and S Rotter 2012 How structure determines
correlations in neuronal networks PLoS Computational Biology 85031916
25 Pernice V Staude B Carndanobile S and S Rotter 2011 Recurrent interactions in
spiking networks with arbitrary topology Physical Review E 7e1002059
26 Stabile G and Torrisi G L 2010 Risk processes with non-stationary Hawkes arrivals
Methodol Comput Appl Prob 12 415-429
27 Varadhan S R S Large Deviations and Applications SIAM Philadelphia 1984
28 Zhu L 2013 Nonlinear Hawkes Processes PhD thesis New York University
29 Zhu L 2013 Moderate deviations for Hawkes processes Statistics  Probability Letters
83 885-890
30 Zhu L 2014 Limit theorems for a Cox-Ingersoll-Ross process with Hawkes jumps Journal
of Applied Probability 51 699-712
31 Zhu L 2013 Ruin probabilities for risk processes with non-stationary arrivals and subex-
ponential claims Insurance Mathematics and Economics 53 544-550
32 Zhu L 2013 Central limit theorem for nonlinear Hawkes processes Journal of Applied
Probability 50 760-771
33 Zhu L 2015 Large deviations for Markovian nonlinear Hawkes Processes Annals of Applied
Probability 25 548-581
34 Zhu L 2014 Process-level large deviations for nonlinear Hawkes point processes Annales
de lInstitut Henri Poincare 50 845-871
Courant Institute of Mathematical Sciences
New York University
251 Mercer Street
New York NY-10012
United States of America
E-mail address mehrdadcimsnyuedu
School of Mathematics
University of Minnesota-Twin Cities
206 Church Street SE
Minneapolis MN-55455
United States of America
E-mail address zhulumnedu
