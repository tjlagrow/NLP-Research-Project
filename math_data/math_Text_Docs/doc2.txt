Large deviations and applications for Markovian Hawkes
processes with a large initial intensity
Xuefeng Gao 1 Lingjiong Zhu 2
March 24 2016
Abstract
Hawkes process is a class of simple point processes that is selfexciting and has
clustering eect The intensity of this point process depends on its entire past history
It has wide applications in nance insurance neuroscience social networks criminol-
ogy seismology and many other elds In this paper we study linear Hawkes process
with an exponential kernel in the asymptotic regime where the initial intensity of the
Hawkes process is large We establish large deviations for Hawkes processes in this
regime as well as the regime when both the initial intensity and the time are large We
illustrate the strength of our results by discussing the applications to insurance and
queueing systems
1 Introduction
Let N be a simple point process on R and let F
be an increasing family of -algebras Any nonnegative F
process t with
Ecid2N a bF
cid3  E
cid20cid90 b
cid21
sdscid12cid12F
almost surely
 N C C  BR C   t
-progressively measurable
for all intervals a b is called an F
to denote the number of points in the interval 0 t
A Hawkes process is a simple point process N admitting an F
-intensity
-intensity of N  We use the notation Nt  N 0 t
t  
ht  sN ds
assume that cid107hcid107L1 cid82 
0 htdt   In 11cid82 t
where   R  R is locally integrable left continuous h  R  R and we always
 t ht  
where  are the occurrences of the points before time t In the literature h and  are
usually referred to as exciting function or sometimes kernel function and rate function
respectively A Hawkes process is linear if  is linear and it is nonlinear otherwise
 ht sN ds stands forcid80
1Department of Systems Engineering and Engineering Management The Chinese University of Hong
Kong Shatin NT Hong Kong xfgaosecuhkeduhk
2Corresponding Author Department of Mathematics Florida State University 1017 Academic Way
Tallahassee FL-32306 United States of America zhumathfsuedu
cid18cid90 t
cid19
The Hawkes process was rst proposed by Alan Hawkes in 1971 to model earthquakes
and their aftershocks 16 It naturally generalizes the Poisson process and it captures both
the selfexciting3 property and the clustering eect In addition Hawkes process is a very
versatile model which is amenable to statistical analysis These explain why it has wide
applications in insurance nance social networks neuroscience criminology and many
other elds For a list of references we refer to 30
Throughout this paper we assume an exponential exciting function ht  et where
   0 and a linear rate function z    z where the base intensity   0 That is
we restrict ourselves to the linear Markovian Hawkes process4 To see the Markov property
we dene
cid90 t
cid90 t
etsN ds  Z0  et 
etsN ds
Then the process Z is Markovian and satises the dynamics
dZt  Ztdt  dNt
where N is a Hawkes process with intensity t    Zt at time t In addition the pair
Z N  is also Markovian We also assume Z0  Z0 ie there is no jump at time zero
In the literature of applications of Hawkes processes the exponential exciting function and
thus the Markovian case together with the linear rate function is the most widely used
due to the tractability of the theoretical analysis as well as the simulations and calibrations
See eg 1 2 7 16 29 and the references therein
In this paper we consider an asymptotic regime where Z0  n and n  R is sent
to innity This implies the initial intensity 0    Z0 is large for xed  Our main
contribution in this paper is to provide the large deviations analysis of Markovian Hawkes
processes in this asymptotic regime as well as the regime when both Z0 and the time are
large The rate functions are found explicitly Our large deviations analysis here comple-
ment our previous results in 13 where we establish functional law of large numbers and
functional central limit theorems for Markovian Hawkes processes in the same asymptotic
regimes
To illustrate the strength of our results we apply them to two examples In the rst
example we develop approximations for nitehorizon ruin probabilities in the insurance
setting where claim arrivals are modeled by Hawkes processes Here the initial arrival rate
of claims could be high say right after a catastrophe event In the second example we
rely on our large deviations results to approximate the loss probability in a multiserver
queueing system where the trac input is given by a Hawkes process with a large initial
3Selfexciting refers the phenomenon that the occurrence of one event increases the probability of further
events
4Note that the Hawkes process is in general nonMarkovian When the exciting function is given by
sum of exponential functions the Hawkes process is Markovian For simplicity of presentation we focus on
a single exponential function in this paper
intensity Such a queueing system could be relevant for modeling large scale service sys-
tems eg server farms with thousands of servers with highvolume trac which exhibits
clustering
We now explain the dierence between our work and the existing literature on limit
theorems of Hawkes processes especially the large deviations The largetime large de-
viations of Hawkes processes have been extensively studied in the literature that is the
large deviation principle for PNtt   as t   Bordenave and Torrisi 6 derived the
large deviations when  is linear and obtained closed-form formula for the rate function
When  is nonlinear the lack of immigration-birth representation 16 makes the study
of large deviations much more challenging mathematically In the case when h is expo-
nential the large deviations was obtained in Zhu 35 by using the Markovian property
and  is assumed to be sublinear so that a delicate application of minmax theorem can
match the lower and upper bounds For general non-Markovian case ie general h the
large deviations was obtained at the process-level in Zhu 36 The large deviations for
extensions of Hawkes processes have also been studied in the literature see eg Karabash
and Zhu 22 for the linear marked Hawkes process and Zhu 33 for the CoxIngersoll-Ross
process with Hawkes jumps and also Zhang et al
28 for ane point processes Other
than the large deviations the central limit theorems for linear nonlinear and extensions
of Hawkes processes have been considered in eg 4 34 33 Recently Torrisi 24 25
studied the rate of convergence in the Gaussian and Poisson approximations of the simple
point processes with stochastic intensity which includes as a special case the nonlinear
Hawkes process The moderate deviations for linear Hawkes processes was obtained in
Zhu 32 that lls in the gap between central limit theorem and large deviations Also
the largetime limit theorems for nearly unstable or nearly critical Hawkes processes have
been considered in Jaisson and Rosenbaum 19 20 The largetime asymptotics for other
regimes are referred to Zhu 30 The limit theorems considered in Bacry et al 4 hold for
the multidimensional Hawkes process Indeed one can also consider the large dimensional
asymptotics for the Hawkes process that is mean-eld limit see eg Delattre et al 9
We organize our paper as follows In Section 2 we will state the main theoretical results
in our paper ie the large deviations for the linear Markovian Hawkes processes with a
large initial intensity We will then discuss the applications of our results to two examples
in Section 3 Finally all the technical proofs will be presented in Section 4
2 Main results
In this section we state our main results First let us introduce the notations that will be
used throughout the paper and introduce the denition and the contraction principle in
the large deviations theory that will be used repeatedly in the paper
21 Notation and background of large deviations theory
We x T  0 throughout this paper Let us rst dene the following spaces
 L0 T  is dened as the space of functions from 0 T  to R equipped with topology
of uniform convergence
 ACx0 T  is dened as the space of absolutely continuous functions from 0 T  to R
that starts at x at time 0
 AC
f  ACx0 T 
x 0 T  is dened as the space that consists of all the non-decreasing functions
We also dene Bx as the Euclidean ball centered at x with radius   0
Note that processes Z and N both depend on the initial condition Z0  n and one can
use Zn N n to emphasize the dependence on Z0  n For simplicity of notations we use
Zt Nt to denote Zn
t throughout this paper unless specied explicitly otherwise
t  N n
Before we proceed let us give a formal denition of the large deviation principle and
state the contraction principle We refer readers to Dembo and Zeitouni 10 or Varadhan
26 for general background of large deviations and the applications
A sequence PnnN of probability measures on a topological space X satises the large
deviation principle with the speed an and the rate function I  X  R if I is non-negative
lower semicontinuous and for any measurable set A we have
 inf
Ix  lim inf
n
log PnA  lim sup
n
log PnA   inf
Here Ao is the interior of A and A is its closure
The contraction principle concerns the behavior of large deviation principle under con-
It states that if PnnN satises a large
tinuous mapping from one space to another
deviation principle on X with a rate function I and F is a continuous mapping from the
Polish space X to another Polish space Y  then the family Qn  PnF 1 satises a large
deviation principle on Y with a rate function J given by
Jy  inf
xF xy
22 Large deviation analysis for large initial intensity
In this section we state a set of results on large deviations behavior of Markovian Hawkes
processes when Z0  n is sent to innity We consider the process Z rst Recall that the
processes Z and N both depend on n
n Zt 0  t  Tcid9  cid1 satises a sample-path large deviation principle on
L0 T  with the speed n and the rate function
Theorem 1 Pcid0cid8 1
cid90 T
IZg 
gt  gcid48t
cid18 gt  gcid48t
cid19
cid18 gt  gcid48t
cid19
 gt
if g  AC10 T  and IZg   otherwise Moreover P 1
deviation principle on R with the rate function
n ZT   satises a scalar large
Jx T  
gT x
x  AT   
where At  satises the ODE Ordinary Dierential Equation
Acid48t   At   eAt  1
A0   
Three remarks are in order
a When gt  et for t  0 T  one immediately veries from 21 that IZg  0
This is consistent with the functional law of large numbers forcid8 1
n Zt 0  t  Tcid9 in
b We have used At  instead of At to emphasize that A takes value  at time zero
and the derivative in 24 is taken with respect to t
c We have two equivalent expressions for the rate function J the rst expression 22
is directly implied by the samplepath large deviation principle together with the
contraction principle and the second expression 23 is obtained via GartnerEllis
Theorem See Section 421 for more details
In general there are no analytical
formulas for A and the rate function J But one can easily numerically solve the
ODE for A eg RungeKutta methods and then solve the optimization problem
in 23 to obtain the rate function J
Next we proceed to state a large deviation principle for Pcid0cid8 1
n Nt 0  t  Tcid9  cid1 To
gain some intuition about the result we note that
dZt  Ztdt  dNt
cid90 t
which implies that
Zt  Z0
Given Z0  n equivalently we have
Now if we dene for t  0 T 
cid18 Zt
cid19
gt  1
cid90 t
gsds
cid90 t
Theorem 2 Pcid0cid8 1
then one readily veries that the map g cid55 h is a continuous map from L0 T  to L0 T 
Therefore by Theorem 1 and contraction principle we can obtain the following result The
details of the proof is left to Section 421
n Nt 0  t  Tcid9  cid1 satises a sample-path large deviation principle on
cid90 T
L0 T  with the speed n and the rate function
cid33
cid32
et  etcid82 t
cid18
hcid48t
cid90 t
0 eshcid48sds
cid19
hcid48t  et  et
eshcid48sds
IN h 
hcid48t log
if h  AC
large deviation principle on R with the rate function
0 0 T  and IN h   otherwise Moreover PN T n   satises a scalar
Hx T  
hhT x
cid18
cid19
cid27
x  C
where Ct 
cid19
 C
  solves the ODE
 eCt 
   1 
Three remarks are in order
Ccid48cid18
cid18
cid19
cid19
a Notice that IN h  cid82 T
and only if x  y Therefore IN h  0 if and only if hcid48t  etetcid82 t
condition h0  0 we get ht cid82 t
This is consistent with the functional law of large numbers forcid8 1
cid17xy for any x y  0 It is easy to see that Rx y  0 and Rx y  0 if
n Nt 0  t  Tcid9 in
0 eshcid48sds
for any 0  t  T  Together with hcid480  1 we get hcid48t  et With the initial
if  cid54 
0 Rhcid48t et  etcid82 t
0 esds  t if    and et1
0 eshcid48sdsdt where Rx y 
cid16 x

cid26
cid18
b Similar as in Theorem 1 we use Ct 
  instead of Ct to emphasize that C takes
value 
 at time zero The derivative in 210 is taken with respect to t
c Similar as in Theorem 1 we have two equivalent expressions for the rate function
H In general there is no analytical formula for H But one can easily numerically
solve the ODE for C eg RungeKutta methods and then solve the optimization
problem in 29 to obtain the rate function H
221 Most likely paths
In this section we compute the most likely paths to rare events for Hawkes processes with
large initial intensities More precisely we are interested to nd the minimizer to the
variational problems in 22 and 28
Fix x  R Let  be the unique maximizer to the optimization problem 235
Proposition 3 The minimizer to the variational problem 22 is given by
cid18cid90 t
cid19
gt  exp
eAsds  t
for 0  t  T  where A solves the ODE given by 24 and 25
Next we consider the variational problem 28 Let  be the unique maximizer to the
optimization problem 296
Proposition 4 The minimizer to the variational problem 28 is given by
cid32
cid32
cid90 t
cid33

cid90 s
cid33
ht 
  C
T  s
eCTu
 du  s

for 0  t  T  where C solves the ODE given by 210 and 211
The proofs of these two propositions are deferred to Section 421
23 Large deviation analysis for large initial intensity and large time
This section is devoted to a set of results on large deviations behavior of Markovian Hawkes
processes in the asymptotic regime where both Z0  n and the time go to innity
5It will be clear from the Proof of Theorem 1 that AT    limn 1
n log EeZT Z0  n if the limit
exists So one readily veries that AT   is convex in  and in fact strictly convex in  from 24 Hence
there is a unique optimal  for the optimization problem 23
  
6It will be clear from the Proof of Theorem 2 that CT  
n log EeNT Z0  n is always
  limn 1
convex in  if the limit exists Indeed from the ODE 210 the limit must be strictly convex Hence there
is a unique optimal  for the optimization problem 29
When the time is sent to innity Hawkes processes behave dierently depending on
the value of cid107hcid107L1 see eg Zhu 30 In our case the exciting function is exponential
ht  et So we have the following three dierent cases 1 critical    2
supercritical    and 3 subcritical    We study each case separately
231 Critical case
We rst consider the critical case ie     0
Theorem 5 Assume that     0 Let tn be a positive sequence that goes to innity
as n   and limn tn
n   satises a large deviation principle on R with the speed
i For any T  0 P ZtnT
and the rate function
x  12
IZx 
if x  0
  satises a large deviation principle on R with the
and  otherwise
ii For any T  0 P NtnT
and rate function
speed n
 
x   
IN x  sup
2
cid16
cid16 
cid17
T
cid17
if   0
if   0
The proof of this result relies on Gartner-Ellis theorem and Gronwalls inequality for
nonlinear ODEs see eg 11 Theorem 42 We defer the details to Section 43
232 Supercritical case
We next state the result for the supercritical case where     0 Below we use the
convention that   0  0 The proof of the result is similar to that of Theorem 5 and we
leave the details to Section 44
Theorem 6 Assume that     0 and 0  T  1 Let tn  log n
i P ZtnT
n1T   satises a large deviation principle on R with the speed nT and the
n1T   satises a large deviation principle on R with the speed nT and the
rate function IZx  01x1    1xcid541
rate function IN x  01x 1
   1xcid54 1
ii P NtnT
  Then


We remark that the sequence tn in Theorem 6 can be taken to be more general We
choose this particular tn for the simplicity of notation Notice that when Z0  n  
the initial intensity is   n which is of the same order as n and assuming   0 we
can easily compute that EZt  net Thus choosing tn  log n
 gives EZtnT   n1T 
which is notation-wise concise
233 Subcritical case
Finally we state the large deviations results for the subcritical case ie     0 The
proofs are given in Section 45
known that as t   Nt
principle see eg 6 So for Z0  n it is natural to study the large deviations for NnT
n  
Theorem 7 Assume that     0 For any T  0 P NnT
deviation principle on R with the speed n and the rate function
Given Z0  z where z is a xed constant and under the assumption     0 it is well
t   satises a large deviation
n   satises a scalar large
almost surely and P Nt
t  
1 
cid18
cid19
Ix  x log
x  1  T
 x 
x  1  T
for x  0 and Ix   otherwise
The proof of this result rely on Gartner-Ellis theorem and asymptotic behavior of the
solutions of certain nonlinear ODEs We defer the details to Section 45
Remark 8 We discuss the connections with existing results on largetime large deviations
of Hawkes processes here As we have discussed in 13 we can decompose Nt  N 0
t N 1
where N 0 is a simple point process with intensity Z0 where
with Z0
0  n and N 1 is a simple point process with intensity
t  Z0
cid90 t
  
t dt  dN 0
etsdN 1
That is we can decompose the Hawkes process N into the sum of N 0 and N 1 where N 0
is a linear Markovian Hawkes process with zero base intensity and initial intensity Z0
and N 1 is a linear Markovian Hawkes process with nonzero base intensity   0 and empty
history ie N 1 0  0 This decomposition is valid due to the immigration-birth
representation of linear Hawkes processes 18 One of the key results from the immigration-
birth representation is that the two processes N 0 and N 1 are independent of each other
n   satises a large deviation principle with the
By letting   0 in Theorem 7 P N 0
rate function
I 0x  x log
 x 
x  1
cid18 x
cid19
x  1
On the other hand from Bordenave and Torrisi 6 P N 1
principle with the rate function
n   satises a large deviation
cid34
cid32 x
cid33
cid35
I 1x  T
Since N 0 and N 1 are independent we conclude that P NnT
principle with the rate function
n   satises a large deviation
Ix  inf
I 0y  I 1z
1  1
cid17
cid19cid27
cid16
cid18 y
I 0x  y 
Jensens inequality we conclude that
cid26
Notice that I 1x  T I 0cid16 x
cid26 1
cid18 1
cid18 x
 1  T I 0
Ix  inf
 1  T 
0yx
0yx
1  T
 1  T I 0
cid17
cid19
1  T
I 0x  y  T I 0
x  y 
cid18
cid19
1  T
1  1
1  T
cid18
cid19
1  1
1  T
cid19
cid18 y
cid18
1  1
which can be easily veried to be consistent with 214
The next result is complementary to Theorem 7
and I 0x is convex in x Hence by
cid19cid27
cid19
cid18
1  1
cid19
Theorem 9 Assume that     0 and   0 Let tn be a positive sequence that goes
to innity as n  
n   satises a large deviation
i If limn tn
n  0 then for any T  0 P NtnT
principle on R with the speed n and the rate function
I 0x  x log
 x 
x  1
  satises a large deviation
ii If limn tn
principle on R with the speed tn and the rate function
n   then for any T  0 P NtnT
cid34
cid32 x
cid33
cid35
I 1x  T
cid18 x
cid19
x  1
t  N 1
from Remark 8 Notice that N 1
Let us give some intuition behind the results of Theorem 9 Recall the decomposition
Nt  N 0
tnT is of order tn and that is because
of the largetime law of large numbers of the linear Hawkes process with xed initial
intensity  and empty history Also notice that N 0
tnT is of order n Let us explain
esds As n   we have tnT  
Notice that EN 0
tnT is of order n Hence when
n   N 1
n  0 N 0 dominates and we have result i and when limn tn
EZsds  ncid82 tnT
0 esds  1
   for    Thus N 0
tnT  cid82 tnT
But cid82 
limn tn
dominates and we obtain ii
So far we have discussed the large deviations for the counting process N in the sub-
critical case We next consider the large deviations for the process Z in the regime where
Z0  n   and the time is also sent to innity Below we use the convention that
0    0
Theorem 10 Assume that     0 0    1 and tn  log n
P ZtnT
the rate function
  For any 0  T  1 
n1T   satises a scalar large deviation principle on R with the speed n1T and
IZx  0  1x1    1xcid541
We remark that similar as in Theorem 6 here the sequence tn in Theorem 10 can be
taken to be more general We choose this particular tn for the simplicity of notation
3 Examples and Applications
This section is devoted to two examples that apply the large deviations principle that we
have developed in the previous sections The rst example is on ruin probabilities in the
insurance setting and the second example is on nitehorizon maximum of queue lengths
in an inniteserver queue We assume Markovian Hawkes processes can adequately model
the clustering behavior of events occurring in each application While this assumption may
not be completely realistic it enables us to illustrate the potential relevance of our large
deviations analysis Throughout this section we write an  on as n   if the sequence
of numbers an satises limn ann  0
31 Example 1 Ruin probability in insurance risk theory
In this example we apply our large deviations results to approximate the nite horizon
ruin probability in a risk model in insurance mathematics
Hawkes processes have been applied to insurance settings to accommodate the clus-
tering arrival of claims observed in practice see eg
8 21 23 31 When a natural
disaster such as an earthquake occurs the claims typically will not be reported following
a constant intensity as in a homogeneous Poisson process Instead we expect clustering
eect in the claim arrivals after a catastrophe In addition the arrival rate of claims is
typically high right after a catastrophe event So one might use Hawkes processes with
large initial intensities to model such claim arrival processes and it is of interest to study
the nite horizon ruin probability in a risk model where the claim arrivals are modeled by
such Hawkes processes
To study the ruin probability let us consider the surplus process of the insurance
company
t  X n
0  t 
tcid88
Here N n is the claim arrival process modeled as a Hawkes process with an initial intensity
  n and an exciting function ht  et the constant   0 is the premium rate
and we assume it is independent of n for simplicity Yi are the claim sizes which are
independent and identically distributed and Yi is independent of N n and n Note that
we use N n to emphasize the dependence on Z0  n in this section
We are interested in approximating the nite horizon ruin probability P n  T  for
xed T  0 and large n where  n is the ruin time of an insurance company and it is
dened as follows
 n  inft  0  X n
t  0
We assume that the initial surplus at time 0 is given by X n0  nx which is large as
n   In the usual setting of the nite horizon ruin probability problem for the classical
risk model the ruin probability is exponentially small when the initial surplus is large see
eg 3 In our example because N n
is of the order n the ruin will occur at a nite time
with probability one
Notice that N n satises a functional law of large numbers see 13
 t
almost surely as n  
cid12cid12cid12cid12 N n
cid12cid12cid12cid12  0
cid40 et1

t 
for  cid54 
for   
0tT
Therefore as n  
 n    inft  0  x  EY1t  0
almost surely
It is easy to compute that assuming that    xEY1  1  0 otherwise  will be 
cid16
cid17
 xEY1 1

 log
 
for  cid54 
for   
For any T   P n  T   1 as n   For any T   this probability will go
to zero exponentially fast as n   and falls into the large deviations regime In the
following we develop approximations for this probability P n  T 
Let us assume that EeY1   for any   R By Mogulskiis theorem we know that
satises a large deviation principle of L0 with the
Pcid16cid110 1
i1 Yi 0  t  cid111  cid17
cid80cid98ntcid99
cid90 
rate function given by see eg 10
gcid48tdt
if g  AC00
Since Yi and N n are independent it follows from Theorem 2 that
x  log EeY1
cid110
cid111
  
  0  t  T 0  s  
x  sup
cid98nscid99cid88

 1
cid80cid98n 1
P n  T   eninf hgxghT 0IN hcid82 
IN hcid82 hT 
ninf hgxghT 0
cid110
0 gcid48tdton
cid111
gcid48tdt
cid82 
satises a large deviation principle on L0 T   0 with the rate function IN h 
cid80N n
0 gcid48tdt where the rate function IN h is given in Theorem 2 It is easy to see that
Yi Hence by contraction principle for any xed 0  T  
t cid99
i1 Yi  1
as n   We can replace  by hT  in 32 since x  0 for any x  0 and it is
zero for x  EY1 and thus the optimal g satises gcid48t  EY1 for t  hT  so that
gcid48t  0 for t  hT  
The expression 32 is not very informative so we next simplify it to obtain a more
manageable expression which allows ecient numerical computations By the convexity of
 and using Jensens inequality we obtain
cid90 hT 
cid32
cid90 hT 
cid33
gcid48tdt  hT 
gcid48tdt
 hT 
cid18 x
cid19
where the second inequality is due to x  ghT   0 and x is non-decreasing in x for
x  EY1 On the other hand by considering gt  x
hT  t we have
cid90 hT 
gcid48tdt  hT 
cid18 x
cid19
This implies that 32 can be reduced to the following
P n  T   e
ninf h
as n   Therefore we have
cid110
IN hhT 
cid16 x
cid17cid111
P n  T   e
ninf y0 inf hhT y
IN hy
cid110
cid16 x
cid17cid111
To further simplify the above expression we note from Theorem 2 that PN T n  
satises a large deviation principle with the rate function
Hx T   inf
hhT x
IN h  sup
where C solves the nonlinear ODE given in 210 and 211 Hence we conclude that
cid26
cid18
cid19
x  C
cid27
as n  
cid19cid27
cid18 x
Hy T   y
cid17
cid16 x
P n  T   expn  I x T   on
I x T   inf
cid26
cid16 x
cid17
We remark that the function Hy T   y
is convex in y This is because Hy T  is
convex in y and one can also verify directly from the convexity of  that y
in y So we can numerically obtain I x T  eciently
We now present a numerical example when Yi has a Poisson distribution with rate 1
Then it is easy to see from 31 that v  v log v  v  1 for v  0 and v  
otherwise Hence we obtain
in convex
cid26
cid18 x
cid18 x
cid19cid19cid27
I x T   inf
Hy T   y 
 1  log
See Figure 1 for a numerical illustration
32 Example 2 Finitehorizon maximum of queue length process in an
inniteserve queue
In this example we use our large deviations results to study certain tail probabilities in
an inniteserver queue in heavy trac where the job arrival process is modeled by a
Hawkes process with a large initial intensity Such a queueing system could be relevant for
analyzing the performance of large scale service systems with highvolume trac which
Figure 1 This gure plots I x T  in 33 as a function of T  0 05 The other
parameters are xed and given by     1 and x  05
exhibits clustering For background on inniteserver queues their engineering applications
and related large deviation analysis see eg 14 27 5 and the references therein
Consider a sequence of queueing system indexed by n with innite number of servers
Jobs arrive to the n-th system according to a Markovian Hawkes process N n with an
initial intensity   n and an exciting function ht  et We use N n to emphasize
the dependence on Z0  n in this section For simplicity we assume that a n is large so
the oered load in the system is high b the system is initially empty c the processing
time of each job is deterministic given by a constant c  0
We are interested in the nitehorizon maximum of queue length process in such an
inniteserve queue similarly as in 5 Mathematically we want to develop large deviations
approximations for the probability of the event
s  nx
0sT
for xed T  0 and suciently large x as n   Here Qn
s is number of jobs or busy
servers in the n-th system at time s For suciently large x we note that 34 is a rare
event This event corresponds precisely to the event of observing a loss in a queue with nx
servers no waiting room and starting empty
It is well known that see eg 15 for the n-th system with deterministic processing
time c the queue length process Qn can be represented by
t  N n
t  N n
00050101502025030350404505001020304050607TIxTt  0 if t  0 by convention It is easy to see that the function  mapping y to y
where N n
yt  max
ys  ys  c
n N n   sat-
is continuous under the uniform topology Since Theorem 2 states that P 1
ises a sample path large deviation principle with the rate function IN  we can apply the
contraction principle and obtain
cid18
cid19
n
cid26
n
  inf
0sT
cid18
0sT
cid19
s  nx
hs  hs  c  x
sc  x
s  N n
IN h T   max
cid27
where we use the notation IN h T  to emphasize the dependence of IN on T  as can be
clearly seen in 27
Therefore to develop large deviations approximations for P max0sT Qns  nx it
remains to solve the optimization problem in 35 For T  c since h is a nondecreasing
function then the inmum in 35 is simply
hT x
IN h T   Hx T 
For T  c the inmum in 35 is equivalent to
cid26
cid27
0sc
hhsx
IN h s
csT
hhshscx
IN h s
Now let us solve the optimization problem
hhthtcx
IN h t
n
n
log PN ny
log PZn
t n  BxZ0  ny  yHxy t
t n  ByZ0  n  Jy t
and by the Markov property we get
log Pcid0N n
n
t  N n
 yHxy c  Jy t  c
tcn  Bx Zn
tcn  ByZ0  ncid1
and nally for suciently large x by 36 and the contraction principle we conclude that
hhthtcx
IN h t   lim
t  N n
yHxy c  Jy t  c 
n
log Pcid0N n
tcn  BxZ0  ncid1
cid27
cid26
cid19
cid18
Hence we conclude that the inmum in 35 is equivalent to the following expression
Gx T   min
0sc
Hx s
csT
yHxy c  Jy s  c
where H and J are given in Theorem 1 and 2 respectively This implies the following
approximation for T  c and suciently large x
s  nx
0sT
 expn  Gx T   on
as n  
Since one can solve H and J numerically we can then also obtain G by solving the opti-
mization problem in 37 numerically We present a numerical example in Figure 2
Figure 2 This gure plots Gx T  in 37 as a function of x  15 10 The other
parameters are xed and given by     1 c  1 and T  5
4 Proofs of Main Results
This section collects the proofs of main results
123456789100051152253xGxT41 Moment generating functions of Zt and Nt
In this section we discuss the moment generating functions of Zt and Nt for xed t condi-
tioned on knowing the value of Z0 These functions play a critical role in proving our large
deviation results
First recall from 13 Section 321 that the moment generating function of Zt is given
ut z  EeZtZ0  z  eAtzBt
where At  Bt  satisfy the ODEs
Acid48t   At   eAt  1
Bcid48t   
eAt  1
cid16
cid17
with initial conditions A0    and B0   0 As remarked earlier we have used
At  instead of At to emphasize that A takes value  at time zero and the derivative
in 42 is taken with respect to t We also write Bt  instead of Bt to stress that B
depends on the initial condition of A
cid82 t
Next we compute the moment generating function of Nt Recall that Nt  ZtZ0
0 Zsds Thus EeNtZ0  z  e 
vt z  Ee
cid82 t
0 ZsdsZ0  z
 zvt z where
 Zt 
Recall that Z is a Markov process with the innitesimal generator
 z  f z    f z
Af z  z
By Feynman-Kac formula v satises the equation
 z
   zvt z    vt z 
zvt z
with initial condition v0 z  e
deduce that vt z  eCt 
 z Therefore by the ane structure see eg
  where Ct 
  satisfy the ODEs
cid19
cid19
Ccid48cid18
Dcid48cid18
 zDt 
 C
cid18
cid19
cid17
cid16
 and Dcid00 
cid19
cid18
cid26cid18
   1
eCt 
  Dt 
   1    C
 eCt 
cid19
cid18
cid1  0 Thus we have
cid18
cid18
cid19cid19
 z  D
with initial condition C0 
   
EeNtZ0  z  exp
Finally we remark that there exists some   0 such that the moment generating
functions in 41 and 46 are both nite for all    See 34
12 one
cid19cid27
42 Proofs of main results
We prove the main results in this section For notational convenience unless specied
explicitly we use E to denote the conditional expectation EZ0  n and P for the
conditional probability PZ0  n
421 Proofs of results in Section 22
Step 1 We rst establish a scalar large deviation principle for Pcid0 1
Proof of Theorem 1 The proof is long so we split it into three steps
n ZT  cid1 using
Gartner-Ellis theorem
From 41 we have
ut z  EeZtZ0  z  eAtzBt
It is easy to see that since Zt process is positive ut z is monotonically increasing in 
Let us recall from Section 41 that At  Bt  satisfy the ODEs
Acid48t   At   eAt  1
Bcid48t   
eAt  1
cid16
cid17
with initial conditions A0    and B0   0
   for any A  0 A  eA  1  0 and thus At  is increasing in t
Let us rst consider the critical and super-critical case that is    When we have
clear that for any   0 cid82 
cid82 
AeA1   On the other hand it is easy to see that
AeA1   Therefore for any xed T  0 there exists a unique positive value
cid90 
cT  such that
A  eA  1
Hence we conclude that for any xed T  0 for any 0    cT  AT   is the unique
positive value greater than  that satises the equation
cT 
cid90 AT 
A  eA  1
Now let us consider the case   0  When    A  eA  1  0 when A  0 or
when A  Ac for some unique negative value Ac For   0 or   Ac At   0 for any
t For Ac    0 At  is decreasing in t and AT   satises the equation 48 For
  Ac At  is increasing in t and AT    0 and satises the equation 48 When
   A  eA  1  0 when A cid54 0 Thus for any   0 At  is increasing in t
and AT    0 and satises the equation 48 and also At 0  0 Also it is easy to see
that for   cT  At  is continuous and nite in t and
eAt  1dt
cid90 T
BT    
is nite Therefore for   cT 
log EeZT   AT  
n
When   cT  this limit is  By dierentiating the equation 48 with respect to 
  e  1
It is clear from the equation 47 and 48 that as   cT  we have AT    
Therefore from 49 we get
AT    eAT   1
AT    0
AT    eAT   1
Hence we veried the essential smoothness condition By Gartner-Ellis theorem Pcid0 1
  e  1
as   cT 
 
AT   
satises a large deviation principle on R with the rate function
n ZT  cid1
Jx T   sup
x  AT   
Next let us consider the sub-critical case that is    In this case AeA1  0
if and only if A  0 or A  Ac where Ac is a positive constant and it is unique For   0
or Ac At   0 for any t For   0 At  is increasing in t and AT   0 satises
the equation 48 For 0    Ac At  is decreasing in t and satises the equation
48 For   Ac At  is increasing in t For any xed T  0 there exists a unique
cT   Ac satisfying the equation 47 so that for any Ac    cT  AT  is the
unique positive value greater than  that satises the equation 48 and for   cT 
large deviation principle on R with the rate function given in 410
AT    We can proceed similarly as before and prove that Pcid0 1
n ZT  cid1 satises a
Step 2 Next we need to prove the exponential tightness before we proceed to establish
the sample path large deviation principle To be more precise we will show that
lim sup
K
lim sup
n
and for any   0
lim sup
lim sup
n
cid33
Zt  nK
 
cid33
Zt  Zs  n
 
cid32
0tT
cid32
ts0tsT
Let us rst prove 411 Notice rst that Zt  Z0  Nt and Z0  n Therefore for
cid32
cid33
cid32
cid32
0tT
Zt  nK
Zt  Z0  nK  1
0tT
cid33
K  1
cid33
0tT
Nt  n
 P NT  nK  1
 EeNT eK1n
where the last inequality follows from Chebychevs inequality
moment generating function of NT in 46 we hence obtain
In conjunction with the
cid32
cid33
cid18
cid19
lim sup
n
which goes to  as K   Hence we proved 411
 K  1
Next let us prove 412 Note that for s  t N s t  Zt  Zs  cid82 t
Zt  nK
0tT
for s  t we have
Zt  Zs  N s t  t  s sup
sut
s Zudu Thus
cid33
Therefore
cid32
cid32
cid32
ts0tsT
Zt  Zs  n
cid18
ts0stT
N s t  t  s sup
sut
cid33
cid32
cid19
cid33
 n
ts0stT
N s t  
ts0stT
t  s sup
sut
Zu  
cid33
Note that
cid32
cid32
cid33
ts0stT
t  s sup
sut
Zu  
cid33
 sup
0uT
Zu  
By 411 we have
cid32
 sup
0uT
Zu  
cid33
 
lim sup
lim sup
n
Next notice that without loss of generality we can assume that 1
cid32
ts0stT
N s t  
1  j  T   N tj1 tj  
cid19
  N and
cid19
cid33
cid18
T cid88
cid18
N tj1 tj  
where 0  t0  t1    tT   T  where tj  tj1   for any j In addition note that
for   0
EeN tj1tj   Ecid104Ecid104
 Ecid104
 expcid0D   Atj1 C   n  Btj1 C   cid1
Ztj1 eCtjtj1Ztj1 Dtjtj1cid105
eN tj1tj Ztj1
cid105cid105
where we have used the moment generating functions of Zt and Nt in Section 41 Hence
using Chebychevs inequality and combining 413 and 414 we nd for xed   0
cid32
cid26
lim sup
n
1jT 
N s t  
ts0stT
Atj1 C     
cid27
cid33
 sup
0tT
At C     
So in order to prove 412 what remains is to choose  that depends on  so that i
   as   0 ii At C    is uniformly bounded for t  0 T  and   0 To
this end let us dene yt  Ct   C0   Ct    Then y satises the ODE
ycid48t  yt  eeyt  1
y0  0
For   0 we have ycid480  e  1  0 which implies y is increasing on 0  for some
  0 This suggests that
0  ycid48t  eeyt
for t  0 
By Gronwalls inequality for nonlinear ODEs we obtain
 log1  et
0  yt   1
  Then it is clear that    as   0 In addition we deduce from
for t  0 
Let us set e  1
415 that for   
 log1  
0  C     y   1
Next we show At C    is uniformly bounded for t  0 T  and   0 When
   it is clear that zero is a stable solution for the ODE of A in 42 Since A0 C 
  y  0 as   0 so the stability of zero solution implies that when   0
At C    is uniformly small and thus uniformly bounded for all t  0 When
   since A0 C     y  0 one readily checks that A is nondecreasing
with respect to time t Hence we obtain
At C     AT  y
0tT
We have shown in Step 1 that AT   is nite when   cT  and AT   is continuous
as a function of  Therefore we deduce from 416 that AT  y is uniformly bounded
for   0 Thus we have proved 412
Step 3 Finally we establish the sample path large deviation principle
For any   0 let Bx denote the open ball centered at x with radius  For any
0  t0  t1  t2    tk1  tk  T and x1     xk  R by the Markov property of
the process Z we have
cid19
cid18 1
cid18 1
Zt1  Bx1
Zt1  Bx1
cid18 1
Zt2  Bx2
cid19
Zt2  Bx2    
cid18 1
Ztk  Bxk
cid12cid12cid12cid12 1
Ztk  Bxk
cid19
cid19
Zt1  Bx1
Ztk1  Bxk1
cid12cid12cid12cid12 1
 P
Hence we have
cid18 1
n
 Jx1 t1  x1J
cid19
cid19
Ztk  Bxk
 tk  tk1
cid18 x2
cid19
Zt1  Bx1
 t2  t1
Zt2  Bx2    
   xk1J
cid18 xk
cid18 1
where J is given in 410 Hence for any g  AC10 T 
n
 Jgt1 t1  gt1J
Zt1  Bgt1
cid18 gt2
 t2  t1
cid19
Zt2  Bgt2    
   gtk1J
For any given positive g  AC10 T  we have
cid19
Ztk  Bgtk
cid18 gtk
gtk1
 tk  tk1
cid19
cid19
cid18 gtj
cid26
cid26
gtj1
 tj  tj1
gtj1
cid18
 tj  tj1 sup
cid27
cid19
 Atj  tj1 
gcid48t
gtj1
gcid48t
gtj1
tj  tj1
cid26
  
cid16At
cid90 tjtj1
j1   eAt
j1  1
cid17cid27
As   eAs  1ds
cid27
where t
j1  tj1 tj is independent of  and t
j1  0 tj  tj1 may depend on 
It is easy to see that for any given positive g  AC10 T 
gcid48t
gtj1  is uniformly bounded
in j To see this notice that g is positive and continuous so inf 0tT gt  0 and since
g is absolutely continuous gcid48 exists almost surely and we can assume that gcid48 exist for any
j  And we can also see that At
j1  is uniformly bounded in j Therefore there exists
some constant K that may depend on the given g such that uniformly in j
cid26
K
gcid48t
gtj1
 sup
0ttjtj1
cid16At
cid16At
cid26
gcid48t
gtj1
gcid48t
gtj1
j1   eAt
j1  1
j1   eAt
j1  1
cid17cid27
cid17cid27
j1   eAt
cid16At
cid26
cid16  e  1
cid12cid12cid12cid16At   eAt  1
gcid48t
gtj1
cid17cid27
cid17cid27cid12cid12cid12cid12
cid17 cid16  e  1
j1  1
cid17cid12cid12cid12  0
Thereforecid12cid12cid12cid12 sup
cid26
 sup
K
as tj  tj1  0 Hence we conclude that
cid18 1
cid26
cid90 T
cid110
n
cid90 T
gt sup
  sup
t0tT
cid19
cid27
Zt  Bg 0  t  T
gcid48t
tgcid48t  t  et  1gt
   e  1
cid111
n Zt 0  t  Tcid9  cid1 satises a large deviation principle with the rate function
Pcid0cid8 1
Together with the superexponential estimates 411 and 412 we have proved that
IZg  sup
t0tT
tgcid48t  t  et  1gt
if g  AC10 T  Note that the maximization problem
cid111
cid90 T
cid110
cid8xgcid48  x  ex  1gcid9
cid33
cid32   gcid48
cid19
cid18 gt  gcid48t
has its maximum achieved at
cid90 T
Therefore we conclude that
IZg 
gt  gcid48t
cid18 gt  gcid48t
cid19
 gt
The proof is therefore complete
obtains from 26 that Pcid0cid8 1
n Nt 0  t  Tcid9  cid1 satises a large deviation principle with
Proof of Theorem 2 We apply Theorem 1 and the contraction principle One then readily
the rate function
IN h 
ht gt1
  
cid82 t
0 gsds0tT
Observe that dierentiating the integral equation ht  gt1
  
0 gsds we get
cid82 t
hcid48t 
gcid48t 
which is a rst-order linear ODE for gt with initial condition g0  1 Thus we can
solve this ODE and get
gt  et  et
eshcid48sds
cid90 t
Hence we infer from 417 and the expression of IZg in 21 that
cid90 T
cid90 T
IN h 
hcid48t log
hcid48t log
 hcid48t  gtdt
hcid48t
cid32
et  etcid82 t
cid18
hcid48t
cid90 t
0 eshcid48sds
cid33
hcid48t  et  et
eshcid48sds
cid19
Using this sample path large deviations result and applying the contraction principle we
can also obtain that PN T n   satises a scalar large deviation principle on R with
the rate function
Hx T  
hhT x
IN h
cid18
cid19cid27
cid18
cid19
Next we prove that the rate function H in 418 can be equivalently given by 29
Recall the moment generating function of Nt in 46
cid18
cid19
cid19
cid19
cid18
Ccid48cid18
EeNtZ0  n  exp
cid26cid18
cid19
in t It is clear that for any   0cid82 
to see that cid82 
positive value dT  such thatcid90 
 C
   for any C  0 and   0 C  eC  1  
CeC1 
Let us rst consider the critical and super-critical case that is    When we have
  0 and thus Ct 
  is increasing
  On the other hand it is easy
CeC1   Therefore for any xed T  0 there exists a unique
 eCt 
   1 
dT 
C  eC  1  dT 
Hence we conclude that for any xed T  0 for any 0    dT  CT  
positive value greater than 
  that satises the equation
  is the unique
C  eC  1  
The case for   0 is similar Also it is easy to see that for   dT  Ct 
and nite in t and
  is continuous
eCt 
   1dt
cid90 CT  
cid18
cid19
cid90 T
is nite Therefore   dT 
n
log EeNT   C
cid19
cid18
When   dT  this limit is  By dierentiating the equation 420 with respect to 
e  1
C  eC  1  
cid19
CT  
   eCT  
   1  
It is clear from the equation 419 and 420 that as   dT  we have CT  
Therefore from 421 we get
   
cid90 CT  
cid18
cid19
cid18
cid19
cid18
cid19
cid18
cid32
   1 
 eCT  
cid90 CT  
e  1
C  eC  1  
cid33
 
as   dT  Hence we veried the essential smoothness condition By Gatner-Ellis
theorem we get the desired result The proof for the subcritical case is similar and is
omitted here
Proof of Proposition 3 Let
Lg gcid48 
g  gcid48
Then the variational problem 22 becomes
cid18 g  gcid48
cid19
cid19
cid18 g  gcid48
cid90 T
g01gT x
Lgt gcid48tdt
gcid48  0 we deduce that the optimal sample
Applying the Euler-Lagrange equation L
path g satises the following equation
 g  gcid48
cid18 g  gcid48
cid19
Dene
g  d
 1  d
cid20 1
cid18 gt  gcid48t
gt
cid19
cid18 g  gcid48
cid19cid21
Then the Equation 422 reduces to
Set qT    then we obtain from 424 24 and the uniqueness of ODE solutions that
qt  qt  eqt  1
Note from 423 and g0  1 we have
qt  AT  t 
for t  0 T 
cid18cid90 t
cid19
gt  exp
eqsds  t
So what is remaining is to nd the parameter  such that gT   x We claim that the
correct parameter  is simply  the maximizer to the optimization problem 23 To see
this we dene t  
 At  That is  is the derivative of A with respect to the initial
condition Then it follows from 24 and 17 Chapter V that
t    eAt  t
0  1
which immediately yields
T   exp
cid18cid90 T
cid19
  eAtdt
 gT   x
Now from 23 it is clear that the optimal  satises
AT  
Therefore when    we have gT   x and the path g solves the Euler-Lagrange
equation 422 which is a necessary condition for optimality
It remains to check g given by 212 is indeed the optimal sample path for the varia-
tional problem 22 It suces to note that
cid111
t  qt  eqt  1gt
t  qcid48tgtcid9 dt
IZg 
Lgt gcid48
tdt
cid90 T
cid90 T
cid90 T
cid110
cid8qtgcid48
qtgcid48
 qT x  q0
   x  AT  
x  AT   
where we have used the fact that qt  AT  t  for t  0 T  Therefore g is indeed
the optimal sample path The proof is complete
Proof of Proposition 4 Let us recall that
Hx T  
where IN is given in 27 By considering f t cid82 t
0 eshcid48sds we get
cid16 fcid48t
h00hT x
Hx T 
IN h
cid82 T
cid17  fcid48t    f t
cid105
fcid48t log
f t
f 00cid82 T
fcid48t
et dtx
This is a constrained optimization problem so we introduce the Lagrange multiplier  and
dene
Lt f fcid48 
et
fcid48t log
  f t
 fcid48t    f t
We consider the modied problem
cid21
fcid48t
et 
cid20
 etcid104
cid18 fcid48t
cid90 T
fcid48t
et dtx
cid19
The Euler-Lagrange equation L
fcid48  0 yields that the optimal f for 425 satises
Let us dene
Then the Equations 426 and 427 become
 pt  ept  1  
pT  
Lt f t fcid48tdt
f 00cid82 T
f  d
cid21
1  ft
cid20 fcid48t
cid12cid12cid12cid12tT
fcid48
et
cid21
cid19
cid21
  ft
cid20
et
cid18 fcid48t
cid19
cid20
cid18 fcid48T 
cid18 fcid48t
  fT 
cid19
  ft
eT
In addition f satises the following transversality condition
Hence p solves a rst order ODE with terminal constraint Comparing with 210 and
211 we infer from the uniqueness of solutions of such ODEs that
cid18
cid19
pt  C
T  t
Note that we can deduce from 428 that
0 epsds  1
Recall that fcid48t  ethcid48t and h0  0 Thus we get
eps  ecid82 s
cid90 t
ht 
fcid48s
es ds 
ft  ecid82 t
cid90 t
which depends on 
0 epudusds
Next we claim that to satises the constraint hT   x the correct Lagrange mul-
tiplier  is simply  the maximizer to the optimization problem 29 To see this we
wt  C
and rt 
One readily checks from 210 and 211 that r solves the ODE
cid90 T
Since  is the maximizer to the optimization problem 29 we deduce that
x  rT  
eCTu
   exp

eCTv
   

where we have applied the change of variable formula Then it is clear from 429 and
430 that when pt  CT  t

  we have hT   x
cid19
cid18
cid16    eCt 
 cid17
which implies
r0  0
cid90 T
rT  
eCt 
   exp
cid18cid90 T
wt
cid18
cid18
cid19cid19
rt  exp
cid17
cid19
eCs 
   
cid16
cid18cid90 u
cid18
cid19
cid19
cid20
IN h    x 
28 It suces to note that
et
et
   x 
cid90 T
cid90 T
cid90 T
   x 
fcid48
t log
cid20
cid90 T
fcid48
cid90 T
cid20
 fcid48
 
  ft
  ft
et
et
cid18 fcid48t
cid19
cid21
cid19
cid18 fcid48t
t    ft  fcid48
cid20 fcid48t
cid21
cid18 fcid48t
cid20
cid19
cid18 et
cid20
cid18 fcid48t
cid18 fcid48T 
cid21
cid19
cid18 fcid480
cid20
1  ftdt
  fT 
  ft
  ft
cid21
cid19
1  ft
cid21cid19
 
 
 
cid19
cid21
 
  f0
eT
 1  f0
1  ft
cid21
1  ftdt
Finally we verify that h given by 213 is indeed optimal for the variational problem
   x  1  fT 
   x  p0 
   x  C
cid26
x  C
cid32
cid33


cid18
cid19

cid27
where the rst equality is due to fcid48t  ethcid48t h0  0 and hT   x the third
equality is due to 426 the fth equality is due to 427 428 and f0  0 the sixth
equality is due to the fact that pt  CT  t
  for any 0  t  T  and other equalities
follow from direct computation Therefore h is indeed the optimal sample path The
proof is complete

43 Proofs of results in Section 231
Proof of Theorem 5 We want to apply Gartner-Ellis theorem to obtain the large deviations
principle Since the moment generating functions of Zt and Nt involves nonlinear ODEs
the key idea in the proof is to use Gronwalls inequality for nonlinear ODEs to obtain
estimates for the ODE solutions Below we prove part i and ii separately
It is easy to check that
2 2T 2   as   2
1 1
Gartner-Ellis Theorem P ZtnT
and the rate function
is dierentiable in  for any   2
2 2T
2T  Thus we veried the essential smoothness condition By
n   satises a large deviation principle with the speed n
2T  and 
2 2T
cid40
cid41
x  12
IZx  sup
x 
1  1
2 2T
if x  0 and  otherwise
Therefore it suces to prove 431 We focus on the case  cid54 0 since the proof is
trivial for the case   0
From the moment generating function of Zt in 41 one readily obtains
cid18
cid19
cid18
cid19
 tn  A
where A are B are solutions to the ODEs in 42 and 43 Here the initial conditions are
 0 So in order to show 431 it suces to show
given by A
log Ecid104
cid17
cid16
ZtnTcid105
cid16
n tn  A
cid18
limn tn
lim inf n tn
cid16
cid17
cid19
cid40 
2 2T
for   2
for   2
cid17
cid16
tnT  
tnT  
cid17  0
for   2
for   2
i We rst prove part i Suppose that we can show
log Ecid104
ZtnTcid105
cid40 
2 2T
n
for any   2
otherwise
cid104
cid105
We rst prove 432 The idea is to use Gronwalls inequality for nonlinear ODEs to
obtain estimates for A Write gx  ex  x  1 Then the ODE in 42 becomes
Acid48t  gAt in the critical case    Given small    0 there exists some   0
such that  2
2  x2 and gx  x when x   If we write
t  0 
for all s  t
cid27
cid18
cid26
2  x2  gx   2
cn  sup
cid19cid12cid12cid12cid12  
cid12cid12cid12cid12A
then we obtain for n large
cid18 2
cid19
cid18
cid19
 Acid48cid18
cid19
Note that the solution to the ODE
cid18
cid19
for all t  0 cn 434
cid19
cid19
cid18 2
cid18 2
cid18 2
cid18 1
ycid48t 
y0  y0
cid19
cid191
is given by
cid17
which is clearly an non-decreasing function when y is properly dened We next discuss
three cases to prove 432
Case 1   0
When    it is clear from 42 that A is non-decreasing in t So for n large such
   for all t  0
that 0  A
That is cn   Hence we deduce from 434435 and Gronwalls inequality for
nonlinear ODEs that
  one readily checks that 0  At 
for all t  0
cid191
cid19
cid19
cid18 tn
cid18
cid18
cid18 2
cid19
cid19
cid191
cid16
cid18 2
cid18 2
cid18 tn
cid18 1
This implies
cid19
cid19
cid191  A
cid18
cid191  lim inf
n tn  A
n tn  A
cid18 1
cid19
Letting   0 we obtain that for any   0
 lim sup
cid18
n tnA
Case 2 0    2
In this case we have T  2
y0  A0 
value is given by
ytnT  
cid18 tn
cid18 2
cid19
cid191
cid18 1
cid18 2
cid19
cid191
 2
1  1
2 2T
2    1 for  small enough This implies that given
 the ODE solution y in 435 is properly dened for t  tnT  and its
1  T  2
Hence from the non-decreasing property of y we have 0  yt   for all t  0 tnT 
when tn is large This implies tnT  cn Following the proof of Case 1 we can deduce
from 434435 and Gronwalls inequality for nonlinear ODEs that 437 holds for
0    2
2T as well
Case 3   2
When   2
2T  we prove 432 by contradiction Suppose
 M  
lim inf
cid19
cid18
cid19
n tn  A
cid18
tnk T 
tnk  A
Then there is a subsequence nk such that
 2M
cid16
for nk large
cid17   which further implies cnk 
cid18
cid19
This implies when nk is large we have 0  A
tnk T Similar as before we can use 434 and apply Gronwalls inequality for nonlinear
ODEs and obtain that
tnk T  
tnk T 
2  
where the last inequality is due to the fact that   2
with 438 since we can choose  arbitrarily small Hence for   2
1  T  2
2T  However this is a contradiction
2T  we have
cid18
cid19
n tnA
 
Therefore we have proved 432
We next prove 433 When   2
2T  we have shown that tnT  cn for n large and
   for all t  0 tnT  together with the fact that ex  1  x  x
thus At 
when x   we deduce from 43 that for   2
cid18
cid12cid12cid12cid12B
cid19cid12cid12cid12cid12  
cid12cid12cid12cid12cid90 tnT
   
cid18
cid16
cid90 tnT
cid12cid12cid12cid12
cid19
cid19cid12cid12cid12cid12 ds
cid17
cid18
cid12cid12cid12cid12A
ntnn  B
cid19
cid18
In conjunction with the inequality 436 it is readily veried that for   2
For   2
is nonnegative and
2T  it is clear that A is always positive for all t Thus we infer from 43 that B
n tnn  B
lim inf
Therefore we have proved 433 and thus 431 holds The proof of part i is complete
ii We next prove part ii Recall the moment generating function of Nt in 46
where C D solve the ODEs in 44 and 45 with initial condition C0 
D0 
To study its limiting behavior as n   we rst prove
We focus on  cid54 0 since the case   0 is trivial to prove Similar as in the proof of part
i we obtain for n large and for all t  0 dn
cid18
cid18
cid19
cid19

cid19

cid16
cid16 
 Ccid48cid18
cid18 2
cid19cid12cid12cid12cid12  
cid19
cid19
cid19cid19
cid18
cid17
T
cid17
if   0
if   0
cid18
cid19
cid27
for all s  t
cid18
cid19
Since Z0  n we infer that
cid20
cid21
cid18
n tn  C
cid18
cid19
cid19
cid18
cid18 2
cid19
cid18
cid26
t  0 
cid18
cid12cid12cid12cid12C
dn  sup
We again want to use Gronwalls inequality for nonlinear ODEs to obtain estimates for C
To this end we rst study the solution zk to the Riccati equation
zcid48t  kz2t  z0
z0  z0 
2   We discuss the cases   0 and
where we are interested in k  2
  0 separately
2   and k  2
n tn  z 2
 lim
cid18
cid18
cid19
cid19
lim sup
n tn  C
n tn  C
lim inf
A similar argument leads to
cid32cid115cid18 2
cid19
cid19
cid113 2
cid18 
cid18 
cid18
cid18
When   0 the solution to the Riccati equation 442 and 443 is given by
zkt 
cid17
cid17  
cid16
cid16
cid17
cid17 
cid16
cid16
cid19
cid18
It follows from 441 and Gronwalls inequality for nonlinear ODEs that
t  C
 z 2
for t  0 dn
2   or k  2
2   it is clear that zktnT   Ot1
For k  2
cid19
one can verify that tnT  dn Together with 444 we obtain
cid18
n  as tn   from which
cid33
cid19
tnT  
lim sup
n tn  C
Setting   0 we nd
So we have proved 440 when   0
When   0 we can similarly solve the Reccati equation 442 and 443 and obtain
cid112k
cid19
cid19
cid18
cid18
 r  exp
 r  exp
cid19
cid19 
zkt   1
1cid113 k
cid113 k
where r 
 Thus we infer from 444 that for k  2
cid18
cid19
lim sup
n tn  C
Setting   0 we nd for   0
n tn  C
lim sup
cid18
n tn  zktnT   
 lim
cid19
cid112
 
cid17
cid112
cid18 
cid112T
cid16cid112kT
cid19
A similar argument leads to
n tn  C
lim inf
cid18
cid19
 
cid112
cid112T
cid19
cid18 
So we have proved 440 when   0
We next show
cid18
cid19
Since we have shown Ct 
1  x  x when x   we deduce that
cid18
cid12cid12cid12cid12D
ntnn  D
   for all t  0 tnT  together with the fact that ex 
cid12cid12cid12cid12cid12
cid90 tnT
cid19cid12cid12cid12cid12  
cid19
cid32
cid18
cid12cid12cid12cid12C
cid18
cid90 tnT
cid12cid12cid12cid12tn  C
cid90 T
cid12cid12cid12cid12cid12
cid33
cid19cid12cid12cid12cid12 ds
cid19cid12cid12cid12cid12 ds
cid18
Given 440 and 445 we obtain
cid18
cid12cid12cid12cid12D
lim sup
n
Since tnn  0 we then deduce that
   
   
cid19cid12cid12cid12cid12  K
cid18
for some constant K  
Hence we infer from 439 that
  lim
n
ntnn  D
cid21


It is easy to verify that  is dierentiable in   0 and
 
and  is dierentiable in   0 and
 

T
cid20
cid18 
cid18
cid19
cid16
cid16 
cid18 
cid18
cid17
if   0
if   0
T
cid17
cid19
for   0
cid19
T
for   0
cid19
cid19
Thus it is easy to see that
cid480  cid480  T
which implies that  is also dierentiable at   0 An application of Gartner-Ellis
Theorem yields the result
44 Proofs of results in Section 232
Proof of Theorem 6 The approach is similar as in the proof of Theorem 5 use Gronwalls
inequality for nonlinear ODEs to obtain estimates and then apply Gartner-Ellis theorem
to obtain the large deviations principle
cid105
nT log Ecid104
i We rst prove part i We claim that for Z0  n and any   R
When   0 the above holds trivially So in the following we focus on  cid54 0
We rst show that
n
n
cid19cid19
cid18
cid18
cid19
cid18
cid18
cid19
Write gx  ex x 1 Then given any small   0 there exists some   0 and K  0
such that gx  minx Kx2 when x   Recall from 42 that A solves the ODE
n n1T  A
cid18
cid19
cid19
   A
cid19
Acid48cid18
cid18
cid18
cid18
cid19cid19
Suppose that for n large we havecid12cid12Acid0t 
 Acid48cid18
  A
 KA2
cid19
cid19
cid18
cid18
cid1cid12cid12   for all t  0 tnT  Then we obtain
cid19
cid19
cid18
cid19
cid18
   A
The solution to the Bernoulli equation
ycid48t    yt  Ky2t
is given by
Hence we have
y0  A0 
cid19
cid18cid18 1
cid18 n1T
ytnT  
  
 et  K
  
  
 nT  K
  
cid191
cid191
It is clear that y is a monotone function and we thus deduce that yt   for all
t  0 tnT  when n is large Note that Ly   y  Ky2 is Lipshitz continuous when
y   Then by Gronwalls inequality for nonlinear ODEs we obtain
At  yt
for t  0 tnT 
which further implies that
AtnT   ytnT  
cid18 n1T
cid191
  
 nT  K
  
Similarly we can nd
cid18 n1T
AtnT  
Thus we get
cid191
  nT 1 
 1
n n1T  A
cid18
  
 nT  K
  
cid18
cid19
cid19cid12cid12cid12cid12  
cid90 t
etsg
cn  sup
To this end we rst dene with a slight abuse of notation see also Section 43
So the only remaining step is to show for n large we have At 
t  0 
cid12cid12cid12cid12A
n    for all t  0 tnT 
cid27
cid26
cid12cid12   for all large n So it suces to show tnT  cn We note
cid19
for all s  t
from the ODE in 445 that
cid1cid12cid12 cid12cid12 
cid18
cid18
Note thatcid12cid12Acid0t 
and note thatcid12cid12Acid00 
cid18
cid19
cid18
cid1cid12cid12   for all t  0 cn Then we have gcid0Acid0t 
cid12cid12cid12cid12A
cid12cid12cid12cid12A
cid18
t  0 cn Hence we obtain for t  0 cn
cid19cid12cid12cid12cid12 
cid18
cid12cid12cid12cid12A
cid19cid12cid12cid12cid12 
cid18
Now notice that for Acid00 
cid1  n and t  tnT where T  1 the righthandside of the
cid19cid12cid12cid12cid12  
cid18
cid90 t
cid19cid12cid12cid12cid12  et  et
cid19cid19
cid1cid1  cid12cid12At 
cid19cid12cid12cid12cid12 ds
n cid12cid12 for all
Gronwalls inequality then implies
for t  0 cn
 et 
es
et
cid12cid12cid12cid12A
cid12cid12cid12cid12A
cid18
above inequality becomes
which is smaller than  when n is large and  is set suciently small Hence when n is
Next we prove
large we have tnT  cn and thuscid12cid12Acid0t 
nT  B
cid19
Recall from the ODE for B that
n
cid18
cid19
cid1cid12cid12   for all t  0 tnT 
cid18
cid90 tnT
cid16
eAs 
n   1
cid17
cid19cid12cid12cid12cid12 ds
Note that for n large we have At 
ex  1  x  x when x   we deduce that
n    for all t  0 tnT  Together with the fact that
cid18
cid12cid12cid12cid12B
cid19cid12cid12cid12cid12    
cid12cid12cid12cid12A
cid18
cid90 tnT
cid90 tnT
     
cid16
     
etdt
cid17
nT 1 
   1
where in the second inequality we have used 446 and A0 
follows So the proof of part i is complete after applying the Gartner-Ellis Theorem
n  Thus 447 readily
n   
ii We next prove part ii The proof is similar to that of part i so we only outline
the key steps Recall that
Ecid104
cid105
 e 
n neCtnT  
n nDtnT  
where C D solve the ODEs in 44 and 45 with initial condition C0 
D0 
n   
n and
n   0
It suces to show
cid18
cid18
cid19
cid19
n n1T C
n nT D
  
When C0 
n   
n  we look at the Riccati equation below to obtain estimates for C
zcid48t    zt  Kz2t 
When n is large we have   2  4K  
n  This implies the constant function
cid32cid114
cid33
  2  4K  
   
is a particular solution to the Ricatti equation 450 In addition an application of Taylor
expansion yields
  
 On2
as n  
Write vt  zt  z Then it is clear that
v0  z0  z 
  
 On2
Moreover one readily veries that v satises the Bernoulli equation
vcid48t      2K zvt  Kv2t
which implies that
cid18cid18 1
    2K z
Suppose that for n large we have Ct 
Gronwalls inequality for nonlinear ODEs that
cid19
 e2K zt 
n    for all t  0 tnT  Then we obtain from
    2K z
cid191
CtnT   ztnT   vtnT   z
Together with 451 and 452 we deduce that
 lim sup
lim sup
n n1T C
n n1T vtnT   z 
  
cid18
cid19
A similar argument leads to
n n1T C
lim inf
cid18
cid19
  
cid18
cid12cid12cid12cid12C
cid18
cid19cid12cid12cid12cid12 
cid12cid12cid12cid12C
Hence the proof of 448 is complete if we can verify that Ct 
n    for all t  0 tnT 
Similarly as before this can be done using the facts that gx  x for x small and
applying Gronwalls inequality to obtain the following bound on the function C
esds
where dn  supt  0  Ct 
for all s  t In addition the proof of 449
follows similarly as for the proof of 447 The proof is complete after applying the
Gartner-Ellis Theorem
for t  0 dn
 et  et
cid19
cid19cid12cid12cid12cid12 
cid18
cid90 t
n   
45 Proofs of results in Section 233
Proof of Theorem 7 We apply Gartner-Ellis theorem The key idea is to study asymp-
totic behavior of the solutions of the ODEs 44 and 45 that characterize the moment
generating function of Nt
Recall from 46 that for Z0  n we have
cid18
cid19
cid18
cid19
log EeNnT   C
with initial condition C0 
   0 Hence to study the limit of 453 as
n   and then apply Gartner-Ellis theorem we need to look at the asymptotic behavior
of the ODE solutions C and D as t  
 and D0 
   
To this end let
F x  x  ex  1 
In addition F x achieves its minimum at x  1
  It is clear that F is a convex function
 at which
 log 
   F Ct 
Then Equation 44 becomes Ccid48t 
and F   
F cid48x  0 and
cid18 1
cid19
  
Thus minx F x  0 if and only if   c  
one readily veries that F cid48C0 
smaller solution x of the equation
  log 
 1 
  1 When   c since   
  converges to the
   0 Hence the ODE solution Ct 
F x  x  ex  1 
as t   Note from 44 and 45 we have
cid18
cid19
cid18
cid18
cid19
cid19cid19
cid18
  
cid90 t
cid18
cid19
ds  
Therefore
Dt 
t  x  
 as t   and for any   c
n
log EeNnT   lim
n
  
cid20
cid18
cid19
cid18
 x 
x  
cid18
cid19cid21
cid19
n log EeNnT    otherwise For   c we get xc  exc 
and limn 1
 log 
  
  0 which implies that xc  log
 By dierentiating the equation
x  ex  1  
  0 with respect to  we get
x 
 

  ex
as   c
Thus we veried the essential smoothness condition By Gartner-Ellis theorem P NnT
satises a large deviation principle with the rate function
n  
cid26
cid18
cid19
cid27
Ix  sup
 x 
x  
We next solve the optimization problem in 455 and simplify the rate function above
At the optimal  in 455 we have
x  
xT 
which implies that
Recall that x satises
x 
  
1  T
 x  ex  1 
Dierentiating with respect to  we get
x  
Plugging 456 into 458 we get
x 
cid18
xex
x  1  T
cid19
Plugging this into 457 we get the optimal  in 455 is given by
  log
x  1  T
x  1  T
Finally substituting 459 and 460 into 455 we get
Ix  x log
The proof is therefore complete
 x 
x  1  T
cid18
cid18
cid19
cid19
x  1  T
Proof of Theorem 9 The proof is similar to that of Theorem 7 so we only provide a sketch
From the proof of Theorem 7 we have
Ecid104
cid105
and limn 1
  c
n
  log 
where for   c  
equation x  ex  1  
cid18
cid19
cid18
Therefore if limn tn
 e 
 nDtnT  
 neCtnT  
eNtnT
  1 limn CtnT  
cid18
  0 In addition we infer from 454 that
   x the smaller solution to the
cid90 tnT
cid19
cid18
cid19
cid19
ds  
cid19cid21
n
cid105
cid20
cid19
eNtnT
n
  
 x
cid18
n  0 we have for   c
cid18
log Ecid104
n log Ecid2eNtnTcid3   otherwise Similarly if limn tn
log Ecid104
log Ecid2eNtnTcid3   otherwise We can also check that d
 xT  
n
cid20 n
eNtnT
cid18
cid18
cid19
cid19
cid105
n   we have for
cid18
cid19cid21
d x   as
and limn 1
  c Therefore by Gartner-Ellis theorem and following the proof of Theorem 7 we
have proved the desired results
Proof of Theorem 10 The proof is similar as the proof of Theorem 6 so we only provide
a sketch From 41 we have
Ecid104
cid105
n ZtnT Z0  n
 eAtnT  
n nBtnT  
Similar as in the proof of Theorem 6 we can show that
n
n1T log Ee
n ZtnT Z0  n  
The result then follows from Gartner-Ellis theorem
Acknowledgements
Xuefeng Gao acknowledges support from Hong Kong RGC ECS Grant 2191081 and CUHK
Direct Grants for Research with project codes 4055035 and 4055054 We thank Xiang Zhou
for the help on the numerical experiments
References
1 Abergel F and A Jedidi 2015 Long time behaviour of a Hawkes process-based
limit order book SIAM J Financial Math 6 1026-1043
2 At-Sahalia Y Cacho-Diaz J and R J A Laeven 2015 Modeling nancial con-
tagion using mutually exciting jump processes Journal of Financial Economics 117
585-606
3 Asmussen S and H Albrecher Ruin Probabilities Second Edition World Scientic
Singapore
4 Bacry E Delattre S Homann M and J F Muzy 2013 Scaling limits for
Hawkes processes and application to nancial statistics Stochastic Processes and their
Applications 123 2475-2499
5 Blanchet J Chen X and H Lam 2014 Two-parameter sample path large devia-
tions for innite-server queues Stochastic Systems 1 206-249
6 Bordenave C and Torrisi G L 2007 Large deviations of Poisson cluster processes
Stochastic Models 23 593-625
7 Dassios A and Zhao H 2013 Exact simulation of Hawkes process with exponen-
tially decaying intensity Electronic Communications in Probability 1862 pp1-13
8 Dassios A and H Zhao 2012 Ruin by dynamic contagion claims Insurance Math-
ematics and Economics 51 93-106
9 Delattre S Fournier N and M Homann High dimensional Hawkes processes
arXiv14035764 Preprint 2014
10 Dembo A and O Zeitouni Large Deviations Techniques and Applications 2nd Edi-
tion Springer New York 1998
11 Dragomir SS and City M 2000 Some Gronwall type inequalities and applications
RGMIA Monographs Victoria University
12 Errais E Giesecke K and Goldberg L 2010 Ane point processes and portfolio
credit risk SIAM J Financial Math 1 642-665
13 Gao X and L Zhu 2015 Limit theorems for Markovian Hawkes processes with a
large initial intensity arXiv151202155
14 Glynn PW 1995 Large deviations for the innite server queue in heavy trac
Institute for Mathematics and its Applications 71 p387
15 Glynn P W and W Whitt 1991 A new view of the heavy-trac limit theorem
for innite-server queues Advances in Applied Probability  188-209
16 Hawkes A G 1971 Spectra of some self-exciting and mutually exciting point pro-
cesses Biometrika 58 83-90
17 Hartman P Ordinary Diererential Equations Second Edition SIAM 2002
18 Hawkes A G and Oakes D 1974 A cluster process representation of a self-exciting
process J Appl Prob 11 493-503
19 Jaisson T and M Rosenbaum 2015 Limit theorems for nearly unstable Hawkes
processes Annals of Applied Probability 25 600-631
20 Jaisson T and M Rosenbaum Rough fractional diusions as scaling limits of nearly
unstable heavy tailed Hawkes processes arXiv150403100
21 Jang J and A Dassios 2013 A bivariate shot noise self-exciting process for insur-
ance Insurance Mathematics and Economics 53 524-532
22 Karabash D and L Zhu 2015 Limit theorems for marked Hawkes processes with
application to a risk model Stochastic Models 31 433-451
23 Stabile G and G L Torrisi 2010 Risk processes with non-stationary Hawkes ar-
rivals Methodol Comput Appl Prob 12 415-429
24 Torrisi G L Gaussian approximation of nonlinear Hawkes processes Preprint 2015
25 Torrisi G L Poisson approximation of point processes with stochastic intensity and
application to nonlinear Hawkes processes Preprint 2015
26 Varadhan S R S Large Deviations and Applications SIAM Philadelphia 1984
27 Whitt W Stochastic-Process Limits An Introduction to Stochastic-Process Limits
and Their Application to Queues Springer Science and Business Media 2002
28 Zhang X Blanchet J Giesecke K and P W Glynn 2015 Ane point processes
Approximation and ecient simulation Mathematics of Operations Research 40 797-
29 Zhou K Zha H and Song L 2013 Learning social infectivity in sparse low-
rank networks using multidimensional Hawkes processes Proceedings of the Sixteenth
International Conference on Articial Intelligence and Statistics 641-649
30 Zhu L 2013 Nonlinear Hawkes Processes PhD thesis New York University
31 Zhu L 2013 Ruin probabilities for risk processes with non-stationary arrivals and
subexponential claims Insurance Mathematics and Economics 53 544-550
32 Zhu L 2013 Moderate deviations for Hawkes processes Statistics  Probability
Letters 83 885-890
33 Zhu L 2014 Limit theorems for a Cox-Ingersoll-Ross process with Hawkes jumps
Journal of Applied Probability 51 699-712
34 Zhu L 2013 Central limit theorem for nonlinear Hawkes processes Journal of
Applied Probability 50 760-771
35 Zhu L 2015 Large deviations for Markovian nonlinear Hawkes Processes Annals
of Applied Probability 25 548-581
36 Zhu L 2014 Process-level large deviations for nonlinear Hawkes point processes
Annales de lInstitut Henri Poincare-Probabilites et Statistiques 50 845-871
