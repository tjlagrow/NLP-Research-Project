Self-exciting point process modeling of
conversation event sequences
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
Abstract
Self-exciting processes of Hawkes type have been used to model various phenom-
ena including earthquakes neural activities and views of online videos Studies of
temporal networks have revealed that sequences of social interevent times for in-
dividuals are highly bursty We examine some basic properties of event sequences
generated by the Hawkes self-exciting process to show that it generates bursty in-
terevent times for a wide parameter range Then we t the model to the data of
conversation sequences recorded in company ofces in Japan In this way we can
estimate relative magnitudes of the self excitement its temporal decay and the base
event rate independent of the self excitation These variables highly depend on in-
dividuals We also point out that the Hawkes model has an important limitation that
the correlation in the interevent times and the burstiness cannot be independently
modulated
Naoki Masuda
Department of Mathematical Informatics The University of Tokyo 7-3-1 Hongo Bunkyo Tokyo
113-8656 Japan e-mail masudamistiu-tokyoacjp
Taro Takaguchi
Department of Mathematical Informatics The University of Tokyo 7-3-1 Hongo Bunkyo Tokyo
113-8656 Japan e-mail tarotakaguchimistiu-tokyoacjp
Nobuo Sato
Central Research Laboratory Hitachi Ltd 1-280 Higashi-Koigakubo Kokubunji-shi Tokyo 185-
8601 Japan e-mail nobuosatojnhitachicom
Kazuo Yano
Central Research Laboratory Hitachi Ltd 1-280 Higashi-Koigakubo Kokubunji-shi Tokyo 185-
8601 Japan e-mail kazuoyanobbhitachicom
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
1 Introduction
11 Temporal Networks
Social networks which specify the pairs of individuals that are directly connected
and those that are not are substrates of social interactions An important caveat in
the use of social networks for understanding social behavior is that the pair of di-
rectly connected individuals does not interact all the time Social events between a
pair of individuals such as dialogues and transmission of email are better described
as a sequence of events ie a collection of tagged event times where the tag in-
cludes for example the identity of the two individuals type of the event duration
and content of dialogues In fact recent massive data mostly online and technologi-
cal developments of recording devices for ofine social interaction enable recording
of social events with a higher temporal and spatial precision than before Exam-
ples of data taken in this domain include calling activity 2 web recommendation
writing 15 email trafc 1 7 22 online forum dealing with sexual escorts 32
human interactions in the real space 3 16 17 33 to name a few Transmission of
infection or information may occur only during the period in which two individuals
are involved in an event A set of such event sequences among pairs of individuals
are collectively called the temporal network 14 which is the focus of this volume
Computational models that generate realistic event sequences possessing properties
such as those described in Secs 12 and 13 would help us understand the nature of
human communication behavior
12 Long-tailed Interevent Time Distribution
In many empirical event sequences that we would like to model interevent times
are distributed according to a long-tailed distribution The survivor functions also
called the complementary cumulative distributions of IET ie the probability that
the IET is larger than a given value t  are shown in Fig 1 for two individuals in
the data sets used in our previous study 33 34 see Sec 41 for descriptions of the
Different mechanisms seem to explain the non-Poissonian behavior of the IET
A rst mechanism that was discovered to generate power-law IET distributions is
a priority queue model 1 In this class of models each task corresponding to an
event carries a priority level and arrives at a queue Then the queue tends to execute
tasks with high priority tasks with low priority are made to wait for a long time
before being executed The priority queue model has also been extended to allow for
interaction of two priority queues between a pair of interacting individuals 18 23
28 38 However some types of social interaction including conversations may not
proceed like a queue Therefore we attempt an alternative approach in the present
chapter
Self-exciting point process modeling
13 IET Correlation
Another facet of actual event sequences is that they often possess positive temporal
correlation In other words a long short IET is likely to be followed by a long
short IET This is the case even if the effect of circadian uctuations is removed
from data 19 Although there are various methods to measure temporal correlation
of the IET 8 19 here we show it by simply measuring the conditional mean IET
dened by
where t i is the ith IET in a sequence and hi represents the average If the IET
correlation is absent t nextt  is independent of t 
t nextt   ht i1it it 
The values of t next are plotted against t
in Figs 2a 2b and 2c for the con-
versation sequences used in Fig 1 times of email sending and receiving in a univer-
sity 6 and times of online sexual escorts by male individuals 32 respectively We
remark that long-tailed IET distributions are known for the email 1 35 and sexual
escort 32 data sets The conditional mean IET t next increases with t
in Figs 2a
and 2b Therefore adjacent IETs are positively correlated In Fig 2c t next de-
creases with t for t  7 and increases with t for t  7 Figure 2c suggests that
those who have bought an escort tend to avoid buying a next escort within a week
This is directly shown in Fig 2d which shows the IET distribution However ad-
jacent IETs for the sexual escort data are positively correlated on a longer time scale
Fig 2c
In the discrete time model proposed in 10 the probability of an event occur-
rence decreases if events occurred too frequently in the recent past and increases if
the time since the last event becomes long Such a mechanism may generate positive
IET correlation
14 Self-excitatory Stochastic Processes
An alternative mechanism that yields positive IET correlation is self-excitation The
idea is that once an individual talks with somebody the individual is excited to talk
with somebody with a higher rate Malmgren and coworkers developed such models
and applied to data 21 22
In the cascading nonhomogeneous Poisson process proposed in 22 the authors
assumed that the primary process is an inhomogeneous Poisson process with a peri-
odic event rate An event generated from the primary process is assumed to elevate
the system to the active state and trigger cascades of activity In other words after
a trigger event a burst of events may ensue as a result of the Poisson process with
a rate that is larger than the base rate of the primary process The entire recording
period is divided into alternately appearing intervals of the active state with a high
event rate and the normal state with a low event rate by an adjustment of the position
and number of intervals to yield a good t to the data As a result the number of
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
events contained in a burst is shown to obey an approximate exponential distribu-
tion also see 19 which shows that the number of events in a burst obeys a power
law distribution the denition of burst is different in the two papers With a circa-
dian and weekly rate modulation the cascading nonhomogeneous Poisson process
is capable of producing the long-tailed IET distributions observed in the data
Their model has many parameters to be estimated This is common to their an-
other model proposed in 21 In 21 letter writing activity of each renowned indi-
vidual is tted by a cascading Poisson process model The time unit is set to a day
The two parameters ie the base event rate and tendency to write an additional let-
ter within a time unit are estimated on the basis of the data Because the different
parameter values are assumed for different sections of the data the number of the
parameters in the model can be large In the case of the letter correspondence by
Einstein data are collected over 54 years and the two parameters are estimated for
each year Therefore there are 108 parameters
These models 21 22 are quite successful in capturing properties of the real
event sequences Nevertheless it may be also fruitful to consider a much simpler
self-excitatory model as a complementary approach to capture the origins of bursts
Sec 12 and IET correlation Sec 13 inherent in human behavior
A simple two state model in which normal and excited states are assumed is pro-
posed in 19 The model is not a hidden Markov model because the probability
of staying in the excited state becomes large as the number of events that have al-
ready occurred in the current burst increases The model reproduces properties of
the original data such as the power-law IET distribution and autocorrelation func-
tion However statistical methods to estimate the model parameters from the data
were not presented 19
15 Our Approach Hawkes Process
In this chapter we t the self-excitatory point process model called the Hawkes
process 111336 to the data recorded in company ofces 33343739 also see
Fig 1 and Fig 2a A main benet for using the Hawkes process is that it contains
a small number of parameters and is mathematically tractable the maximum likeli-
hood ML method for inferring parameter values is established for some important
special cases 29
This chapter is organized as follows In Sec 2 we introduce the Hawkes model
and recapitulate its basic mathematical properties In Sec 3 we numerically inves-
tigate properties of event sequences generated by the Hawkes process In Sec 4 we
carry out the ML estimation of the parameters of the Hawkes model and compare
the data and the estimated model In Sec 5 we discuss the results with an emphasis
on the limitation and possible extensions of the Hawkes model for better describing
human data Mathematical details are delegated to two Appendices
Self-exciting point process modeling
2 Hawkes Process
The Hawkes process is a self-exciting point process model that is analytically
tractable It is an inhomogeneous Poisson process in which the instantaneous event
rate depends on the history of the time series of events It is not a renewal process
The event rate at time t denoted by l t is given by
l t  n  cid229
f t  ti
itit
where ti is the time of the ith event and f t is the memory kernel ie the additional
rate incurred by an event The causality implies f t  0 t  0
The Hawkes process has been used for modeling for example seismological
data 26 36 video viewing activities 4 24 neural spike trains 30 and genomic
data 31 For example in 4 time series of views of different videos on YouTube
were categorized into three classes which were characterized by different f t and
different time-dependent versions of n  The Hawkes process has also been used to
construct a method to estimate the structure of neural networks from given spike
trains 5 analyze auto and cross correlation in data recorded from mouse retina
20 and understand the correlation between the activities of different neurons in
pulse-coupled model networks of excitatory and inhibitory neurons 30 In 31
the Hawkes process is used to model stochastic occurrences of specic genes on
DNA sequences The method to estimate a piecewise linear f t based on the least
square error was presented
Depending on applications the memory kernel f t has been assumed to be a
hyperbolic ie power law function 4 or a superposition of the gamma function
26 Nevertheless in the present work we simply set
f t  a eb tt  0
for the following reasons First it allows the ML estimation of the parameters a 
b  and n
29 Second the Hawkes process with Eq 3 has a small number of
parameters as compared to competitive models with self excitation 21 22 26 27
It should be noted that Eq 3 indicates that the self-exciting effect of an event
decays in time It is contrasted with a previous model in which the self-exciting
effect is constant for some time and then the event rate returns to the basal rate 22
An example time course of the event rate l t and the corresponding event sequence
are shown in Fig 3
We dene cluster of events as the set of events that are triggered by a single
event occurring at the basal rate n  In other words all the events in a cluster are
descendants of the trigger event The expected cluster size is given by 12 36
f tdt 
and the stationary event rate is given by
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
The convergence of the event rate requires a  b 
l  cn 
3 Numerical Results for Statistics of IET
In this section we numerically examine basic properties of the Hawkes process with
the exponential memory kernel To quantify the broadness of the IET distribution
we measure the coefcient of variation CV dened as the standard deviation of
the IET divided by the mean of the IET as follows
CV  qcid229 N
i1t i  ht i2N
where N is the number of IETs in a given sequence and ht i  cid229 N
IET It should be noted that ht i in the limit N  
The Poisson process yields CV  1
t iN is the mean
is equal to 1l  1  a b n 
We also measure the correlation coefcient for the IET 8 dened as
i1 t i  ht it i1  ht iN  1
cid229 N1
i1t i  ht i2N
cid229 N
 b  Cb
The Hawkes process is invariant under the following rescaling of the time and pa-
rameter values Ct  t a  Ca
 and n  Cn  where C  0 is a constant
Therefore we normalize the time by setting n  1 and vary a and b  The values of
CV IET correlation and mean cluster size c are invariant under this rescaling For
a given pair of a and b values we generate a time series with 2  105 events using
the method described in 25 and calculate the statistics of the IET
The values of CV IET correlation and c Eq 4 for various a and b values
are shown in Fig 4a Fig 4b and Fig 4c respectively Although we can more
theoretically calculate CV using the expression of the IET distribution 13 also
see Appendix 1 for details it is numerically demanding to do so Therefore we
resorted to direct numerical simulations The data are present only in the region
a  b  where the Hawkes process does not explode
Figure 4a indicates that the Hawkes process generates a wide range of CV A
large value of a b  1 yields a large CV value This is the case for both small and
large a values In Fig 5 the survival function of the IET on the basis of 2  105
events is compared for different a and b values that satisfy b  11a or 12a  Al-
though the CV values are large the IET distributions are consistently different from
power law distributions In particular the IET distribution seems to be a superposi-
tion of multiple distributions with different time scales when a
is large Fig 5c
Self-exciting point process modeling
It should be noted that we assumed the exponential not long-tailed memory kernel
Eq 3
Figure 4b indicates that a large a b value also yields a large IET correla-
tion Once the event rate increases because of recent occurrences of other events
the following IET tends to be small Therefore strong self-excitation in the model
ie large a b  is considered to cause large IET correlation The strength of self-
excitation can be also quantied by c Figure 4c indicates that a large a b
to yield a large c
Figures 4a 4b and 4c look similar suggesting that the three quantities are
correlated with each other
4 Fitting the Hawkes Process to the Data
41 Data Sets
We analyze two data sets D1 and D2 of face-to-face interaction logs obtained from
different company ofces in Japan World Signal Center Hitachi Ltd Japan col-
lected the data using the Business Microscope system developed by Hitachi Ltd
Japan For technical details concerning the data collection see 33 37 39 We pre-
viously analyzed the data using different methods 33 34 Data sets D1 and D2
consist of recordings from 163 individuals for 73 days and 211 individuals for 120
days respectively The two individuals are dened to be involved in a conversation
event simply called the event if their modules exchange the IDs at least once in a
minute The module has other types of data that we do not use in the present study
such as the list of conversation partners and the duration of each event In total D1
and D2 contain 51879 and 125345 events respectively
42 Results of Fitting
For the entire sequence of event times obtained for each individual we carry out
the ML estimation of the parameters of the Hawkes process with the exponential
memory kernel It should be noted that we use the information about event times
and not the duration of events or the partners IDs We slightly modify the ML
method developed in 29 see Appendix 2 for details
The modication is concerned with the treatment of the data during the night
Our data are nonstationary owing to the circadian and weekly rhythms Therefore
direct application of the Hawkes process which is a stationary point process is
invalid In the previous literature in which different models are investigated these
rhythms are explicitly modeled 9 22 or treated by dynamically changing the time
scale according to the event rate 18 In contrast we omit the night part of the data
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
from the analysis because our data are collected in company ofces and therefore
there is no event from late in the night through early in the morning
In both data sets D1 and D2 there is nobody in the ofce between four and six in
the morning Accordingly we can partition the data into workdays without ambigu-
ity For each individual we discard the workdays that contain less than 40 conver-
sation events We call a workday containing at least 40 events the valid day Then
we dene the rst event in each valid day as trigger event and set t  0 The follow-
ing events on the same valid day are interpreted to be generated from the Hawkes
process The time of the last event denoted by tlast denoted by td
in Appendix 2
is dened to be the end time of the valid day it is necessary to specify tlast to apply
the ML method Appendix 2 The value of tlast depends on individuals even on the
same day The individual may stay in the ofce for a considerable amount of time
after t  tlast before leaving the ofce This implies that the individual does not have
conversations with others remaining in the ofce between t  tlast and the time when
the individual leaves the ofce If this is the case the fact that this individual does
not have events for t  tlast may affect the ML estimators Nevertheless we neglect
this point Finally we obtain the likelihood of the series of events for an individual
by multiplying the likelihood for all the valid days
We apply the ML method to the individuals that possess at least 300 valid IETs
ie IETs derived from the valid days during the entire period This thresholding
leaves 63 individuals in D1 and 148 individuals in D2 We also exclude one individ-
ual in D1 because the ML method does not converge for this individual
The survivor function of the IET is compared between the data and the esti-
mated Hawkes process in Fig 6 The comparison is made for an individual in D1
Fig 6a and an individual in D2 Fig 6b We calculated the IET distribution for
the estimated model using the theoretical method 13 Appendix 1 The agreement
between the IET distributions of the data and the estimated model is excellent
To assess the quality of the t at a population level we compare three statistics
of the IET between the data and model for different individuals The relationship
between the mean IET obtained from the data and that obtained from the estimated
model ie 1l  1  a b n  is shown in Fig 7a For different individuals in
both data sets the mean IET is close between the data and the model The Pearson
correlation coefcient between the data and model are equal to 0993 and 0986 for
D1 and D2 respectively However the Hawkes process slightly underestimates the
mean IET
The CV values for the data and the estimated model are compared in Fig 7b
We calculated the CV values for the estimated model on the basis of 2  105 events
that we obtained by simulating the Hawkes process with the ML estimators a  b 
and n  Although the CV can be theoretically calculated using the ML estimators
Appendix 1 we avoided doing so because the theoretical method is computation-
ally too costly to be applied to all the individuals Roughly speaking the CV values
obtained from the model are close to those of the data The Pearson correlation co-
efcient between the data and model are equal to 0832 and 0936 for D1 and D2
respectively
Self-exciting point process modeling
The IET correlation of the data and that for the estimated model are compared in
Fig 7c We calculated the IET correlation for the estimated model by direct nu-
merical simulations as in the case of the CV Figure 7c indicates that the Hawkes
process does not reproduce the IET correlation for most individuals The IET corre-
lation for the estimated model is distributed in a much narrower range than that of
the data This is consistent with the nding that the CV and the IET correlation are
positively correlated in the Hawkes process Sec 3 Because most individuals have
the CV values larger than unity Fig 7b the estimate of the IET correlation ob-
tained by the model tends to be positive regardless of the estimated values of a  b 
and n  Figure 7c suggests that the Hawkes process with the exponential memory
kernel is incapable of approximating the real data in terms of the IET correlation
5 Discussion
We analyzed properties of the IET generated by the Hawkes process with an ex-
ponential memory kernel and then tted the model to the face-to-face interaction
logs obtained from company ofces The model successfully reproduced the data in
terms of the IET distribution However the model does not explain the behavior of
the IET correlation in the data
This limitation may be because the effect of self-excitation is too strong in the
Hawkes process the event rate can be very large after a burst of events To examine
this issue we carry out additional numerical simulations using a modied Hawkes
model We modify the model such that after each event that would increase the
event rate by f 0 in the original Hawkes process we reset the event rate to the
basal value n with probability p The original Hawkes process corresponds to p  0
The CV and IET correlation for p  01 and various values of a and b are shown
in Figs 8a and 8b respectively The values of the CV and IET correlation for
p  01 are much smaller than those for p  0 Figs 4a and 4b This is because
a burst which increases the CV and IET correlation in the Hawkes model is forced
to terminate with probability p after each event in the modied model The CV and
IET correlation values for a b   02i02 j where 0  i  j  100 are plotted
in Fig 4c For comparison the corresponding results for p  0 on the basis of
the data used in Figs 4a and 4b are also shown in the gure The introduction
of p  0 does not decorrelate the CV and IET correlation To explain the behavior
of the IET correlation in the present data we need different models It seems that
the IET correlation has not been discussed in the context of social interaction data
with a notable exception 19 We are interested in the capabilities of alternative
models 10 21 22 in reproducing the IET correlation in the data
In the present study we used the exponential memory kernel because it is ana-
lytically tractable and contains only three parameters The original Hawkes process
with other memory kernels has also been applied to data 4 26 The ML method is
available also for this case 26 Nevertheless we suspect that self-excitation inher-
ent in the Hawkes process induces both high CV and positive IET correlation for a
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
variety of memory kernels Therefore the use of different memory kernel may not
improve the t of the Hawkes process to our data in terms of the IET correlation
Two-state models 192122 in which events are produced at high and low rates
in the excited and normal states respectively are also self-exciting These models
may be more realistic for social data than the standard Hawkes process used in this
work in the sense that humans may not distinguish many different levels of self-
excitation as is assumed in the Hawkes process On the other hand the Hawkes
process with the exponential memory kernel is simpler than these models such that
the ML methods are available and the parameters have simple physical meanings
Although the model by Malmgren and colleagues allows for the ML method 22
the method is quite complicated and contains many parameters It may be desirable
to develop two-state models that are simple and allow for statistical methods Al-
ternatively it may be desirable to modify the Hawkes process to account for the
behavior of the IET correlation in the real data
We lack methods to compare the goodness of t of different models except that
it is straightforward to test the validity of a model against the Poisson process but
see 22 We need develop goodness of t tests to compare the performance of
models proposed in different papers
Appendix 1 IET Distribution of the Hawkes Process
In this section we explain the derivation of the IET distribution of the Hawkes
process shown in 13 Also see 36 for introduction to mathematical treatments of
the Hawkes and related processes
Consider a trigger event at t  0 and the inhomogeneous Poisson process with
rate function f t ie the point process directly induced by the trigger event The
probability generating functional PGFL for this inhomogeneous Poisson process
denoted by H is given by
H z E cid213
 expcid26Z
zt  1f tdtcid27 
where zt is a carrying function and ti is the time of the ith event We dene t0  0
The events at t  ti may induce further events On the basis of Eq 8 the PGFL
for the inhomogeneous Poisson process including all the descendant events induced
by a trigger event at t  0 denoted by F is given through the following recursive
relation
F z  z0expcid26Z
F zt   1f tdtcid27 
Self-exciting point process modeling
where zt t  zt t is the time translation On the right-hand side of Eq 9 z0
accounts for the trigger event at t  0 and F zt  accounts for the fact that an
event triggered at time t initiates an inhomogeneous Poisson process with rate f t
on top of the other inhomogeneous Poisson processes going on
We obtain the PGFL for the entire Hawkes process denoted by G by combining
Eq 9 and the PDFL of the homogeneous Poisson process with rate n as follows
G z  expcid26Z
n F zt   1dtcid27 
We set zt  z for ts  t  ts  D and zt  1 otherwise Then p tsD  z 
Fz is the probability generating function PGF for the number of events in
tsts  D  with the carrying variable z and
is the PGF for the number of events in ts  tts  t  D  Equation 9 is reduced to
p ts  tD  z  Fzt 
expnR tsD
zexpnR tsD
p ts  tD  z  1f tdto 
p ts  tD  z  1f tdto  D  ts  0
ts  D 
ts  0
p tsD  z 

By setting ts  0 and combining Eqs 10 and 11 we obtain the PGF for the
number of events in 0D  as
QD z  Gz  expcid26Z
n p tD  z  1dtcid27 
In particular
is the probability that there is no event in tsts D  for a cluster of events originating
at t  0 Using Eq 12 we obtain
p tsD   p tsD 0
expnR tsD
 p ts  tD   1f tdto 
ts  0
D  ts  0
ts  D 
p tsD  

By setting z  0 in Eq 13 and using Eq 15 we obtain the survivor function of
the forward recurrence time ie time to the next event from arbitrary t as follows
QD 0  Prforward recurrence time  D   expcid26nD  n Z
1  p tD  dtcid27 
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
where Pr denotes probability QD 0 is the probability that the Hawkes process does
not have any event in 0D 
Finally the distribution of the interevent time t
is given in the form of survivor
function as
Prt  t  
dQD 0t
dt cid30l 
where the stationary event rate l
is given by Eq 5
In the numerical simulations we adopted the Simpsons rule for calculating in-
tegrals in Eqs 15 and 16 and solved Eq 15 by iteration
We remark that integration of Eq 17 by part leads to
cid10t 2cid11 
QD 0tdt
Equations 18 and 19 can serve to calculate the CV However we did not use
them and obtained the CV by direct numerical simulations because calculating the
CV via Eqs 18 and 19 is time consuming
Appendix 2 ML Method for the Hawkes Process
In this section we explain a slightly modied version of the ML method for the
Hawkes process with the exponential memory kernel originally proposed in 29
We let the event times be 0  t1  t2      tN Different from the usual assump-
tion of the continuous-time point process we allow multiple events to occur at the
same time ie ti  ti1 Such simultaneous events actually occur in our data be-
cause of the nite time resolution of one minute Simultaneous events do not prevent
the application of the ML method explained in the following
For the exponential memory kernel given by Eq 3 the event rate at time t is
given by
l t  n  a
jmaxt
eb tt j 
where jmaxt is the index of the last event before time t
The likelihood of the event sequence during time period 0tN denoted by
Lt1    tN is given by
Lt1    tN  expcid18Z tN
l tdtcid19 Ncid213
l ti
cid229
Self-exciting point process modeling
By substituting Eq 20 in Eq 21 we obtain the log likelihood for the original
Hawkes process as follows 29
log Lt1    tN  n tN 
Ncid229
b cid16eb tNti  1cid17 
eb tit j 
logn  a Ai
Ncid229
Ai  cid229
1 jiN
Exactly speaking the point process for an individual for one workday begins
when the individual has arrived in the ofce Because we do not know when the
point process begins we assume that the rst event of each day is a trigger event In
other words we set t1  0 and modify Eq 22 as
log Lt1    tN  n tN 
Ncid229
b cid16eb tNti  1cid17 
Ncid229
logn  a Ai
For each individual we use the days that have at least 40 events We index such
a valid day as d  12    dmax We denote the event times of valid day d by 0 
1      td
 where Nd is the number of events in valid day d The log likelihood
of the entire sequence is given by the summation of the log likelihood over all the
valid days
The partial derivatives of the log likelihood with respect to a  b  and n are orig-
inally derived in 29 In the present case they read
 logL
 logL
 logL
Ndcid229
 1cid17 
i eb td
n  a Adi 
b 2cid16eb td
Nd  td
d1 Ndcid229
b cid16eb td
Ndcid229
d1a
i1cid20 1
a Bdi
Ndcid229
n  a Adi 
Ndcid229
d1td
m  a Adi 
Adi  cid229
eb td
i td
1 jiNd
Bdi  cid229
1 jiNd
i  td
j eb td
i td
 1cid17cid21 
We obtain the ML estimates by setting the left-hand sides of Eqs 25 26 and
27 to 0
cid229
cid229
cid229
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
We carried out the gradient descent method to estimate a  b  and n
for each
individual We repeat the substitution
a a  d
b b  d
n n  d
 log L
 logL
 log L
where we set d  102 For one individual in D2 the ML method does not converge
with d  102 Because it converges with d  103 we used this value for this
particular individual
Because the likelihood may have multiple local maxima we started the gradient
descent method with two different initial conditions ie a b n   061206
and 122412 hr1 We found that the nal results corresponding to the two
initial conditions were identical for each individual
For the ML method the Hessian of the log likelihood can be explicitly given
and used in combination with the Newton method 29 However we found that
the Newton method does not converge for many individuals compared to the simple
gradient descent described above Therefore we did not use the Newton method
Because a b n  0 and a  b are needed for the Hawkes process to be well
dened we forced the parameter values to satisfy these conditions In each update
step if the updated a becomes less than 106 we set a  106 Similarly if a  b
is violated we set b  a  106 If n  106 we set n  106
The temporal resolution of our data is a minute We set the unit time for the ML
method to an hour such that our data has a resolution of 160 on this timescale The
data would be too discrete for the ML method to bear accurate results if we set the
unit time for the ML method to a minute We veried that the results little changed
when we made the time unit larger than one hour
Acknowledgements N M acknowledges the support provided through Grants-in-Aid for Scien-
tic Research No 23681033 and Innovative Areas Systems Molecular EthologyNo 20115009
from MEXT Japan T T acknowledges the support provided through Grants-in-Aid for Scientic
Research No 10J06281 from JSPS Japan
References
1 Barabasi AL The origin of bursts and heavy tails in human dynamics Nature 435 207211
2 Candia J Gonzalez MC Wang P Schoenharl T Madey G Barabasi AL Uncovering
individual and collective human dynamics from mobile phone records J Phys A 41 224015
Self-exciting point process modeling
3 Cattuto C Van den Broeck W Barrat A Colizza V Pinton JF Vespignani A Dynam-
ics of person-to-person interactions from distributed RFID sensor networks PLoS ONE 5
e11596 2010
4 Crane R Sornette D Robust dynamic classes revealed by measuring the response function
of a social system Proc Natl Acad Sci USA 105 1564915653 2008
5 Dahlhaus R Eichler M Sandkuhler J Identication of synaptic connections in neural en-
sembles by graphical models J Neurosci Methods 77 93107 1997
6 Ebel H Mielsch LI Bornholdt S Scale-free topology of e-mail networks Phys Rev E
66 035103R 2002
7 Eckmann JP Moses E Sergi D Entropy of dialogues creates coherent structures in e-mail
trafc Proc Natl Acad Sci USA 101 1433314337 2004
8 Goh KI Barabasi AL Burstiness and memory in complex systems Europhys Lett 81
48002 2008
9 Gonzalez MC Hidalgo CA Barabasi AL Understanding individual human mobility
patterns Nature 453 779782 2008
10 Han XP Zhou T Wang BH Modeling human dynamics with adaptive interest New J
Phys 10 073010 2008
11 Hawkes AG Point spectra of some mutually exciting point processes J R Stat Soc B 33
438443 1971
12 Hawkes AG Spectra of some self-exciting and mutually exciting point processes
Biometrika 58 8390 1971
13 Hawkes AG Oakes D A cluster process representation of a self-exciting process J Appl
Prob 11 493503 1974
14 Holme P Saramaki J Temporal networks Phys Rep 519 97125 2012
15 Iribarren JL Moro E Impact of human activity patterns on the dynamics of information
diffusion Phys Rev Lett 103 038702 2009
16 Isella L Romano M Barrat A Cattuto C Colizza V Van den Broeck W Gesualdo F
Pandol E Rava L Rizzo C Tozzi AE Close encounters in a pediatric ward measuring
face-to-face proximity and mixing patterns with wearable sensors PLoS ONE 6 e17144
17 Isella L Stehle J Barrat A Cattuto C Pinton JF Van den Broeck W Whats in a
crowd Analysis of face-to-face behavioral networks Journal of Theoretical Biology 271
166180 2011
18 Jo HH Karsai M Kertesz J Kaski K Circadian pattern and burstiness in mobile phone
communication New J Phys 14 013055 2012
19 Karsai M Kaski K Barabasi AL Kertesz J Universal features of correlated bursty be-
haviour Sci Rep 2 397 2012
20 Krumin M Reutsky I Shoham S Correlation-based analysis and generation of multiple
spike trains using Hawkes models with an exogenous input Frontiers in Comput Neurosci
4 147 2010
21 Malmgren RD Stouffer DB Campanharo ASLO Amaral LAN On universality in
human correspondence activity Science 325 16961700 2009
22 Malmgren RD Stouffer DB Motter AE Amaral LAN A Poissonian explanation for
heavy tails in e-mail communication Proc Natl Acad Sci USA 105 1815318158 2008
23 Min B Goh KI Kim IM Waiting time dynamics of priority-queue networks Phys Rev
E 79 056110 2009
24 Mitchell L Cates ME Hawkes process as a model of social interactions a view on video
dynamics J Phys A 43 045101 2010
25 Ogata Y On Lewis simulation method for point processes IEEE Trans Info Th 27 2331
26 Ogata Y Seismicity analysis through point-process modeling A review Pure Appl Geo-
phys 155 471507 1999
27 Ogata Y Akaike H On linear intensity models for mixed doubly stochastic Poisson and
self-exciting Point-Processes J R Stat Soc B 44 102107 1982
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
28 Oliveira JG Vazquez A Impact of interactions on human dynamics Physica A 388 187
192 2009
29 Ozaki T Maximum likelihood estimation of Hawkes self-exciting point processes Ann
Inst Stat Math 31 145155 1979
30 Pernice V Staude B Cardanobile S Rotter S How structure determines correlations in
neuronal networks PLoS Comput Biol 7 e1002059 2011
31 Reynaud-Bouret P Schbath S Adaptive estimation for Hawkes processes application to
genome analysis Ann Stat 38 27812822 2010
32 Rocha LEC Liljeros F Holme P Information dynamics shape the sexual networks of
Internet-mediated prostitution Proc Natl Acad Sci USA 107 57065711 2010
33 Takaguchi T Nakamura M Sato N Yano K Masuda N Predictability of conversation
partners Phys Rev X 1 011008 2011
34 Takaguchi T Sato N Yano K Masuda N Importance of individual events in temporal
networks New J Phys 14 093003 2012
35 Vazquez A Oliveira JG Dezso Z Goh KI Kondor I Barabasi AL Modeling bursts
and heavy tails in human dynamics Phys Rev E 73 036127 2006
36 Vere-Jones D Stochastic models for earthquake occurrence
J R Stat Soc B 32 162
37 Wakisaka Y Ohkubo N Ara K Sato N Hayakawa M Tsuji S Horry Y Yano K
Moriwaki N Beam-scan sensor node Reliable sensing of human interactions in organization
2009 Sixth International Conference on Networked Sensing Systems INSS IEEE Press
Piscataway NJ USA pp 14 2009
38 Wu Y Zhou C Xiao J Kurths J Schellnhuber HJ Evidence for a bimodal distribution
in human communication Proc Natl Acad Sci USA 107 1880318808 2010
39 Yano K Ara K Moriwaki N Kuriyama H Measurement of human behavior creating a
society for discovering opportunities Hitachi Rev 58 139144 2009
Self-exciting point process modeling
ID79 in D1
ID51 in D2
t  min
Fig 1 Survivor functions of the IET ie probability that the IET is larger than t  for the conversa-
tion sequences of two individuals For each of D1 and D2 the individual with the largest number of
events is selected The selected individuals in D1 and D2 have 2397 and 2886 events respectively
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
t  min
t  min
t  day
t  day
Fig 2 Conditional mean IET dened by Eq 1 for a conversation event sequences 33 b
email logs 6 and c purchase of sexual escorts 32 d Histogram of the IET for the data shown
in c
Self-exciting point process modeling
Fig 3 Example time course of event rate l t and the corresponding event sequence
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
Fig 4 Statistics of the IET obtained from the Hawkes process a CV b IET correlation and c
mean cluster size c for various values of a and b 
Self-exciting point process modeling
a   1 b
a   1 b
 001  01  1
 10  100 1000
IET min
a   5 b
a   5 b
 001  01  1
 10  100 1000
IET min
a   20 b
a   20 b
 001  01  1
 10  100 1000
IET min
Fig 5 Survivor functions of the IET for the Hawkes process with different values of a and b 
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
IET min
IET min
Fig 6 Survivor functions of the IET for two individuals a Results for an individual in D1
who has 1694 valid IETs during the recording period The ML estimators are given by a  491
b  789 and n  218 b Results for an individual in D1 who has 1765 valid IETs The ML
estimators are given by a  245 b  386 and n  277
Self-exciting point process modeling
 8  10  12  14
mean IET data
IET correlation data
Fig 7 Comparison between the data and the estimated model a mean IET b CV and c
IET correlation Each data point corresponds to one valid individual The mean IET CV and IET
correlation for the data are calculated on the basis of the days containing at least 40 events
Naoki Masuda and Taro Takaguchi and Nobuo Sato and Kazuo Yano
Fig 8 Results for the modied Hawkes process with n  1 a CV with p  01 b IET correla-
tion with p  01 c Relationship between the CV and IET correlation with p  0 and p  01
