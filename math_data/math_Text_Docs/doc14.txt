Eective measure of endogeneity for the Autoregressive
Conditional Duration point processes via mapping to the
self-excited Hawkes process
V Filimonov S Wheatley and D Sornette
Department of Management Technology and Economics
ETH Zurich Scheuchzerstrasse 7 CH-8092 Zurich Switzerland
Dated June 20 2014
In order to disentangle the internal dynamics from exogenous factors within the
Autoregressive Conditional Duration ACD model we present an eective measure
of endogeneity
Inspired from the Hawkes model this measure is dened as the
average fraction of events that are triggered due to internal feedback mechanisms
within the total population We provide a direct comparison of the Hawkes and
ACD models based on numerical simulations and show that our eective measure of
endogeneity for the ACD can be mapped onto the branching ratio of the Hawkes
INTRODUCTION
An outstanding challenge in socio-economic systems is to disentangle the internal dynam-
ics from the exogenous inuence It is obvious that any non-trivial system is both subject to
external shocks as well as to internal organizational forces and feedback loops In absence
of external inuences many natural and social systems would regress or die however the
internal mechanisms are of no less importance and can either stabilize or destabilize the
system These systems are continuously subjected to external shocks forces noises and
stimulations they propagate and process these inputs in a self-reexive way The stability
or criticality of these dynamics is characterized by the relative strength of self-reinforcing
Electronic address vlimonovethzch
Electronic address wspencerethzch
Electronic address dsornetteethzch
mechanisms
For instance the brain development and performance is given by both external stimuli and
endogenous collective and interactive wiring between neurons The normal regime of brain
dynamics corresponds to asynchronous ring of neurons with relatively low coupling between
individual neurons However as the coupling strength increases the internal feedback loops
starts playing an increasingly important role in the dynamics and the system moves towards
the tipping point at which abnormal synchronous neuronal avalanches result in an epileptic
seizure 77 As another example nancial systems are known to be driven by exogenous
idiosyncratic news that are digested by investors and complemented with quasi-rational
sometimes self-referential behavior Correlated over-expectations herding of investors
correspond to the bubble phase that pushes the system towards criticality where the crash
may result as a bifurcation towards a distressed regime 78
In physical systems at thermodynamic equilibrium the so-called uctuation-dissipation
theorem relates quantitatively the response of the system to an exogenous and instanta-
neous shock to the correlation structure of the spontaneous endogenous uctuations 86
In out-of-equilibrium systems the existence of such relation is still an open question 68 In
a given observation set it seems in general hopeless to separate the contributions resulting
from external perturbations and internal uctuations and responses However one would
like to understand the interplay between endogeneity and exogeneity the endo-exo prob-
lem for short in order to characterize the reaction of a given system to external inuences
to quantify its resilience and explain its dynamics Using the class of self-exciting condi-
tional Poisson Hawkes processes 42 43 some progress has recently been made in this
direction 15 18 79 80
In the modeling of complex point processes in natural and socio-economic systems the
Hawkes process 42 43 has become the gold standard due to its simple construction and
exibility Nowadays it is being successfully used for modeling sequences of triggered earth-
quakes 62 genomic events along DNA 67 brain seizures 63 82 spread of violence 52
and crime 56 across some regions extreme events in nancial series 19 and probabilities
of credit defaults 25 In nancial applications the Hawkes processes are most actively used
for modeling high frequency uctuations of nancial prices see for instance 4 7 11 32
however applications to lower frequency data such as daily are also possible see A
Being closely related to branching processes 39 the Hawkes model combines in a natural
and parsimonious way exogenous inuences with self-excited dynamics It accounts simul-
taneously for the co-existence and interplay between the exogenous impact on the system
and the endogenous mechanism where past events contribute to the probability of occur-
rence of future events Moreover using the mapping of the Hawkes process onto a branching
structure it is possible to construct a representation of the sequence of events according to
a branching structure with each event leading to a whole tree of ospring
The linear construction of the Hawkes model allows one to separate exogenous events
and develop a single parameter the so-called branching ratio  that directly measures the
level of endogeneity in the system The branching ratio can be interpreted as the fraction
of endogenous events within the whole population of events 32 45 The branching ratio
provides a simple and illuminating characterization of the system in particular with respect
to its fragility and susceptibility to shocks For   1 on average the proportion 1   of
events arrive to the system externally while the proportion  of events can be traced back to
the inuence of past dynamics As  approaches 1 from below the system becomes critical
in the sense that its activity is mostly endogenous or self-fullling More precisely its activity
becomes hyperbolically sensitive to external inuences The regime   1 corresponds to
the occurrence of an unbounded explosion of activity nucleated by just a few external events
eg news with non-zero probability In any realistic case when present this explosion
will be observable in nite time Not only does the Hawkes model provide this valuable
parameter  but it also amenable to an easy and transparent estimation by maximum
likelihood 60 64 without requiring stochastic declustering 54 93 which is essential in the
branching processes framework but has several limitations 84
However the Hawkes model is not the only model that describes self-excitation in point
processes
In particular the Autoregressive Conditional Duration ACD model 22 23
and the Autoregressive Conditional Intensity ACI model 69 have been introduced and
successfully used in econometric applications A similar concept was used in the so-called Au-
toregressive Conditional Hazard ACH model 37 These processes were designed to mimic
properties of the famous Autoregressive Conditional Heteroskedasticity ARCH model 20
and Generalized Autoregressive Conditional Heteroskedasticity GARCH model 8 that
successfully account for volatility clustering and self-excitation in price time series Some
other modications of ACD models such as Fractionally Integrated ACD FIACD 47 or
Augmented ACD AACD 29 were introduced to account for additional eects such as
long memory or to increase the exibility of the model for a more detailed review see 7
and references therein
In general all approaches to modeling self-excited point processes can be separated into
the classes of Duration-based represented by the ACD model and its derivations and
Intensity-based approaches Hawkes ACH ACI and so on which dene a stochastic ex-
pression for inter-event durations and intensity respectively Of all the models as discussed
above the Hawkes process dominates by far in the class of intensity-based model and the
ACD model  a direct ospring of the GARCH-family  is the most used duration-based
Despite belonging to dierent classes both models describe the same phenomena and
exhibit similar mathematical properties In this article we aim to establish a link between
the ACD and Hawkes models We show that despite the fact that the ACD model cannot
be directly mapped onto a branching structure and thus the branching ratio for this model
cannot be derived
it is possible to introduce a parameter   0 1 that serves as an
eective degree of endogeneity in the ACD model We show that this parameter shares
important properties with the branching ratio   0 1 in the framework of the Hawkes
model Namely both  and  characterize stationarity properties of the models and provide
an eective transformation of the exogenous excitation of the system onto its total activity
By numerical simulations we show that there exists a monotonous relationship between
the parameter  of the ACD model and the branching ratio  of the corresponding Hawkes
model In particular the purely exogenous case   0 and the critical state   1 are
exactly mapped to the corresponding values   0 and   1 We validate our results by
goodness-of-t tests and show that our ndings are robust with respect to the specication
of the memory kernel of the Hawkes model
The article is structured as follows In section II we introduce the Hawkes and ACD
models and briey discuss their properties Section III introduces the branching ratio and
relates it to the measure of endogeneity within the framework of the Hawkes model
section IV we discuss similarities between the Hawkes and ACD models and identify a
parameter in the ACD model that can be treated as an eective degree of endogeneity
We support our thesis with extensive numerical simulations and goodness-of-t tests
section V we conclude
II MODELS OF SELF-EXCITED POINT PROCESSES
Let us dene a univariate point process of event times tiiN0 ti  tj for i  j with
the counting process Ntt0  maxi  ti  t and the duration process of inter-event
times tiiN0  ti  ti1 Properties of the point process ti are usually described with
the unconditional intensity process t  limh0
intensity process tFt  limh0
h PrNt  h  Nt  0 and conditional
h PrNt  h  Nt  0Ft which is adapted to the
natural ltration Ft  t1     ti  t  ti representing the history of the process
The well-known Poisson point process is dened as the point process whose conditional
intensity does not depend on the history of the process and is constant
tFt  t  0  0
The non-homogenous Poisson process extends expression 1 to account for time-dependence
of both conditional and unconditional intensity functions tFt  t  0t  0
Both homogeneous and non-homogeneous Poisson processes are completely memoryless
which means that the durations ti are independent from each other and are completely
determined by the exogenous parameter function 0t
The Self-excited Hawkes process and Autoregressive Conditional Durations ACD model
which are described in this article extend the concept of the Poisson point processes by
adding path dependence and non-trivial correlation structures These models represent two
dierent approaches in modelling point processes with memory the so called intensity-based
and duration-based approaches As follows from their names the rst approach focuses
on models for the conditional intensity function tFt and the second considers models
of the durations ti For example in the context of the intensity-based approach the
Poisson process is dened by equation 1 In the context of the duration-based approach
the Poisson process is dened as the point process whose durations ti are independent
and identically distributed iid random variables with exponential probability distribution
function f t  0 exp0t
A Hawkes Model
The linear Hawkes process 42 43 which belongs to the class of intensity-based models
has its conditional intensity tFt being a stochastic process of the following general form
tFt  t Z t
ht  sdNs
where t is the background intensity which is a deterministic function of time that accounts
for the intensity of arrival of exogenous events not dependent on history A determinis-
tic kernel function ht which should satisfy causality ht  0 for t  0 models the
endogenous feedback mechanism memory of the process Given that each event arrives
instantaneously the dierential of the counting process dNt can be represented in the
form of a sum of delta-functions dNt  Ptit t  tidt allowing 2 to be rewritten in
the following form
tFt  t Xtit
ht  ti
It can be shown and we will discuss this point in the following section that the stationarity
of the process 3 requires that
0  Z 
htdt  1
The shape of the kernel function ht denes the correlation properties of the process
In particular the geophysical applications of the Hawkes model or more precisely of its
spatio-temporal extension called the Epidemic-Type Aftershock sequence ETAS 62 90 91
assume in general a power law time-dependence of the kernel ht
t  c t
that describes the modied Omori-Utsu law of aftershock rates 88 89 Financial applica-
tions 11 14 32 46 traditionally use an exponential kernel
ht  a expt t
which has been originally suggested by 43 and ensures Markovian properties of the
model 59
In both cases a Heaviside function t ensures the validity of the causal-
ity principle The stationarity condition 4 requires Kc1  1  1 for the power law
kernel and a  1 for the exponential kernel
In the present work we focus on the Hawkes model with an exponential kernel 6 and
background intensity t that does not depend on time t    0 We introduce a new
dimensionless parameter   a  which will be discussed in detail later which allows us to
write the nal expression for the conditional intensity as follows
tFt   
 Xtit
expcid18
t  ti
 cid19 
Then the stationarity condition reads   1 In order to check the robustness of the results
presented below in particular with respect to the choice of the memory kernel we have also
considered a power law kernel 5 with time-independent background intensity t    0
Similarly to the exponential kernel the integral from 0 to  of the memory kernel denes
the dimensionless parameter   Kc1  1 which allows us to rewrite the Hawkes
model with power law kernel as
tFt    c1  1Xtit
t  ti  c 
Again the stationarity condition reads   1
B Autoregressive Conditional Durations ACD Model
The class of Autoregressive Conditional Durations ACD models has been introduced
by 22 23 in the eld of econometrics to model nancial data at the transaction level
The ACD model applies the ideas of the Autoregressive Conditional Heteroskedasticity
ARCH 20 model which separates the dynamics of a stationary random process into
a multiplicative random error term and a dynamical variance that regresses the past values
of the process In the spirit of the ARCH the ACD model is represented by the duration
process ti in the form
ti  ii
where i denes an iid random non-negative variable with unit mean Ei  1 and the
function i  NFt  is the conditional expected duration EtiFt  i Here 
represents the set of parameters of the model From expression 9 one can simply derive
the conditional intensity of the process 23
tFt  cid18t  tN t
N t1 cid19
N t1
where s represents the intensity function of the noise term i Assuming i to be iid
exponentially distributed one can call this model 9 an Exponential ACD model
The conditional expected duration NFt  of the ACDpq model where p q
denotes the order of the model is dened as an autoregressive function of the past observed
durations ti and the conditional durations i themselves
i   
jtij 
kij
where   0 j  0 and k  0 are parameters of the model that constitute the set  
 1     p 1     p The stationarity condition for the ACD model has the form 23
k  1
In the simple ACD11 case that is considered in the present article equation 11 is
reduced to
i    ti1  i1
Similarly the conditional intensity 10 of the Exponential ACD11 has the form
tFt 
N t1
  tN t  N t
and the stationarity condition 12 reduces to     1
III THE BRANCHING RATIO AS A MEASURE OF ENDOGENEITY IN THE
HAWKES MODEL
The linear structure of the Hawkes process 3 with identical functional form of summands
ht  ti that depend only on arrival time of a single event ti allows one to consider it as
a cluster process in which the random process of cluster centers tc
process with rate t All clusters associated with centers tc
i iN0 is the Poisson
i  are mutually independent
by construction and can be considered as a generalized branching process 44 illustrated in
gure 1
Insert Figure 1 here
In this context each event ti can be either an immigrant or a descendant The rate of
immigration is determined by the background intensity t and results in an exogenous
random process Once an immigrant event occurs it generates a whole cluster of events
Namely a zeroth-order event which we will call the mother event can trigger one or more
rst-order events daughter events Each of these daughters in turn may trigger sev-
eral second-order events the grand-daughters of the initial mother and so on All rst-
second- and higher-order events form a cluster and are called descendants or aftershocks
and represent endogenously driven events that appear due to internal feedback mechanisms
in the system It should be noted that this mapping of the Hawkes process 3 onto the
branching structure gure 1 is possible due to the linearity of the model and is not valid
for nonlinear self-excited point processes such as the class of nonlinear mutually excited
point processes 12 of which the Multifractal stress activation model 83 is a particular
implementation
The crucial parameter of the branching process is the branching ratio n which is dened
as the average number of daughter events per mother event Depending on the branching
ratio there are three regimes i sub-critical n  1 ii critical n  1 and iii super-
critical or explosive n  1 Starting from a single mother event or immigrant at time
t1 the process dies out with probability 1 in the sub-critical and critical regimes and has a
nite probability to explode to an innite number of events in the super-critical regime The
critical regime for n  1 separates the two main regimes and is characterized by power law
statistics of the number of events and in the number of generations before extinction 71 For
n  1 the process is stationary in the presence of a Poissonian or more generally stationary
ux of immigrants
Being the parameter that describes the clustering structure of the branching process
the branching ratio n denes the relative proportion of exogenous events immigrants and
endogenous events descendants or aftershocks Moreover in the sub-critical regime in the
case of a constant background intensity t    const the branching ratio is exactly
equal to the fraction of the average number of descendants in the whole population 32
45 In other words the branching ratio is equal to the proportion of the average number
of endogenously generated events among all events and can be considered as an eective
measure of endogeneity of the system
To see this let us count separately the rates of exogenous and endogenous events The
rate of exogenous immigrants zeroth-order events is equal to the background activity rate
Rexo   Each immigrant independently gives birth on average to n daughters and thus
the rate of rst-order events is equal to r1  n In turn each rst-order event produces
on average n second-order events whose rate is equal to r2  nr1  n2 Continuing this
process ad innitum and summing over all generations we obtain the rate of all endogenous
descendants
Rendo 
ri  
1  n
which is nite for n  1 The global rate is the sum of the rates of immigrants and
descendants and equal to
R  Rexo  Rendo   
1  n
1  n
And the proportion of descendants endogenously driven events in the whole system is equal
to the branching ratio
Calibrating n on the data therefore provides a direct quantitative estimate of the degree of
endogeneity
In the framework of the Hawkes model 3 with t    const the branching ratio n
is easily dened via the kernel ht
n  Z 
htdt
For the exponential parametrization 6 the branching ratio n  a  is equal to a dimension-
less parameter n   previously introduced The Hawkes framework provides a convenient
way of estimating the branching ratio n   from the observations ti using the Max-
imum Likelihood method which benets from the fact that the log-likelihood function is
known for Hawkes processes 60 64 The calibration of the model and estimation of the
branching ratio n can then be performed with the numerical maximization of Log-Likelihood
function in the parameter space  n   for the exponential kernel 6 and  n c  for
the power law model 5 Despite being a relatively straightforward calibration procedure
special care should be taken with respect to data processing choice of the kernel robustness
of numerical methods and stationarity tests as discussed in details in 34
IV THE EFFECTIVE DEGREE OF ENDOGENEITY IN THE
AUTOREGRESSIVE CONDITIONAL DURATIONS ACD MODEL
A Formal similarities between the ACD and Hawkes models
Note that the ACDpq and Hawkes models operate on dierent variables with inverse
dimensions duration t for the ACDpq model and conditional intensity tFt for the
Hawkes model which is of the order of the inverse 1t of the duration t As a consequence
equations 21 and 16 apply to dierent statistics average durations Et and average
rate R  E1t Moreover the ACD model cannot be exactly mapped onto a branching
structure whereas the Hawkes process can
Indeed the branching structure requires that the conditional probability for an event
to occur within the innitely small interval t t  dt which is the conditional intensity
should be decomposed into a sum of 1 a deterministic or stochastic function of time that
represents the immigration intensity and 2 the contributions fi from each past event ti
that satisfy the following conditions i these contributions should depend only on ti and
be independent from all other events tj  t ii these contributions should exhibit identical
structure for all events and iii they should satisfy the causality principle Thus in its
general form a conditional Poisson process that can be mapped on multiple branching
structures if it is described by the following conditional intensity
tFt  t Xtit
f t tit  ti
where f t ti is some deterministic function and t is a unit step Heaviside function In
the context of autoregressive models such as ACD the expected waiting time at a given
time t is dened as a regressive sum of past durations which means that the contribution of
each event ti  t to the intensity at time t depends on all the events tj that happened after it
ti  tj  t This violates the rst principle for a branching processes of the independence
of distinct branches For the ACD model the analysis is also complicated by the structure
of the conditional intensity function 10 where past history is inuencing the intensity
both in a multiplicative way and with a shift in the baseline intensity  One should note
that autoregressive intensity models such as ACI in general also do not have a branching
structure representation due to the problem discussed above
Despite the dierences in their denition and the impossibility of developing an exact
mapping onto a branching structure the ACD model shares many similarities with the
Hawkes model and their point processes exhibit similar degrees of clustering In particular
for the ACD dened by expression 11 the combined parameter
plays a similar role to the parameter  of the Hawkes process with an exponential kernel 7
The similarities start with the stationarity conditions 4 and 12 which require   1 for
the Hawkes model and   1 for the ACD but go much deeper than the simple idea of
eective distance to a non-stationary regime
As we have seen in the previous section  denes the eective degree of endogeneity 17
that translates the exogenous rate Rexo   into the total rate Rtotal  Rexo1  
Similarly let us study the role of endogenous feedback in the ACD model For j  k   
0 the ACD00 model 911 reduces to a simple Poisson process with durations ti  i
having an average value of Eti   which can be considered as the exogenous factor
When j  0 and k  0 there is an amplication of the average durations Considering
the average of eq 11 in the stationary regime Eti1  Eti and Ei1  Ei and
taking into account eq 9 we obtain the following expression for the mean duration in the
stationary regime
Et 
1 Pp
j1 j Pq
1  
k1 k
Equations 21 and 16 share the same functional dependence with a divergence when the
corresponding control parameters  and  approach 1
B Empirical dependence of the eective branching ratio  as a function of     
for the ACD11 process
In order to quantify the similarities between the ACD and Hawkes models outlined in the
previous section we have performed the following numerical study We simulated realizations
of the ACD11 process and calibrated the Hawkes model to it The traditional way of
tting the Hawkes model uses the maximum likelihood method 64 which is asymptotically
normal and asymptotically ecient 60 We have used the R package PtProcess 40
which provides a convenient framework for Hawkes models 3 with arbitrary kernel ht
and background intensity t Then we maximized the likelihood function using a Newton-
type non-linear maximization 17 75 The B reports a study of the nite sample bias and
eciency of the Hawkes maximum likelihood estimator We nd that the estimation error
   of the branching ratio without model error measured with the 90 quantile ranges
does not exceed 01 for all values   09
More precisely we want to quantify similarities between control parameters  of the
model ACDpq and  of the exponential Hawkes model For this we have simulated
realizations of the ACD process and estimated the parameter  from these realizations The
parameter  of the ACDpq 11 model denes the time scale Without loss of generality
we let   1 which accounts for a linear transformation of time ti  ti in equations 9
and 11 For the sake of simplicity we present our results for the ACD11 model for
which the dimensionless parameter  reduces to      However our ndings are robust
to the choice of the order of the ACD model and can be easily generalized to the case of
p q  1 The parameters  and  were chosen so that      spanned 0 1 at 40
equidistant points For each of the 40 values of  we have generated 100 realizations of the
corresponding exponential ACD11 process Each realization of 3500 events was generated
by a recursive algorithm using eq 13 In order to minimize the impact of edge eects that
can bias the estimation of the branching ratio 34 the rst 500 points of each realization
were discarded Then the Hawkes model 7 was calibrated on these synthetic datasets
For each calibration we have performed a goodness-of-t test based on residual analy-
sis 62 which consists of studying the so-called residual process dened as the nonparametric
transformation of the initial time-series ti into
i  Z ti
tFtdt
where tFt is the conditional intensity of the Hawkes process 7 estimated with the
maximum likelihood method Under the null hypothesis that the data has been generated
by the Hawkes process 7 the residual process i should be Poisson with unit intensity 66
Visual analysis involves studying the cusum plot or Q-Q plot and may be complemented
with rigorous statistical tests Under the null hypothesis Poisson statistics of the resid-
ual process i the inter-event times in the residual process i  i  i1 should be
exponentially distributed with CDF F   1  exp Thus the random variables
Ui  F i  1  expi should be uniformly distributed in 0 1 We have performed
rigorous Kolmogorov-Smirnov tests for uniformity and provided the corresponding p-values
We start with a visual comparison of realizations generated with the two models Figure 2
presents a comparison of the conditional intensities and durations for i simulations of the
ACD11 process and ii simulations of the Hawkes process with parameters calibrated to
the corresponding ACD process realization Visual similarities are striking for all four ACD-
Hawkes pairs Total average and maximum durations are similar Moreover bursts of short
and long durations are of similar length The conditional intensities uctuate in a similar
range and show qualitatively similar clustering of events although the ACD conditional
intensity is constant between events while the Hawkes decays exponentially Quantitatively
the distributions of durations also show a large degree of similarity
Insert Figure 2 here
Figure 2 also reveals one important property of the ACD model Despite the fact that
many statistical properties such as average durations 21 are dened by the control pa-
rameter       and  have dierent impacts on the eective degree of endogeneity
 For instance case B   038   013 and caseC   013   038 both have the
same   051 but   052 for B and   022 for C The smaller endogeneity found in
case C is compensated by a higher rate of exogenous events   038 for C compared
with   024 for B resulting in a atter conditional intensity for C
In order to explore this eect in simulations of the ACD model for each value of   
we considered dierent relations between  and  i     2 ii   0   
iii   0    iv   3  34 and v   3  34 Figure 3 presents the
results of the tting of the Hawkes model on realizations of the ACD11 model in these ve
cases The rst striking observation is the existence of two fundamentally dierent behaviors
observed for   0 case iii versus   0 cases iiiivv For   0 the estimated
eective branching ratio  is 0 for all values of the control parameter    as shown in
Figure 3B This diagnoses a completely exogenous dynamics of the ACD process which is
indeed the expected diagnostic given that for   0 eq 9 and 13 reduce to
ti  ii i    i1
for which the dynamics of the conditional durations i is purely deterministic and inde-
pendent of the realized durations ti while the later are entirely driven by the random term
Insert Figure 3 here
For   0 we nd similar non-trivial results Figure 3B shows the eective branching
ratio  as a monotonously increasing function of  for all combinations of  6 0 and  In
cases ii   0 and iv   3 the dependence of  on  is almost linear for   05 and
  09 respectively and for higher values of  the convexity increases In case i   
 depends linearly on  for   04 with a very good approximation Finally in case v
  3 the curvature of  is signicant over the range of 03    09 Remarkably
all four dependencies converge to the same value   09 for   1
Figure 4 presents the dependence of the eective branching ratio  on the control param-
eter      after correction of the bias in estimation due to nite size eects presented
in the B and summarized in gure 7 All dependencies of  as a function of  converge to
the critical value   1
Insert Figure 4 here
Figure 5 generalizes gure 3B by presenting the dependence of the eective branching
ratio  corrected for the nite sample bias determined in the B on the parameters  and
 separately As expected the impact of a change of  is much larger than that of  There
is a region delineated by the dashed line within which the Hawkes model is rejected at the
5 level for the Kolmogorov-Smirnov test For most combinations of  and  such that
06      095 the Hawkes model is rejected Interestingly the Hawkes model is not
rejected in the case where  is kept signicantly larger than  and it is only rejected in a
small interval in the extreme opposite case where   0 The model is often not rejected
for large values of 
C Dierences between the ACD and Hawkes models
Despite similarities the Hawkes and ACD models exhibit some important dierences
Figure 3A shows that the eective background rate  estimated by the Hawkes model is
a decreasing function of the control parameter  This is an indirect consequence of the
dependence of the expected duration on  given by expression 21
In contrast to the
Hawkes model 2 for which the background rate t completely describes the exogenous
impact on the system the parameter  of the ACD model 11 is not the only factor
embodying the exogenous activity and there is no strict decoupling between the exogenous
driver  and endogenous level  as occurs for the parameters  and  of the Hawkes model
In other words in contrast to the Hawkes model the ACD in its classical form 11 does
not provide a clean distinction between exogenous and endogenous activities
Another dierence between the Hawkes and ACD models can be observed in gure 3D
which presents a residual analysis of the calibration of realizations of the ACD process by the
Hawkes model using the Kolmogorov-Smirnov test The null hypothesis that the realizations
of the ACD process are generated by the Hawkes model is rejected at the 5 condence level
for   06 in case i    For case ii   0 and iv   3 the null hypothesis is
rejected for even lower   04 However for case v   3 the null cannot be rejected
for almost all values of the control parameter  except for a small interval around   08
Inuence of the memory kernel ht of the calibrating Hawkes process
Finally we need to discuss the choice of the kernel ht in the specication of the Hawkes
model 3 used in the calibration of the realizations generated with the ACG process The use
of the exponential kernel 6 is a priori justied by the short memory of the ACD11 process
Indeed the autocorrelation function of the ACD11 model decays exponentially 7 and
the same can be shown explicitly for the GARCH11 model 92 The choice of a short-
memory exponential kernel for the Hawkes model ensures Markovian properties with a fast
decaying autocorrelation function of the durations 59 High p-values of the goodness-of-t
tests for parameters   05 see gure 3 conrm the good mapping between the exponential
ACD11 and Hawkes processes with an exponential kernel
In order to further validate the selection of the exponential kernel of the Hawkes process
we have compared the calibrations of realizations generated with the ACG process with the
Hawkes model with the exponential kernel 6 and with the power law kernel 5 Since these
models have a dierent number of parameters k  3 and k  4 respectively we compare
them using the Akaike information criterion AIC 2 The AIC is by far the most popular
model comparison criterion used in the point process literature 35 The AIC penalizes
complex models by discounting the likelihood function L by the number k of parameters of
the model Specically the AIC suggests selecting the model with a minimum AIC value
where AIC  2k  2 log L
Insert Table 1 here
Table 1 gives the results for the realizations presented in gure 2 In terms of likelihood
the exponential and power law kernels give practically identical values log Lexp  log Lpow
Penalizing model complexity with the AIC widens the gap and the exponential kernel with
one fewer parameters is selected under the AIC
Notwithstanding their apparent strong dierence the estimated background intensities
 and branching ratios n are almost the same for both memory kernels This can
explained by the fact that the parameters  and c estimated for the power law kernel
5 are such that the later remains very close to an exponential kernel over a large time
interval as illustrated by gure 6 for case C   013   038 which presents a direct
comparison between the exponential kernel ht  ht   1 expt  and the power
law kernel ht  c1  1t  c The corresponding ML estimates of their parameters
are respectively   776   10517 and c  81641 The large value of the estimated
exponent  of the order of 100 implies a fast decay similar to an exponential function
Correlatively the large value of the constant c implies the absence of the hyperbolic range
or long tail as well The almost perfect coincidence is observed for up to times t  30
over which the kernels ht decay by a factor of almost 50 For t  50 for which the relative
dierence between the two kernels exceed 20 the absolute values of ht is less than 2104
so that the contribution of time scales beyond t  50 to the total intensity 78 becomes
insignicant
Insert Figure 6 here
V CONCLUSION
The present article positions itself within the neoclassical nancial literature that inves-
tigates the nature of the mechanisms that drive nancial prices The benchmark called
the Ecient Market Hypothesis EMH 27 28 73 74 holds that markets only reacts
to external inputs information ow and almost instantaneously reect these inputs in
the price dynamics This purely exogenous view on price formation has been contradicted
by many empirical observations see for instance the original works 16 76 and more re-
cent 26 50 81 which show that only a minor fraction of price movements can be explained
by relevant news releases This implies a signicant role for internal feedback mechanisms
Using the framework of Hawkes processes two of us 30 32 have used the corresponding
branching ratio to provide what is to the best of our knowledge the rst quantitative
estimate of the degree of endogeneity in nancial markets This degree of endogeneity is
measured as the proportion of price moves resulting from endogenous interactions among
the total number of all price moves including both endogenous interactions and exogenous
news These works provided a solid counter-example of short-term ineciency of nancial
markets which was complemented with the similar conrmation from longer time scales 38
The later work though is subjected to a number of numerical biases as shown in 34 and
triggered an ongoing discussion about the nature of long-range memory and criticality
In this context the present article expands the quantication of endogeneity to the class
of Autoregressive Conditional Duration ACD point processes This is done by the intro-
duction of the composite parameter  20 associated with the parameters j and k which
control the dependence of the conditional expectated duration between events as a function
of past realized duration and past conditional expected duration We have shown that the
parameter  can be mapped onto the branching ratio  that directly measures the level
of endogeneity within the framework of the Hawkes self-excited conditional Poisson model
This result leads to a novel interpretation of the various studies that analyzed high-frequency
nancial data with the ACD model
An important conclusion derives from our mapping of the ACD onto the Hawkes process
Both original works 21 23 69 as well as more recent studies reviewed in Refs 24 65 have
reported estimated parameters j and k that combine to extremely large values of  often
larger than 05 and up to 095 From the perspective oered by the present work and in
particular from the mapping of  onto  these empirical ndings provide strong support to
the hypothesis of a dominant endogenous or reexive 85 component in the dynamics of
nancial markets
The present work oers itself to a natural extension beyond point processes to the class
of discrete time processes There are several successful models of self-excitation within
a discrete time framework such as AR auto-regressive ARMA auto-regressive moving
average 36 and GARCH models 8 and their siblings as well as the recently introduced
Self-Excited Multifractal SEMF model 31 that extends Quasi-Multifractal models 70
72 by introducing explicit feedback mechanism However until now there has been no
framework that provides a direct quantication and estimation of the degree of endogeneity
present in a given time series As discussed above the ACDpq model in fact belongs to the
class of GARCHpq models though not with normally distributed innovations but instead
with iid distributed innovations with a Poisson distribution By extension this suggests
a direct application of our present ndings to GARCH models This correspondence will
benet from the elaborate toolbox of calibration methods and the detailed accumulated
knowledge of the statistical properties of GARCH models 55 92
Appendix A Financial applications of the Hawkes and ACD models
Both Hawkes and ACD-type models belong to a class of point processes and describe
stochastic arrival times of events of some kind Since the key variable of these models is the
arrival time selection of what denes an event is extremely important both for numerical
analysis and for the diagnostic of the exogenous and endogenous mechanisms
In 30 a
number of endogenous mechanisms that exist in nancial markets are listed  ranging from
high frequency trading to behavioural herding at longer time scales These mechanisms
operate on dierent time scales and have dierent magnitudes Thus the appropriate
events must be dened to capture and hopefully isolate the dynamics of the mechanism
of interest Below we present a non-exhaustive review of modern nancial applications of
Hawkes and ACD models
As discussed in the introduction high-frequency applications of Hawkes and ACD models
are by far dominant in modern nancial econometrics see also 41
In the context of
the description of the order-book formation process events can be naturally dened as a
sequence of individual transactions 21 23 46 or quotes 22 or more detailed as a set of
mutually-exciting processes of submission and cancellation of limit orders and submission of
market orders 1 48 51 87 On the aggregate level the last transaction price change can
serve as a proxy for cross-excitation between dierent markets 3 4 Following the modern
literature on price impacts see 10 and references therein 32 and 30 suggested mid-
quote price as a better proxy for price movements and mid-quote price changes were used
for the estimation of the endogeneity of the price dynamics In 11 and 5 the co-excitation
between market orders and mid-price changes was used to model market impact
However applications of self-excited point processes are not limited to microstructure
events that can be dened only using complete order ow or level-1 tick data In case of
regularly-spaced discrete time time series such as minutely hourly or daily price dynamics
events can be dened as some kind of extremes in the dynamics The most standard way
see for instance 13 19 with respect to applications to daily data denes events using the
peak-over-threshold concept for a given dynamics of nancial returns one selects those
returns that fall outside a selected quantile range for example 1090 The resulting
irregularly-spaced point process can then be calibrated using the Hawkes or ACD model
A more accurate approach should account for potential changes of regime and volatility
clustering and thus should use local extreme detection methods such as the realized bi-
power variation 6 9 apply this method to model co-jumps in time-series of 1-minute
returns
Another interesting but not yet explored application of point process models involves
detecting regime or trend changes in price dynamics and dening a point process using
turning points The simplest way is to dene a local minima and maxima at a xed time-
scale in the discrete time series and use these extrema to construct a point process More
accurate trend detection would involve local volatility estimation such as method of drawup
and drawdown detection consecutive positive or negative price changes discussed in 49
However one needs to be warned that i most trend detection methods are not causal and
require information about the future price dynamics thus they are not well-suited for fore-
casting purposes and ii all these methods are based on conditional statistics that should
be treated carefully in order to avoid spurious phenomena even in featureless processes 33
A general recommendation is to always consider one or several well-known processes such
as the uncorrelated random walk and apply rst the new method to these known processes
to check if the event dening procedure might not introduce some spurious endogeneity
Finally in modeling both micro- and macro-structure of nancial time series the magni-
tude of events size of orders size and sign of price changes or jumps can be relevant In this
case a marked Hawkes model may be considered in which the size of the event determines
its expected number of ospring such as in the ETAS model for earthquakes for which the
marks are the earthquake magnitudes 62 90 91
Appendix B Finite sample bias of the Hawkes maximum likelihood estimator
In order to optimize the calibration of the Hawkes model on the ACD11 we study the
nite sample bias and eciency of the Hawkes maximum likelihood estimator For this we
have simulated realizations of the Hawkes process with a modied thinning procedure 53 61
implemented in the same PtProcess package 40 and afterwards we have calibrated the
Hawkes model on this synthetic data It should be noted that simulation and tting 23 of
the ACD model is computationally easier than for the Hawkes model Indeed simulation of
the Hawkes process with the thinning algorithm has complexity of ON 2 with possibility
to reduce to ON log N 57 58 compared with complexity of only ON for the ACD11
Insert Figure 7 here
We swept the parameter  in the range 0 1 xing other parameters to   1 and   1
We generated 100 realizations of the Hawkes process of size 3500 each To reduce the edge
eects of the thinning algorithm we discarded the rst 500 points of each realization and
afterwards calibrated the parameters of the Hawkes model on these realizations of length
3000 Figure 7 illustrates the bias and eciency of the maximum likelihood estimator in our
framework The denition of the Hawkes model 3 requires the kernel ht to be always
positive This implies   0 so the estimation of  is expected to have positive bias for small
values as seen in gure 7 On the other hand when  approaches the critical value of 1 from
below the memory of the system increases dramatically and for critical state of   1 the
memory becomes innite Thus for a realization of limited length the nite size will play a
very important role and will result in a systematic negative bias for   1 This reasoning
is supported by the evidence presented in gure 7 where one observes large systematic bias
for   09 For values of the branching ratio not too close to 0 or 1 the bias is very small
for almost all reasonable realization lengths longer than 200 to 400 points We also nd
that the bias for  close to 1 strongly depends on the realization length Finally gure 7
illustrates the high eciency of the maximum likelihood estimator for values of   09
the estimation error    measured with the 90 quantile ranges does not exceed 01
1 Abergel F  Jedidi A 2011 A Mathematical Approach to Order Book Modelling In
Econophysics of Order-Driven Markets pp 93107 Springer Verlag
2 Akaike H 1974 A new look at the statistical model identication IEEE Transactions on
Automatic Control 19 6 716723
3 Bacry E Delattre S Homann M  Muzy J-F 2011 Modeling microstructure noise
using Hawkes processes Proceedings of the ICASSP 2011  pp 57405743
4 Bacry E Delattre S Homann M  Muzy J-F 2013 Modeling microstructure noise
with mutually exciting point processes Quantitative Finance 13 1 6577
5 Bacry E  Muzy J-F 2013 Hawkes model for price and trades high-frequency dynamics
6 Barndor-Nielsen O  Shephard N 2004 Power and bipower variation with stochastic
volatility and jumps Journal of Financial Econometrics 2 1 1
7 Bauwens L  Hautsch N 2009 Modelling Financial High Frequency Data Using Point
Processes In T Mikosch J-P Krei R A Davis  T G Andersen Eds Handbook of
Financial Time Series pp 953979 Springer
8 Bollerslev T 1986 Generalized autoregressive conditional heteroskedasticity Journal of
Econometrics 31 3 307327
9 Bormetti G Calcagnile L M Treccani M Corsi F Marmi S  Lillo F 2013
Modelling systemic cojumps with Hawkes factor models
10 Bouchaud J-P Farmer J D  Lillo F 2009 How markets slowly digest changes in
supply and demand In Handbook of Financial Markets Dynamics and Evolution pp 57
160 Amsterdam North Holland
11 Bowsher C G 2007 Modelling security market events in continuous time Intensity based
multivariate point process models Journal of Econometrics 141 2 876912
12 Bremaud P  Massoulie L 1996 Stability of nonlinear Hawkes processes The Annals of
Probability 24 3 15631588
13 Chavez-Demoulin V Davison A C  McNeil A J 2005 Estimating value-at-risk a
point process approach Quantitative Finance 5 2 227234
14 Cont R 2011 Statistical Modeling of High Frequency Financial Data Facts Models and
Challenges IEEE Signal Processing 28 5 1625
15 Crane R  Sornette D 2008 Robust dynamic classes revealed by measuring the response
function of a social system Proceedings of the National Academy of Sciences of the United
States of America 105 41 1564915653
16 Cutler D M Poterba J M  Summers L H 1987 What moves stock prices Journal
of Portfolio Management 15 3 412
17 Dennis J E  Schnabel R B 1987 Numerical Methods for Unconstrained Optimization
and Nonlinear Equations vol 16 of Classics in Applied Mathematics Society for Industrial
Mathematics
18 Deschatres F  Sornette D 2005 Dynamics of book sales Endogenous versus exogenous
shocks in complex networks Physical Review E  72 1 016112
19 Embrechts P Liniger T  Lu L 2011 Multivariate Hawkes Processes an Application
to Financial Data J Appl Probab 48A 367378
20 Engle R F 1982 Autoregressive Conditional Heteroscedasticity with Estimates of the
Variance of United Kingdom Ination Econometrica Journal of the Econometric Society
50 4 9871007
21 Engle R F 2000 The Econometrics of Ultra-High-Frequency Data Econometrica Journal
of the Econometric Society 68 1 122
22 Engle R F  Russell J R 1997 Forecasting the frequency of changes in quoted foreign
exchange prices with the autoregressive conditional duration model Journal of Empirical
Finance 4 2-3 187212
23 Engle R F  Russell J R 1998 Autoregressive Conditional Duration A New Model
for Irregularly Spaced Transaction Data Econometrica Journal of the Econometric Society
66 5 11271162
24 Engle R F  Russell J R 2009 Analysis of High Frequency Financial Data In Handbook
of Financial Econometrics pp 383426 North Holland
25 Errais E Giesecke K  Goldberg L R 2010 Ane Point Processes and Portfolio Credit
Risk SIAM Journal on Financial Mathematics 1 1 642
26 Fair R C 2002 Events That Shook the Market Journal of Business 75 4 713731
27 Fama E F 1970 Ecient Capital Markets A Review of Theory and Empirical Work The
Journal of Finance 25 2 383417
28 Fama E F 1991 Ecient capital markets II Journal of Finance 46 5 15751617
29 Fernandes M  Grammig J 2006 A family of autoregressive conditional duration models
Journal of Econometrics 130 1 123
30 Filimonov V Bicchetti D Maystre N  Sornette D 2014 Quantication of the High
Level of Endogeneity and of Structural Regime Shifts in Commodity Markets Journal of
International Money and Finance 42  174192
31 Filimonov V  Sornette D 2011 Self-excited multifractal dynamics Europhysics Letters
94 4 46003
32 Filimonov V  Sornette D 2012 Quantifying reexivity in nancial markets Toward a
prediction of ash crashes Physical Review E  85 5 056108
33 Filimonov V  Sornette D 2012 Spurious trend switching phenomena in nancial mar-
kets The European Physical Journal B - Condensed Matter and Complex Systems 85 5
34 Filimonov V  Sornette D 2013 Apparent criticality and calibration issues in the Hawkes
self-excited point process model application to high-frequency nancial data Swiss Finance
Institute Research Paper No 13-60 
35 Guttorp P  Thorarinsdottir T L 2012 Bayesian Inference for Non-Markovian Point
Processes In E Porcu J M Montero  M Schlather Eds Advances and Challenges in
Space-time Modelling of Natural Events pp 79102 Berlin Heidelberg Springer Berlin
Heidelberg
36 Hamilton J D 1994 Time Series Analysis Princeton University Press
37 Hamilton J D  Jorda O 2002 A Model for the Federal Funds Rate Target Journal of
Political Economy 110  11351167
38 Hardiman S J Bercot N  Bouchaud J-P 2013 Critical reexivity in nancial markets
a Hawkes process analysis The European Physical Journal B - Condensed Matter and Complex
Systems 86 10 442
39 Harris T E 2002 The Theory of Branching Processes Dover Phoenix Editions
40 Harte D 2010 PtProcess An R package for modelling marked point processes indexed by
time Journal of Statistical Software 35 8 132
41 Hautsch N 2012 Econometrics of Financial High-Frequency Data Berlin Heidelberg
Springer Berlin Heidelberg
42 Hawkes A G 1971 Point Spectra of Some Mutually Exciting Point Processes Journal of
the Royal Statistical Society Series B Methodological 33 3 438443
43 Hawkes A G 1971 Spectra of some self-exciting and mutually exciting point processes
Biometrika 58 1 8390
44 Hawkes A G  Oakes D 1974 A Cluster Process Representation of a Self-Exciting
Process Journal of Applied Probability 11 3 493503
45 Helmstetter A  Sornette D 2003 Importance of direct and indirect triggered seismicity
in the ETAS model of seismicity Geophysical Research Letters 30 11 1576
46 Hewlett P 2006 Clustering of order arrivals price impact and trade path optimisation In
Workshop on Financial Modeling with Jump processes Ecole Polytechnique
47 Jasiak J 1998 Persistence in intratrade durations Financial Analysts Journal 19  166
48 Jedidi A  Abergel F 2013 On the Stability and Price Scaling Limit of a Hawkes
Process-Based Order Book Model
49 Johansen A  Sornette D 2001 Large stock market price drawdowns are outliers Journal
of Risk  4 2 69110
50 Joulin A Lefevre A Grunberg D  Bouchaud J-P 2008 Stock price jumps news
and volume play a minor role Wilmott Magazine SepOct 46
51 Large J 2007 Measuring the resiliency of an electronic limit order book Journal of
Financial Markets 10 1 125
52 Lewis E Mohler G O Brantingham P J  Bertozzi A L 2012 Self-exciting point
process models of civilian deaths in Iraq Security Journal 25  244264
53 Lewis P A W  Shedler G S 1979 Simulation of nonhomogeneous poisson processes
by thinning Naval Research Logistics Quarterly 26 3 403413
54 Marsan D  Lengline O 2008 Extending Earthquakes Reach Through Cascading
Science 319 5866 10761079
55 Mikosch T Krei J-P Davis R A  Andersen T G Eds 2009 Handbook of
Financial Time Series Springer 1 ed
56 Mohler G O Short M B Brantingham P J Tita G E  Schoenberg F P 2011 Self-
Exciting Point Process Modeling of Crime Journal of the American Statistical Association
106 493 100108
57 Mller J  Rasmussen J G 2005 Perfect simulation of Hawkes processes Advances in
applied probability 37 3 629646
58 Mller J  Rasmussen J G 2006 Approximate Simulation of Hawkes Processes Method-
ology and Computing in Applied Probability 8 1 5364
59 Oakes D 1975 The Markovian Self-Exciting Process Applied Probability Trust 12 1
6977
60 Ogata Y 1978 The asymptotic behaviour of maximum likelihood estimators for stationary
point processes Annals of the Institute of Statistical Mathematics 30 1 243261
61 Ogata Y 1981 On Lewis simulation method for point processes IEEE Transactions on
Information Theory 27 1 2331
62 Ogata Y 1988 Statistical models for earthquake occurrences and residual analysis for point
processes Journal of the American Statistical Association 83 401 927
63 Osorio I Lyubushin A  Sornette D 2014 Self-exciting component of brain activity
working paper 
64 Ozaki T 1979 Maximum likelihood estimation of Hawkes self-exciting point processes
Annals of the Institute of Statistical Mathematics 31 1 145155
65 Pacurar M 2008 Autoregressive Conditional Duration ACD Models in Finance A Survey
of the Theoretical and Empirical Literature Journal of Economic Surveys 22 4 711751
66 Papangelou F 1972 Integrability of Expected Increments of Point Processes and a Related
Random Change of Scale Transactions of the American Mathematical Society 165  483506
67 Reynaud-Bouret P  Schbath S 2010 Adaptive estimation for Hawkes processes appli-
cation to genome analysis The Annals of Statistics 38 5 27812822
68 Ruelle D 2004 Conversations on nonequilibrium physics with an extraterrestrial Physics
Today 57 5 4853
69 Russell J R 1999 Econometric Modeling of Multivariate Irregularly-Spaced High-
Frequency Data Working Paper University of Chicago pp 140
70 Saichev A  Filimonov V 2008 Numerical Simulation of the Realizations and Spectra
of a Quasi-Multifractal Diusion Process  JETP Letters 87 9 506510
71 Saichev A Helmstetter A  Sornette D 2005 Anomalous Scaling of Ospring and
Generation Numbers in Branching Processes Pure and Applied Geophysics 162  11131134
72 Saichev A  Sornette D 2006 Generic multifractality in exponentials of long memory
processes Physical Review E  74 1 011111
73 Samuelson P A 1965 Proof That Properly Anticipated Prices Fluctuate Randomly In-
dustrial Management Review  6  4149
74 Samuelson P A 1973 Proof That Properly Discounted Present Values of Assets Vibrate
Randomly The Bell Journal of Economics and Management Science 4 2 369374
75 Schnabel R B Koonatz J E  Weiss B E 1986 A modular system of algorithms for
unconstrained minimization ACM Transactions on Mathematical Software 11 4 419440
76 Shiller R J 1981 Do Stock Prices Move Too Much to be Justied by Subsequent Changes
in Dividends The American Economic Review  71 3 421436
77 Shorvon S Guerrini R Cook M  Lhatoo S Eds 1012 Oxford Textbook of Epilepsy
and Epileptic Seizures Oxford Textbooks in Clinical Neurology OUP Oxford
78 Sornette D 2003 Why Stock Markets Crash Critical Events in Complex Financial Systems
Princeton University Press
79 Sornette D 2006 Endogenous versus Exogenous Origins of Crises
In S Albeverio
V Jentsch  H Kantz Eds Extreme events in nature and society pp 95119 Berlin
Heidelberg Springer Berlin Heidelberg
80 Sornette D Deschatres F Gilbert T  Ageon Y 2004 Endogenous Versus Exogenous
Shocks in Complex Networks An Empirical Test Using Book Sale Rankings Physical Review
Letters 93 22 228701
81 Sornette D Malevergne Y  Muzy J-F 2003 What causes crashes Risk  16 2
6771
82 Sornette D  Osorio I 2010 Prediction In Epilepsy The Intersection of Neurosciences
Biology Mathematics Physics and Engineering pp 203237 CRC Press Taylor  Francis
83 Sornette D  Ouillon G 2005 Multifractal Scaling of Thermally Activated Rupture
Processes Physical Review Letters 94 3 038501
84 Sornette D  Utkin S 2009 Limits of declustering methods for disentangling exogenous
from endogenous events in time series with foreshocks main shocks and aftershocks Physical
Review E  79 6 061110
85 Soros G 1987 The Alchemy of Finance Reading the Mind of the Market NY John Wiley
 Sons
86 Stratonovich R L 1992 Nonlinear Nonequilibrium Thermodynamics I Linear and Non-
linear Fluctuation-Dissipation Theorems Springer-Verlag
87 Toke I M 2011 Market making in an order book model and its impact on the spread
In Econophysics of Order-Driven Markets pp 4964 Springer Verlag
88 Utsu T 1961 A statistical study of the occurrence of aftershocks Geophysical Magazine
30  521605
89 Utsu T  Ogata Y 1995 The centenary of the Omori formula for a decay law of aftershock
activity Journal of Physics of the Earth 41 1 133
90 Vere-Jones D 1970 Stochastic Models for Earthquake Occurrence Journal of the Royal
Statistical Society Series B Methodological 32 1 162
91 Vere-Jones D  Ozaki T 1982 Some examples of statistical estimation applied to earth-
quake data I Cyclic Poisson and self-exciting models Annals of the Institute of Statistical
Mathematics 34 1 189207
92 Zakoian J-M  Francq C 2010 GARCH Models Structure Statistical Inference and
Financial Applications Oxford Wiley-Blackwell
93 Zhuang J Ogata Y  Vere-Jones D 2002 Stochastic declustering of space-time earth-
quake occurrences Journal of the American Statistical Association 97 458 369380
TABLE 1 Estimated parameters of the Hawkes model with exponential 6 and power law 5
kernels together with values of log-likelihood log Lexp and log Lpow and Akaike information cri-
terion AICexp and AICpow for cases presented in gure 2 Bold font identies the lowest AIC
value among the two models
 Hexp   n  
Hpow   n c 
log Lexp log Lpow AICexp AICpow
A 005 005 084 007 43
083 010 26277 7313 3430 3434
B 038 013 024 052 56 021 054 50114 11341 4904 4914
C 013 038 038 022 79 036 023 81641 10517 5093 5093
10236 10266
D 045 045 002 083 284
001 087 20391 770
9000 9015
18060 18110
FIG 1 Illustration of the branching structure of the Hawkes process top and events on the time
axis bottom This gure corresponds to a branching ratio n  088
FIG 2 Realizations of the durations and conditional intensities of the ACD11 process left
column and Hawkes process right column simulated with parameters obtained by calibrating to
the realization of the ACD process Parameters of the ACD process ACD     and estimated
parameters of the Hawkes model H      are the following A ACD  1 005 005
H  084 007 43 B ACD  1 038 013 H  024 052 56 C ACD  1 013 038
H  038 022 79 and D ACD  1 045 045 H  002 083 284
FIG 3 Results of the calibration of the Hawkes model on the ACD11 realizations Estimated
A background intensity  B branching ratio  and C characteristic time of the kernel  
Panel D shows the p-value from the goodness-of-t test where the dashed line indicates the the
10 level i     2 ii   0    iii   0    iv   3  34 and v
  3  34 The black line corresponds to the mean p-value for case i    the shaded
area to the 95 quantile range for case i and the dotted lines depict mean p-values for cases ii
  0 iii   0 iv   3 and v   3
FIG 4 The estimated branching ratio  of the Hawkes model estimated on ACD11 realizations
with correction for the nite sample estimation bias determined in the B
FIG 5 Contour plot of the estimated branching ratio   of the Hawkes model calibrated to
ACD11 realizations for a grid of values  and  with     1 corrected for the nite sample
estimation bias determined in the B The dashed line delineates the region where the goodness-of-t
tests rejects the null hypothesis see text
Exponential kernel
Power law kernel
FIG 6 Comparison of the exponential kernel with parameter   79 solid line with the power
law kernel with parameters   10517 and c  81641 dashed line
00 02 04 06 08 10
00 02 04 06 08 10
00 02 04 06 08 10
00 02 04 06 08 10
FIG 7
Illustrations of the nite sample bias and variance of the maximum likelihood estima-
tor 64 of the parameters of the Hawkes process calibrated on time series generated by the Hawkes
process itself no model error Panel A dierence between the estimates of the background
intensity  and the true value  used for the generation of the time series Panel B dierence
between the estimates of the branching ratio  and the true value  Panel C dierence between
the estimates of the characteristic time of the kernel  and the true value   Panel D shows the
p-value of the Kolmogorov Smirnov test for standard uniformity of the transformed durations of
the residual process 62 In all panels the black lines correspond to the mean and the shaded
areas to 90 50 and 10 quantile ranges
