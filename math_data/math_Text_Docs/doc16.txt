Submitted to the Annals of Applied Probability
arXiv arXiv12011573
ON STABILITY OF HAWKES PROCESS
By Dmytro Karabash
Courant Institute of Mathematical Sciences New York University
cid16
g0t cid80
cid17
Existence and stability properties are studied for Hawkes pro-
cess ie point process S that has long-memory and intensity rt 
 tS ht   
 The approach to Hawkes process pre-
sented in this paper allows us to prove the uniqueness of invariant
distribution of the process under weaker conditions New speed of
convergence results are also shown Unlike previous results the func-
tion  is not required to be Lipschitz and can be even discontinuous
Some generalizations are also considered
1 Introduction
11 Denition Hawkes Process is a time-homogeneous self-exciting
locally-nite point process on R with long-memory A realization of the
process is a random locally-nite subset S  S of R Any locally-nite
point process is characterized by its intensity rate rt  dened as the in-
tensity of the point process at time t conditioned on the past history of the
process until time t ie rt  can be dened as
cid21
cid20
S  t t  t  1Ft
rt   lim
t0
where St tt is the number of elements of the set St tt
and Ft is the eld for St  S   t generated by elementary
events   St  I cid54  where I varies over all intervals I   t
It is convenient to view the process as a random subset of R  0
and thus the intensity function rt  is dened for t  R Hawkes Process
is dened by three R-valued functions on R Given these three functions
 h g0 the intensity rate is given by
rt   g0t 
cid88
St
ht   
Partially supported by NSF grantsDMS-0904701 DMS-1208334 and DARPA
AMS 2000 subject classications Primary 60B10 60G10 60G52 60G55 60J75 60J80
92D25 secondary 47D07 60E15 60F05 60J85 60K15
Keywords and phrases point processes self-exciting processes Hawkes processes sta-
bility convergence equilibrium invariant distribution speed of convergence multi-type
where g0 is some initial condition
The above description is equivalent to the one found in literature except
for the term g0 Usually instead of starting from initial condition g0 the
process is dened by giving S0 a locally nite collection of points in  0
This set S0 represents points of process before time 0 To connect to our
setting g0 can then be computed as
g0t 
cid88
S0
ht   
and the the two denitions are equivalent Dening process with g0 as initial
conditions also allow for more general functions which are not of form 3
This approach besides providing this slight generalization of the model
leads to a somewhat dierent perspective Hawkes process is a solution of a
stochastic partial dierential equation with jumps In fact Hawkes process
corresponds to solution of one of the simplest such equations where the
state of the process at time t is the random impulse function gt that
evolves by translation in time gtt  gt  t with jumps gt  gt 
h occurring at rate gt0 There is a built-in invariance under time
translation due to the form of 2 The evolution of the impulse function
gt  R  R is dened by
gts  g0t  s 
ht  s   
cid88
St
It is Ft-measurable and is a Markov process it need not contain all the past
information as is the case when ht  et Given two times s  t  0 the
conditional distribution of the next   S after time t being greater than s
is given by
P  sFt
 PS  s t   S  t cid54 Ft
cid90 st
cid20
cid21
at which point g  jumps to g   h Thus gt is by itself a Markov
process
gtsds
12 Results The two main results of this paper Theorems 2 and 3
generalize the results of Bremaud-Massoulie 1 in dierent directions and
prove that under certain conditions on  and h for a certain wide class C of
initial conditions g0 the distributions of gt converge to a common limit
Furthermore the limiting distribution is supported on C The secondary new
result Theorem 4 is on speed of convergence
ON STABILITY OF HAWKES PROCESS
In addition to these theorems we also observe several facts well known
for attractive systems These are collected in Proposition 1 The results are
stated in sections 4 and 5
13 History and references to related work Point processes were rst
studied in 4 by Erlang in connection with queueing theory Hawkes process
were rst introduced in 5 to study self-exciting point processes See 2 3
for additional references The current work is the rst one that covers cases
where  need not be Lipschitz and in fact can even have jumps Large
deviations questions for wide classes of  and h have been studied by Zhu
in 9 and 10 for the special case of linear  explicit large deviation rates
and other limit theorems have been derived in 7
Currently Hawkes processes are used to model many phenomena rang-
ing from queues and population growth to mutations and spread of in-
fections to defaults and jumps in nancial markets to neuroactivity and
social-networks and nally even to modeling of articial intelligence and
creative thinking While most of the real world applications involve use of
multi-dimensional Hawkes process in order to keep the presentation simple
we limit ourselves to the one-dimensional version Possible generalizations
are outlined in section 7
14 Example Simple example comes from population growth Consider
a population that grows either by immigration or by birth generated by the
current population Immigrants are treated as newborns when they arrive
The immigration rate is A and the birth rate for each individual is hs
which depends only on the current age s of the individual Then total growth
rate of the population at time t is then given by
cid88
ht   
S t
cid88
S t
or if we normalize with h bycid82 
rt  A 
rt  A  B
ht   
0 hsds  1 we replace this by
since B comes out of normalization So we see that this is a Hawkes process
with z  A  Bz The Hawkes processes with such linear  appear very
often and are related to Galton-Watson trees which in turn provides an easy
way of studying many properties of Hawkes processes
2 Formal Denitions
21 Formal Denition of a Hawkes Process
Definition 1 Hawkes process is a random collection S of points in
R  0 characterized by triplet of functions  h g0 where the func-
tions  h g0  0  0 The conditional Poisson intensity at time t
g0t 
cid88
0 tS
ht   
rt  
where the sum is over all previous points  in St  S  0 t The func-
tion g0 describes the initial condition and the functions  and h describe
the evolution of the process We denote this Hawkes process by quadruple
P  h g
We will dene a coupling of these dierent measures Pg by a canonical
construction in the subsection 31
It is convenient to take as state space the space X of locally integrable R-
valued functions on R Let MX be the space of probability distributions
on X Then the process can be realized as an X-valued process Start at
time t from with initial condition gt  X and consider the random evolution
determined by two components deterministic ow gtts  g0t  t  s
up to stopping time  at which point g jumps g 0x  g0x  hx
with the distribution of    g given by
Pg  t  t  exp
cid90 t
gtsds
cid20
cid21
After time   the process restarts in the sense that same procedure is to be
repeated with  as a new starting time and g as a new initial condition
Each time stopping corresponds to a point in S The generator of the semi-
group Tt of the Markov process acting on functions F  X  R is given
where h is a shift operator dened by hF g  F g  h and D is the
derivative of push-forward of time evolution dened by
A  D  g0h  Id
DF g  lim
F g  F g
where  is the time-shift operator dened by gs  gs   Then this
X-valued process gt satises
gts  g0t  s 
ht  s   
cid88
St
ON STABILITY OF HAWKES PROCESS
For any initial condition g0 we have a Markov process gt Then zt
will be the intensity of the point process where
zt  gt0  g0t 
cid88
St
h  t
It is sometimes more convenient to consider instead of St the process
Qt  Nt gt
where Nt  St is the number of jumps from time 0 to time t Then Qt
can be viewed as a point process Nt driven by the Markov process gt
Remark 1 Without loss of generality we can assume cid82 
Indeed one can always achieve this if cid107hcid1071  cid82 htdt   by observing
0 htdt  1
that triples z ht gt and
produce the same
Hawkes process On the other hand if cid107hcid1071   and inf zR z  0 then
limt gt0   as and hence there can be no stationary version of the
process
zcid107hcid1071 ht
cid107hcid1071
 gtcid107hcid1071
cid17
cid16
cid82 n
22 Convergence notions We equip the space X with Lloc
1 cid82 n
0 gs  f sds
0 gs  f sds
g f  X
cid88
dX g f  
1 metric
The space MX will then have the topology of weak convergence inherited
from the metric space X Let DX be the space of X-valued functions on
0 equipped with Skorohod J1-metric d and let G be the -eld generated
by the open sets in X d Collection Gt is the corresponding ltration
Let g be the non-initial part of impulse function
ht  s   
cid88
t s 
St
gcid101g  DX
dgcid101g  dSgScid101g  dgcid101g
be the pull-back of d under the map S  DX  DX S  g cid55 g dened
according to 17 as
Sgts  gts  g0t  s
Let fs be the distribution of gsimpulse-function at time sstarting
from initial condition f 
The distribution of the whole process g starting with initial condition g0
will be denoted by Pg0 and the associated expectations will be denoted by
Eg0 Any   MX can be viewed as a random initial condition and
Pf df  E 
Ef df 
cid90
cid90
denote the corresponding probability measure and expectation with respect
to it Similarly P and E will be used as analogous expressions for the g
In Theorems 2 and 3 we consider total variation dT V of the dierence of
P starting from two dierent initial conditions which can also be viewed
as total variation of the corresponding P but under a dierent -eld G 
G  S1
ie the total variation on the sigma-algebra G  ST
ST is dened by
Furthermore let us dene dT VT to be the total variation after time T 
1 where operator
STgts  1tT gts  g0t  s
3 Tools
31 Canonical Construction One way to construct point processes is to
start from a canonical Poisson point process P To any measure m one can
associate a Poisson point process such that for any measurable set A the
number of points in A will be random variable with a Poisson distribution
with mean mA In our case canonical Poisson point process will correspond
to the choice mA  A the Lebesgue measure on R  R Given  h g
measure P induces a measure Ph
consistent with the denition above in
the following way If S is our point process then   S if there is a point on
the vertical line   0 zt of our plane R  R In the rest of the paper
by Pg because  and h would be the same unless stated
we will denote Ph
otherwise
This induces a natural coupling of the collection of the measures Pg
indexed by initial conditions g that we will call canonical coupling This
coupling is no way unique but this particular coupling is maximal when  is
non-decreasing and we have two dierent initial conditions one of which is
strictly larger than the other by point-wise partial ordering The coupling
is maximal in the sense that the set of points common to both of these two
processes will stochastically dominate the similar set of points in any other
coupling
ON STABILITY OF HAWKES PROCESS
32 Coupling  Stochastic Domination Here we present the canonical
coupling that we will use
Lemma Stochastic Domination Suppose S  h g0 and cid101Scid101cid101hcid101g0
are two Hawkes processes satisfying
x  R hx cid101hx gx cid101gx
x  y x cid101y
Then there exists a coupling such that Scid101S
Note hcid101h are not necessarily normalized
Proof If at bt are two intensities and if at  bt for all t one
can couple the point processes such that the two processes jump together
with rate at and the second one jumps by itself at rate bt  at This
can also be done if    at   bt  In fact this is done naturally
by our construction that is discussed in the previous subsection Hence it
remains to prove that
gt0 cid101cid101gt0
We know that up to the rst jump in cid101S we have gt0  g0tcid101gt0 
cid101g0t However we know from 22 and 23 that
g0t cid101cid101g0t
which in turn implies that 24 holds up to rst jump of cid101S Then we claim
of g cid101g is preserved because there is no jump in S before rst jump of cid101S
and the jump ofcid101g is always larger because h cid101h
by induction that it holds for all times Indeed at the time of jump the order
33 Parent-Ospring Structure and the Branching representation We
add the following parent-ospring structure to obtain a random forest struc-
ture embedded in time This will be useful due to its connection to Galton-
Watson trees branching processes
We start with the Hawkes process corresponding to functions  h g0 and
let S  1 2  where  is an increasing sequence ie i  j  i  j
Let us also denote
0z  z  0
Now to each i we associate a randomly chosen parent element pi from
S   where  represents having no parent and being a root node
Fig 1 For both z  1  z
of corresponding color
ht  1
1t2  Each region corresponds to children of point
Given a sequence 1 2  i we dene pi to be mutually independent
with distributions given by 
Ppi  1 i 
zi
Ppi  j1 i  1ji
0zi
zi
hi  j
0zi
zi
Note that pi while mutually independent are not identically distributed
Figure 33 provides a particular visualization of parent-ospring structure
that is consistent with the above description We are specically interested
in linear case which provides us with dual description of the same process
as described in the following tool
Lemma Branching Process Equivalence When z  z  A  Bz
roots have rate ABgt and each tree is a branching process with the number
of branches having a Poisson distribution with mean B The distribution of
age j of any parent at the time  of birth of any child is then given by
P  j  tp   j 
hsds
cid90 
02468101212345ON STABILITY OF HAWKES PROCESS
Proof By the above scheme we see that the intensity of roots is given
Ppi  zi  0  Bzi
Now each new point creates an area of size Bcid107hcid1071  B and hence the number
of children is PoissonB Now the shape of the area is given via h which
then proves 29
 A  Bgi
4 Existence We begin with preliminary results regarding existence
and ergodicity Let us consider the following hypothesis on Hawkes Process
Hypothesis 1 The function  satises
A B  0z  R z  z  A  Bz
which brings us to our rst proposition
Proposition 1 Suppose Hawkes process satises Hypothesis 1 Then
the following three statements hold
i Hawkes process is well dened for all times
ii When the Hypothesis 1 is satised with B  1 there exists an invariant
distribution for process gt
iii If in addition  is non-decreasing and we start from 0 initial condition
ie g0  0 then the distribution of gt converges weakly to 0 which
being the unique minimal invariant measure is ergodic
Proof of Proposition 1 i Consider Hawkes process with z 
A  Bz By Galton-Watson representation it is well dened for all times It
can be coupled with our process which it will dominate Hence the dominated
process is also well dened for all times
ii If B  1 then the dominating process has uniformly bounded density
then so does the dominated process and we can get an invariant distribution
g0 by taking Cesaro limit along a subsequence
cid90 tk
g0  lim
tk
sg0ds
where sg0 represents marginal distribution of the impulse-function at time
s given the initial condition g0
iii The expected size of each tree is nite and hence we have bounded
density Since  is non-decreasing the process is order-preserving Hence
E0f gt  s1     gt  sk
is non-decreasing in t for any non-decreasing f which implies convergence
of s0 to 0
This gives us weak convergence We claim that invariant distribution 0
is the unique minimal one ie stochastically dominates any other invariant
distribution To see this consider any other invariant cid101 and choose initial
condition chosen randomly according to cid101 but then we have point-wise
times and letting t   we see that cid101 dominates  Hence  being the
domination initially and by coupling we see that there is domination at all
unique minimal invariant measure is extremal Hence it is ergodic
5 Uniqueness
Definition 2 Let  be an invariant distribution supported on a class
of functions C meaning that
Then we say that the pair  h is C -stable if starting from any initial
condition g0 in C the distribution tg0 of the impulse function at time t
converges to 
C  1
t tg0
where d signies that the limit is in the sense of weak convergence
Now we turn to main results of this paper Here is our 2nd hypothesis
Hypothesis 2 The function  is non-decreasing and it satises
x  s  x  s
cid90 
for some concave non-decreasing  satisfying
Hsds  C   where Hs 
cid90 
cid27
Theorem 2
and Hypothesis 2 then pair  h is C -stable as in denition 2 with
If Hawkes process satises both Hypothesis 1 with B  1
cid26
cid90 
g  CR 
gsds  
and  being 0 from Proposition 1 part iii
ON STABILITY OF HAWKES PROCESS
Remark 2
In this theorem we relax the Lipschitz condition with con-
stant 1 on  that was imposed in 1 in a slightly dierent form since cid107hcid107
was not normalized When we do have this assumption the results of 1
follow as a corollary of the above theorem 2 In fact the results follow even
under weaker assumption that  is Lipschitz with constant L for some L
x y  Rx  y  Lx  y
Before we start with proof of theorem 2 let us prove the following lemma
Lemma 21
If  is a stationary distribution of the impulse function gt
of a Hawkes process then
Egs  Eg0Hs
Proof By stationarity
Egs  E
cid20cid90 
cid21
g0htdt
cid90 
 Eg0
 Eg0Hs
show that exists some class Ccid48C such that
Proof of Theorem 2 We use a recurrence argument It is enough to
i f  Ccid48 implies that P
f  P
f and P
0  1  dT V P
0 have non-trivial overlap
f  P
0    0
ii Ccid48 is recurrent with respect to C starting from any point in class C the
impulse function will enter Ccid48 at some time in the future ie
g0  C Pg0t  R gt  Ccid48  0
We will split the proof into three steps In step i and ii we will show
the above statements and in step iii we will complete the proof using
recurrence Step i in turn will suggest the choice of Ccid48
Step i First observe that by applying Jensens inequality and concavity
of  we obtain
f  P
0  E0
cid20
cid18
cid90 
zt  f t  ztdt
cid19cid21
 exp
 exp
cid21cid19
zt  f t  ztdt
cid21cid19
cid18
cid18
cid18
cid20cid90 
cid20cid90 
cid90 
f tdt
cid19
f tdt
Step ii Step i suggests that we take
Ccid48 
g  CR 
gsds  K
cid26
cid90 
cid27
whereas for Ccid48 to satisfy the recurrence condition we will make a suitable
choice of K We know that for any nite time t process which started from
C will remain in C since  is convex Now consider starting from C but
replacing  by with  in the denition of our process Then because  is
nondecreasing by applying stochastic domination we get
gtsds
 E
gtsds
cid20cid90 
We now take lim supt on both sides of 49 and by proposition 1iii the
right hand side converges to a limit from any initial g
cid20cid90 
cid20cid90 
cid21
cid21
cid21
cid21
cid21
gtsds
t
cid20cid90 
cid20cid90 
cid90 
 lim
t
 lim
t
 lim
t
gtsds
gtsds
E
0 gt0Hsds
where the line 52 follows from Lemma 21 Recall that part of assumption
of hypothesis 2 is that  is concave and increasing While concavity implies
that cx  cx for c  1 monotonicity implies that cx  x for
c  1 Combining these two we get cx  maxc 1x Applied to 52
with c  E
0 gt0 we obtain
cid20cid90 
cid21
t
gtsds
 C max lim
t
0 gt0 1
cid90 
where C cid82 
ON STABILITY OF HAWKES PROCESS
0 Hsds   by Hypothesis 2 Hence 53 is nite since
0 gt0   by branching representation Hence C  1 and
limt E
in 48 it is enough to set
K  max lim
t
0 gt0 1  
Hsds
Step iii Hence we return almost surely to the class Ccid48 Now starting
from any initial condition in Ccid48
f  P
0  1  exp K
and result follows from the following schematic representation
g  C cid29 Ccid48  
where all arrows represent transitions with uniformly positive probability
which implies the convergence to 
Let us describe this in detail Dene two sequences of alternating stopping
times as follows Let stopping time 1 be the rst time that gt is in Ccid48 Then
we try to couple the process S with S1 where S1 is Hawkes process with
same pair  h but that starts at time t with gt  0 we use canonical
coupling Then by step i the coupling is successful with probability at
least   0 If it is not then there is a stopping time 1  S  S1 in
this case we restart the procedure dening i i by the following recursive
denition
1  inft  gt  Ccid48
i  1 i  inft  i  t  S  Sk
i  1 i  inft  i1  gt  Ccid48
where Sk is Hawkes Process that starts at time k with condition gt  0
Hence we want to show that almost surely for some i i   which is
immediate from step i
Pi i    E
1  eK  0
cid89
cid89
Finally we turn to the last theorem where  can have jumps
Hypothesis 3
i Function  is non-decreasing and satises
0  0    B  1
cid90 
ii Function h is convex and satises
cid107hcid107   log hcid48x  ox
thtdt  
Remark 3 These assumptions allow large tails in h which was the aim
of this study in particular hx 
1xp1 where p  0
Remark 4 These assumptions can be weakened to allow piece-wise de-
creasing h as long as h1y is nite for any y  R
cid27
cid26
cid90 
Theorem 3
Hypothesis 3 then pair  h is C -stable as in denition 2 with
If Hawkes process satises Hypothesis 1 with B  1 and
g  CR 
tgtdt  
and  being 0 from Proposition 1 part iii
Definition 3 Let  denote distribution of g0 under 
Next we state estimates on the tail of  as well as on the probability
density of  We will prove the following two Lemmas after we complete the
proof of Theorem 3
Lemma 31 Under Hypothesis 3 the following statements hold
  0 Eezt  
In particular  has exponential tail there exist constants 0  c1   and
1  0 such that for all z  0
z  c1e1z
Lemma 32 Under Hypothesis 3 there exists a constant ccid48
1 such that for
any invariant distribution  the associated  distribution of g0 under 
has a density z that satises
z  ccid48
1zz  h0
Furthermore there exist constants c2 2 such that
z  c2e2z
ON STABILITY OF HAWKES PROCESS
Proof of Theorem 3 Unlike proof of Theorem 3 the comparison is
done between initial conditions f and g  f where g is randomly chosen with
distribution 0 We denote by 
f the distribution of g  f  ie 0 shifted
f A  0g  f  g  A The idea of the proof remains the
by f  ie 
same as that of Theorem 3 while the calculations of 49-53 are redone as
follows
f  P
  E0
 exp
zt  f t  ztdt
zt  f t  ztdt
by Jensens Inequality Since 0 is invariant we can replace zt by z0
cid19cid21
cid21cid19
cid21
cid21
cid90 
cid20cid90 
cid18
cid20
cid18
E0
cid20cid90 
cid20cid90 
cid90 cid90 cid90
cid90 cid90 cid90
zxtR
zxzf t
zxtR
xf tzx
zdxdzdt
zdzdxdt
 E0
zt  f t  ztdt
z0  f t  z0dt
We can now apply the estimate on z from Lemma 32 and obtain
zxtR
xf tzx
cid90 cid90 cid90
cid90 cid90 cid90
cid90 cid90 cid90
zxtR
f tz0
c2e2zdzdxdt
c2e2xe2zdzdxdt
c2e2xe2f tdzdxdtdxdt
zxtR
f tz0
 c2cid107f e2fcid107L1
cid90
e2xdx
 c2cid107fcid107L1e2cid107fcid107L
cid90
e2xdx
cid90
cid90
where the last line follows from Hypothesis 3 since f  L1  L last term
is integrated by parts
e2xdx  0 
2e2xxdx  
The rest of the proof follows analogously to Theorem 2
51 Lemmas for Theorem 3 The two lemmas in this section provide
estimates on the density as well as the tail probabilities of distribution 
Let us rst prove the tail estimate
Proof of Lemma 31 Observe rst that z  z by stochas-
tic domination We can now use Galton-Watson representation in the fol-
lowing way Consider a tree T viewed as a population starting with one
individual born at time 0 Each individual born at time s gives birth to new
individuals at rate Bht  s Since B  1 andcid82 hsds  1 the size of the
tree T is nite Consider the quantities
t
 ln Eexp
 ln Eexpzt
cid88
ht   
If we ignore time we have a Galton-Watson tree with the number of
branches having a Poisson distribution with parameter B  1 Then it is
known that see 8 for example the total size Z of the population has an
exponential moment ie
EeZ  
for some 0  0 In particular since cid107hcid107   exists   0cid107hcid107
E exp
ht     Eexpcid107hcid107Z  
cid88
By dominated convergence theorem
t t  0
ON STABILITY OF HAWKES PROCESS
Observe that for linear z  A  Bz
ht     ht  B
cid88
cid90 t
ets  1hsds
is a martingale Therefore t satises
t  ht  B
ets  1hsds
Similarly
cid90 
es  1ds  
  A
as we add the contributions of eT s  1 from trees at s that are created
at rate A It only remains to show that right hand side of 86 is nite
Integrate 86 with respect to t from 0 to 
t    B
   B
   B
ets  1hsdsdt
ets  1hsdtds
0st
et  1dt
cid90 t
cid90 
cid90 t
cid90 
cid90 cid90
cid90 
cid90 
Since t  0 as t   given   0 we can bound et  1 by
1  t for suciently large t providing us with an estimate
tdt    C  B1  
We choose   0 so that B1    1 This proves thatcid82 
ascid82 
0 et  1dt are nite
tdt
0 tdt as well
cid90 
Having obtained exponential tail estimates we now turn to the proof of
the density estimate
Proof of lemma 32 Let Ls t A be time spent in A by zt  gt0
between time s and t starting from arbitrary initial condition ie
Ls t A 
1zsAds
cid90 t
Let I  z z   0  0 and i i  0 be ith jump after 0 that is
Furthermore let
i  inft  i1  t  S
nt  infs  t  s  S
be the rst jump after time t We note that we can calculate I as
We consider rst the numerator
E L0 t I
Li i1 I1it
I  lim
t
L0 t I  cid88
cid88
cid88
Taking expectations and using the properties of conditional expectations 
EL0 t I  E
ELi i1 IFi1it
where function F  X  R is dened as
F gi1it
We nally have
F g  EgL0 1 I
cid90 t
EL0 t I  E
F gtdNt
which we can now view as a stochastic integral of a predictable process with
respect to dNt using 100 and the stationarity of gt we obtain
E L0 t I
cid105
0 F gtdNt
I  lim
t
 lim
t
 lim
t
 lim
t
cid104cid82 t
cid104cid82 t
cid104cid82 t
cid105
cid105
0 F gt  hgtdt
0 F g0  hg0dt
cid90
cid90
ON STABILITY OF HAWKES PROCESS
Egh L0 1 I g0dg
cid20
cid21
hcid481
1g0h0zg0dg
The last equation follows from condition 61 By convexity hcid48 is decreas-
ing and L0 1 I  
hcid481 since between two jumps gt can cross I
only once Because g0  A  0 we have the estimate P1  t  eAt
In view of condition 61 we obtain
for some constant constant C1  0 Then we continue from 106
1g0h0zg0dg
gcid481  
cid20
cid20
cid90
cid21
cid21
hcid481
 C1
I 
1g0h0zg0dg
hcid481
cid90
cid90
xdx
1zz  h0
xzh0
 ccid48
where the last inequality follows the fact that dx has exponential tail
Hence we have
from which we rst observe that there is density  since then I  ccid48
1z
and then taking limit as   0 in 112 we obtain the estimate on the
density
1zz  h0
I  ccid48
6 Speed of Convergence
In general estimating the speed of con-
vergence by the methods of Theorem 2 and 3 appears to be dicult To
overcome this we need to strengthen Hypothesis 2 to the following
Hypothesis 4 The function  is non-decreasing and it satises
for some  that satises
B  B
x  s  x  s
cid90 
htdt  1
ht  Bht
that satises
cid80
Bnncid82
cid82
hxdx
hxdx
  C4  
lim sup
t
In addition gt  gt also satises cid107gcid1071 cid82 
h does not hx cid80
Remark 5 Condition 115 can be replaced by other conditions as can
be seen from the proof The important feature is that all nicely decaying
functions like hx 
1xp1  p  0 satisfy Hypothesis 4 while the following
i0 22i112ix2i1 where 12ix2i1 is the indicator
0 gtdt  
function that is 1 if x  2i 2i1 and 0 otherwise
If Hawkes process satises Hypothesis 1 with B  1 and
Theorem 4
Hypothesis 4 then
cid90 
dT VtPg P0  B
I  BQh1gsds
where Qh stands for the convolution operator Qhg  h  g
In turn this implies that tail of dT VtPg P0 cannot be much worse than
that of ht or gt more precisely
dT VtPg P0
gs  hsds
cid82 
lim sup
t
Proof Consider the canonical coupling of the measures Pg and P0 ie
a pair of processes g g0 which start from initial conditions g0  g and
0  0 respectively Let cid52g  gg0 be the dierence of impulse functions
cid52S  S  S0 be the dierence in sets and the last point in cid52S being
L  maxs  R  s  cid52S
Then observe that the concavity of  along with 0  0 implies subad-
ditivity of  ie a  b  a  b It now follows from 113 that
gts  g0
 cid52gts
 g0t  s 
 g0t  s 
cid88
cid88
cid52S
cid52S
ht  s   
ht  s   
ON STABILITY OF HAWKES PROCESS
By setting s  0 we see that the point process with rate cid101rt at time t
given by
cid101rt  g0t 
cid88
cid52S
ht   
dominates stochastically the process cid52S Consider the process cid52D with
the following description one begins with roots that are created with rate
gt at time t and then each root generates a Galton-Watson tree with
birthrate at time t along any branch born at time s given by ht  s
Let the last point of cid52D be
Notice that
LD  maxs  R  s  cid52D
dT VtPg P0  PL  t  PLD  t  Ecid52D  t
where the rst inequality follows from L  LD because cid52S  cid52D and the
second from LD  cid52D So we will be estimating Ecid52D  t which
turns out to be much simpler to work with If we dene
cid90 
Next we compute Ecid80
lA  Ecid52D  A
etldt  E
cid88
cid52D
e 
cid52D e  and from that can obtain either an exact
formula or estimate the tail behavior Observe that we have the recurrence
relation
e  1  B 
Bhtetdt
e
cid18cid90 
cid19
cid88
T
cid88
T
where 1 comes from the root Bht is the rate of birth of the direct children
of the root at time   t et comes from time shift and nally due to the fact
that each child generates independently the same random tree we multiply
e This in turn implies that
Ecid80
T
e 
cid88
T
1  B cid82 
htetdt
Now similarly we let  be an arbitrary root and T be its tree we obtain
cid88
cid52D
from 128
e   B 
e
cid19
cid18cid90 
B cid0cid82 
0 gtetdtcid1
1  B cid82 
gtetdt
htetdt
cid88
T
where the recurrence relation in 130 is similar to 128 there is no 1 here
since there is no initial birth at time 0 the birth rate rate is Bgt and the
rest of the calculation is the same
Finally when combining 125 128 and 131 we obtain the exact for-
mula 116 Observe that if f1 f2 fk are probability density functions and
ai  0 i  1 2 kcid80k
cid90 
i1 ai  1 then
f1  f2    fksds 
f1s1fks2ds1dsk
fisids1dsk
cid90
where second line follows from the fact that cid80k
i1 Xi  t  PXi  ait for some i  1 2  k cid80k
Pcid80k
i1 si  t implies that for
some i si  ait Another way to see this is via probability interpreta-
tion if random variables Xi are independent and have distribution fi then
PXi  ait
fisidsi
where the rst and last expressions correspond to those of 132 Then
cid90
cid90
cid90
cid80k
 ncid88
 ncid88
i1 sit
cid90
dT VtPg P0 
cid90 
 cid107cid101gcid1071
 cid107cid101gcid1071
g 
cid32
cid88
cid88
cid90
1  B
cid33
cid90 
 cid101g
cid107cid101gcid1071
cid32cid90
cid101gs
cid107cid101gcid1071
cid101gsds  cid107cid101gcid1071
cid124
1  B
cid123cid122
 h    h
n times
cid125
cid90
cid33
cid88
hsds
cid90
hsds
ON STABILITY OF HAWKES PROCESS
 f2  f3    fk1  h a1  1
2n  Finally
using 132 with k  n  1 f1  cid101gcid107cid101gcid1071
a2  a3    ak1  1
cid82 
2 cid101gs  hsds
cid80
2cid101gsds  cid107cid101gcid1071
 cid107cid101gcid1071C4  
Bnncid82
cid82 
2 cid101gs  hsds
dT VtPg P0
lim sup
t
1 B
cid82
1  B
hsds
7 Generalizations
71 Multi-type models This section suggests two generalizations rst
making Hawkes multi-type and second replacing h by a general measure
The proofs will be simple modication of the ones we have presented here
Consider that points are now of nitely many types and the set of type
is E  1  d Now the process is specied by analogues triple h  g
 hijt  E  E  R  R where i j  E cid107hijcid107L1  1
 i  E  Rd2
 gijt  E  E  R  R
  R
Then for all e  E the rate at time t of type e is given by
ret  ezt
where zijt is a matrix given by
zij  gijt 
cid88
cid88
hijt   
Sit
extends the denition of the can extend functionalscid82 b
cid88
whre Sit are all the point of type i before time t When h is a measure one
a resds if exist such
ij for each i j e  E that satisfy
ij  Rd2
e ke
ecz
  lim
c
As the analogue of Hypothesis 1 we now have
k  Rd3
 e  E ez  ez  ce 
As a generalization of Propositoin 1 we get
cid88
Corollary 11 Suppose condition 143 is satised and if h is a mea-
sure then condition 142 is satised Then the following statements hold
i If e  E e is non-decreasing then Hawkes process is well dened
ii If in addition matrix
cid88
indexed by i e  E has spectrum supported on unit disk c  C  c  1
then invariant measure exists and is unique minimal invariant measure and
hence ergodic
72 Stationary initial conditions as a generalization The proofs of this
paper can also accommodate additional levels of complexity where one adds
a stationary signal in the following sense Suppose you add another bounded
stationary process pt to the rate function before passing through  so that
now rate rt is dened as
rt  
g0t  pt 
cid32
cid32
cid33
ht   
cid88
St
cid33
cid88
St
The results of this paper will still hold One can also add another signal
bounded signal qt outside of lambda where rate will be
rt  
g0t  pt 
ht   
One useful application of this is a Hawkes-like linear process where the roots
of the trees have some non-Poisson but stationary behavior while the trees
are just like in Hawkes process
Acknowledgements
I would like to thank my adviser S R Srinivasa
Varadhan for giving this topic to me and Lingjiong Zhu He not only gave
us this rich and interesting topic but also provided guidance in motivation
formulation of results and clear view of the subject I also thank Lingjiong
Zhu for helpful discussions and review of my paper
This research is supported by NSF DMS-0904701 DMS-1208334 and
DARPA grants
1 Bremaud P and Massoulie L 1996 Stability of nonlinear Hawkes processes
Ann Probab 24 15631588  MR1411506 97j60080
REFERENCES
ON STABILITY OF HAWKES PROCESS
2 Cox D R and Isham V 1980 Point processes Chapman  Hall London Mono-
graphs on Applied Probability and Statistics MR598033 82j60091
3 Embrechts P Liniger T and Lin L 2011 Multivariate Hawkes processes
 MR2865638
an application to nancial data J Appl Probab 48A 367378
2012j60125
4 Erlang A K 1909 The Theory of Probabilities and Telephone Conversations
Nyt Tidsskrift for Matematik B 20
5 Hawkes A G 1971 Spectra of some self-exciting and mutually exciting point
processes Biometrika 58 8390 MR0278410 43 4140
6 Hawkes A G and Oakes D 1974 A cluster process representation of a self-
exciting process J Appl Probability 11 493503 MR0378093 51 14262
7 Karabash D and Zhu L 2012 Limit Theorems For Marked Hawkes Processes
With Application to a Risk Model arXiv12114039
8 Nakayama M K Shahabuddin P and Sigman K 2004 On nite exponential
moments for branching processes and busy periods for queues J Appl Probab 41A
273280 Stochastic methods and their applications  MR2057579 2005a60069
9 Zhu L 2012 Large Deviations for General Markovian Hawkes Processes
arXiv11082432
10 Zhu L 2012 Process-Level Large Deviations for General Hawkes Processes
arXiv11082431
Dmytro Karabash
Courant Institute of Mathematical Sciences
New York University
251 Mercer St
New York NY 10012
E-mail karabashcimsnyuedu
dmytrokarabashgmailcom
