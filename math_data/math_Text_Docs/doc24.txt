Mean-field limit of generalized
Hawkes processes
Julien Chevallier
Univ Nice Sophia Antipolis CNRS LJAD UMR 7351 06100 Nice France
Abstract
We generalize multivariate Hawkes processes mainly by including a dependence with re-
spect to the age of the process ie the delay since the last point
Within this class we investigate the limit behaviour when n goes to innity of a system
of n mean-eld interacting age-dependent Hawkes processes We prove that such a system can
be approximated by independent and identically distributed age dependent point processes
interacting with their own mean intensity This result generalizes the study performed by
Delattre Fournier and Homann 2015
In continuity with the work of Chevallier et al 2015 the second goal of this paper is
to give a proper link between these generalized Hawkes processes as microscopic models of
individual neurons and the age-structured system of partial dierential equations introduced
by Pakdaman Perthame and Salort 2010 as macroscopic model of neurons
Keywords Hawkes process mean-eld approximation interacting particle systems renewal
equation neural network
Mathematical Subject Classication 60G55 60F05 60G57 92B20
Introduction
In the recent years the self-exciting point process known as the Hawkes process 22 has been
used in very diverse areas First introduced to model earthquake replicas 25 or 35 ETAS
model it has been used in criminology to model burglary 32 in genomic data analysis to model
occurrences of genes 20 44 in social networks analysis to model viewing or popularity 3 10
as well as in nance 1 2 We refer to 28 or 47 for more extensive reviews on applications
of Hawkes processes A univariate nonlinear Hawkes process is a point process N admitting a
stochastic intensity of the form
t  cid18Z t
ht  zN dzcid19 
where   R  R is called the intensity function h  R  R is called the self-interaction function
and N dz denotes the point measure associated with N 
Such a form of the intensity is motivated by practical cases where all the previous points of
the process may impact the rate of appearance of a new point The inuence of the past points is
formulated in terms of the delay between those past occurrences and the present time through the
weight function h In the natural framework where h is non-negative and  increasing this choice
of interaction models an excitatory phenomenon each time the process has a jump it excites
itself in the sense that it increases its intensity and thus the probability of nding a new point A
classical case is the linear Hawkes process for which h is non-negative and x    x where 
is a positive constant called the spontaneous rate Note however that Hawkes processes can also
describe inhibitory phenomena For example the function h may take negative values  being
the positive part modulo the spontaneous rate  ie x  max0   x
Corresponding author e-mail julienchevallierunicefr
Hawkes processes are also really suitable to model interacting particles such as bids and asks or-
ders in limit order books 33 Multivariate Hawkes processes consist of multivariate point processes
N 1     N n whose intensities are respectively given for i  1     n by
t  i
Xj1Z t
hjit  zN jdz
where i
 R  R is the intensity function associated with the particle i and hji is the
interaction function describing the inuence of each point of N j on the appearance of a new point
onto N i via its intensity i
When the number of interacting particles is huge as for instance nancial or social networks
agents one may be willing to let the number of particles goes to innity This is especially true
for multivariate Hawkes processes subject to mean-eld interactions In such a case we may in-
deed expect propagation of chaos namely the particles are expected to become asymptotically
independent provided that they start from independent and identically distributed iid initial
conditions and submitted to iid sources of noise Mean-eld type interactions involve some ho-
mogeneity and some symmetry through coecients that depend upon the empirical measure of the
processes In the limit regime the coecients depend upon the common asymptotic distribution
of the particles which satises nonlinear dynamics sometimes called of McKean-Vlasov type
The study of mean-eld situations for Hawkes processes was initiated by Delattre et al 13 by
considering the following form of intensity
t  
Xj1Z t
ht  zN jdz
where in comparison with 2 all the is and the hjis are the same In particular it is shown
in 13 that mean-eld interacting Hawkes processes are well approximated when the size of the
network n goes to innity by iid Poisson processes of the McKean-Vlasov type in the sense that
their intensity is given by the following implicit formula t  R t
In the present article a generalized version of Hawkes processes with mean-eld interactions
namely Age Dependent Random Hawkes Processes ADRHP for short is studied For any point
process N  we call age process associated with N the predictable process Stt0 given by
0 ht  zzdz
St  t  supT  N T  t
for all t  0
and extended by continuity in t  0 In particular its value in t  0 is entirely determined by
N  R and is well-dened as soon as there is a point therein In comparison with the standard
mean-eld type Hawkes processes studied in 13 we assume here that the intensity function 
in 3 which is denoted by  to avoid confusion may also depend on the age process Si
tt0
associated with the point process N i like for instance
t  
Xj1Z t
ht  zN jdz
This more general choice for the intensity makes the main dierence with 13 where the in-
tensity is assumed to be of the simpler form 3 only We then show that instead of Poisson
processes of the McKean-Vlasov type the limit processes associated with mean-eld interacting
age-dependent Hawkes processes are point processes of the McKean-Vlasov type whose stochastic
intensity not only depends on the time but also on the age More precisely for the toy exam-
ple 5 the intensity of the limit process N would be given by the following implicit formula
t  StR t
0 ht  zEcid2zcid3 dz where Stt0 is the age process associated with N 
Part of our analysis nds its motivation in the use of Hawkes processes for the modelling in
neuroscience First of all at a microscopic scale Hawkes processes are commonly used in theoretical
studies 9 21 40 43 to describe the time occurrences of the action potentials of dierent neurons
These action potentials are associated with brutal changes of the membrane potential called spikes
in the rest of the article The motivation for using Hawkes process is well-understood and linked
with the synaptic integration phenomenon the interaction functions hji describe the fact that
whenever a neuron spikes the membrane potential of the other neurons in the network and thus
their ring rate as well may change In that sense the L1 norm of the interaction function hji
for j 6 i is the analogue of the synaptic weight of neuron j over neuron i that is the strength
of the inuence of neuron j over neuron i through their synaptic connection For example if one
considers hji  jih for a xed function h then ji represents the relative synaptic weight
of neuron j over neuron i Notice that in the present paper we allow the functions hji to be
random and thus the synaptic weights to be random as well as in 15 for instance
To model a transition in the behaviour of the network at the shifting time t  0 the distribution
of N  R is considered as an initial condition of the dynamics of the point process and may be
dierent from the distribution of a Hawkes process Therefore to specify the dependence of the
dynamics on R upon the initial condition the following form of intensity can be considered
ht  zN dzcid19  cid18Z t
t  cid18Z t
 htzN dz models in a Hawkes manner the inuence of the initial condition
This choice of F is taken from 8 However other choices are conceivable For example more
general functions F may describe a stimulus at a given time t0  0 which is more convenient for
peristimulus analyses like 41
ht  zN dz  F tcid19 
where F t R 0
However standard Hawkes processes fail to model in a convenient way the neurophysiological
constraint known as refractory period that is the fact that a neuron cannot spike twice in a too
short delay This is the main reason why we allow the intensity of the Hawkes process to depend
upon the age in the present study In comparison with 1 one may represent strict refractory
period by considering for instance the following form of intensity
t  cid18Z t
ht  zN dzcid19 1St
where Stt0 is the age process associated with N and  is a parameter corresponding to the time
length of the strict refractory period of a neuron This sounds as an alternative to the strategy
used in 9 Therein refractory periods are described by choosing in the standard formulation of
Hawkes processes strongly negative self-interaction functions at a very short range The strategy
used in the present article is more exible synaptic integration and refractory period involve dif-
ferent aspects of the physiology of a neuron and so we prefer to describe each of them by dierent
elements in the modelling
Mean-eld approaches have been already used to pass from a microscopic to a macroscopic
description of neural networks Taking for granted that the network is symmetric enough the
mean-eld modelling sounds quite fair Indeed neural networks admit a large number of vertices
and are highly connected see 15 for a review One may distinguish three types of models intrin-
sically spike generating models like the FitzHughNagumo model 29 threshold spike generating
models like the integrate-and-re model 6 12 11 and point processes models 17 or 18 24
As usual with McKean-Vlasov dynamics the asymptotic evolution when n goes to innity of
the distribution of the population at hand can be described as the solution of a nonlinear partial
dierential equation PDE In the present article the candidate to describe the dynamics at a
macroscopic level is the following age structured system of nonlinear PDEs studied by Pakdaman
Perthame and Salort in a series of articles 36 37 38
n s t
n s t
m t  n 0 t Z 
 p s X t n s t  0
p s X t n s t ds

Here ns t represents the probability density of the age s of a neuron at time t where the age
of a neuron is the delay since its last spike Of course the denition of the age of a neuron ts
with the denition of the age associated with a point process as soon as the spike train is modelled
by a point process The function p represents the ring rate which may depend on the age s
As already explained this dependence describes for instance the phenomenon of refractory period
the network which is denoted by Xt R t
eg ps x  1s for some   0 The function p may also depend on the global activity of
0 dzn0 t zdz where d is some delay function This
global deterministic variable Xt corresponds to the mean of the integral that appears in 1
This correspondence forms the basis of the previous work 8 where a bridge is made between a
modied version of PPS and the distribution of the age of a single neuron modelled by a point
process From a neural network point of view this distribution can of course be recovered as the
limit of the empirical distribution associated with a network of iid neurons
The study of the link between the PPS system and a mean-eld interacting neural network
modelled by point processes was left as an open question in 8 The heuristic of this mean-eld
interpretation comes from the specic structure of the variable Xt which brings out a non-
linearity of the McKean-Vlasov type One of the main purpose of the present paper is to answer
that left open question To be precise this kind of study is performed in a preliminary work 42
for a ring rate p that is continuous and non-decreasing in both variables and under Markovian
assumptions Transposed to the Hawkes framework this last point corresponds to interaction
functions of the form hjit  etj1jt where  is a constant and the js are iid
random variables describing the propagation time of the signal from the neuron to the network
The convergence of the empirical measure is discussed in 42 when p is continuous only but without
any rate of convergence In the present study rates of convergence are given for non Markovian
Hawkes processes that is non necessary exponential interaction functions as well as for ring
rates that are discontinuous with respect to the age like 7 for instance However we make the
crucial assumption that the ring rate p is Lipschitz continuous with respect to the second variable
To sum up we call Age Dependent Random Hawkes Process ADRHP a multivariate age
dependent Hawkes process like 7 for instance with some general dependence with respect to
the initial condition 6 and with some randomness regarding the interaction functions hji This
article has two main purposes extend the mean-eld approximation obtained in 13 to this gen-
eralization of Hawkes processes and establish a proper link between the microscopic modelling of
individual neurons given by a n-particle system of mean-eld interacting age-dependent Hawkes
processes like 5 for instance and the macroscopic modelling given by the PPS system
The paper is organized as follows
In section II we introduce ADRHPs and we show how
to represent them as solutions of an SDE driven by a Poisson noise As a by-product of this
representation we get on the one hand the existence of such processes and on the other hand
an ecient way to get a coupling between our n-particle system and n iid
limit processes As
a rst step towards the mean-eld approximation the limit dynamics is studied in Section III
Existence and uniqueness of a solution of the PPS system which is our candidate to drive the
limit dynamics are proved in Theorem III5 As a consequence we get the existence of point
processes of the McKean-Vlasov type whose intensity depends on both the time and the age In
Section IV these processes are proved to be the mean-eld approximation of age dependent random
Hawkes processes Theorem IV1 and Corollary IV4 using coupling arguments under either of
the two following main assumptions the intensity is bounded or the intensity does not depend on
the age Notice that even when the intensity does not depend on the age the results presented
here extend the ones given in 13 since random interaction functions hji as well as dependences
with respect to the dynamics before time 0 cannot be taken into account in 13 Finally the
link between age dependent random Hawkes processes and the PPS system is given by Corollary
IV4 For sake of readability most of the computations and technical lemmas are given in two
appendices
General notations
 The space of continuous function from E to R is denoted by CE
 The space of Radon resp probability measures on E is denoted by ME resp PE
 For  in PE X   means that X is a random variable distributed according to 
 For f  R  R f1 f2 and f respectively denote the L1 L2 and L norms of f 
II Age dependent random Hawkes processes
In all the sequel we focus on locally nite point processes N  on RBR that are random
countable sets of points of R such that for any bounded measurable set K  R the number of
points in N  K is nite almost surely as The associated points dene an ordered sequence
of points TnnZ For a measurable set A N A denotes the number of points of N in A We
are interested in the behaviour of N on 0  and we denote t  R 7 Nt  N 0 t the
associated counting process Furthermore the point measure associated with N is denoted by
N dt In particular for any non-negative measurable function f  RR f tN dt PiZ f Ti
We work on a ltered probability space F  Ftt0 P and suppose that the canonical l-
tration associated with N  namely F N
t t0 dened by F N
 N   t is such that for
all t  0 F N
t  Ft Let us denote F  Ftt0 We call F-predictable intensity of N any
non-negative F-predictable process tt0 such that Nt R t
0 sdst0 is an F-local martingale
Informally tdt represents the probability that the process N has a new point in t t  dt given
Ft Under some assumptions that are supposed here this intensity process exists is essentially
unique and characterizes the point process see 4 for more insight
In analogy with the study of the dynamics of a variable over time we use a dichotomy between
the behaviour of the point process before time 0 which is treated as an initial condition and its
behaviour after time 0 which is supposed to admit a Hawkes type intensity For every point
process N  we denote N  N  R and N  N  0  In the rest of the paper a point
process on R is characterized by
1 the distribution of N namely N which gives the dynamics of N on R
2 the F-predictable intensity t which gives the dynamics of N on 0
In particular N characterizes the distribution of T0 that is the last point spike before time 0
Notice that the -algebra F0 is such that N is F0-measurable
II1 Parameters of the model
The denition of an age dependent random Hawkes process ADRHP is given bellow but let us
rst introduce the parameters of the model
 a positive integer n which is the number of particles eg neurons in the network for
i  1     n N i represents the occurrences of the events eg spikes associated with the
particle i
 a distribution N determining the initial conditions N i
cesses on R distributed according to N
i1n which are iid point pro-
 a distribution H determining the matrix of interaction functions H  Hij1ijn where
Hij  R  R are F0-measurable random functions distributed according to H such that
for any xed i  1     n the variables Hi1     Hin are independent
the vectors Hi1     Hin are exchangeable with respect to i
the matrix H is independent from the initial conditions N i
i1n

 a distribution F determining the matrix of functions F  Fij 1ijn where Fij  R  R
are F0-measurable random functions distributed according to F such that
for any xed i  1     n the variables Fi1     Fin are independent
the vectors Fi1     Fin are exchangeable with respect to i
 an intensity function   R  R  R
Note that the functions Hijs can in particular be equal to a given deterministic function h
which corresponds to more standard Hawkes processes
II2 Denition via the intensity
The denition of an age dependent random Hawkes process is given by providing the form of its
intensity
Denition II1 An age dependent random Hawkes process ADRHP with parameters
n H  F   N is a family N ii1n of point processes on R such that N i
i1n is a family
of iid point processes on R distributed according to N and N i
i1n is a family of point
processes on R with F-intensity given for all i  1     n by
t  
Xj1cid18Z t
Hijt  zN j
dz  Fij tcid19
tt0 is the predictable age process associated with N i dened in 4 and Hij 1ijn
where Si
respectively Fij 1ijn is a random matrix with entries distributed according to H resp F 
and satisfying 8 resp 9
An age dependent random Hawkes process admits two dierent behaviours
1 before time 0 the processes N i
i1n are independent and identically distributed
2 after time 0 the processes N i
i1n are dependent in general and driven by their re-
spective intensities which can be dierent from one process to another
Remark II2
1 The dichotomy of behaviours can model a change of regime at time t  0 It
should be interesting to see whether the results could be extended to initial conditions given
by a mean-eld dynamics and not necessarily iid ones However it is not in the scope of
this article
2 Assumptions 8 and 9 mean that a single particle receives iid
interactions from its
neighbours and that the particles are exchangeable one can permute the particles without
modifying their joint distribution
3 Given F0 the randomness of i
dz and
the age process Si
tt0 These intensities and so the point processes are not exchangeable
given F0 However they are exchangeable when they are considered with respect to all the
randomness including the N i
t in Equation 10 only lies in the point measures N j
s Hij s and Fij s
4 The link between synaptic weights that is the strength with which one given neuron inu-
ences an other one and interaction functions can be well emphasized by the following choice
of interaction functions Consider a xed function h  R  R and independently of ev-
erything else a sequence j j1n of iid random variables with values in 0 1 Then
Hij 1ijn dened by Hij  jh satises 8 The js represent the relative synaptic
weight of neuron j over all the other ones
The interaction functions even if they are random are xed at time 0 The dynamics of
synaptic weights is not taken into account here
5 As presented in the introduction see Equation 7 a particular case we have in mind in
this study is when there exists a function   R  R and a non-negative real number  such
s x  x1s
This particular choice of  provides an interesting modelling of the strict refractory period
of a neuron Furthermore when   0 there is no refractory period and one recovers more
standard Hawkes processes
In particular if H is the Dirac mass located at some xed
function h and F is the Dirac mass located at the null function then one recovers the
Hawkes processes studied in 13 Remark that the exchangeability of the Hawkes processes
studied in 13 is obvious since they have the same intensity at each time t
6 Since the auto-interaction given by Hii is scaled by 1n it vanishes when n goes to innity
and so the asymptotic behaviour proved in this article Corollary IV4 remains the same if
one assumes that Hii  0
7 Unlike the matrix H the matrix F can depend on the initial conditions as it can be seen in
the following particular case which is derived from 6 for instance For the same matrix
H  Hij 1ijn as in 8 we may choose for all 1  i j  n the function Fij  R  R
dened for all t  0 by
Fijt Z 0
Hijt  zN j
dz
These random functions are F0-measurable and they satisfy the rst two lines of 9 thanks
to the independence of the Hijs and the N j
s Hence one can consider the intensity given
by 10 with such a choice of F to represent the contribution of the processes N i
i1n to
the dynamics after time 0 In this example the Fij s are obviously dependent from the N j
s
8 In the case of neurons modelling one can model external inputs via the functions Fij  For
example one could take Fij  Hij t    where  is some non-positive real number that may
be random independent of anything else modelling that all the neurons have spiked at the
same time   0 thanks to a common stimulus
II3 List of assumptions
In the present article several assumptions on the parameters of the model are used depending on
the context For sake of simplicity all these assumptions are gathered here
Main assumptions
uin cid17
cid16A
If N is distributed according to N N  N and T0 denotes the closest point
of N to 0 then T0 admits a density with respect to the Lebesgue measure denoted
by uin in stands for initial Furthermore uin is uniformly bounded
If H  H  then there exists a deterministic function G  R  R such that as
for all t  0 Ht  Gt The smallest possible deterministic function G denoted
by MH  is moreover supposed to be locally integrable In particular E Ht is
well-dened and we let mH t  E Ht
If F  F  then t  R 7 E F t is locally bounded In particular for all t  0
E F t is well-dened and we let mF t  E F t
cid0A
Lipcid1
cid0A
cid1
A0 
The function   R  R  R is uniformly Lipschitz continuous with respect
to the second coordinate there exists a constant C  0 such that for all s  0
the function x 7 s x is Lipschitz with constant C The smallest constant C is
denoted by Lip Furthermore s  R 7 s 0 is uniformly bounded
The function  is uniformly bounded that is   
There exists a function 0  R  R such that for all s  0 s  0 In
this case if A
Lip is satised then Lip is rather denoted by Lip0
Additional assumptions
cid16A
 cid17
If N  N and T0 denotes the closest point of N to 0 then T0 is upper
bounded as that is there exists a constant C  0 such that T0  C as The
smallest possible constant C is denoted by MT0
cid0AH
2cid1
  is satised and MH is furthermore locally square integrable
1  is satised and if F  F  then for all t  0 F t admits a variance denoted
by VF t satisfying that for all t  0 R t
0 VF t12dt   Furthermore mF is
a continuous function
Remark that
 Assumptions AH
  AF
1  and A
system
Lip are used to prove the existence of the n-particle
 Assumptions AH
2 AF
the addition of either A
2  and A
 and A
Lip are used to prove the mean-eld approximation under
uin  or A0 
II4 Representation via a stochastic dierential equation
Denition II1 describes ADRHPs as weak solutions It characterizes their distribution but not their
path-wise dynamics As it is well emphasized in 30 point processes can be either represented as
weak solutions thanks to their stochastic intensity or represented as strong solutions of a stochastic
dierential equation SDE driven by Poisson noise The idea to represent point processes as strong
solutions of SDEs driven by Poisson measures was rst introduced by Lewis and Shedler 27 for
inhomogeneous Poisson process and extended by Ogata 34 thinning procedure under some weak
assumptions on the intensity It says that if N admits tt0 as a F-predictable intensity then the
point measure associated with N can be represented by N dt  dt0 t where  is a Poisson
measure with intensity 1 on R2
 This has been used to show existence or stability results for some
classes of point processes by Bremaud and Massoulie in 5 or 30 and more recently to exhibit
some suitable coupling between interacting Hawkes processes and their mean eld approximation
in 13 We introduce here the representation of ADRHPs based on such a thinning procedure
Representation II3 Let N i
i1 be some iid point processes on R distributed according
to N Let Hij 1ijn respectively Fij 1ijn be a random matrix with entries distributed
9 Let idt dxi1 be some iid
according to H resp F  and satisfying 8 resp
F-Poisson measures with intensity 1 on R2
Let N i
t i1n
be a family of counting processes such that for i  1  n and all t  0
idt dx
dz  Fij tcid17o
  N i
0 Z 
nx   Si
t
Xj1cid16Z t
Hijt  zN j
tt0 is the predictable age process associated with N i  N i
where Si
process associated with the counting process N i
Hawkes process with parameters n H  F   N
 is the point
t t0 Then N ii1n is an age dependent random
 and N i
This representation is mainly used in this paper in order to provide a suitable coupling between
ADRHPs and iid point processes describing the mean-eld dynamics
Going back and forth between the weak solution of Denition II1 and the strong solution of
Representation II3 is classic the thinning Theorem see 5 Lemma 2 or 8 Theorem B11 for a
complete proof states that a strong solution is also a weak solution and the Poisson inversion 5
Lemma 4 states that from a weak solution N ii1n one can construct Poisson measures on
an enlarged probability space such that 13 is satised
At this stage one has two equivalent concepts of ADRHPs but no result on the existence of
such processes Indeed if there is too much self-excitation then there may be an innite number
of points in nite time In the present paper point processes that do not explode in nite time
are considered and thanks to Representation II3 one can prove existence of these non-explosive
processes
Proposition II4 Under AH
1  and A
parameters n H  F   N such that t 7 Ecid2N 1
This result can be challenging in an innite dimensional framework like in 13 However in our
nite dimensional framework it is quite clear since the ADRHP can be stochastically dominated
by some multivariate linear Hawkes process thanks to the Lipschitz assumption A
Lip Yet the
well-posedness of linear Hawkes processes is standard thanks to their branching structure 23
Nevertheless a proof of Proposition II4 is given in Appendix A1
tcid3 is locally bounded
Lip there exists an ADRHP N ii1n with
  AF
III Study of the limit dynamics
The interactions between the point processes involved in the denition of an ADRHP are of mean-
eld type Therefore the limit version of Equation 13 is proposed below in Equation 14
informally the empirical means involved in 13 are replaced by their expected values The limit
equation with parameters h f0  N is given by
t  0 N t Z t
0 Z 
nx   StZ t
ht  zEcid2N dzcid3  f0to
dt dx
where h and f0 are some functions from R to R dt dx is an F-Poisson measure on R2
intensity 1 and Stt0 is the predictable age process associated with N  N   N  where N 
is a point process distributed according to N and N  is the point process associated with the
counting process N tt0
Looking simultaneously at Equations 13 and 14 shows that the empirical mean of the random
interaction functions Hij respectively the random functions Fij  are replaced by h resp f0 which
should be the mean interaction function mH resp mF  Moreover the empirical mean of the
point measures N j
dz in 13 is replaced by the expectation of the point measure N dz
Finally let us note that the dependence with respect to the age process is still present in the
limit equation This matches with experimental data in neuroscience where refractory periods are
highlighted By comparison there is no such dependence in the limit process given in 13 which
is an inhomogeneous Poisson process
This limit equation is used in the next section to provide suitable couplings to prove the mean-
eld approximation Hence the main point of this section is to prove the well-posedness of the
limit equation 14 However to study the probabilistic formulation of the mean-eld dynamics
described in Equation 14 one rst needs to nd a representation of the distribution of a possible
solution of 14 As a rst step we prove existenceuniqueness results for a linearisation of the
PPS system Proposition III1 as well as we give a representation of the solution given by the
method of characteristics Proposition III2 The second step is to deduce existenceuniqueness
results for the PPS system Theorem III5 from the linearised system via a xed point argument
Then the well-posedness of the limit equation 14 is proved thanks to the results obtained for the
PPS system Finally the link between the PPS system and the processes dened by the limit
equation is fully investigated
Note that the analytical study of the xed point equation satised by the expectation of the
solution of 14 as it is done in 13 can be extended to the case when the intensity does depend
on the age However the results for the PPS system are valid in a more general framework so
they are favoured here
III1 Study of the linear system
In comparison with the PPS system the linear system studied below corresponds to the case
where the ring rate p in PPS is a function of the time t and the age s only More precisely we
consider the system
u t s
u t s

u t 0 ZsR
 f t su t s  0
f t su t s ds
where f is a bounded function
We state uniqueness of the solution of this system in a measure space as a consequence of the
uniqueness result stated in 7 More precisely the result is stated in BCRMR that is the
space of bounded continuous curves on MR the space of Radon measures on R endowed with
the bounded Lipschitz norm as considered in 7 As we are interested in probability measures
let us remark that the bounded Lipschitz norm on PR is equivalent thanks to the duality of
Kantorovich-Rubinstein to the modied 1-Wasserstein distance dened by
W1   inf E minX  Y  1 
where the inmum is taken over all joint distributions of the random variables X and Y with
marginals  and  respectively
Since measure solutions are considered a weak form of the system is given The following set
of test functions is used
The function  belongs to C
  is continuous uniformly bounded
  has uniformly bounded derivatives of every order
 there exists T  0 such that t s  0 for all t  T and s  0
The result stated below is a consequence of 7 Theorem 24 in the same essence than the one
presented in 7 Section 33 Its proof is given in Appendix A2
Proposition III1 Assume that f  R  R  R is bounded and continuous uniformly in the
rst variable with respect to the second variable Assume that uin belongs to MR
Then there exists a unique solution in the weak sense u such that t 7 ut belongs to
BCRMR of the system 15 with initial condition u0  uin The weak sense means
here that for every  in C
cid18 
scid19  t s u t ds dt ZR
0 suinds
t 0  t sf t sut dsdt  0
Remark that the system is mass-conservative eg take a sequence of functions converging to
t 7 10T t as test functions in the weak equation 17 As we are interested in probability
measures as solutions let us remark that the mass-conservation alone cannot ensure that the
solution is a probability even if the initial condition is a probability However when the initial
condition is a probability which admits a density the method of characteristics shows that the
solution of 15 is probability density function for all time t  0
Proposition III2 Under the assumptions of Proposition III1 assume that uin is a probability
which admits a density denoted by uin as well with respect to the Lebesgue measure Then there
exists a unique locally bounded function u0  R  R which is furthermore non-negative such
that u dened by
ut s  uins  t expcid18Z t
ut s  u0t  s expcid18Z s
f t s  t  tdtcid19 
f t  s  s sdscid19 
for s  t
for t  s


is the unique solution of 15 In particular
 u satises the second equation of 15 in a strong sense
 since u0 is non-negative and the system is mass-conservative the function ut is a density
for all time t  0
A detailed proof of this result is given in Appendix A3 Here are listed some properties of the
solution u of the linear system
Proposition III3 Under the assumptions of Proposition III2 assume furthermore that there
exists M  0 such that for all s  0 0  uins  M 
function t 7 ut 0 is continuous and
Then the solution u of 15 is such that the function t 7 ut belongs to CR L1R the
0  ut s  maxMf
for all t s  0
Proof The rst continuity property is rather classic thanks to a xed point argument in the space
C0 T  L1R for a good choice of T  0 see 39 Section 33 for instance The second one
is given by the second equation of 15 which is satised in a strong sense by the solution given
by the characteristics Indeed
ut  t 0  ut 0  Z 
Z 
f t  t sut  t s  ut sds
f t  t s  f t sut sds
 fut  t  ut1  sup
s0 f t  t s  f t s
Yet the continuity properties of both functions f and t 7 ut and give that ut  t 0 ut 0
goes to 0 as t goes to 0 hence the continuity of t 7 ut 0
Finally one can prove that u satises 20 thanks to the representation given by the charac-
teristics On the one hand the function u0 given in Proposition III2 is non-negative and so is
u On the other hand it follows from 18 that for s  t ut s  M and it follows from the
second equation of 15 that for all t  0 ut 0  f and so 19 implies that for t  s
ut s  f
III2 Study of the PPS system
Here a global existence result for the nonlinear system PPS is stated under suitable assumptions
Since this result is one of the cornerstone of this work its proof is given even if its sketch is pretty
similar to the proof of 36 Theorem 51
In comparison with the uniqueness for the linear system which takes place in BCRMR
the uniqueness result stated in this section takes place in BCRPR However this last result
is sucient for our purpose since it is applied to measures that are probabilities a priori
First of all a technical lemma is needed to fully understand the non linearity involved in the
system PPS
Lemma III4 Under A
 assume that h  R  R is locally integrable and that
f0  R  R is continuous Then for all u in BCRPR there exists a unique function
Xu  R 7 R such that
Lip and A
Xut Z t
z0Z 
ht  z s Xuz  f0z u z ds dz
Furthermore the function Xu is continuous
Proof The proof is divided in three steps
-1 Establish a priori estimates on Xu to show that it is locally bounded Indeed using the
boundedness of  and the fact that u belongs to BCRPR one deduces that
Xut  Z t
z0Z 
s0 ht  zu z ds dz  Z t
z0 ht  zdz
Hence the local integrability of h implies the local boundedness of Xu
-2 Show that Xu exists and is unique as a xed point For any T  0 consider the following
application
GT  L0 T  
7 cid18t 7Z t
z0Z 
L0 T 
ht  z s Xz  f0z u dz dscid19 
The Lipschitz continuity of  leads for any X1 X2 in L10 T  and t in 0 T  to
GT X1t  GT X2t  LipZ t
 LipZ t
 LipX1  X2L0T Z T
0 ht  zX1z  X2zZ 
0 ht  zX1z  X2z dz
hzdz
uz dsdz
Fix T  0 such that LipR T
0 hzdz  12 so that GT is a contraction and admits a unique xed
point Iterating this xed point gives the existence and uniqueness of Xu in the space of locally
bounded functions
For instance we give the idea for the rst iteration Denoting W the xed point of GT  one
can consider the following application
2T  LT 2T  
7 cid18t 7Z t
z0Z 
LT 2T 
ht  zcid16s Xz  f0zcid17 u z ds dzcid19 
where Xt  W t if 0  t  T  Xt  Xt if T  t  2T  and Xt  0 otherwise Applying
the same argument as for the xed point of GT leads to existence and uniqueness of the trace of
Xu on 0 2T 
-3 Finally let us show that Xu is continuous thanks to a generalized Gronwall lemma Using
the Lipschitz continuity and the boundedness of  one deduces from 21 that
Xut  t  Xut  LipZ t
0 hyXu  f0t  y  Xu  f0t  t  ydy
 Z tt
hydy
This means that the function Y t
Y t
 Xu  t  Xu satises
u  gtt  LipZ t
0 ht  zY t
0 ht  zf0z  t  f0zdz R tt
where gtt  LipR t
hydy Applying Lemma
B4-i gives for any T  0 supt0T  Y t
t  CT supt0T  gtt Yet the continuity hence
uniform continuity on compact time intervals of f0 and the local integrability of h gives that
supt0T  gtt  0 as t  0
Now we have all the ingredients to state the existenceuniqueness result for the PPS system
in a measure space of possible solutions Notice that the existenceuniqueness result used for the
linear system would not directly apply to the non-linear system
In that sense we extend the
result stated in 7
Theorem III5 Under A
 assume that h  R  R is locally integrable and
that f0  R  R is continuous Assume that uin is a non-negative function such that both
uinsds  1 and there exists M  0 such that for all s  0 0  uins  M 
Then there exists a unique solution in the weak sense u such that t 7 ut belongs to
BCRPR of the following PPS system
Lip and A
u t s
u t s
u t 0 ZsR
  s Xt  f0t u t s  0
 s Xt  f0t u t s ds

0 ht  zuz 0dz The weak
with initial condition that u0  uin where for all t  0 Xt R t
sense means here that for every  in C
scid19  t s u t ds dt ZR
cid18 
0 suinsds
t 0  t s s Xt  f0t ut dsdt  0 23
where X is the continuous function given by Lemma III4 and satisfying
Xt Z t
z0Z 
ht  z s Xz  f0z u z ds dz
Moreover the solution u is such that for all t  0 the measure ut is a probability and
admits a density which is identied to the solution itself Furthermore the function t 7 ut
belongs to CR L1R the function t 7 ut 0 is continuous and
0  ut s  maxM
for all t s  0
As for the linear case the system is mass-conservative eg
take a sequence of functions
converging to t 7 10T t as test functions in the weak equation 23
Proof The proof is divided in two steps First we apply the results of Section III1 to a linearised
version of the non-linear system 22 and then we nd the auxiliary function X corresponding to
the solution u as a xed point in a space of continuous functions in order to deal with the non
linearity of the system 22
-1 The linearised version of the system takes the form
u t s
u t s

u t 0 ZsR
  s Y t  f0t u t s  0
 s Y t  f0t u t s ds
for a xed continuous function Y  Note that the funciton f  t s 7  s Y t  f0t is bounded
and continuous uniformly in s with respect to t So the assumptions of Propositions III1 III2
and III3 are satised In particular for any continuous function Y  there exists a unique solution
uY with initial condition uin in BCRPR  BCRPM of the system 26 which
furthermore satises the properties listed in Proposition III3
consider the application
-2 Let us notice that for all T  0 if Y belongs to the Banach space C0 T 0T  then
t 7R t
0 ht  zuY z 0dz belongs to C0 T  too Indeed remind that t 7 uY t 0 is continuous
thanks to Proposition III3 and that R t
0 hzuY t  z 0dz Hence one can
FT  C0 T  
0 ht  zuY z 0dz R t
C0 T 
7 cid18t 7Z t
ht  zuY z 0dzcid19 
and show that it admits a xed point for a good choice of T  Computations given in Appendix
A4 provide the following statement
 T  0 Y1 Y2  L0 T 
FT Y1  FT Y2L0T  
2Y1  Y2L0T 
where T depends neither on the initial condition nor on f0
Until the end of the proof let x such a T  Then there exists a unique W in C0 T  such
that FT W   W  In particular uW is a solution of 22 on 0 T  so we have existence on 0 T 
For the uniqueness let us consider the trace of a solution u  BCRPR to 22 on 0 T 
Then the auxiliary function Xu associated with u dened in Lemma III4 is continuous Since u
is a solution of 22 the trace of Xu on 0 T  is a xed point of FT and so Xu  W and u  uW 
This gives the uniqueness of the solution of 22 on 0 T  in BCRPR
Taking uW T instead of uin as initial condition the function t 7 f0t  T   R T
0 ht 
zuW z 0dz instead of f0 and applying the same nd of xed point argument gives the trace of
the solution on T 2T  Iterating this xed point argument one deduces that there exists a unique
solution u of 22 on R remind that T depends neither on the initial condition nor on f0 In
particular the iteration is possible since the boundedness of the initial condition is carried on by
the equation see Equation 20
The regularity and boundedness of the solution u ie the continuity properties and Equation
25 listed at the end of the statement come from the regularity and boundedness of the solutions
uY since u is one of the uY s
III3 Limit process
Let us remind the limit equation 14 that is
t  0 N t Z t
0 Z 
nx   StZ t
ht  zEcid2N dzcid3  f0to
dt dx
This limit equation describes an age dependent point process interacting with its own mean
intensity in an Hawkes manner More precisely a solution N tt0 of 14 if it exists admits
an intensity t which depends on the time t and the age St in a McKean-Vlasov manner in the
sense that it satises the following implicit equation t  StR t
ht  zEcid2zcid3 dz  f0t
Equation 14 is in particular a non trivial xed point problem of the McKean-Vlasov type Notice
that the dependence of N with respect to the past N  is reduced to the age at time 0 ie
S0  T0 Throughout this article a solution of the limit equation is called a point process of
the McKean-Vlasov type whose intensity depends on time and on the age
The xed point problem of the limit equation 14 is proved to be well-posed in two cases as
given in the next two statements In either case the idea of the proof is rst to compute the mean
intensity denoted by t of a possible solution of 14 The next two propositions state the same
result under dierent sets of assumptions and can be summarized as follows
 in the rst case the intensity is bounded ie  satises A
given by the system 22 More precisely t  ut 0 with u given by Theorem III5
 and the mean intensity is
 in the second case the intensity does not depend on the age process ie  satises A0 
and the mean intensity is given by a generalization of 13 Lemma 24
uin  A
Lip and A
 assume that h  R  R is locally integrable
Proposition III6 Under A
and that f0  R  R is continuous Denote by u the unique solution of 22 with initial condition
uin as given by Theorem III5 and let for all t  0 t  ut 0 Then the following statements
i if N tt0 is a solution of 14 then Ecid2N dtcid3  tdt
ii there exists a unique once  and N  are xed solution N tt0 of the following system
0 Z 
N t Z t
Ecid2N tcid3 Z t


1nxcid16St R t
0 htzzdzf0tcid17o dt dx
tdt
where Stt0 is the predictable age process associated with N  N   N  where N  is
a point process distributed according to N and N  is the point process associated with the
counting process N tt0
In particular  is a continuous function satisfying t  Ehcid16StR t
and the solution of 29 is the unique once  and N  are xed solution of 14
0 ht  zzdz  f0tcid17i
Proof -i Suppose that N tt0 is a solution of 14 The thinning procedure implies that N tt0
admits an intensity which only depends on the time t and the age St This allows us to denote
by f the bivariate function such that the intensity of N at time t is given by t  f t St It
satises for all t s  0
f t s  cid18sZ t
ht  zEcid2f z Szcid3 dz  f0tcid19 
In particular the intensity is bounded since  is bounded So if we denote wt  wt the
distribution of the age St Lemma B2 gives that w belongs to BCRPR and 8 Section
41 implies that w satises the system
w t s
w t s
 f t sw t s  0
f t sw t s ds

w t 0 Z 
Yet by denition of w Ecid2f z Szcid3 R 
s0 f z swz ds so 30 rewrites as
f t s   s Xt  f0t 
where X satises
Xt Z t
ht  zZ 
s Xz  f0zwz dsdz
Hence w is a solution in BCRPR of the system 22 Yet the solution of 22 is unique
Theorem III5 so we have w  u dened in Proposition III6 and in particular Ecid2N dtcid3 
Ecid2f t Stcid3 dt  ut 0dt  tdt
-ii The rst equation of 29 is a standard thinning equation with  given by the rst step
so its solution N tt0 is a measurable function of  and N  hence it is unique once  and N 
are xed
To conclude this step it suces to check that N tt0 satises the second equation of 29
Identifying t with Ecid2f t Stcid3 in 30 the intensity of N is given by
ht  zzdz  f0tcid19
f t St  cid18StZ t
which is bounded Hence 8 Section 41 implies that the distribution of the age St denoted by
vt is the unique solution of
v t s
v t s
 cid18sZ t
ht  zzdz  f0tcid19 v t s  0
v t 0 Z 
cid18sZ t
ht  zzdz  f0tcid19 v t s ds


Since t  ut 0 and u is a solution of 22 it is clear that u satises this system so ut is
the density of St Finally using Fubinis Theorem we have
Ecid2N tcid3 Z t
Ecid2f t Stcid3 dt  Z t
 Z t
tdt
E StZ t
 sZ t
0 Z 
ht  zzdz  f0t dt
ht  zzdz  f0t ut sdsdt
since u satises the second equation of 33
Finally the three remaining points are rather simple Firstly the continuity of  comes from
Theorem III5 Secondly using 32 and i one has
t  Ecid2f t Stcid3  Ecid20cid18StZ t
ht  zzdz  f0tcid19cid21 
Lastly the solution of 29 is clearly a solution of 14 and i tells that a solution of 14 is
necessarily a solution of 29 which gives uniqueness
Proposition III7 Under A
that f0  R  R is continuous
on 0 h and f0 such that the following statements hold
Lip and A0 assume that h  R  R is locally integrable and
Then there exists a unique function  which is furthermore continuous on R depending only
i if N tt0 is a solution of 14 then Ecid2N dtcid3  tdt
ii there exists a unique once  is xed solution N tt0 to the following system


In particular t  0cid16R t
 is xed solution of 14
1nx0cid16R t
0 htzzdzf0tcid17o dt dx
N t Z t
0 Z 
Ecid2N tcid3 Z t
0 ht  zzdz  f0tcid17 and the solution of 34 is the unique once
tdt
The proof follows 13 Theorem 8-i and is given in Appendix A5 for sake of exhaustiveness
III4 Link via the age process
The link between the limit equation 14 and system 22 is even deeper than what is stated in
Proposition III6 Indeed the distribution of the age process associated with a solution of the limit
equation is a solution of 22 as described in the next statement
Proposition III8 Under the assumptions of Proposition III6 the unique solution u to the
system 22 with initial condition that u0  uin is such that ut is the density of the age St
associated with the solution of the limit equation 14 given in Proposition III6
This result is in fact given in the proof of Proposition III6 below Equation 33
IV Mean-eld dynamics
The convergence to the limit dynamics is proved by using a path-wise coupling like in 13 31
between the processes given by Representation II3 on the one hand and by the limit equation
on the other hand Then this coupling is studied in two dierent cases when the intensity is
bounded ie  satises A
 or when the intensity does not depend on the age process ie 
satises A0 
The precise statement regarding the convergence of the n-particle system towards point pro-
cesses of the McKean-Vlasov type whose intensity depends on time and on the age is given in
Corollary IV4
IV1 Coupling
Once the limit equation is well-posed following the ideas of Sznitman in 46 it is easy to construct
a suitable coupling between ADRHPs and iid solutions of the limit equation 14 More precisely
consider
i1 of iid point processes distributed according to N
 a sequence N i
 an innite matrix Hij ij1 independent of N i
H such that
i1 with entries distributed according to
for any xed i  1 the variables Hi1     Hin    are independent
the sequences Hi1     Hin    are exchangeable with respect to i
the matrix Hijij1 is independent from the initial conditions N i
i1n

 an innite matrix Fij ij1 with entries distributed according to F such that
for any xed i  1 the variables Fi1     Fin    are independent
 a sequence idt dxi1 of iid F-Poisson measures with intensity 1 on R2
the sequences Fi1     Fin    are exchangeable with respect to i
Notice that 35 resp 36 is the equivalent of 8 resp 9 for innite matrices Under AH
either
2
Lip the assumptions of Proposition II4 are satised Furthermore if we assume
2  and A
 H1 A
 H2 A0  is satised
 and A
uin  are satised
  and AF
1  satisfy the assumptions of either Proposition
then mH and mF dened in AH
III6 under H1 or III7 under H2 so one can build simultaneously
- a sequence indexed by n  1 N nii1n of ADRHPs with parameters n H  F   N
according to Representation II3 that is
0 Z 
idt dx
x  
Sni
t
Xj1Z t
Hijt  zN nj
 dz  Fij t
with age processes Sni
ti1
- and a sequence N
that is
t i1n
t0 of iid solutions of the limit equation with parameters mH  mF   N
and past given by N i
0 Z 
1x   S
tZ t
mH t  zzdz  mF tidt dx
tt0 is the
where  is dened either in Proposition III6 under H1 or III7 under H2 and S
predictable age process associated with N
  N
Notice that this coupling is based on the sharing of a common past N i
i1 and a common
underlying randomness that are the F-Poisson measures idt dxi1 Note that the sequence
of ADRHPs is indexed by the size of the network n whereas the solutions of the limit equation
that represent the behaviour under the mean eld approximation are not
The following result states the control of the mean-eld approximation
Theorem IV1 Under AH
2 AF
2  and A
Lip assume either H1 or H2
Then the sequence of ADRHP N nii1n with F-intensities on R denoted by nii1n
t0 of the solution of the limit equation with F-intensities
dened by 37 and the iid copies N
ti1
on R denoted by 
i1n dened by 38 are such that for all i  1     n and   0
t0N ni
t  N
t Z 
Ehni
t  
ti dt  C  H  F  n12
where the constant C  H  F  does not depend on n
Proof First let us note that in each cases the coupling is well-dened thanks to either Proposition
III6 or III7 Let us x some n  1 Let us denote i
dt and
nt  Ei
nt its expectation Denoting AB the symmetric dierence of the sets A and B
and Card A the cardinal of the set A we have
nt  R t
 dt  N
0 N ni
nt Z t
0 N ni
 dt  N
dt  Card cid16N ni N
  0 tcid17 
between 0 and t Then it is
that is the number of points that are not common to N ni and N
clear that for all i  1     n and   0 supt0 N i
t  i
t  Ehi
ni  i
t0N ni
t  N
t  N
n and so
On the one hand the N
s are iid hence exchangeable On the other hand thanks to the form
of the intensity and the assumptions on the matrices Hij ij1 and Fij ij1 - 35 and 36 - the
family N nii1n is exchangeable too Hence i
n does not depend on i and is simply denoted
by n in the sequel Let us focus on the case i  1 First let us remind that 
t is the intensity of
n Z 
0 Z 
Taking expectation we nd
n  EZ 
 EZ 
 EZ 
1dt dx
tcid9cid12cid12cid12
cid12cid12cid12
t cid9  1cid8x
1cid8xn1
Ecid20Z 
1dt dxcid12cid12cid12cid12
tcid9cid12cid12cid12
cid12cid12cid12
t cid9  1cid8x
1cid8xn1
0 Z 
cid12cid12cid12
tcid9cid12cid12cid12
t cid9  1cid8x
1cid8xn1
tdt Z 
tcid12cid12cid12i dt
Ehcid12cid12cid12
0 n1
t  
t  
Ftcid21
where the last equality comes from Fubinis Theorem It remains to show that the rate of conver-
gence is n12
Computations given in Section A6 show that in each cases there exists some locally bounded
function g depending on  H and F such that n satises
n  n12g Z 
n  n12g Z 
  LipMH   z nzdz
under H1
LipMH   znzdz
under H2


Remark that the only dependence with respect to n lies in n Since g is locally bounded and MH
is locally integrable using Lemma B4-i we end up with n  C  H  F  n12 where C
does not depend on n
There are mainly two reasons for the dichotomy of the assumptions H1 and H2 Firstly up
to our knowledge existenceuniqueness results on the macroscopic system 22 are only valid if
the function  is bounded Secondly as it appears in 43 when the intensity of the n-particle
system depends on the age the control of n involves the L norm of the function  This
boundedness condition is used in order to control the coupling as soon as the ages of the n-particle
system on the one hand and the iid copies of the solution of the limit equation on the other
hand are dierent Notice that even under H2 this coupling result extends 13 Theorem 8-ii
since there are two novelties in the present article random interaction functions Hij as well as
dependences with respect to the past Fij 
Under more restrictive assumptions corresponding informally to uniform controls instead of
local ones the rate with respect to  of C  H  F  given in Theorem IV1 is linear in
comparison with a rate which is at least exponential in general The main assumption corresponds
to the stability criterion of Hawkes processes 5
Proposition IV2 Under AH
assume that both
Lip assume either H1 or H2 Furthermore
2 AF
2  and A
 the functions MH and  are such that   LipMH1  1 and MH2  
 the functions mF and VF are uniformly bounded
Then the constant C  H  F  given in Theorem IV1 can be bounded by  H  F  
where the constant  H  F  depends neither on  nor on n
This bound holds for all   0 under H2 whereas it holds for   1   under H1
A proof is given in Appendix A7 where an explicit expression of  can be found in Equation
81 or 83 depending on the context
As said in the introduction Hawkes processes seem to be the microscopic point processes
underpinning the PPS system introduced in 36 There is a striking similarity modulo a change
of time between 
 on the one hand the mean intensity denoted by mt of a Hawkes process which is a function
0 ht  zmzdz
 and on the other hand the ring rate p in PPS which is a function of R t
0 dzn0 t  zdz
A rst step in this direction has been made in 8 in the framework of a network of iid Hawkes
processes In that case there is no direct bridge between Hawkes processes and the PPS system
as it is shown in 8 Indeed when the size of the network goes to innity one recovers conditional
expectation of the intensity with respect to the age instead of the mean intensity By comparison
the limit system of the mean-eld interacting age-dependent Hawkes processes system considered
in the present article involves the mean intensity as it can be seen in Equation 14 Furthermore
this mean intensity is in some cases given by the macroscopic system
System 37-38 provides an ecient coupling between the spikes attached with the n-particle
system and the spikes associated with the limiting process
In order to go one step further a
natural question is to wonder about a possible coupling between the ages associated with the two
dynamics This question is not addressed in 13 in which the propagation of chaos is discussed
at the level of the counting processes only In comparison we are here willing to investigate this
question carefully The underlying motivation is not of a mathematical essence only exhibiting
a suitable coupling between the ages of the ADRHP and the ages of the point processes of the
McKean-Vlasov type whose intensity depends on time and on the age is the right and proper
way to make the connection between the microscopic description of the neural dynamics and the
macroscopic equation PPS
In the sequel Assumption A
  is used It appears that the dependence of the age at time 0
with respect to the initial condition generates additional diculties for investigating the mean-eld
approximation To limit the complexity of the analysis it is quite convenient to assume that the
age at time 0 is bounded which is precisely what Assumption A
Corollary IV3 With the notations and assumptions of Theorem IV1 assume that A
satised
  says
  is
Then the age processes Sni
t i1n
t0 associated with the iid solutions N
associated with the sequence of ADRHP N nii1n and
t0 of the limit equation satisfy
ti1
the age processes S
for all i  1     n and   0
ti1
t0Sni
t  S
t  MT0   C  H  F  n12
where C  H  F  is given in Theorem IV1 and MT0 is dened in A
Proof Let us note that for all n  1 and i  1     n N ni and N
part ie N ni
t  S
MT0   when the trajectories Sni
Therefore we have the following bound
0 and supt0 Sni
coincide on the non-positive
t is as upper bounded by
tt0 are dierent and is equal to 0 otherwise
 Therefore Sni
t t0 and S
  N
t0Sni
t  S
t  MT0  Pcid18cid16Sni
tcid17t0 6cid16S
tcid17t0cid19 
Yet if the trajectories are dierent there is at least one point between 0 and  which is not common
to both N ni
 and N
t  N
t 6 0 hence
 that is supt0 N ni
Pcid18cid16Sni
tcid17t0 6cid16S
tcid17t0cid19  P  sup
t0N ni
t  N
t 6 0 
Moreover since counting processes are piecewise constant with jumps of height 1 as it is clear
t0N n1
t  N
t 6 0  P  sup
t0N n1
t  N
t  1  E sup
t0N n1
t  N
where we used Markovs inequality Finally inequality 44 clearly follows from Theorem IV1
IV2 Mean-eld approximations
Inspired by the seminal work of Sznitman 46 we now obtain from the results of the previous
section the convergence of the n-particle system towards the limit equation
 the empirical distribution of the point processes associated with the n-particle system con-
verges to the distribution of the point process solution of the limit equation
 the empirical distribution of the age processes associated with the n-particle system converges
to the distribution of the age process associated with the solution of the limit equation
This result together with the ones from the previous paragraphs are typical of what is known as
the propagation of chaos theory of interacting particle system In particular it says that k xed
neurons behave independently and identically when the size of the network goes to innity Their
spiking dynamics being described by the limit equation 14
Corollary IV4 Let LX denote the distribution of some random variable X and DR denote
the space of cadlag functions from R to R endowed with the Skorohod topology
With notations and assumptions of Theorem IV1 we have the following mean-eld approxi-
mations
 the weak convergence in PDR of the empirical measure of counting processes
N ni
t0 n Lcid0N
t t0cid1
 if furthermore A
age processes
  holds the weak convergence in PDR of the empirical measure of
Sni
t t0 n Lcid0S
tt0cid1
Both convergences also hold in probability since the limits are constant in PDR
Finally if furthermore A
 and A
with initial condition that u0  uin is such that ut  ut is the density of the age S
for all   0
uin  hold then the unique solution u of the system 22
t and
t0
EW1  1
 ut  D  H  F  MT0 n12
where W1 denotes the standard 1-Wasserstein distance and the constant D  H  F  MT0 does
not depend on n
t0 N n2
Proof The space of cadlag functions DR endowed with the Skorohod topology is a Polish space
So according to 46 Proposition 22 or 31 Proposition 42 to show the rst limit 47 it suces
to check that N n1
t0 converges in distribution as n   to two independent
t t0 Since the convergence with respect to Lipschitz continuous test functions is
copies of N
sucient in order to prove the convergence in distribution Portemanteau Theorem 26 the rst
limit clearly follows from both 39 and the fact that the uniform convergence topology on compact
time intervals is ner than the Skorohod topology The proof of the second limit is similar with
the dierence that it follows from 44 instead of 39
The link between the solution of 22 and the age process associated with the solution of the
limit equation 14 is given by Proposition III8
The rate of convergence for the 1-Wasserstein distance stated in 49 is a consequence of the
rate of convergence for iid real valued random variables Fix   0 and let t be in 0  First
using the exchangeability of the particles it follows from Corollary IV3 that there exists a constant
C  H  F  MT0 such that
EW1  1
t 
t0Sni
t  S
t  C  H  F  MT0 n12
Then applying 16 Theorem 1 to the iid random variables S
deduce that there exists a constant C MT0  such that EW1 1
Finally the triangular inequality for the 1-Wasserstein distance gives 49
i1 S
t that are bounded by MT0  we
 ut  CMT0 n12
The rst mean-eld approximation 47 is a generalization of the one given in 13 Theorem
8-iii where mean-eld interacting Hawkes processes are approximated by Poisson processes of
the McKean-Vlasov type Here the limit processes are point processes of the McKean-Vlasov type
whose intensity depends on time like Poisson processes and on the age
Moreover Equation 49 extends the result on the rate of convergence for the age processes
given in 42 Section 5
V Conclusion
We present a generalization of mean-eld interacting Hawkes processes namely age dependent
random Hawkes processes ADRHPs which are well-adapted to neuroscience modelling From
a biological point of view they encompass some interesting features such as refractory period
synaptic integration or random synaptic weights These processes are studied in a mean-eld
situation and we show in Theorem IV1 and Corollary IV4 that as the number of particles goes
to innity they can be well approximated by point processes of the McKean-Vlasov type whose
intensity depends on time and on the age These limit point processes are closely related to the age
structured PDE system introduced by Pakdaman Perthame and Salort namely PPS as shown
in Proposition III8
Hence using the theory of mean-eld approximations the present article makes a bridge be-
tween the microscopic modelling given by Hawkes processes or more generally age dependent
random Hawkes processes and the macroscopic modelling given by the PPS system This bridge
is presented under the main assumption that the intensity of the microscopic point processes is
bounded In this sense the present article oers an answer to the question left open in 8 This
legitimises the convolution term Xt in the PPS system as well as opens the way to the study
of new assumptions on the spiking rate p appearing in the PPS system from a more analytical
point of view Up to our knowledge this has not been done yet
The present article gives somehow the law of large numbers for a generalization of Hawkes
processes It could be interesting to investigate how these processes uctuates around their mean
limit or in other words nd some kind of functional central limit theorem for Hawkes processes in
a mean-eld framework
As noted random synaptic weights can be considered in this study However they are sup-
posed to be in some sense independent and identically distributed which can be considered as
an unrealistic assumption Inspired by 14 it could be interesting to see how correlated synaptic
weights could be handled in the Hawkes processes framework
On a dierent path it could be interesting to see how locally stationary Hawkes processes as
introduced in 45 behave in a mean-eld situation Indeed these processes may take into account
the dynamics of the synaptic weights occurring in the neural network
Acknowledgement This research was partly supported by the french Agence Nationale de la
Recherche ANR 2011 BS01 010 01 projet Calibration and by the interdisciplanary axis MTC-
NSC of the University of Nice Sophia-Antipolis I would like to thank Patricia Reynaud-Bouret
and Francois Delarue for helpful discussions which improved this paper
A Proofs
A1 Proof of Proposition II4
Let us denote Gi  t 7 sups0 s 0  Lipn1Pn
j1 Fij t Thanks to AF
1  and Fubinis
0 F11tdt  R T
Theorem we have for all T  0 ER T
EF11tdt   In particular for all
1  i j  n t 7 Fij t is locally integrable almost surely Hence there exists a subset  of
probability 1 such that on  Gi is locally integrable for all i Fixing the Gis one can apply
Lemma B1 with ai  Lip and gi  Gi to deduce that the processes N i
are dominated
by the processes  N i
dened by 85 and so are well-dened
t i1n
t i1n
dominating processes We have
t  E 1
It remains to show that the function t 7 Ecid2N 1
Gitdt  Lip
Xi1Z t
E Git dt  LipZ t
Xi1Z t
MH t  zE
t
 dt
where we used Lemma B3 Next t 7 E Git  sups0 s 0  LipE F11t is locally
ti  Eh N 1
bounded and MH is locally integrable so Lemma B4-i gives that t 7 Ehn1Pn
tcid3 is locally bounded First let us study the
N jdz
0 Z t
Xi1Z t
 dt
MH t  tE
is locally bounded Finally the stochastic domination in particular EN 1
result
t   E N 1
t  gives the
A2 Proof of Proposition III1
First in order to be consistent with the formalism used in 7 we must rewrite the system 15 in
a single equation in the following way
u t s
u t s
 N1t s u  s0n2t u
with initial condition uin where
N1t s u  f t sut s
n2t u R 
f t sut sds
The use of the Dirac mass localized in age equal to 0 represents the boundary condition that is
the second equation of 15
Note that the general result 7 Theorem 24 gives existence and uniqueness of solution in
BCRMR and not BCRMR even if the initial condition has support contained in
R However as explained in 7 Section 33 it suces to extend the equation for s in R to
apply 7 Theorem 24 and then to check that the support of the solution is conserved in the sense
that if uin has support on R then the unique solution given by the Theorem has also support
contained in R for all time t  0
Hence consider Equation 50 but with s being in R by mirror symmetry for deniteness that
is N1t s u  N1ts u and so f t s  f ts Let us check that the assumptions of 7
Theorem 24 are satised
-H1 and H2 are clearly satised
-H3 We need to verify that N1 and n2 are continuous in t with respect to the usual topology
and in u with respect to the topology induced by the bounded Lipschitz norm denoted by BL
On the one hand using the boundedness of f  we have with ut denoting the measure ut
N1t  t s u  u  N1t s uBL  sup
sR f t  t s  f t sutBL
 futtBL  futt  utBL
As t and u converge to 0 the rst term converges to 0 since f is uniformly in s continuous with
respect to t the second one clearly converges to 0 and the third one converges to 0 since u belongs
to BCRMR
On the other hand using once again the boundedness of f  we have
n2t  t u  u  n2t u  sup
which converges to 0 as t tends to 0
sR f t  t s  f t sutBL  futt  utBL
-H4 It suces to show that N1 and n2 are Lipschitz continuous with respect to the variable
u On the one hand we have
On the other hand we have
N1t s u  N1t s vBL  fut  vtBL
n2t u  n2t v  fut  vtBL
-H5 Here it suces to check that N1t s u  s0n2t u carries bounded sets in total
variation norm to bounded sets in total variation norm Denoting T V the total variation norm
we have N1t s u  s0n2t uT V  2fuT V 
Finally the argument to prove conservation of the support for solutions being the same as the
one elaborated in 7 Section 33 it is not reproduced here
A3 Proof of Proposition III2
The method of characteristics applied to the rst equation of 15 suggests to consider
 for all z  0 uz  t 7 ut t  z satisfying
uzt  f t z  tuzt
hence for all t  0
uzt  uz0 expcid18Z t
f t z  tdtcid19
and so using that uz0  uinz and letting s  z  t one has 18
 for all z  0 uz  s 7 us  z s satisfying
uzs  f s  z suzs
hence for all s  0
uzs  uz0 expcid18Z s
f s  z sdscid19
and so using that uz0  uz 0 and letting t  z  s one has
ut s  ut  s 0 expcid18Z s
f t  s  s sdscid19 
for t  s
which is not exactly 19 Here ut  s 0 is just a parameter which is not constrained by
the rst equation of 15 However it is characterized by the second equation of 15 as
explained below
For any T  0 consider the application
GT  L0 T  
L0 T 
7 t 7 Gu0t 
Gu0t Z t
f t su0t  s expcid18Z s
Z 
f t  s  s sdscid19 ds
f t suins  t expcid18Z t
f t s  t  tdtcid19 ds
Note that the characteristics and the second equation of 15 suggest that denoting u the solution
of 15 u 0 is bounded and that its trace on 0 T  is a xed point of GT  Using the boundedness
of f and the fact that the argument in the exponential is non-positive we have for any u0 v0 in
L0 T 
GT u0t  GT v0t  fZ t
0 u0t  s  v0t  sds  Tfu0  v0L0T 
Now x T  0 such that Tf  12 so that GT is a contraction and admits a unique xed
point Note that GT maps non-negative functions to non-negative functions so that the xed point
of GT is a non-negative function Iterating this xed point gives the existence and uniqueness of a
locally bounded function u0 which is non-negative such that for all t  0 u0t  Gu0t see
the end of the proof of Lemma III4 for the same kind of argument in a more detailed form Until
the end of the proof u0 will denote this xed point
It only remains to check that u is a solution of 15 in the weak sense Let  be in C
compute RR2
scid1  t s u t s dtds Sticking with the decomposition of the representation
given by 18-19 and using integration by parts to go backward in the heuristic given by the
method of characteristics one has
cid0 
 let us
t  
Zstcid18 
scid19  t s u t s dtds Zst
t sf t sut sdtds Z 
0 suinsds
Ztscid18 
scid19  t s u t s dtds Zts
t sf t sut sdtds Z 
t 0u0tdt
Remarking that the denition of u0 as the xed point of G gives that u dened by 18-19 satises
the second equation of 15 in a strong sense one deduces that 17 is satised by gathering 51
and 52
A4 Proof of 28
Let Y1 and Y2 be two xed locally bounded functions and denote u1  uY1 and u2  uY2 the two
solutions associated with Y1 and Y2 with same initial condition uin and ut  u1t 0  u2t 0
for all t  0 Using the characteristics ie 18 and 19 one deduces from the second equation
in 26 that for i  1 or 2 uit 0  0t
i  t
t
Z 
s Yit  f0tuit  s 0 expcid18Z s
s Yit  f0tuins  t expcid18Z t
s Yit  s  s  f0t  s  sdscid19 ds
s  t  t Yit  f0tdtcid19 ds


and so ut  At  Bt where At  0t
 Before studying the
functions A and B let us remark that in order to prove 28 it suces to prove that there exists
a non-decreasing function C which depends neither on the initial condition nor on f0 such that
for all T  0
2 and Bt  t
1  t
1  0t
uL0T   CT Y1  Y2L0T 
Indeed using the denition of FT given by 27 one then deduces that for all T  0
FT Y1  FT Y2L0T   CT Y1  Y2L0T Z T
hzdz
and since h is locally integrable and C is non-decreasing there exists T  0 small enough such
0 hzdz  12 which ends the proof To prove 53 let t be a positive real number
that CT R T
Study of A We have A  A1  A2  A3 with
A1t Z t
A2t Z t
A3t Z t


s Y1t  f0t  s Y2t  f0tu1t  s 0e R s
s Y2t  f0tu1t  s 0  u2t  s 0e R s
s Y2t  f0tu2t  s 0eR s
 e R s
0 sY1f0ds
0 sY1f0ds
0 sY1f0ds
0 sY2f0ds
where the arguments t  s  s in the exponentials are not written for simplicity
is non-positive and the a priori bound on u1 we have
- Study of A1 Using the Lipschitz continuity of  the fact that the argument in the exponential
A1t  LipZ t
u1t  s 0Y1t  Y2tds  Lipu1LR2
 tY1t  Y2t
 Lip maxM tY1  Y2L0t
- Study of A2 Using the boundedness of  and the fact that the argument in the exponential
is non-positive we have
A2t  Z t
0 u1z 0  u2z 0dz  Z t
0 uz 0dz
- Study of A3 The arguments of the exponentials are non-positive and the exponential function
is Lipschitz with constant 1 on R so using the a priori bound on u2 we have
A3t  u2LR2
s Y1  f0ds Z s
0 cid12cid12cid12cid12
s Y2  f0dscid12cid12cid12cid12
  maxMLipZ t
0 Y1t  s  s  Y2t  s  s dsds
  maxMLip t2 Y1  Y2L0t
where the arguments t  s  s are not written in the rst equation for simplicity
Study of B We have B  B1  B2 with
B1t Z 
B2t Z 
s Y1t  f0t  s Y2t  f0t
uins  t expcid18Z t
s Y2t  f0tuins  t
s  t  t Y1t  f0tdtcid19 ds
e R t
0 sttY1tf0tdt
0 sttY2tf0tdt
 e R t
- Study of B1 Using the Lipschitz continuity of  and the fact that the argument in the


exponential is non-positive we have
Y1t  Y2tuins  tds  LipY1  Y2L0t
B1t  LipZ 
uinsds  1
- Study of B2 As for A3 we have
where we used that R 
B2t  Z 
uins  t
cid12cid12cid12cid12
s  t  t Y1t  f0t  s  t  t Y2t  f0tdtcid12cid12cid12cid12
0 Y1t  Y2t dtds
 LipZ 
uins  tZ t
 Lip tY1  Y2L0t
where we used once again that R 
such that for all t  0
uinsds  1
Gathering 54 55 56 57 and 58 we get that there exists a non-decreasing function g
ut  gtY1  Y2L0t  Z t
0 uzdz
Then Lemma B4-i gives that for all T  0
uL0T   CT sup
t0T cid8gtY1  Y2L0tcid9 
with CT being a non-decreasing function of T  Then 53 follows since g is non-decreasing
A5 Proof of Proposition III7
-i Suppose that N tt0 is a solution of 14 Then the mean cumulative intensity t 
EN t is a non-decreasing locally bounded function satisfying
t Z t
0 Z t
ht  zdz  f0t dt
for every t  0
By Lemma B5 we know that 59 admits a unique solution which is furthermore of class C1 and
we denote  its derivative Thus we have Ecid2N dtcid3  
-ii The rst equation of 34 is a classical thinning equation so its solution N tt0 is a
tdt  tdt
measurable function of  hence it is unique once  is xed
To conclude this step it suces to check that N tt0 satises the second equation of 34
where we remind that  is the derivative of  which is the unique solution of 59 But EN t 
0 tdt since  is a solution of 59
0 htzzdzf0tdt which is equal to t R t
Finally the two remaining points are rather simple First taking the derivative of 59 gives
14 and i tells that a solution of 14 is necessarily a solution of 34 which gives uniqueness
0 ht  zzdz  f0tcid17 Secondly the solution of 34 is clearly a solution of
0 0R t
that t  0cid16R t
A6 Proof of 43
For simplicity of notations in 37 and 38 let us denote for all t  0
Xj1cid18Z t
Hijt  zN nj
 dz  Fij tcid19 
mH t  zzdz  mF t
t Z t


where  is dened either in Proposition III6 under H1 or III7 under H2 We have ni
Sni
depend on i whereas ni is random
t t Notice that  is a deterministic function which does not
 and 
t  S
t  ni
First point of 43 Assume that H1 is satised Then one can use the decomposition
and the fact that n1
t  
n Z 
Let us denote
t S
t  1
t 6S
t S1
ti dt  Z 
t   to deduce from 42 that
tcid12cid12cid12
t  
An Z 
Dn Z 
Ehcid12cid12cid12
Pcid16Sn1
tcid12cid12cid12
tcid17 dt
t  
t 6 S
t S
Ehcid12cid12cid12


t 6 S
Pcid16Sn1
ti dt
tcid17 dt
Study of An Using the Lipschitz continuity of  it is clear that for all t in 0  if
t then n1
t  
t  Lipn1
An  LipBn
t  t So one deduces that
3   Cn
1   Bn
2   Bn
t  S


H1jt  zN nj
1  Z 
Ehcid12cid12cid12Z t
2  Z 
Ehcid12cid12cid12Z t
3  Z 
Ehcid12cid12cid12Z t
Cn Z 
Ehcid12cid12cid12
1  Firstly using AH
H1jt  zN
Xj1cid16H1jt  z
F1jt  mF tcid12cid12cid12idt
H1j t  zcid12cid12cid12cid12cid12cid12
Xj1cid12cid12cid12
MH t  zcid12cid12cid12
1   Z 
 Z 
MH t  zdj
- Study of Bn
  and then Lemma B3 we have
 dz  N
dz  
dzcid12cid12cid12idt
zdzcid12cid12cid12idt
z  mH t  zzcid17 dzcid12cid12cid12idt
 dz  N
 dz  N
dzcid12cid12cid12idt
dzcid12cid12cid12idt
nzidt Z 
MH   znzdz
where the j
ns are given in 40
- Study of Bn
2  Secondly using Cauchy-Schwartz inequality we have
zdzcid12cid12cid12
2  
H1jt  zN
Xj1Z t
Ehcid12cid12cid12
dz  
Xj1Z t
zdzi12
H1jt  z2
0 cid16nZ t
MH t  z2dzcid1712
0 cid18Z t
 Z 
MH t  z2dzcid19
n12
B2
  and the fact that 
by computing the bracket of a sum over a compensated point process see 19 Proposition II41
using AH
z Since
z is the intensity of a solution of the limit equation it is independent of H1j Moreover the H1js
are independent see 8 and the 
3  Let us x some t in 0  and z in 0 t and denote Yj  H1jt  z
s are independent so the Yjs are independent Hence
is bounded by 
- Study of Bn
E Yj  E H1jt  z Eh
zi  mH t  zz
Var Yj  Var H1jt  z Varcid16
On the one hand it follows from AH
other hand it follows from A
zcid17  Var H1jt  z z2  mH t  z2Varcid16
  that VarH1js  MH s2 for all s  0 On the
 for all z  0 Finally 67 leads to
z  2
 that Var
zcid17 
Var Yj  3MH t  z22
Using the fact that the Yjs are independent one has
 since mH is dominated by MH and  is bounded by 
So starting from the denition of Bn
3  thanks to Cauchy-Schwartz inequality one has
H1jt  z
  E
cid12cid12cid12cid12cid12cid12
3   Z 
0 cid18 3
MH t  z22
nZ 
z  mH t  zzcid12cid12cid12cid12cid12cid12
 
cid1912
MH t  zdzdt 
MH t  z22
B3
- Study of Cn Since for all t  0 F11t     F1nt are iid random variables see 9 with
expectation mF t and variance VF t one deduces from Cauchy-Schwartz inequality that
Cn 
nZ 
VF t12dt 
C
Finally one deduces from 63 65 66 68 and 69 that
An 
Lip
n cid16 B2  B3  Ccid17  LipZ 
MH   znzdz
Study of Dn Since the initial conditions of N n1 and N
0 as If at a xed time t  0 Sn1
holds that Sn1
between 0 and t which is not common to both N n1
hence PSn1
piecewise constant with jumps of height 1 as it is clear that
t 6 S
t 6 S
are the same equal to N 1
 it
t then there is at least one point
 that is supt0t N ni
 and N
t 6 0
t 6 0 Moreover since counting processes are
t  N
t  Psupt0t N ni
t  N
t 6 0  P  sup
t  N
t0tN n1
t0t N n1
t  N
t  1  E sup
where we used Markovs inequality Using 41 one has Pcid16Sn1
t 6 S
t 
t0tN n1
t  N
tcid17  nt and so
Dn Z 
ntdt
Rewriting 62 under the form n  An  Dn one deduces from 70 and 71
n 
Lip
n cid16 B2  B3  Ccid17 Z 
  LipMH   z nzdz
where B2 B3 C are respectively dened in 66 68 and 69 Since MH is locally square
integrable  7 B2 is locally bounded since MH is locally integrable  7 B3 is locally
bounded since VF is locally square root integrable  7 C is locally bounded Hence we proved
the rst point of 43
Second point of 43 Assume that H2 is satised Then the decomposition 61 is not helpful
anymore Whatever the age processes are one always has ni
 and 
t  0t for
all i  1     n and t  0 Remark that in this case the intensities 
of the limit processes dened
by 38 are deterministic and equal to  dened in Proposition III7 Instead of 62 one should
t  0ni
start from n R 
t  
En1
n  Lip0Bn
tdt One can prove in the same way as above that
1   Bn
2   Bn
3   Cn
1  Bn
where Bn
in the study of Bn
1ssumption A0 
- Study of Bn
we have
2  
3 and Cn are dened by 64 Since the uniform boundedness of  was not used
1 and Cn then 65 and 69 still hold It remains to control Bn
3 under
2 and Bn
2  Firstly remind that for all j 
t  t so using Cauchy-Schwartz inequality
dz  zdzcid12cid12cid12
Xj1Z t
Ehcid12cid12cid12
H1jt  zN
Xj1Z t
H1jt  z2zdzi12
0 cid18Z t
nZ 
MH t  z2zdzcid19
B2
by computing the bracket of a sum over a compensated point process see 19 Proposition II41
and then using AH
- Study of Bn
3  Secondly since 
t  t for all j then Bn
3 rewrites as
3  Z 
Ehcid12cid12cid12Z t
H1jt  z  mH t  z zdzcid12cid12cid12idt
Z 
Ehcid12cid12cid12
H1jt  z  mH t  zcid12cid12cid12izdzdt
Using Cauchy-Schwartz inequality the fact that the H1js are iid with mean function mH and
that for all s  0 VarH1js  MH s2 which follows from AH
3  Z 
Var H1j t  z12 zdzdt 
MH t  zzdzdt 
nZ 
  we have
B3
Finally one deduces from 73 65 74 75 and 69 that
n 
Lip0
cid16B2  B3  Ccid17 Z 
Lip0MH   znzdz
where B2 B3 C are respectively dened in 74 75 and 69
Since MH is locally square integrable and  is continuous  7 B2 is locally bounded since
MH is locally integrable and  is continuous  7 B3 is locally bounded since VF is locally
square root integrable  7 C is locally bounded Hence we proved the second point of 43
A7 Proof of Proposition IV2
-1 Assume that H1 is satised The mean intensity  dened in Proposition III6 is clearly
uniformly bounded by 
Looking at 72 one wants to nd some uniform bounds on B2 B3 C respectively dened in
66 68 and 69 Firstly since MH is square integrable and  is uniformly bounded it is clear
from 66 that
B2  MH212
 
Secondly using the integrability of MH and the boundedness of  one deduces from 68 that
Finally since VF is uniformly bounded one deduces from 69 that
B3 
3MH1
C  VF 12
 
Moreover using the fact that n is a non-decreasing function we nd with   LipMH1
0 LipMH   znzdz  n
0 nzdz  n
Gathering 77 78 79 and 80 one deduces from 72 that
n 
Lip
n cid16MH212
  3MH1  VF 12
 cid17     n
which leads to n   H  F n12 with
 H  F  
Lip
1    cid16MH212
  3MH1  VF 12
 cid17 
as soon as     1 ie   1  
-2 Assume H2 is satised Under the assumptions of Proposition IV2 the mean intensity 
dened in Proposition III7 is uniformly bounded thanks to Lemma B6
Looking at 76 one wants to nd some uniform bounds on B2 B3 C respectively dened in
74 75 and 69 In the same way as above one can deduce from 74 75 and 69 that
B2  MH212
B3  MH1
C  VF 12
 

Using 82 and the rst equation of 80 which is still valid is this case one deduces from 76 that
n 
Lip
n cid16MH212
  MH1  VF 12
 cid17   n
which leads to n   H  F n12 with
 H  F  
Lip
1   cid16MH212
 cid17 
  MH1  VF 12
for every   0 Notice that an explicit expression of  with respect to MH  mF and  can
be obtained thanks to Lemma B6
B Lemmas
B1 Point processes
Here we collect some technical lemmas about point processes
The following lemma is used to show the well-posedness of the studied point processes
Lemma B1 Let n  1 be an integer let gii1n be a family of locally integrable functions
aii1n be a family of non-negative real numbers and h  R  R be a locally integrable function
Let idt dxi1 be some iid F-Poisson measures with intensity 1 on R2
Let N i
t i1n
be a family of counting processes such that for i  1  n and all t  0 
x  i
where the is are F-predictable processes such that i
t  git  ai
Then the linear multivariate Hawkes process  N i
dened by
t i1n
idt dx
0 Z 
ht  zN jdz
j1R t
0 Z 
nx  git  ai
Xj1Z t
idt dx
ht  z N jdzo
is such that for all i  1     n N i stochastically dominates N i in the sense that N i  N i where N i
resp N i denotes the point process associated with the counting process N i
t t0
In particular the processes N i
t t0 resp  N i
are well-dened
t i1n
Proof First let us note that the processes  N i
are well-dened by the Galton-Watson
representation of the linear Hawkes process introduced in 23 when the gis are constant in time
see 8 Proposition B3 when the gis are more generally locally integrable functions
t i1n
We are going to show by induction that
t  i
t  git  ai
t  0 i
ht  u N jdu
Xj1Z t
N i the respective
Indeed for all time t less than the rst point of either N  n
t Hence the rst point of N  N denoted by T1 is a
intensities are such that i
point of N and possibly a point of N  Let us denote Tkk1 the ordered sequence of the points
of N  N 
t for all t  Tk0 Then
it is clear that for every k  1     k0 Tk  N  hence for every i  1     n N i stochastically
dominates N i up to time Tk01 Moreover it implies that for every i  1     n and for all t in
Tk0 Tk01
Let us x some k0  1 Suppose that for every i  1     n i
i1N i or N  n
t  git  i
t  i
t  git  ai
 git  ai
Xj1Z t
Xj1Z t
ht  zN jdz
ht  z N jdz  i
since h is a non negative function Therefore by induction on k the desired stochastic domination
holds true for all time In particular the dominated processes are well-dened
Lemma B2 If N admits the bounded F-intensity t and Stt0 denote its associated age
process then the distribution of St denoted by wt is such that t 7 wt belongs to BCRPR
Proof This continuity result comes from the fact that the probability that N has a point in an
interval goes to 0 as the size of the interval goes to 0 Indeed let t t be positive real numbers
zdz goes to 0 as t goes to 0 Moreover
Pcid0N t t  t 6 0cid1  Ecid2N t t  tcid3  ER tt
Stt  St  t as soon as there is no point of N in the interval t t  t and so one has
W1wtt  wt  Ecid2mincid0cid12cid12Stt  Stcid12cid12  1cid1cid3  t  Pcid0N t t  t 6 0cid1 t0
reminding that W1 denotes the modied Wasserstein distance dened in 16 The same argument
for t  0 gives continuity
B2 Analytic lemmas
Here we collect some analytic lemmas regarding the convolution equations used throughout the
present paper First here are two lemmas introduced in 13
The rst one is an easy application of Fubinis Theorem 13 Lemma 22
Lemma B3 Let   R  R be locally integrable and let   R  R have bounded variations
on compact intervals satisfying  0  0 Then for all t  0
 s  u d u ds Z t
 t  s  s ds
where the integral has to be understood in the Stieltjes sense
The second one is a rather classical generalization of Gronwall Lemma 13 Lemma 23
Lemma B4 Let   R  R be locally integrable and g  R  R be locally bounded
i Consider a locally bounded non-negative function u such that for all t  0 ut  gt 
0  t  s usds Then supt0T  ut  CT supt0T  gt for some constant CT depending
only on T  0 and  Moreover CT can be taken as a non-decreasing function of T 
ii Consider a sequence of locally bounded non-negative functions un such that for all t  0 all
t  CT  for some constant CT
n  0 un1
depending only on T  0 u0 and 
s ds Then supt0T Pn0 un
0  t  s un
 R t
 gt R t
iii Consider a sequence of locally bounded non-negative functions un such that for all t  0 all
t  CT  for some constant
n  0 un1
CT depending only on T  0 u0 g and 
s ds Then supt0T  supn0 un
0  t  s un
Note that we added to the rst statement that CT can be taken as a non-decreasing function
of T  It is not given in 13 Lemma 23 but it is a direct consequence of the proof
Then here is a well-posedness result which is a generalization of 13 Lemma 24
Lemma B5 Let   R  R be Lipschitz-continuous h  R  R be locally integrable and
f0  R  R be continuous The equation
 Z t
ht  zdmz  f0t dt
mt Z t
has a unique locally bounded solution Furthermore m is of class C1 on R
Proof The proof is similar to 13 Lemma 24 We refrain from reproducing it here instead we
only indicate the minor changes that are required to make it t the current framework ie the
addition of the function f0 The uniqueness part is exactly the same The existence part
requires f0 to be locally integrable in order to have locally boundedness in the Picard iteration
Finally we need f0 to be continuous to show by induction that at each step of the Picard iteration
the function is C1 on R and so it is for the limit that is the solution of 86
Here is given an analytic result which is used to give a uniform bound on the mean intensity
of a Hawkes process under stationary conditions
Lemma B6 Let   R  R be Lipschitz-continuous and h  R  R be integrable such that
Liph1  1 Moreover let f0  R  R be uniformly bounded
If g  R  R is a continuous function satisfying
gt  cid18Z t
ht  ugudu  f0tcid19
for every t  0 then g is uniformly upper bounded by
0  Lipf0
1  Liph1
Proof For any t  0
gt  0  Lipcid18Z t
0 ht  ugudu  f0cid19
hence thanks to the continuity of g for every T  0
t0T 
gt  0  Lip h1 sup
t0T 
gt  f0
t0T 
gt 
1  Liph1
0  Lipf0  M
References
1 E Bacry K Dayri and J-F Muzy Non-parametric kernel estimation for symmetric hawkes
processes application to high frequency nancial data The European Physical Journal B-
Condensed Matter and Complex Systems 855112 2012
2 E Bacry S Delattre M Homann and J F Muzy Scaling limits for Hawkes processes and
application to nancial statistics Feb 2012
3 P Bao H-W Shen X Jin and X-Q Cheng Modeling and predicting popularity dynamics
of microblogs using self-excited hawkes processes arXiv preprint arXiv150302754 2015
4 P Bremaud Point processes and queues Springer-Verlag New York 1981 Martingale
dynamics Springer Series in Statistics
5 P Bremaud and L Massoulie Stability of nonlinear Hawkes processes Ann Probab
24315631588 1996
6 N Brunel and V Hakim Fast global oscillations in networks of integrate-and-re neurons
with low ring rates Neural computation 11716211671 1999
7 J A Canizo J A Carrillo and S Cuadrado Measure solutions for some models in population
dynamics Acta applicandae mathematicae 1231141156 2013
8 J Chevallier M J Caceres M Doumic and P Reynaud-Bouret Microscopic approach of a
time elapsed neural model arXiv150602361 to appear in M3AS 2015
9 E Chornoboy L Schramm and A Karr Maximum likelihood identication of neural point
process systems Biological Cybernetics 594-5265275 1988
10 R Crane and D Sornette Robust dynamic classes revealed by measuring the response function
of a social system Proceedings of the National Academy of Sciences 105411564915653
11 F Delarue J Inglis S Rubenthaler and E Tanre Particle systems with a singular mean-eld
self-excitation application to neuronal networks Stochastic Processes and their Applications
125624512492 2015
12 F Delarue J Inglis S Rubenthaler E Tanre et al Global solvability of a net-
worked integrate-and-re model of mckeanvlasov type The Annals of Applied Probability
25420962133 2015
13 S Delattre N Fournier and M Homann High dimensional hawkes processes arXiv preprint
arXiv14035764 2014
14 O Faugeras and J Maclaurin Asymptotic description of stochastic neural networks i exis-
tence of a large deviation principle Comptes Rendus Mathematique 35210841846 2014
15 O Faugeras J Touboul and B Cessac A constructive mean-eld analysis of multi-population
neural networks with random synaptic weights and stochastic inputs Frontiers in computa-
tional neuroscience 3 2009
16 N Fournier and A Guillin On the rate of convergence in wasserstein distance of the empirical
measure Probability Theory and Related Fields pages 132 2014
17 N Fournier and E Locherbach On a toy model of interacting neurons arXiv preprint
arXiv14103263 2014
18 A Galves and E Locherbach Modeling networks of spiking neurons as interacting processes
with memory of variable length arXiv preprint arXiv150206446 2015
19 R D Gill N Keiding and P K Andersen Statistical models based on counting processes
Springer 1997
20 G Gusto and S Schbath Fado A statistical method to detect favored or avoided distances
between occurrences of motifs using the hawkes model Statistical Applications in Genetics
and Molecular Biology 41 2005
21 N R Hansen P Reynaud-Bouret V Rivoirard et al Lasso and probabilistic inequalities for
multivariate point processes Bernoulli 21183143 2015
22 A G Hawkes Spectra of some self-exciting and mutually exciting point processes Biometrika
5818390 1971
23 A G Hawkes and D Oakes A cluster process representation of a self-exciting process Journal
of Applied Probability pages 493503 1974
24 P Hodara and E Locherbach Hawkes processes with variable length memory and an innite
number of components arXiv preprint arXiv14105235 2014
25 Y Y Kagan Statistical distributions of earthquake numbers consequence of branching
process Geophysical Journal International 180313131328 2010
26 A Klenke Probability theory a comprehensive course Springer 2007
27 P A W Lewis and G S Shedler Simulation of nonhomogeneous Poisson processes by
thinning Naval Research Logistics Quarterly 263403413 1979
28 T J Liniger Multivariate hawkes processes PhD thesis Diss Eidgenossische Technische
Hochschule ETH Zurich Nr 18403 2009 2009
29 E Lucon and W Stannat Mean eld limit for disordered diusions with singular interactions
The Annals of Applied Probability 24519461993 2014
30 L Massoulie Stability results for a general class of interacting point processes dynamics and
applications Stochastic processes and their applications 751130 1998
31 S Meleard Asymptotic behaviour of some interacting particle systems McKean-Vlasov and
Boltzmann models In Probabilistic models for nonlinear partial dierential equations Mon-
tecatini Terme 1995 volume 1627 of Lecture Notes in Math pages 4295 Springer Berlin
32 G O Mohler M B Short P J Brantingham F P Schoenberg and G E Tita Self-exciting
point process modeling of crime Journal of the American Statistical Association 106493
33 I Muni Toke and F Pomponio Modelling trades-through in a limited order book using
hawkes processes Economics discussion paper 2011-32 2011
34 Y Ogata On Lewis simulation method for point processes IEEE Transactions on Information
Theory 2712330 1981
35 Y Ogata Space-time point-process models for earthquake occurrences Annals of the Institute
of Statistical Mathematics 502379402 1998
36 K Pakdaman B Perthame and D Salort Dynamics of a structured neuron population
Nonlinearity 23155 2010
37 K Pakdaman B Perthame and D Salort Relaxation and self-sustained oscillations in the
time elapsed neuron network model SIAM Journal on Applied Mathematics 73312601279
38 K Pakdaman B Perthame and D Salort Adaptation and fatigue model for neuron net-
works and large time asymptotics in a nonlinear fragmentation equation The Journal of
Mathematical Neuroscience JMN 41126 2014
39 B Perthame Transport equations in biology Springer Science  Business Media 2006
40 J W Pillow J Shlens L Paninski A Sher A M Litke E Chichilnisky and E P Simoncelli
Spatio-temporal correlations and visual signalling in a complete neuronal population Nature
4547207995999 2008
41 C Pouzat and A Chaol Automatic spike train analysis and report generation an imple-
mentation with r R2HTML and STAR Journal of Neuroscience Methods 1811119 
144 2009
42 C Quininao A microscopic spiking neuronal network for the age-structured model arXiv
preprint arXiv150300115 2015
43 P Reynaud-Bouret V Rivoirard F Grammont and C Tuleau-Malot Goodness-of-t tests
and nonparametric adaptive estimation for spike train analysis The Journal of Mathematical
Neuroscience JMN 41141 2014
44 P Reynaud-Bouret S Schbath et al Adaptive estimation for hawkes processes application
to genome analysis The Annals of Statistics 38527812822 2010
45 F Roue R Von Sachs and L Sansonnet Time-frequency analysis of locally stationary
hawkes processes prepublication on HAL 2015
46 A-S Sznitman Topics in propagation of chaos In Ecole d Ete de Probabilites de Saint-Flour
XIX1989 volume 1464 of Lecture Notes in Math pages 165251 Springer Berlin 1991
47 L Zhu Nonlinear Hawkes Processes PhD thesis New York University 2013
