Limit theorems for Markovian Hawkes processes with a
large initial intensity
Xuefeng Gao 1 Lingjiong Zhu 2
December 8 2015
Abstract
Hawkes process is a class of simple point processes that is selfexciting and has
clustering eect The intensity of this point process depends on its entire past history
It has wide applications in nance neuroscience social networks criminology seismol-
ogy and many other elds In this paper we study the linear Hawkes process with an
exponential kernel in the asymptotic regime where the initial intensity of the Hawkes
process is large We derive limit theorems for this asymptotic regime as well as the
regime when both the initial intensity and the time are large
Introduction
Let N be a simple point process on R and let Ft
be an increasing family of -algebras Any nonnegative Ft
process t with
cid3  Ecid20Z b
cid21 
sdscid12cid12Fa
Ecid2N a bFa
as for all intervals a b is called an Ft
to denote the number of points in the interval 0 t
 N C C  BR C   t
-progressively measurable
-intensity of N  We use the notation Nt  N 0 t
A Hawkes process is a simple point process N admitting an Ft
-intensity
t  cid18Z t
ht  sN dscid19 
where   R  R is locally integrable left continuous h  R  R and we always
assume that khkL1 R 0 htdt   In 11R t
ht sN ds stands forP t ht  
where  are the occurrences of the points before time t In the literature h and  are
usually referred to as exciting function or sometimes kernel function and rate function
respectively A Hawkes process is linear if  is linear and it is nonlinear otherwise
The Hawkes process was rst proposed by Alan Hawkes in 1971 to model earthquakes
and their aftershocks 28 It naturally generalizes the Poisson process and it captures both
1Department of Systems Engineering and Engineering Management The Chinese University of Hong
Kong Shatin NT Hong Kong xfgaosecuhkeduhk
2Corresponding Author Department of Mathematics Florida State University 1017 Academic Way
Tallahassee FL-32306 United States of America zhumathfsuedu
the selfexciting property and the clustering eect In addition Hawkes process is a very
versatile model which is amenable to statistical analysis These explain why it has wide
applications in neuroscience genome analysis criminology social networks healthcare
seismology insurance nance and many other elds For a list of references we refer to
Throughout this paper we assume an exponential exciting function ht  et where
   0 and a linear rate function z    z where the base intensity   0 That is
we restrict ourselves to the linear Markovian Hawkes process3 To see the Markov property
we dene
etsN ds
Zt Z t
etsN ds  Z0  et Z t
Then the process Z is Markovian and satises the dynamics
dZt  Ztdt  dNt
where N is a Hawkes process with intensity t    Zt at time t In addition the pair
Z N  is also Markovian We also assume Z0  Z0 ie there is no jump at time zero
In the literature of nancial applications of Hawkes processes the exponential exciting
function and thus the Markovian case together with the linear rate function is the most
widely used due to the tractability of the theoretical analysis as well as the simulations
and calibrations See eg the survey paper Bacry et al 3 and the references therein
In this paper we consider an asymptotic regime where Z0  n and n  R is sent to
innity We derive limit theorems functional law of large numbers and functional central
limit theorems for linear Markovian Hawkes processes in this asymptotic regime as well
as the regime when both the initial intensity and the time are large We do not study here
the nonMarkovian case which may require a dierent approach since knowing the value
of Z0 is not sucient to describe the future evolution of a nonMarkovian Hawkes process
Our main results Theorem 14 are mainly oriented to develop approximations for the
transient behavior of Hawkes processes with large initial intensity 0 Note that 0  Z0
so when Z0 is large we have 0 large In practice this means the intensity of arriving events
observed at time zero is considerably larger than the base intensity  Our results could
be potentially useful for applications where Hawkes process is a relevant model As an
example consider stock trading Arrivals of trades or orders are usually clustered in time
and can be modeled by Markovian Hawkes processes see eg Bowsher 7 Da Fonseca
and Zaatour 11 Hewlett 30 If the current trading intensity of a stock is high a given
large value then our asymptotic analysis can help approximate the volume duration ie
the waiting time until a predetermined buy or sell volume is traded4 Such a volume
3Note that the Hawkes process is in general nonMarkovian When the exciting function is given by
sum of exponential functions the Hawkes process is Markovian For simplicity of presentation we focus on
a single exponential function in this paper
4Assuming trade size is a constant given by the average trade size over a certain time window
duration is useful in measuring the time costs of liquidity in the trading process see
eg Gourieroux et al 23 Hautsch 27 As an another example consider portfolio credit
risk Hawkes processes have been proposed to capture the clustering eect in the arrival of
company defaults in a portfolio see eg Errias et al 19 Our asymptotic analysis can
help approximate the number of corporate defaults occurring over a given time interval
when the initial intensity of defaults is high such as during a nancial crisis
We now explain the dierence between our work and the existing literature Note
that almost all the existing literature on limit theorems for Hawkes processes are for large
time asymptotics eg the functional law of large numbers and functional central limit
theorems in Bacry et al
2 the large deviations principle in Bordenave and Torrisi 6
the moderate deviation principle in Zhu 48 for linear Hawkes processes and see eg
Karabash and Zhu 35 Zhu 49 for the limit theorems for extensions of linear Hawkes
processes and the functional central limit theorems in Zhu 50 quantitative Gaussian and
Poisson approximations in Torrisi 45 46 the large deviations in Zhu 51 52 for nonlinear
Hawkes processes When z    z note that the large-time limit theorems mentioned
above hold under the socalled subcritical regime that is when khkL1  1 5 The critical
and supercritical regimes are when khkL1  1 and khkL1  1 respectively Those dierent
regimes rst appeared in Zhu 47 and the terminology comes from the GaltonWatson trees
because the linear Hawkes process has the well-known immigration-birth representation
see eg 29 The limit theorems for critical supercritical and other regimes have been
studied in Zhu 47 The limit theorems for the nearly critical or socalled nearly unstable
case was studied in Jaisson and Rosenbaum 33 34
Other than the large time asymptotics the large dimensional asymptotics of Hawkes
processes have been studied recently see eg Delattre et al 16 that is the asymptotics
for the multivariate nonlinear Hawkes process where the number of dimension goes to
innity The mean-eld limit was obtained in 16 for dierent regimes See also Chevallier
10 Hodara and Locherbach 32 Delattre and Fournier 15
To the best of our knowledge this is the rst paper to study the large initial value
asymptotics Z0  n   in the context of the Hawkes process Large initial value
asymptotics have been studied in the many dierent facets of applied probability For
example in queueing networks if the initial total queue length is large one may derive a
deterministic model so called uid limit for the system Such a uid limit model is useful
in understanding the stability and thus the performance of multiclass queueing networks
see eg Bramson 8 Dai and Meyn 13 As an another example consider mathematical
biology where the large initial value corresponds to the large initial population
context of birthdeath processes the large initial value asymptotics have been obtained as
the applications to study the cancer dynamics see eg Foo and Leder 20 and Foo et al
21 and the references therein
The rest of the paper is organized as follows In Section 2 we state our main results
5Note that one can also dene dierent regimes for nonlinear Hawkes processes see Zhu 47
In Section 3 we present the proofs of the main results The proofs of auxiliary results are
collected in the appendix
2 Main results
In this section we state our main results Note that processes Z and N both depend on
the initial condition Z0  n and one can use Z n N n to emphasize the dependence on
Z0  n For simplicity of notations we use Zt Nt to denote Z n
throughout this
paper Write Da b as the space of cadlag processes on a b  0 that are equipped
with Skorohod J1 topology see eg Billingsley 4
 N n
21 Limit theorems with large Z0
In this section we present limit theorems including functional law of large numbers FLLN
and functional central limit theorem FCLT for processes Z and N in the asymptotic
regime where Z0  n  
We rst state the FLLN for the processes Z and N 
Theorem 1 Fix any T  0 As n   we have
n  etcid12cid12cid12cid12
0tTcid12cid12cid12cid12
n  tcid12cid12cid12cid12
0tTcid12cid12cid12cid12
t  et1

almost surely
almost surely
  6 
  
We next state the FCLT for the processes Z and N  Recall that a Gaussian process is
called centered if its mean function is identically zero
Theorem 2 For any T  0 as n   the sequence of processes
 Zt  net
 t  0 T 
converges in distribution to a centered Gaussian process G on D0 T  where the covariance
function of G is given as follows for 0  s  t
CovGs Gt  2
 ets  et  6 
  
Furthermore the sequence of renormalized Hawkes processes
cid26 Nt  n  t
 t  0 T cid27
converges in distribution to a centered Gaussian process H on D0 T  where H is given
t  0 T 
The covariance function of H is given in 327 and 328
While we focus on the setting    0 it is helpful to consider the case     0 to
develop some intuition about the above results In such a special case we have Zt  Z0  n
for all t and the Hawkes process N becomes a homogeneous Poisson process with rate
  n The largeintensity limits of Poisson processes are wellknown when  is xed and
n   the Poisson process N satises the FLLN in 22 In addition the sequence of
renormalized Poisson processes in 26 converges in distribution to a standard Brownian
motion This is consistent with our FCLT for the case    where the limiting Gaussian
process H has a covariance function
CovHt Hs  s  st  2cid18 ts2
6 cid19 
for 0  s  t
and H becomes a standard Brownian motion when   0
We next discuss several properties of the limiting Gaussian processes G and H Note
that the theory of Gaussian processes is rich We refer the reader to textbooks by eg
Hida and Hitsuda 31 Lifshits 38 and Piterbarg 42 for introduction and comprehensive
treatment of Gaussian processes
 It is easy to see from the covariance functions that the limiting Gaussian processes
G and H are both nonstationary
 Recall see eg Revuz and Yor 43 p86 that a centered Gaussian process  with
covariance function s t  Est is Markovian if and only if
s ut t  s tt u
for every 0  s  t  u Thus we can directly check from the covariance functions of
G and H that the Gaussian process G is a Markov process and H is not In addition
we deduce from the Markov property of G and 27 that the joint process G H
is also Markovian This is not surprising since we know for each xed Z0  n the
process Z is Markovian the point process N is not Markovian but the pair Z N 
is Markovian
 In the critical case when    one readily nds from 25 that the limiting Gaussian
process G is actually a Brownian motion with drift zero and variance 2
 In both the subcritical and supercritical cases where  6  the limiting Gaussian
process G with covariance 25 also has a version with continuous sample path on the
bounded time interval 0 T  Hence the process H in 27 inherits such continuity
property One can readily verify this as follows note from 25 that Gth  Gt is a
Gaussian random variable with mean zero and variance given by
EGth  Gt2 
    eh  1  et  eth  1  e2t
Using the facts that 0  t  t  h  T and 1
C depending on   and T only we deduce that
  eh  1  Ch for some constant
EGth  Gt4  3cid0EGth  Gt2cid12
 C  h2
where C is a also constant only depending on   and T  Hence the continuity result
follows from Kolmogrovs continuity criterion see eg Revuz and Yor 43 p19
To illustrate the usefulness of our limit theorems let us consider the rst passage time
problem mentioned in the introduction For a given volume K we are interested the
waiting time K dened by K  inft  0  Nt  K where by convention the inmum
of an empty set is  When Z0  n is large we can approximate the distribution of K
using Theorem 2 as follows for each 0  t  
PK  t  PNt  K  Pnt  nHt  K  1    K  nt
pn  V arHt 
where  is given in 23 V arHt is the variance of Ht and  is the cumulative
distribution function of a standard normal random variable Thus the probability in 29
can be readily computed after one ts a Markovian Hawkes processes to the data and
estimates the parameters Z0  and  See eg Ozaki 41 Daley and VereJones 12
Chapter 7 for estimation methods and related issues
22 Limit theorems with large Z0 and large time
In this section we present limit theorems for processes Z and N in the asymptotic regime
where both Z0  n and the time go to innity Such limit theorems could provide insights
on the macroscopic behavior of the Hawkes processes with large initial intensity
When the time is sent to innity Hawkes processes behave dierently depending on
the value of khkL1 see eg Zhu 47 In our case the exciting function is exponential
ht  et So we have the following dierent casesregimes
 Supercritical   
 Subcritical   
 Critical   
 Nearlycritical   
We study each case separately
We rst state the FLLN for the process Z and the point process N when Z0 and the
time are both large
Theorem 3
i SuperCritical Case Assume that     0 and let n  log n
  For
any T  0 as n   we have
0sTcid12cid12cid12cid12
  
n1s  1cid12cid12cid12cid12
  nscid12cid12cid12cid12
n1s 
0sTcid12cid12cid12cid12
0sTcid12cid12cid12cid12
  
n1s  1cid12cid12cid12cid12
  nscid12cid12cid12cid12
0sTcid12cid12cid12cid12
almost surely
almost surely
in probability
in probability
ii SubCritical Case Assume that     0 and let tn  log n
  Then for any
0  T  1 as n   we have
We have almost surely convergence for 212 and 213 if 0  T  1
A few remarks are in order
 We choose to speed up the time by a factor of log n and scale the space accord-
ingly to ensure the convergence to a nontrivial limit Such a scaling simplies our
presentation and it is natural in view of 21 and 22 in Theorem 1
 In the subcritical case we restrict T  1 One can easily show that EZstn  n1s
see Proposition 5 which implies that EZstn  1 if s  1 Therefore the process
Z starts with a large number Z0  n and after tn unit of time it drops to one on
average Z is always positive So it makes sense to consider the law of large numbers
for Zstnn1s for 0  s  T where 0  T  1 Due to our proof technique the almost
surely convergence here is restricted to T  1
 We do not state the FLLN in the critical or nearlycritical case since the limit process
is trivial under appropriate time and space scalings as readily seen from the FCLT
result below
We next state the FCLT for the processes Z and N when Z0  n is large and the time
is speeded up in an appropriate way
Theorem 4 iCritical and Nearly Critical Cases Fix   0 and   R For Z0  n
dene n    
n  which is positive for all large n Assume that
dZt  Ztdt  ndNt
where the point process N has intensity   Zt at time t Then as n   we have
the sequence of processes cid8 Ztn
n  t  0 T cid9 converges in distribution to the process X on
D0 T  where X satises
where B is a standard Brownian motion In addition we have the sequence of renormalized
Hawkes processes cid8 Ntn
dXt    Xtdt  pXtdBt
 t  0 T cid9 converges in distribution toward the process
X0  1
cid26Z t
Xsds  t  0 T cid27
on D0 T 
iiSuperCritical Case Assume that     0 and let n  log n
2  as n   we have the sequence of processes
  For any 0  t 
cid26 Zsn  n1s
n12s
s  t T cid27 
converges in distribution to the process Y on Dt T  where Ys   for s  t T  and  is
a normal random variable with mean 0 and variance 2
  Moreover we have
 Nsn  n1sn

s  t T  
converges in distribution to the process
 on Dt T 
iii SubCritical Case Assume that     0 and let tn  log n
we have all the nite dimensional distributions of the processes
  For any 0  T  1
cid26 Zstn  n1s
n1s
s  0 T cid27 
converges in distribution to the corresponding nite dimensional distributions of a centered
Gaussian process R with covariance function CovRu Rv  2
 if u  v  0 and zero
otherwise
Discussions on Theorem 4
 Since   0 and X0  1 there is a unique strong solution X  0 to the stochastic
dierential equation 214 see eg Chapter IX in Revuz and Yor 43 The process
X is known as a squareroot diusion or a CoxIngersollRoss CIR process which
is widely used in modeling interest rate and stochastic volatility in nancial mathe-
matics In addition the properties of X and the time integral of X are well studied
See eg Dufresne 17 and GoingJaeschke and Yor 22
 In the critical case where   0 the process 4
2 X with X dened by 214 is also
known as the square of a 4
 dimensional Bessel process See eg Revuz and Yor
43 See also Hamana and Matsumoto 24 and 25 26 for further properties of
Bessel processes such as rst passage times
 In the nearly critical case when   0 we have 0  n   for each large n and
n approaches one as n   Such Hawkes processes are called nearly unstable
in Jaisson and Rosenbaum 33 In line with the results in 33 we obtain in this
nearly unstable case meanreverting CIR process in the limit for the process Z where
Z0 and the time are both sent to innity We also remark that since we consider a
dierent asymptotic regime compared with 33 we obtain a dierent initial condition
for the limiting process X in 214 In addition our result holds for general   R
 In the supercritical case the weak limit of the sequence of processes in 215 is
a constant normal random variable  Note that this processlevel convergence is
restricted to Dt T  for T  t  0 and such weak convergence can not be extended
to the space D0 T  which is readily seen after noting that Z0  n
 In the subcritical case the centered Gaussian process R with covariance function
CovRu Rv  2
 if u  v and zero otherwise is known to exist But such a
Gaussian process does not have a measurable version and hence a cadlag version
see eg Revuz and Yor 43 p37 Therefore we only have the convergence of nite
dimensional distributions for the sequence of processes in 217 but we do not have
processlevel convergence In other words the sequence of processes in 217 is not
tight Hence we also do not have or state weak convergence result for the Hawkes
process N when both Z0 and the time are large in this subcritical case
3 Proofs of Main Results
In this section we gather the proofs of our main results Theorem 14 For notational
simplicity in all the proofs we use C  0 as a generic constant which may vary line from
line The constant C may depend on    and T  but it is independent of n
Our proof strategy is to rst show the functional law of large numbers and functional
central limit theorems for processes Z and N when the base intensity  is zero and then
extend the proofs to the case when   0 Such a strategy relies critically on the observation
described in the next section
31 Decomposition of Hawkes processes
This section presents a decomposition result for linear Hawkes processes
The linear Hawkes process has the wellknown immigration birth representation see
eg 29 That is the immigrant arrives according to a homogeneous Poisson process
with constant rate  Each immigrant would produce children and the number of children
has Poisson distribution with parameter khkL1  
  Conditional on the number of the
children of an immigrant the time that a child was born has probability density function
 et Each child would produce children according to the same laws independent
of other children All the immigrants produce children independently The number points
of a linear Hawkes process on a time interval 0 t equals the total number of immigrants
and the descendants on the interval 0 t
Recall that we are interested in a Hawkes process N with intensity   Zt at time t
and Z0  n and
Zt  net Z t
etsdNs
By the immigration-birth representation we can decompose linear Hawkes process as
Nt  N 0
t  N 1
t  0
where N 0
is the number of points of the immigrants that arrive according to an inho-
mogenous Poisson process with rate net and all the descendants on the interval 0 t and
is the number of points of the immigrants that arrive according to a homogeneous
Poisson process with rate  and all the descendants on the interval 0 t Therefore N 0
is a simple point process with intensity Z 0 where
t  net Z t
etsdN 0
and in the dierential form
t  Z 0
t dt  dN 0
 Z 0
N 1 is a simple point process with intensity 1 where
   Z 1
t   Z t
etsdN 1
and in the dierential form
etsdN 1
t  Z 1
t dt  dN 1
 Z 1
In addition the two point processes N 0 and N 1 are independent of each other As a
result we also have
Zt  Z 0
t  Z 1
t  0
and the processes Z 0 and Z 1 are also independent of each other An alternative way to
see the validity of decompositions 31 and 32 is via the Poisson embedding technique
often used in the theory of point processes 9
Now we illustrate the very high level idea of our proofs of limit theorems The rst step
is to study the Hawkes process N with   0 In the decomposition N  N 0  N 1 we
note that N 1 is a linear Hawkes process which is empty on  0 Thus when   0
t  0 for any t  0 So we have N  N 0 and Z  Z 0 in this case Once we have
established limit theorems for Z 0 and N 0 we move to the second step consider Hawkes
process with   0 In view of the decompositions in 31 and 32 it suces to have
limit theorems for N 1 and Z 1 when n   This is relatively straightforward when we
consider a nite time horizon then N 1 and Z 1 do not contribute in the scaling limits
as they are independent of Z0  Z 0
0  n which goes to innity When we consider the
time also goes to innity the functional law of large numbers and central limit theorems
of N 1 have already been well studied in the literature So combining the limit theorems
we obtained for N 0 and Z 0 in the rst step we have the limit theorems for processes N
32 Preliminaries
This section presents preliminaries for proving the main results Throughout this section
N is a simple point process and its intensity at time t is given by Zt where dZt 
Ztdt  dNt That is we consider   0
N 0 t in terms of the intensity process Zt in the following way
We have the following immediate observation We can express the jump process Nt 
Zt  Z0
This relation is very useful once we prove limit theorems for process Z the identity 33
allows us to prove limit theorems for process N in a direct way
Dene for t  0
Mt  Nt Z t
variation hMit of this martingale is given by R t
Then M is a martingale with respect to the natural ltration and the predictable quadratic
0 Zsds see eg 39 It is readily seen that
dZt  net  Ztdt  dNt    netdt
   Zt  netdt  dMt
Therefore we have
Zt  net  etZ t
esdMs
We next summarize two results on the moments of Zt and related inequalities The
proofs are given in the appendix
Proposition 5 Suppose    0 We have
If    we have
EZtZ0  Z0et
t Z0  Z 2
t Z0  Z 3
0  2Z0t
0  32Z 2
4Z0t2  3Z0t
If  6  we have
t Z0  Z 2
t Z0  cid18Z 3
0 e2t 
32Z 2
  
cid18 32Z 2
  
  
e2t  et
2   
  2 
  2cid19 e2t cid18 3Z0
2  2cid19 e3t
2   
2  2cid19 et
Proposition 6 Given Z0  n suciently large we have
0tT
Ecid20cid16Zt  netcid174cid21  Cn2
esdMscid194  Cn22
Ecid18Z t
tT
for   0 t
In addition when  6  we have for any t  0
Ecid18Z t
 Ctcid20
esdMscid194
2  
1  e2t 
2  2 1  e2t 
3  2 1  e3tcid21 
Here C is a constant that may depend on    and T  but it is independent of n and t
321 Moment generating function of Zt
In this section we present a result on moment generating function of Zt which can be found
in Errais et al 19 for example We include it here since it is a critical tool in establishing
Gaussian limit in the functional central limit theorems Indeed in 19 they only discussed
the Laplace transforms But for the purpose of showing the convergence of distribution
we need convergence of moment generating functions in a neighborhood of zero
We rst note that for a Markovian Hawkes process N with intensity being Zt at time
t the Markov process Z has the innitesimal generator
Af z  z
 zf z    f z
where f  C 1
Indeed the operator A can be applied to unbounded functions f and
the boundedness assumption can be relaxed to Ef Zt nite for every t  0 in many
applications eg Kolmogorov backward equation see eg Remark 621 and Proposition
631 in 5
It is proved in Zhu 50 that there exists some c  0 so that for any   c EeNt  
In our case Zt  Z0  Nt and thus for any   c EeZt   Therefore we can apply
Proposition 631 in 5 and for   c the function uz t  EeZtZ0  z satises
the Kolmogorov backward equation
 z
uz 0  ez
 zuz   t  uz t
The above equation is ane and we can try the Ansatz uz t  eAtzBt Substituting
the Ansatz into the equations above we obtain
At  At  eAt  1
A0  
Bt  0
B0  0
This implies that Bt  0 for any t  0 For convenience in the following we will write
At instead of At to emphasize that A takes value  at time 0 Then we have
uz t  EeZtZ0  z  eAtz
We remark that in general the function A is not explicit in the sense that there is no
closed-form solution to the dierential equation system given by 38 and 39 One key
idea in establishing our central limit theorems is that we exploit perturbation theory see
eg 40 of dierential equations to show the convergence of certain moment generating
functions
33 Proof of Theorem 1
We prove Theorem 1 in this section We rst consider the case   0 and then extend the
proof to the case   0 using the observation in Section 31
331 Proof of Theorem 1 when   0
Proof of 21 When   0 let us recall from 34 that
Together with Doobs martingale inequality we have for any   0
esdMs
Zt  net  etZ t
 
n  etcid12cid12cid12cid12
0tTcid12cid12cid12cid12
 P 1  eT  sup
 n
0tTcid12cid12cid12cid12
esdMscid12cid12cid12cid12
Ecid18Z T
esdMscid19
41  eT 4
On combining with inequality 37 we obtain
0tTcid12cid12cid12cid12
n  etcid12cid12cid12cid12
  
Cn2  Cn
is nite the result 21 follows from the Borel-Cantelli lemma
Since Pn1
Proof of 22 By 21 we have
0tTcid12cid12cid12cid12cid12
 tcid12cid12cid12cid12cid12
almost surely as n  
where t R t
to show that
0 esds Since Mt  Nt R t
0 Zsds thus in order to show 22 it suces
n  0
0tT
almost surely as n  
Similar to the proof of 21 we can apply Doobs martingale inequality and 37 to show
that for any   0
0tT
n   
n44  Cn2  n
Thus 311 follows from Borel-Cantelli lemma
332 Proof of Theorem 1 when   0
As described in Section 31 when   0 we can decompose Zt  Z 0
and Z 1 are independent We have established in the previous section that
t  Z 1
t where Z 0
0tTcid12cid12cid12cid12cid12
n  etcid12cid12cid12cid12cid12
almost surely
In addition note that Z 1
almost surely as n   Now 21 immediately follows
parameter n we obtain N 1
Similarly we have Nt  N 0
is independent of Z 0
t  N 1
t when   0 Since N 1
T n  0 almost surely as n   Thus 22 follows
0  n and hence sup0tT Z 1
t n  0
is independent of the
34 Proof of Theorem 2
We prove Theorem 2 in this section
341 FCLT for Z when   0
In this section we prove the weak convergence of renormalized processes of Z in 24 on
D0 T  for the case   0 For notational simplicity we dene for Z0  n and each t  0
Zt 
Zt  net
Our approach is to apply Theorem 135 in Billingsley 4 In particular we verify the
following three conditions recall that G is a centered Gaussian process with covariance
a Gt  Gt converge to zero in distribution as   0
b Finitedimensional distributions of Z converge to those of G
c For 0  t    t    T  there exists a constant C independent of n such that
Eh Zt  Zt2 Zt  Zt2i  C2
We rst prove a When    we know G is a Brownian motion with mean zero
and variance 2 Hence EGt  Gt2  2 which goes to zero as   0 Hence
by Chebychevs inequality we conclude that Gt  Gt  0 in distribution as   0
When  6  we nd from 28 that EGt  Gt4  C2 Hence Gt  Gt  0 in
distribution as   0 by Chebychevs inequality
We next prove b We rst show that for each xed t  0 the sequence of random
variables  Zt  n  1 dened in 312 converges in distribution as n   To this end
we study the moment generating function of Zt Fix   R It is immediate from 310
that for any suciently large n
Ecid20e Ztnet
cid12cid12Z0  ncid21  expcid18Acid18t
ncid19  n  netcid19 
To show this sequence of moment generating functions converges when n   we rely
on the asymptotic approximations for A which satises the ordinary dierential equation
38 with initial condition  n  For n large the quantity  n is small so we introduce
the following expansion
Acid18t
ncid19  f0t  f1t cid18
ncid19  f2t 
 On 3
where O is a term bounded by Ct   for a positive constant Ct and  small enough
Due to the smooth dependence of the solution A to dierential equations 38 and 39
on the initial value we infer that f0 f1 f2 and the constant in the big O notation are all
uniformly bounded for t  0 T  see eg 40 for background on perturbation theory
and asymptotic expansions for dierential equations Next we use the dierential equation
38 to determine the unknown functions f0 f1 and f2 First it is obvious that f0t 
At 0  0 ie the solution to 38 is zero when we have zero initial condition This
implies that for t  0 T  we have At n   O 1n  as n   which further implies
Acid16t 
ncid17
 Acid18t
ncid19  1    Acid18t
ncid19 
2Acid18t
ncid192
 On 3
Together with 314 the dierential equation 38 becomes
ncid19  f2t 
f1t cid18
   f1t cid16 ncid17   1
 On 3
2 2f1t2    f1t  2
n  On 3
Hence equating the coecients depending on the power of  n  we have
f1t    f1t
f2t 
2f1t2    f2t
For the initial conditions we can deduce from the equality A0 n    n that
Solving the above two dierential equations we obtain
f10  1
f20  0
f1t  et
f2t   1
 e2t  et
2 2t
if  6 
if   
Thus we obtain
Acid18t
ncid19  et cid18
ncid19  f2t 
 Ocid16n 3
2cid17 
which implies that as n  
cid18Acid18t
ncid19  n  netcid19 
2  2f2t
Therefore the sequences of the moment generating functions in 313 converges when
n   and we obtain for xed t  0
Zt  net
in distribution
 Gt
where Gt is a random variable following normal distribution with mean zero and variance
2f2t where f2 is given in 315
Now to prove b it remains to show the nite dimensional distributions of Z in 312
converge for dimensions of two and higher We use mathematical induction and rely on
the Markov property of Z Given Z0  n suppose for arbitrary 0  t1      tk
cid16 Zt1     Ztkcid17  Gt1      Gtk  
in distribution
Here we suppose Gt1      Gtk  follows kvariate normal distribution with mean zero and
k  k covariance matrix ijkk where for 1  i  j  k
ij  CovGti  Gtj   2
 eti tj   etj   6 
  
and ij  ji if i  j Hence for 1     k  R we have as n  
To show for arbitrary 0  t1      tk  tk1
Ehe Pk
i1 i Zticid12cid12Z0  ni  exp
cid16 Zt1      Ztk1cid17 cid0Gt1      Gtk1cid1 
ijij
in distribution
where cid0Gt1      Gtk1cid1 follows k  1variate normal distribution with mean zero and
some covariance matrix consistent with 317 we show the sequence of moment generating
functions converges as n   By tower property of conditional expectation and Markov
property of Z for any suciently large n we have
Z0  ncid21  Ecid20e Pk
i1 i Zti  Ehek1 Ztk1Ztkicid12cid12cid12cid12
Z0  ncid21 
Similar for 313 we rst deduce from 310 that
i1 i Zticid12cid12cid12cid12
Ecid20e Pk1
Ehek1 Ztk1Ztki
 expcid18Acid18tk1  tk
 expcid18Acid18tk1  tk
k1n cid19 Ztk  k1netk1cid19
k1n cid19  n Ztk  netk   k1netk1cid19 
where the last equality follows from 312 With this we deduce from 319 that
Ehe Pk1
i1 i Zticid12cid12Z0  ni  Ecid20e Pk
where n
i  i for i  1     k  1 n
n
Zticid12cid12cid12cid12
Z0  ncid21  expn
k  k  nAtk1  tk k1n  and
k1n cid19  netk  k1netk1 
n  Acid18tk1  tk
From the expansion of A at 316 we infer that
n
n  2
n
n
 k  k1etk1tk
k1etk  f2tk1  tk
where f2 is the function given in 315 In conjunction with 318 and 320 and sim-
plifying the resulting expression we obtain as n  
Ehe Pk1
i1 i Zticid12cid12Z0  ni  exp
ijij
k1k1  2f2tk1
ik1   2
 eti tk1  etk1   6 
  
and k1i  ik1 for i  1     k Hence we have established that the nite dimension
distribution of Z n converges to that of a centered Gaussian process G with covariance
function is given by for 0  s  t
CovGt Gs  2
 ets  et  6 
  
Finally we prove c We study the cases  6  and    separately We start with
the case  6  Given Proposition 5 it is straightforward to compute that
Ecid20cid16Zt  net  Zt  netcid172
Ztcid21
 EZ 2
tZt  2net  net  ZtEZtZt
 net  net  Zt2
t e2 
e2  e
  
 2hnete  1  Zti Zte
 n2e2te  12  Z 2
 e  12Zt  net2  e  1
t  2nete  1Zt
2e
  
In addition by the Markovian property of Z we obtain
Eh Zt  Zt2 Zt  Zt2i
 EhEh Zt  Zt2 Zt  Zt2cid12cid12Zs  0  s  tii
 Eh Zt  Zt2  Eh Zt  Zt2cid12cid12Ztii 
On combining the above equation with 321 we obtain
Eh Zt  Zt2 Zt  Zt2i
n2 e  12Ecid20Zt  net2cid16Zt  net  Zt  netcid172cid21
Ecid20Ztcid16Zt  net  Zt  netcid172cid21 
n2 e  1
2e
  
Next we derive upper bounds for the terms in 322 First let us bound the rst term
on the right hand side of 322 Direct computation yields
Ecid20Zt  net2cid16Zt  net  Zt  netcid172cid21
 2Ecid20Zt  net2cid20cid16Zt  netcid172
 2Ecid20cid16Zt  netcid174cid21  2Ecid20cid16Zt  netcid172cid16Zt  netcid172cid21
 2Ecid20cid16Zt  netcid174cid21  2cid20Ecid16Zt  netcid174cid2112cid20Ecid16Zt  netcid174cid2112
 4Cn2
cid16Zt  netcid172cid21cid21
where the second last inequality follows from Cauchy-Schwarz inequality and the last in-
equality is due to Proposition 6 On combining with the fact that
e  1  C
  0 T 
we infer that the rst term on the right hand side of 322 is upper bounded by C2 for
some constant C
We next proceed to bound the second term on the right hand side of 322 By 34
we have
Zt  net  Zt  net
 etZ t
 etZ t
esdMs  etZ t
esdMs  e  1etZ t
esdMs
esdMs
Therefore by Cauchy-Schwarz inequality we nd
Ecid20Ztcid16Zt  net  Zt  netcid172cid21
 EZ 2
t 12cid20Ecid16Zt  net  Zt  netcid174cid2112
t 12cid204Ecid18etZ t
esdMscid194
 EZ 2
 4Ecid18e  1etZ t
esdMscid194
t 12cid18e4t4Ecid18Z t
 2EZ 2
esdMscid19
cid2112
 e  14e4t4Ecid18Z t
esdMscid19
cid1912
Now Proposition 5 implies that EZ 2
323 we deduce from the above inequality that
t 12  Cn In conjunction with Proposition 6 and
Ecid20Ztcid16Zt  net  Zt  netcid172cid21
 Cn cid0Cn22  C4n2cid1
 Cn2
Hence it follows that the second term on the right hand side of 322 is also upper bounded
by C2 for some constant C Therefore we have proved c for the case  6 
We next proceed to prove c for the case    The proof is similar as for the case
 6  so we only outline the key steps Given Z0  n we have Zt  Ztnn  Then we have
Eh Zt  Zt2 Zt  Zt2i
Ecid2Zt  Zt2Zt  Zt2cid3
Ecid2Zt  Zt2  EZt  Zt2Ztcid3
Ecid2ZtZt  Zt2cid3 
where the second equality follows from the fact that Z is Markovian and the third equality
follows from a similar argument as for 321 in the case  6  To bound the last term in
325 we note that
Ecid2ZtZt  Zt2cid3  EZ 3
 EZ 3
t
42EZt  3EZt
t Zt  EZtZ 2
t   2EZ 2
t  32EZ 2
 2EZ 3
t 
t  22EZ 2
t cid18 3
t  EZ 3
t
42  3cid19 EZt
 2EZ 2
 2n2  2nt   cid18 3
42  3cid19 n
where the rst equality follows from Proposition 5 and tower property of conditional ex-
pectation and the last equality follows from Proposition 5 and the fact that Z0  n
Eh Zt  Zt2 Zt  Zt2i  42cid201 
t   
2 
ncid21  C2
where C is a positive constant that is independent of n Hence we have also established
c when    The proof is therefore complete
342 FCLT for N when   0
In this section we prove the weak convergence of the sequence of renormalized Hakwes
processes 26 when   0 Let us recall that the intensity process Zt satises the dynamics
dZt  Ztdt  dNt
Z0  n
where Nt is a simple point process with intensity Zt We can express the jump process
Nt  N 0 t in terms of the intensity process Zt in the following way
Zt  Z0
This immediately yields that
Nt  nR t
0 esds
Zsds  nZ t
Note that we have shown that for any T  0 as n  
ncid20 Zt  n
n Zt  net
esdscid21
Zs  nesds
 Zt  net
 t  0 T   G
weakly on D0 T  equipped with Skorohod J1 topology where G is a centered Gaussian
process Thus using 326 we conclude from 36 Theorem 22 that as n  
 Nt  nR t
0 esds
 t  0 T   H
weakly on D0 T  where
for t  0
Since G is a centered Gaussian process it is then readily seen that H is a also centered
Gaussian process The covariance function of H is given as follows for 0  s  t when
 6 
CovHt Hs
EGtGs 
2 Z t
EGuGsdu
  
EGvGtdv 
EGuGvdudv
2 Z t
2 Z s
    e2s  es
ets  et 
  2 es  1et  es
    ets  et
 set
  3 cid16et  escid17cid16es  1  s  cid17
  
  
 ses
  2 es  12 
  2 ses 
  3 es  1
When    for 0  s  t we have
CovHt Hs  s  st  2cid18 ts2
6 cid19 
343 FCLT for Z and N when   0
In this section we prove Theorem 2 for the case   0 using the observation in Section 31
is nite and
 Note for any T  0 we have sup0tT N 1
Decompose Nt  N 0
t  N 1
independent of the parameter n This implies that as n  
tn  0
0tT
almost surely
Since we have established FCLT for N 0
Similarly we can decompose Zt  Z 0
 the result for N then readily follows from 329
t  Z 1
is independent of n
t n   sup0tT N 1
t n  0 almost surely as n   Hence
and note that Z 1
and hence sup0tT Z 1
the FCLT for Z follows
35 Proof of Theorem 3
We prove Theorem 3 in this section We also rst prove Theorem 3 when   0 and then
prove it when   0 using the observation in Section 31
351 Proof of Theorem 3 when   0
Proof of part i supercritical case We rst show 210 Observe rst from 34 that
for any n  N
Zsn  n1s
eudMu
is a martingale Therefore Doobs martingale inequality implies that for any   0
nZ sn
 
cid12cid12cid12cid12
eudMucid12cid12cid12cid12
eudMucid19
Zsn  n1s
0sTcid12cid12cid12cid12
 P  sup
0sTcid12cid12cid12cid12
Ecid18Z T n
Now inequality 37 implies that for    and n  log n
 
Ecid18Z T n
eudMucid19
Thus we obtain
4  CT n cid0n21  n2T   n1  n2T   n1  n3T cid1 
0sTcid12cid12cid12cid12
  
Zsn  n1s
CT log n
Hence by Borel-Cantelli lemma
cid12cid12cid12cid12
n1s  1cid12cid12cid12cid12
0sTcid12cid12cid12cid12
almost surely as n  
We next prove 211 Recall that the intensity process Zt satises the dynamics
dZt  Ztdt  dNt
Z0  n
where Nt is a simple point process with intensity Zt since   0 We can therefore
express the jump process Nt  N 0 t in terms of the intensity process Zt in the following
Zt  Z0
This implies that for any t  0
Nt  nZ t
esds 
Zt  net
Zs  nesds
Hence for    and n  log n
Nsn  n1sn

cid12cid12cid12cid12cid12
cid12cid12cid12cid12cid12
  we obtain
Zsn  n1s
Zstn  n1s
Zstn  n1s
cid12cid12cid12cid12
cid12cid12cid12cid12
cid12cid12cid12cid12
 cid12cid12cid12cid12
cid12cid12cid12cid12
Then 210 implies the desired result 211
nus Zun  n1u
Zutn  n1u
0uscid12cid12cid12cid12
n sup
  
0uscid12cid12cid12cid12
ducid12cid12cid12cid12
Zutn  n1u
cid12cid12cid12cid12
nusds
cid12cid12cid12cid12
Proof of part ii subcritical case The proof is similar as in the supercritical case so
we only outline the key steps
We rst show 212 For    we observe that for 0  s  T  1
is a martingale Thus we have for tn  log n
Zstn  n1s
esdMs
 and any   0
 
cid12cid12cid12cid12
eudMucid19
Zstn  n1s
0sTcid12cid12cid12cid12
Ecid18Z T tn
n44 T tn cid0n2n2T  1  nn2T  1  nn3T  1cid1 
where the last inequality follows from 37 Therefore for tn  log n
  we obtain
0sTcid12cid12cid12cid12
Zstn  n1s
  
CT log n
cid2n2n2T  n  n3Tcid3 
cid12cid12cid12cid12
Zstnn1s
convergences
cid12cid12cid12
2  we have
Hence the almost sure convergence follows from Borel-Cantelli lemma
to zero in probability for any T  1 Furthermore if T  1
which goes to 0 as n   for any T  1 Thus we have sup0sT cid12cid12cid12
n44 cid2n2n2T  n  n3Tcid3  
  we have
  
We next prove 213 When    and tn  log n
 n  n1s
Zstn  n1s
Zstn  n1s
Nstn  1
n1s
n1s
cid12cid12cid12cid12cid12
cid12cid12cid12cid12cid12
The desired result 213 then follows
cid12cid12cid12cid12
nu Zutn  n1u
ducid12cid12cid12cid12
Zutn  n1u
0uscid12cid12cid12cid12
cid12cid12cid12cid12
cid12cid12cid12cid12
cid12cid12cid12cid12
352 Proof of Theorem 3 when   0
In this section we prove Theorem 3 for the case   0 using the observation in Section 31
t log N 1
Proof of 210 Note that Z 1
 In Zhu 47 it was showed that limt
t  N 1
   for     0 Thus for any 0  T  1
0sT
n1s 
n1s   sup
0sT
  Then 210 follows from the decomposition
n  0
almost surely as n   since n  log n
Zt  Z 0
t  Z 1
and the result proved in the previous section
Proof of 211 Similarly it follows from the decomposition Nt  N 0
t  N 1
and that
for any 0  T  1
0sT
almost surely as n   since n  log n
 
Proof of 212 Note that for     0 N 1
n1s 
n  0
Therefore for tn  log n
 we deduce that for any 0  T  1
t  
1 
almost surely as t  
n1s 
N 1
n1T  0
0sT
almost surely as n  
Proof of 213 Similarly for tn  log n
  we have
n  0
0sT
t  
1 
almost surely as n   since N 1
almost surely as t  
36 Proof of Theorem 4
This section is devoted to the proof of Theorem 4
361 Proof of critical and nearlycritical cases
Proof The proof is based on diusion approximations In particular we apply Theorem 41
in Ethier and Kurtz 18 Chapter 7 and verify their conditions 4147 Fix Z0  n
Dene for t  0 and   0
t Z t
One readily checks that the two processes
t  Bn
t  t  0 T  
n  Xn
s ds An
t  2
0 cid16Xn
ncid17 ds
t  Bn
t 2  An
cid8Xn
t  t  0 T cid9
are martingales with respect to the ltration generated by Xn Since Z can only make jumps
of size n we deduce that Xn can only make jumps of size n
n  This implies condition 43 of
Theorem 41 in 18 Chapter 7 holds Condition 44 and 45 hold trivially since Bn and
An have continuous sample paths In view of 330 and limn n   Condition 46
also holds if we set bx    x and ax  2x Now if we dene
dXt    Xtdt  pXtdBt
where B is a standard Brownian motion then this stochastic dierential equation SDE
0  1 for all n we deduce that Xn converges
has a pathwise unique strong solution Since Xn
weakly to X by Theorem 41 in 18 Chapter 7 and the wellknown equivalence of SDE
and martingale problems see eg 37
We next establish the weak convergence of the sequence of renormalized Hawkes pro-
n2  t  0 T cid27 
cid26 Ntn
n Z t
n Z t
Since for   0 the point process N has intensity   Zt at time t where dZt 
Ztdt  ndNt for Z0  n So we still have
Zt  Z0
which yields
Ztn  Z0
n2  n
Since limn n   and we have the weak convergence of the sequence of processes
cid8 Ztn
n  t  0 T cid9 the result then follows from 36 Theorem 22
362 Proof of supercritical case when   0
Proof The proof is based on Aldouss result on weak convergence of a sequence of martin-
gales to a continuous martingale limit 1
We rst note that in the super-critical case     0 where n  log n
  we have
Zsn  n1s  nsZ sn
eudMu
Thereforen Zsnn1s
forward to compute that
 s  0 T o is a martingale for any xed n Moreover it is straight-
Ecid18 Zsn  n1s
e2uZuducid21
cid192  sup
Ecid20Z sn
n Z sn
   cid181 
nscid19
euZ0du
  
Therefore for each s n Zsnn1s
 n  1o is uniformly integrable
We next establish the convergence of nite-dimensional distributions To this end we
rst show for xed s  0 the sequence of moment generating functions
converges when n   It is straightforward to compute that
Zsn n1s
n12s
Ee
cid12cid12Z0  n
cid12cid12Z0  n  expcid18Acid18sn
Zsn n1s
n12s
Ee
n12scid19  n  ncid19 
where A solves the dierential equation in 38 Noting that esn  ns which implies
esn  
n12s
 
n  1
for n suciently large
Hence we obtain from 316 the following asymptotic expansion
Acid18sn
n12scid19  ns cid18
n12scid19 
  
n2s  ns
n12s  ocid18 1
ncid19 
where ocid0 1
We then immediately obtain from 331 that
ncid1 is a term that is smaller in magnitude than any multiple of 1n as n  
Ee
n
Zsn n1s
n12s
cid12cid12Z0  n  expcid18 1
  
2cid19 
which implies that for xed s  0
Zsn  n1s
n12s   weakly as n  
where  is a normal random variable with mean zero and variance 2
 
After establishing the convergence of one-dimensional marginal distributions we pro-
ceed to consider the dimension of two The general case of nite dimensions follows similarly
and the proof is omitted Fix 1 2  R For any 0  u  v and for suciently large n
the moment generating function is given by
nnu Zun 2
Ecid20e 1
nnv ZvnZ0  ncid21  e1n2n
It can be directly computed that
nnu Zun 2
Ecid20e 1
 Ecid20e 1
 Ecid20e 1
nnv ZvnZ0  ncid21
nnu Zun  Ecid20e 2
nnu Zun cid20eAvun  2
Zun n1u
n12u
Een
Z0  ncid21
nnv ZvnZuncid21cid12cid12cid12
Z0  ncid21 
nnv Zuncid21cid12cid12cid12
cid12cid12Z0  n  expn
2nnvcid19 
2nnvcid19cid19  n
hence the moment generating function in 333 becomes
n
n12u  Acid18v  un
 1 
 cid182  n12u  Acid18v  un
Similar as in 332 we have the following asymptotic expansion for A
Acid18v  un
 nvu cid18
2n12u
2nnvcid19
2n12vcid19 
  
  
n2vu  nvu
n12v  ocid0n12ucid1
n12u  ocid0n12ucid1 
where ocid0n12ucid1 is a term that is smaller in magnitude than any multiple of n12u as
n   This suggests that
 1  2
n
n  0
n
n
It immediately follows that
n
Ecid20e 1
nnu Zun 2
nnv ZvnZ0  ncid21  e1n2n  expcid18 1
  
1  22cid19 
which implies that
cid18 Zun  n1u
n12u
Zvn  n1v
n12v cid19  Y u Y v weakly as n  
where Y u  Y v   for v  u  0 and  is a normal random variable with mean zero
and variance 2
  It is clear that Y is a continuous process on Dt T  for any 0  t  T 
Thus by Proposition 12 in Aldous 1 we deduce that
cid26 Zsn  n1s
n12s
 s  t T cid27  Y
weakly on Dt T 
We next prove 216 ie the functional central limit theorem for rescaled jump process
N in the supercritical case Recall from 33 that
Nsn  n1sn

Zsn  n1s
nus Zun  n1u
and that Ys   for s  0 where  is a normal random variable with mean 0 and variance
  In addition note that
nusdu 
  
1  ns
Therefore we deduce that
 Nsn  n1sn

  
weakly on Dt T  The weak limit is simply 1
 s  t T  
 
363 Proof of supercritical case when   0
Proof Zhu 47 showed that when    limt
N 1
and for any 0  T  1
t log N 1
t     Note that Z 1
snn12s 
N 1
T nn  0
0sT
almost surely as n   Similarly we have
snn12s 
0sT
T nn  0
almost surely as n   Hence the results follow from the decompositions Z  Z 0  Z 1
and N  N 0  N 1
364 Proof of subcritical case when   0
Proof We prove the convergence of nite dimensional distributions of the rescaled Z pro-
cesses To this end we rst show for xed s  1 the sequence of moment generating
functions
Zstn n1s
n1s
Ee
cid12cid12Z0  n
cid12cid12Z0  n  expcid18Acid18stn
converges when n   It is straightforward to compute that for any xed   R and for
any suciently large n
Zstn n1s
n1s
Ee
n1scid19  n  n1scid19 
Noting that estn  ns This term together with the quantity  n1s  goes to zero
as n   Hence we obtain from 316 the following asymptotic expansion
Acid18stn
n1scid19  ns cid18
We then immediately obtain that
  
n1scid19 
cid12cid12Z0  n  expcid18 1
Zstn n1s
n1s
Ee
which implies that for xed s  0 1
Zstn  n1s
n2s  ns
n1s  ocid0n1cid1 
  
2cid19 
n1s  Rs weakly as n  
where Rs is a normal random variable with mean zero and variance 2
 
We proceed to consider the dimension of two The proof for the general case of nite
dimensions follows from a similar argument and hence is omitted Fix 1 2  R For any
0  u  v  1 and any suciently large n the moment generating function is given by
Ecid20e 1n1u
Zutn 2n1v
ZvtnZ0  ncid21  e1n1u2n1v
It can be directly computed that
Zutn 2n1v
Ecid20e 1n1u
 Ecid20e 1n1u
 Ecid20e 1n1u
ZvtnZ0  ncid21
Zutn  Ecid20e 2n1v
Zutn cid20e
Avutn  2n1v
Een
Zutn n1u
n1u
Z0  ncid21
ZvtnZutncid21cid12cid12cid12
Z0  ncid21 
Zutncid21cid12cid12cid12
cid12cid12Z0  n  expn
2n1vcid19 
2n1vcid19  2 
n1v
After rewriting the moment generating function in 334 becomes
n
n1u  Acid18v  utn
 1 
 n1u  Acid18v  utn
Note from 316 that we have the following asymptotic expansion for A
Acid18v  utn
 nuv cid18
This suggests that
2n1vcid19
2n1vcid19 
  
  
n1u  ocid18 1
n2vu  nvu
n1ucid19 
n1v  ocid18 1
n1ucid19
n
n
n
  
It immediately follows that
n
Ecid20e 1n1u
Zutn 2n1v
ZvtnZ0  ncid21  e1n1u2n1v
 expcid18 1
  
which implies that
cid18 Zutn  n1u
n1u
Zvtn  n1v
n1v cid19  Ru Rv weakly as n  
1  2
2cid19 
where Ru and Rv are independent normal random variables both with mean zero and
variance 2
 
365 Proof of subcritical case   0
Proof Note that for     0 N 1
0  T  1
t  
1 
stnn1s 
almost surely as t   Therefore for any
N 1
T tnn1T  0
0sT
almost surely as n   Hence the result follows from the decomposition Z  Z 0 
4 Appendix
41 Proof of Proposition 5
Proof The process Z is a piecewise deterministic Markov process as dened in Davis 14
see also Chapter 11 in Rolski et al
44 Suppose f is any continuous function with at
most polynomial growth on 0 ie there exists some integer k such that f x  xk
for all x  0 Recall that dZt  Ztdt  dNt Dene
Af z  z
 zf z    f z
We rst verify that f is in the domain of the full generator of the Markov process Zt  t 
06 That is
cid26f Zt  f Z0 Z t
0 Af Zsds  t  0cid27
is a martingale with respect to the natural ltration generated by Z See Section 1114 in
Rolski et al 2009 for the denition of full generator and further details We use Theorem
6The domain of the innitesimal generator of a Markov process is always contained in the domain of its
full generator
1122 in Rolski et al 44 and check the three conditions there Since the boundary set of
the piecewise deterministic Markov process Z is empty Z never hits zero and the sample
path of Z is absolutely continuous between jumps it suces to check that for each t  0
where is are the jump epochs of the process Z Direct computation yields
f Zi  f Zi
  
Xit
f Zi  f Zi
Xit
0 f Zs    f ZsdNscid21
Zs  kdNscid21
Z0  Ns  kdNscid21
  Ecid20Z t
 2Ecid20Z t
 2Ecid20Z t
 2kEcid20Z t
sdNscid21
 2kcid16Z0  kENt  kEN k1
Z0  k  kN k
cid17  
where we have used the facts that f is of at most polynomial growth and Zt  Z0  Nt
for all t Write EZ0  EZ0 The martingale property then implies
EZ0f Zt  f Z0  EZ0cid20Z t
0 Af Zsdscid21 
where Af is given in 41
To compute the rst moment we apply f z  z in 42 and obtain
EZ0Zt  Z0  EZ0cid20Z t
  Zsdscid21  Z0 Z t
    EZ0Zsds
which implies
Thus we have
EZ0Zt      EZ0Zt
EZ0Zt  Z0et
Now we compute second moments Applying f z  z2 in 42 we nd
EZ0Z 2
t   Z 2
0  2  Z t
0  2  Z t
EZ0Z 2
EZ0Z 2
s ds  2Z t
s ds  2Z0Z t
EZ0Zsds
esds
Solving this equation yields
EZ0Z 2
t   Z 2
0  2Z0t
0 e2t  2Z0
 e2t  et
if   
if  6 
Next we compute the third moments We apply f z  z3 in 42
If    we
immediately get
EZ0Z 3
t   Z 3
EZ0Z 2
s ds  3Z t
EZ0Zsds
0  32Z t
0  32Z 2
4Z0t2  3Z0t
When  6  we have
EZ0Z 3
t   Z 3
0  3  Z t
0  3  Z t
   Z t
 32 2Z0
EZ0Zsds
EZ0Z 3
EZ0Z 3
s ds  32Z t
s ds  32Z 2
EZ0Z 2
s ds  3Z t
e2sds
e2s  esds  3Z0Z t
esds
Therefore
EZ0Z 3
t   3  EZ0Z 3
t  cid1832Z 2
  cid19 e2t cid183Z0 
  cid19 et
which yields that
EZ0Z 3
t e3t  Z 3
0 cid18 32Z 2
  
  2cid19 1  et
2   
cid18 3Z0
2  2cid19 1  e2t
which implies that
EZ0Z 3
t  cid18Z 3
32Z 2
  
cid18 32Z 2
  
cid18 3Z0
2   
  2 
  2cid19 e2t
2   
2  2cid19 et
2  2cid19 e3t
The proof is therefore complete
42 Proof of Proposition 6
Proof First recall from 34 that
Zt  net  etZ t
esdMs
0 Zsds is the predictable quadratic variation of the martingale M  By
Burkholder-Davis-Gundy inequality we have
0 esdMs is a martingale with predictable quadratic variationR t
Note thatR t
where hMit  R t
esdMscid194  Ecid18 sup
cid194
Ecid18Z t
0stcid12cid12cid12cid12
eudMucid12cid12cid12cid12
e2sdhMiscid192 
 C  Ecid18Z t
0 e2sdhMis
e4sZ 2
esdMscid194
e2sZsdscid192 Burkholder-Davis-Gundy inequality
where C is a positive constant Hence when  6  we deduce from Proposition 5 that
Ecid18Z t
 C  Ecid18Z t
 CtEcid20Z t
 CtZ t
 CtZ t
 Ctcid20
e2s  escid21 ds
  
2  2 1  e2t 
s dscid21 Cauchy-Schwarz inequality
e4scid20Z 2
2  
3  2 1  e3tcid21 
1  e2t 
Hence we have established 37
e4sEZ 2
0 e2s 
A similar argument yields that
Ecid18Z t
tT
tTZ t
 C sup
 Cn22
esdMscid194
e4scid20Z 2
0 e2s 
  
e2s  escid21 ds
Thus we have proved 36
Finally we prove 35 When    a similar argument leads to
Ecid18Z t
esdMscid194  CtZ t
 Ctcid18Z 2
e4sEZ 2
2t2Z0cid19  Ctcid18n2t 
2t2ncid19 
Together with 37 we infer that the inequality 35 follows in view of 43 The proof
is therefore complete
Acknowledgements
Xuefeng Gao acknowledges support from CUHK Direct Grants for Research with project
codes 4055035 and 4055054 We would like to thank Peter Carr Jasmine Foo and Frederi
G Viens for helpful discussions
References
1 Aldous D 1989 Stopping times and tightness II The Annals of Probability 172
586-595
2 Bacry E S Delattre M Homann and J F Muzy 2013 Scaling limits for Hawkes
processes and application to nancial statistics Stochastic Processes and their Appli-
cations 123 2475-2499
3 Bacry E Mastromatteo I and Muzy J F 2015 Hawkes processes in nance
arXiv150204592
4 Billingsley P 1999 Convergence of Probability Measures 2nd edition Wiley-
Interscience New York
5 Bjork T An Introduction to Point Processes from a Martingale Point of View KTH
6 Bordenave C and Torrisi G L 2007 Large deviations of Poisson cluster processes
Stochastic Models 23 593-625
7 Bowsher C G 2007 Modelling security market events in continuous time Intensity
based multivariate point process models Journal of Econometrics 1412 876-912
8 Bramson M 2008 Stability of queueing networks Springer Berlin Heidelberg
9 Bremaud P and Massoulie L 1996 Stability of nonlinear Hawkes processes Ann
Probab 24 1563-1588
10 Chevallier J Mean-eld limit of generalized Hawkes processes arXiv151005620
11 Da Fonseca J and Zaatour R 2014 Hawkes process Fast calibration application
to trade clustering and diusive limit Journal of Futures Markets 346 548-579
12 Daley D J and Vere-Jones D An Introduction to the Theory of Point Processes
Volume I and II 2nd edition Springer-Verlag New York 2003
13 Dai J G and Meyn S P 1995 Stability and convergence of moments for multiclass
queueing networks via uid limit models IEEE Transactions on Automatic Control
40 1889-1904
14 Davis M H 1984 Piecewise-deterministic Markov processes A general class of non-
diusion stochastic models Journal of the Royal Statistical Society Series B Method-
ological 353-388
15 Delattre S Fournier N 2015 Statistical inference versus mean eld limit for
Hawkes processes Preprint
16 Delattre S Fournier N and M Homann 2014 High dimensional Hawkes pro-
cesses arXiv14035764
17 Dufresne D 2001 The integrated square-root process Working Paper University
of Montreal
18 Ethier S N and Kurtz T G 2009 Markov processes characterization and con-
vergence Vol 282 John Wiley and Sons
19 Errais E Giesecke K and Goldberg L 2010 Ane point processes and portfolio
credit risk SIAM J Financial Math 1 642-665
20 Foo J and Leder K 2013 Dynamics of cancer recurrence Annals of Applied Prob-
ability 23 1437-1468
21 Foo J Leder K and J Zhu 2014 Escape times for branching processes with
random mutational tness eects Stochastic Processes and their Applications 124
3661-3697
22 Going-Jaeschke A and M Yor 2003 A survey and some generalizations of Bessel
processes Bernoulli 92 313349
23 Gourieroux C Jasiak J and Le Fol G 1999 Intra-day market activity Journal
of nancial markets 23 193-226
24 Hamana Y and H Matsumoto 2013 The probability distributions of the rst
hitting times of Bessel processes Trans Amer Math Soc 365 5237-5257
25 Hamana Y and M Hiroyuki 2012 The probability densities of the rst hitting
times of Bessel processes J Math-for-Ind 4B 91-95
26 Hamana Y and M Hiroyuki 2014 Asymptotics of the probability distributions of
the rst hitting times of Bessel processes Electronic Communications in Probability
19 Article 5
27 Hautsch N 2004 Modelling irregularly spaced nancial data theory and practice of
dynamic duration models Springer Science and Business Media
28 Hawkes A G 1971 Spectra of some self-exciting and mutually exciting point pro-
cesses Biometrika 58 83-90
29 Hawkes A G and Oakes D 1974 A cluster process representation of a self-exciting
process J Appl Prob 11 493-503
30 Hewlett P 2006 Clustering of order arrivals price impact and trade path optimiza-
tion In Workshop on Financial Modeling with Jump processes Ecole Polytechnique
pp 6-8
31 Hida T and Hitsuda M 1993 Gaussian processes Vol 120 American Mathe-
matical Society
32 Hodara P and E Locherbach 2014 Hawkes processes with variable length memory
and an innite number of components arXiv14105235
33 Jaisson T and M Rosenbaum 2015 Limit theorems for nearly unstable Hawkes
processes Annals of Applied Probability 25 600-631
34 Jaisson J and M Rosenbaum 2015 Rough fractional diusions as scaling limits of
nearly unstable heavy tailed Hawkes processes arXiv 150403100
35 Karabash D and L Zhu 2015 Limit theorems for marked Hawkes processes with
application to a risk model Stochastic Models 31 433-451
36 Kurtz Thomas G and Protter Philip 1991 Weak limit theorems for stochastic
integrals and stochastic dierential equations The Annals of Probability 10351070
37 Kurtz T G 2011 Equivalence of stochastic equations and martingale problems In
Stochastic Analysis 2010 pp 113-130 Springer Berlin Heidelberg
38 Lifshits M A 2013 Gaussian random functions Vol 322 Springer Science and
Business Media
39 Lipster R S and A N Shiryaev Statistics of Random Processes II Applications
2nd Edition Springer 2001
40 Murdock James A 1999 Perturbations theory and methods 27 SIAM
41 Ozaki T 1979 Maximum likelihood estimation of Hawkes self-exciting point pro-
cesses Annals of the Institute of Statistical Mathematics 311 145-155
42 Piterbarg V I 2012 Asymptotic methods in the theory of Gaussian processes and
elds Vol 148 American Mathematical Society
43 Revuz D and M Yor 1998 Continuous Martingales and Brownian Motion
Springer 3rd Edition
44 Rolski T Schmidli H Schmidt V and Teugels J 2009 Stochastic processes for
insurance and nance Vol 505 John Wiley and Sons
45 Torrisi G L Gaussian approximation of nonlinear Hawkes processes Preprint
46 Torrisi G L Poisson approximation of point processes with stochastic intensity and
application to nonlinear Hawkes processes Preprint
47 Zhu L 2013 Nonlinear Hawkes Processes PhD thesis New York University
48 Zhu L 2013 Moderate deviations for Hawkes processes Statistics  Probability
Letters 83 885-890
49 Zhu L 2014 Limit theorems for a Cox-Ingersoll-Ross process with Hawkes jumps
Journal of Applied Probability 51 699-712
50 Zhu L 2013 Central limit theorem for nonlinear Hawkes processes Journal of
Applied Probability 50 760-771
51 Zhu L 2015 Large deviations for Markovian nonlinear Hawkes Processes Annals
of Applied Probability 25 548-581
52 Zhu L 2014 Process-level large deviations for nonlinear Hawkes point processes
Annales de lInstitut Henri Poincare-Probabilites et Statistiques 50 845-871
