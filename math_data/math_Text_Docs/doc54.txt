HIGH DIMENSIONAL HAWKES PROCESSES
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
Abstract We generalise the construction of multivariate Hawkes processes to a possibly innite
network of counting processes on a directed graph G The process is constructed as the solution
to a system of Poisson driven stochastic dierential equations for which we prove pathwise
existence and uniqueness under some reasonable conditions
We next investigate how to approximate a standard N -dimensional Hawkes process by a
simple inhomogeneous Poisson process in the mean-eld framework where each pair of individuals
interact in the same way in the limit N   In the so-called linear case for the interaction we
further investigate the large time behaviour of the process We study in particular the stability
of the central limit theorem when exchanging the limits N T   and exhibit dierent possible
behaviours
We nally consider the case G  Zd with nearest neighbour interactions In the linear case
we prove some large time laws of large numbers and exhibit dierent behaviours reminiscent
of the innite setting Finally we study the propagation of a single impulsion started at a given
point of Zd at time 0 We compute the probability of extinction of such an impulsion and in
some particular cases we can accurately describe how it propagates to the whole space
Mathematics Subject Classication 2010 60F05 60G55 60G57
Keywords Point processes Multivariate Hawkes processes Stochastic dierential equations
Limit theorems Mean-eld approximations Interacting particle systems
1 Introduction
11 Motivation In several apparently dierent applied elds a growing interest has been ob-
served recently for a better understanding of stochastic interactions between multiple entities
evolving through time These include seismology for modelling earthquake replicas Helmstetter-
Sornette 18 Kagan 24 Ogata 29 Bacry-Muzy 5 neuroscience for modelling spike trains
in brain activity Grun et al
31 Reynaud et al
33 34 genome analysis Reynaud-Schbath 32 nancial contagion Ait-Sahalia et al 1 high-
frequency nance order arrivals see Bauwens-Hautsch 6 Hewlett 19 market micro-structure
see Bacry et al
2 and market impact see Bacry-Muzy 4 5 nancial price modelling across
scales Bacry et al 3 Jaisson-Rosenbaum 21 social networks interactions Blundell et al 7
Simma-Jordan 36 Zhou et al 38 and epidemiology like for instance viral diusion on a network
Hang-Zha 37 to name but a few In all these contexts observations are often represented as
events like spikes or features associated to agents or nodes on a given network and that arrive
randomly through time but that are not stochastically independent
13 Okatan et al
30 Pillow et al
In practice we observe a multivariate counting process Z 1
t t0 each component Z i
recording the number of events of the i-th component of the system during 0 t or equivalently
the time stamps of the observed events Under relatively weak general assumptions a multi-
variate counting process Z 1
t t0
informally dened by
t t0 is characterised by its intensity process 1
t      Z N
t      Z N
t      N
Prcid0Z i has a jump in t t  dtcid12cid12 Ftcid1  i
i  1     N
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
where Ft denotes the sigma-eld generated by Z i1iN up to time t For modelling the inter-
actions a particularly attractive family of multivariate point processes is given by the class of
mutually exciting Hawkes processes Hawkes 15 Hawkes-Oakes 16 with intensity process
given by
t  hicid16 NXj1
scid17
jit  sdZ j
where the causal functions ji  0  R model how Z j acts on Z i by aecting its intensity
process i The nonnegative functions hi account for some non-linearity but if we set hix  ix
with i  0 we obtain linear Hawkes processes where i can be interpreted as a baseline Poisson
intensity In the degenerate case ji  0 we actually retrieve standard Poisson processes
Multivariate Hawkes processes have long been studied in probability theory see for instance the
comprehensive textbook of Daley-Vere-Jones 10 and the references therein Bremaud-Massoulie
8 or the recent results of Zhu 39 40 Their statistical inference is relatively well understood
too from a classical parametric angle Ogata 27 together with recent signicant advances in
nonparametrics Reynaud-Bouret-Schbath 32 Hansen et al 17 However the frontier is pro-
gressively moving to understanding the case of large N  when the number of components may
become increasingly large or possibly innite see Galvez-Locherbach 14 for some constructions
in that direction This context is potentially of major importance for future developments in the
aforementioned applied elds This is the topic of the present paper
12 Setting We work on a ltered probability space F  Ftt0 Pr We say that Xtt0
is a counting process if it is non-decreasing cadlag integer-valued and nite for all times with
all its jumps of height 1 For Xtt0 a Ftt0-adapted counting process there is a unique non-
decreasing predictable process tt0 called compensator of Xtt0 such that Xt  tt0 is a
Ftt0-local martingale see Jacod-Shiryaev 22 Chapter I
We consider a countable directed graph G cid0SEcid1 with vertices or nodes i  S and directed
edges e  E We write e  j i  E for the oriented edge We also need to specify the following
parameters a kernel   ji j i  E with ji
 0 7 R and a nonlinear intensity
component h  hi i  S with hi  R 7 0 The natural generalisation of nite-dimensional
Hawkes processes is the following
Denition 1 A Hawkes process with parameters G  h is a family of Ftt0-adapted counting
processes Z i
t iSt0 such that
t t0 and Z j
t t0 never jump simultaneously
tt0 has the form i
tt0 of Z i
t  R t
sds where the
intensity process i
i almost surely for all i 6 j Z i
ii for every i  S the compensator i
t  hicid16Xji
tt0 is given by
scid17
jit  sdZ j
with the notation Pji for summation over j  j i  E
We say that a Hawkes process is linear when hix  i  x for every x  R i  S with i  0
and when ji  0 We will give some general existence uniqueness and approximation results
for nonlinear Hawkes processes but all the precise large-time estimates we will prove concern the
linear case
HIGH DIMENSIONAL HAWKES PROCESSES
A Hawkes process Z i
the rate of jump of Z i is at time t it  hiPjiPk1 jit  T j
tiSt0 with parameters G  h behaves as follows For each i  S
k k1
are the jump times of Z j In other words each time one of the Z js has a jump it excites its
neighbours in that it increases their rate of jump in the natural situation where h is increasing
and  is positive If  is positive and decreases to 0 the case of almost all applications we have
in mind the inuence of a jump decreases and tends to 0 as time evolves
k t where T j
k 1T j
13 Main results In the case where G is a nite graph under some appropriate assumptions
on the parameters the construction of Z i
tiSt0 is standard However for an innite graph the
situation is more delicate we have to check in some sense that the interaction does not come
from innity
The rst part of this paper Section 2 consists of writing a Hawkes process as the solution to a
system of Poisson-driven SDEs and of nding a set of assumptions on G and on the parameters
 h under which we can prove the pathwise existence and uniqueness for this system of SDEs
Representing counting processes as solutions to SDEs is classical see Lewis-Shedler 26 Ogata
28 Bremaud-Massoulie 8 Chevallier 9 However the well-posedness of such SDEs is not
obvious when G is an innite graph
0 tdt with respect to 1 the so-called critical case
In a second part Section 3 we study the mean-eld situation we assume that we have a nite
large number N of particles behaving similarly with no geometry In other words S  1     N
is endowed with the set of all possible edges E  i j  i j  S and there are two functions
h and  such that hi  h and ij  N 1 for all i j  S We show that as N   Hawkes
processes can be approximated by an iid family of inhomogeneous Poisson processes Concerning
the large-time behaviour we discuss in the linear case the possible law of large numbers and
central limit theorems as t N    and we observe some dierent situations according to
the position of R 
Finally we consider in Section 4 the case where G is Zd endowed with the set of edges E 
i j 
i  j  0 or 1 where    denotes the Euclidean distance We study the large time
behaviour in the linear case where hix  i  x and when ij  2d  11 does not depend
on i j We rst assume that i does not depend too much on i consider eg the case where the
i are random iid and bounded and show that i if R 
0 tdt  1 then there is a law of
t  Z j
large numbers and the interaction makes everything at in the sense that for all i 6 j Z i
as t   ii if R 
0 tdt  1 then there is again a law of large numbers but the limiting value
depends on i We also explain why these results are reminiscent of the innite setting and of the
interaction Finally we study the case where i  0 for all i but where there is an impulsion at
time 0 at i  0 We compute the probability of extinction of such an impulsion and in some
particular cases we study how it propagates to the whole space when it does not blow out
14 Notation The Laplace transform of   0 7 R is dened when it exists by
L Z 
ettdt
We also introduce the convolution of h g  0 7 R as if it exists g  ht  R t
0 gtshsds As is well-known when everything makes sense Lgh  Lg  Lh
0 gshtsds 
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
2 Well-posedness using a Poisson SDE
We will study Hawkes processes through a system of Poisson-driven stochastic dierential equa-
tions This will allow us to speak of pathwise existence and uniqueness and to prove some propa-
gation of chaos using some simple coupling arguments
Consider on a ltered probability space F  Ftt0 Pr a family ids dz i  S of iid
Ftt0-Poisson measures with intensity measure ds dz on 0  0
Denition 2 A family Z i
with parameters G  h if as for all i  S all t  0
t iSt0 of cadlag Ftt0-adapted processes is called a Hawkes process
0 Z 
1cid8z  hicid0Xji
jis  udZ j
ucid1cid9ids dz
This formulation is consistent with Denition 1
Proposition 3 a A Hawkes process in the sense of Denition 2 is also a Hawkes process in the
sense of Denition 1
Point a is very easy for a Hawkes process Z i
b Consider a Hawkes process in the sense of Denition 1 on some ltered probability space
F  Ftt0 Pr Then we can build on a possibly enlarged probability space   F   Ftt0 Pr
 Ftt0-Poisson measures with intensity measure ds dz on
a family ids dz i  S of iid
0  0 such that Z i
that for every i  S the compensator of Z i is R t
equal to R t
measures ids dz i  S guarantees that for all i 6 j Z i
simultaneously
t iSt0 in the sense of Denition 2 it is clear
udzds which is
uds Furthermore the independence of the Poisson random
t t0 as never jump
t iSt0 is a Hawkes process in the sense of Denition 2
0 hiPjiR s
0 jis  udZ j
0 1zhiPji R s
tt0 and Z j
0 R 
0 jisudZj
Point b is more delicate but standard and a very similar result was given in Bremaud-Massoulie
8 Their proof is based on results found in the book 20 of Jacod of which one of the main goals
is exactly this topic prove the equivalence between martingale problems and SDEs We also
refer to Chevallier 9 Section IV where a very complete proof is given as well as a historical survey
Let us mention that the idea to integrate an indicator function with respect to a Poisson measure
in order to produce an inhomogeneous Poisson process with given intensity was rst introduced by
Lewis-Shedler 26 and later extended by Ogata 28 in the case of a stochastic intensity
The following set of assumptions will guarantee the well-posedness of 1
Assumption 4 There are some nonnegative constants ciiS  some positive weights piiS and
a locally integrable function   0 7 0 such that
a for every i  S every x y  R hix  hiy  cix  y
b PiS hi0pi  
c for every s  0 every j  S PijiE cipicid12cid12jiscid12cid12  pjs
Let us give a few examples of parameters G  h satisfying Assumption 4
Remark 5 i If S is nite then Assumption 4 holds true with the choice pi  1 as soon as hi
is Lipschitz continuous for all i  S and ji is locally integrable for all j i  E
HIGH DIMENSIONAL HAWKES PROCESSES
i  j  0 or 1 then Assumption 4 holds with
loc0 such
ii If S  Zd is endowed with E  i j 
the choice pi  2i if PiZd 2ihi0   and if there are c  0 and   L1
that hix  hiy  cx  y and jkt  t for all i  S x y  R j k  E and t  0
i j  Zd
iii Consider next S  Zd endowed with the set of all possible edges E  i j 
and assume that there is c  0 such that hi0  c and hix  hiy  cx  y for all i  S
x y  R Assume that there are   L1
loc0 and a nonincreasing a  0 7 0 such
that jit  ai  jt for all i j  E and t  0 Then if PiZd ai   Assumption 4
holds true
iv Consider the strongly oriented graph Z endowed with the set of edges E  i i  1 
loc0 such that for every
i  Z Then Assumption 4 holds true as soon as there is   L1
i  Z there are ci  0 and ai  0 such that hix  hiy  cix  y and ii1  ai
Points ii and iii of course extend to other graphs
In iv there is no growth condition
on hi0 ci and ai This comes from the fact that the interaction is directed Z 0 is actually
a Poisson process with rate h00 the intensity of Z 1 is entirely determined by that of Z 0 and
so on Hence this example is not very interesting But we can mix eg points ii and iv
informally coecients corresponding to edges directed to the origin have to be well-controlled
while coecients corresponding to edges directed to innity require less assumptions
Proof Point i is obvious To check ii simply note that for all j  S PijiE c2iji 
c2jPijiE 2ji  c22d  12j and dene   c22d  1 Point iv holds with
piiZ dened by p0  1 and by induction pi1  min2i1  hi10 pi1  aici1
pihi0   and that for all j  1 PijiE cipiji 
This of course implies that PiZ
cj1pj1jj1  cj1pj1aj  pj as desired
To prove iii we work with the sup norm i  i1     id  maxi1    id The delicate
part consists in showing that there is b  N 7 0 and a constant C  0 such thatPiZd bi 
 and for all j  Zd PiZd biai  j  Cbj Then the result will easily follow with
the choices pi  bi and   Cc We dene b recursively by b0  a0 and bk  1 
maxak  1 k  1k  22dbk Using that a is nonincreasing we easily check that b is
nonincreasing We next check that PiZd bi   ie that Pk0 kd1bk   knowing by
assumption that Pk0 kd1ak   We have for k  0
bk  1  ak  1 cid0k  1k  22dbk  ak  1cid1
k  1k  22dbk  ak cid0k  1k  22dak  ak  1cid1
k  1k  22dbk  ak  ak  ak  1
1a  1  a  1k  12d by
Recalling that b0  a0 one gets bk  ak  Pk
iteration Hence
a  1  a  1k  12d
kX1
kd1bk  ak Xk1
X1
CX1
a  1  a  12dXk
a  1  ad
kd1k  12d
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
This last quantity is nothing but CP1 a  1d  d  CP1 ad1   We have
thus checked that Pk0 kd1bk Pk1 akkd1 Pk1 kd1bk  ak  
We nally prove that for all j  Zd PiZd biai  j  Cbj First we claim that
there is C such that bk  Cb2k for all k  0 This is easily checked iterating the inequality
bk  k  2k  12dbk  1 Next we write using that a and b are nonincreasing
XiZd
biai  j  Xij2
biai  j  Xij2
bi  bj2XiZd
aj2XiZd
Caj2  Cbj2
biai  j
ai  j
By denition of b we have aj2  bj2 And we have just seen that bj2  Cbj We
nally have checked that PiZd biai  j  Cbj as desired
cid3
Our well-posedness result is the following
Theorem 6 Under Assumption 4 there exists a pathwise unique Hawkes process Z i
t iSt0 such
that PiS piEZ i
t    for all t  0
Observe that this result is not completely obvious in the case of an innite graph
In some
sense we have to check that the interaction does not come from innity Let us insist on the fact
that even in simple situations a graphical construction is not possible consider eg the case of
Z endowed with the set of edges E  i j 
i  j  0 or 1 assume that hix  1  x for all
i  S and that ij  1 for all i j  E Then one easily gets convinced that we cannot determine
the values of Z 0
t t0T  by observing the Poisson measures i in a random nite box
t    or something similar
As a second comment let us mention that we believe it is not possible or at least quite
dicult to obtain the full uniqueness ie uniqueness outside the class of processes satisfying
PiS piEZ i
Indeed consider again the case of Z endowed with
E  i j 
i  j  0 or 1 assume that hix  1  x for all i  S and that ji  1 for all
i j  E One easily checks that for Z i
t it holds that
t  t R t
ds for every i This innite system of equations is of course closely
related to the heat equation tut x  1  xxut x on 0  R and with initial condition
u0 x  0 As is well-known uniqueness for this equation fails to hold true without imposing
some growth conditions as x   See eg Tychonovs counterexample of uniqueness which
can be found in John 23 Chapter 7
tiSt0 a Hawkes process for mi
t  EZ i
s  mi1
0 mi1
Proof We rst prove uniqueness Let thus Z i
satisfying the required condition Set
t iSt0 and  Z i
t iSt0 be two solutions to 1
0 cid12cid12dcid0Z i
s  Z i
scid1cid12cid12 for i  S t  0
In other words i
put i
t  Ei
t is the total variation norm of the signed measure dcid0Z i
s  Z i
scid1 on 0 t We also
t and rst prove that
t  ciZ t
0 Xji
jit  sj
HIGH DIMENSIONAL HAWKES PROCESSES
We have
Taking expectations we deduce that
0 jisudZj
0 Z 
ciXji
cid12cid12cid121cid8zhicid0 Pji R s
ucid1cid9  1cid8zhicid0 Pji R s
Ehcid12cid12cid12hicid0Xji
ucid1  hicid0Xji
jis  udZ j
0 Z s
cid12cid12jis  ucid12cid12dj
0 jisud Zj
jis  ud Z j
ucid1cid9cid12cid12cid12ids dz
ucid1cid12cid12cid12ids
by Assumption 4-a Using Lemma 22 we see that
dsZ s
jis  udj
0 cid12cid12jit  ucid12cid12j
which plugged into 3 yields 2
Set t  PiS pii
is well-dened and nite We infer by 2 that
t where the weights pi were introduced in Assumption 4 By assumption t
By Assumption 4-c
t Z t
0 XjS
s XijiE
piciXjicid12cid12jit  scid12cid12j
0 XiS
t Z t
cipicid12cid12jit  scid12cid12ds Z t
0 XjS
st  sds Z t
t  ssds
Lemma 23-i thus implies that t  0 identically from which uniqueness follows
We now quickly prove existence by a Picard iteration Let Z i0
Z in1
0 Z 
 dZ in
0dZ in1
t  ER t
We dene in
obtain for n  0
0 jisudZjn
1zhiPji R s
 and n
t  PiS piin
t  sn
t  0 and for n  0
u ids dz
 As in the proof of uniqueness we
Next we put min
t  EZ in
EhZ t
0 cid16hi0  ciXji
 By Assumption 4-a hix  hi0  cix whence
jis  udZ jn
jit  smjn
s cid17ds
u cid17dsi Z t
jis  udZ jn
0 cid16hi0  ciXji
u ds  R t
s ds  Ct Z t
jis  umjn
t  sun
0jit  uZ jn
u du Setting
where we used that by Lemma 22 R t
t PiS pimin
0 XiS
t tXiS
hi0pi Z t
0 R s
piciXji
and using Assumption 4-b-c
t  0 and  is locally integrable we easily check by induction that un is locally bounded
Since u0
for all n  0 Consequently n is also locally bounded for all n  0 Lemma 23-ii implies that
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
converges there exists a family Z i
for all T  0 Pn1 n
all T  0 limnPiS piER T
from which PiS piEZ i
deduce that Z i
s  dZ in
t    as desired
T   This classically implies that the Picard sequence is Cauchy and thus
tiSt0 of cadlag nonnegative adapted processes such that for
  0 It is then not hard to pass to the limit in 4 to
t   for all t  0
t iSt0 solves 1 Finally Lemma 23-iii implies that supn un
0 dZ i
cid3
In this section we work in the following setting
3 Mean-field limit
Assumption 7 Let h  R 7 0 be such that hlip  supx6y x  y1hx  hy   and
let   0 7 R be a locally square integrable function
For each N  1 we consider the complete graph GN with vertices SN  1     N and edges
EN  i j 
i  h for all
i  SN and N
i j  SN ie all pairs of points in SN are connected We put hN
ji  N 1 for i j  EN 
Under Assumption 7 the triplet GN  N  hN  satises Assumption 4 the graph GN is nite
t0 with parameters GN  N  hN 
     Z NN
for each N  1 Therefore a Hawkes process Z N1
is uniquely dened by Theorem 6
Introduce the limit equation
Z t Z t
0 Z 
1cid8z  hcid0Z s
s  udEZ ucid1cid9ds dz
for every t  0
where ds dz is a Poisson measure on 0  0 with intensity measure dsdz Also dEZ u
is the measure on 0 associated to the necessarily non-decreasing function u 7 EZ u Note
that a solution Z  Z tt0 if it exists is an inhomogeneous Poisson process on 0 with
intensity t  hR t
0 t  udEZ u
31 Propagation of chaos The main result of this section reads as follows
Theorem 8 Work under Assumption 7
i There is a pathwise unique solution Z tt0 to 7 such that EZ tt0 is locally bounded
ii It is possible to build simultaneously the Hawkes process Z N1
     Z NN
t0 with parame-
tt0i1N of solutions to 7 in such a way that for
ters GN  N  hN  and an iid family Z
all T  0 all i  1     N 
0T Z Ni
t  Z
ti  CT N 12
the constant CT depending only on h  and T see Remark 9 below for some bounds of CT in a
few situations
iii Consequently we have the mean-eld approximation
ZNi
t0  Lcid0Ztt0cid1 in probability as N  
where PD0 R is endowed with the weak convergence topology associated with the topology
on D0 R of the uniform convergence on compact time intervals
HIGH DIMENSIONAL HAWKES PROCESSES
Proof For Z tt0 a solution to 7 the equation satised by mt  EZ t writes
mt Z t
hcid0Z s
s  udmucid1ds for every t  0
By Lemma 24 we know that this equation has a unique non-decreasing locally bounded solution
which furthermore is of class C1 on 0 We now split the proof in several steps
Step 1 Here we prove the well-posedness of 7 For Ztt0 a solution to 7 its expectation
mt  EZ t solves 8 and is thus uniquely dened Thus the right hand side of 7 is uniquely
determined which proves uniqueness For the existence consider m the unique solution to 8 and
0 sudmuds dz We thus only have to prove that EZ t  mt But
put Zt  R t
0 R 
0 1zhR s
0 hR s
EZ t R t
0 s  udmuds which is nothing but mt since m solves 8
Step 2 We next introduce a suitable coupling Let ids dzi1 be an iid family of Poisson
measures with common intensity measure dsdz on 0  0 For each N  1 we consider
the Hawkes process Z N1
     Z NN
0 Z 
u cid1cid9ids dz
Next still denoting by m the unique solution to 8 we put for every i  1
1cid8zhcid0N 1 PN
0 sudZNj
j1 R s
0 Z 
1cid8zhcid0 R s
0 sudmucid1cid9ids dz
Clearly Z
tt0i1 is an iid family of solutions to 7
Step 3 Here we introduce i
u  Z Ni
does not depend on i by exchangeability Observe that
u  and N t  Ei
N t  R t
N t which obviously
0t Z
u  Z Ni
u   i
N t whence Eh sup
0t Z
u  Z Ni
u i  N t
We show in this step that for all t  0
N t  hlipN 12Z t
0 cid16Z s
2s  udmucid1712
ds  hlipZ t
0 t  sN sds
First 1
N t equals
Taking expectations we nd
0 Z 
cid12cid12cid121cid8zhcid0N 1 PN
Ehcid12cid12cid12hcid0Z s
N t Z t
0 sudmucid1cid9cid12cid12cid12ids dz
u cid1cid12cid12cid12ids
s  udZ Nj
j1 R s
0 sudZNj
u cid1cid9  1cid8zhcid0 R s
s  udmucid1  hcid0N 1
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
s  udmu  N 1
s  udZ
u  Z Nj
s  udZ
u cid12cid12cid12ids
ucid12cid12cid12ids
0 s  ud1
N uids Z t
0 t  uN udu
u are iid with mean R s
Var X 1
s 12ds
A  N 12Z t
0 s  udmu whence
N t hlipZ t
Ehcid12cid12cid12Z s
 hlipZ t
Ehcid12cid12cid12N 1
hlipA  B
Using exchangeability and Lemma 22
B Z t
0 s  udZ
Next we use that X j
But it holds that
1zhR u
0 Z 
s  Z s
2s  uhcid0Z u
0 Z 
s  EX 1
Var X 1
Recalling Assumption 7 we nd
Since the integrand is deterministic denoting by 1 the compensated Poisson measure
0 urdmrs  u1du dz
1zhR u
0 urdmrs  u1du dz
u  rdmrcid1ds Z s
2s  udmu
We used 8 for the last inequality Gathering 11 12 13 and 14 completes the step
Step 4 Here we conclude that for all T  0 sup0T  N t  CT N 12 This will end the proof
of ii by 9 This is not hard it suces to start from 10 to apply Lemma 23-i and to observe
0cid16R s
that R t
locally square integrable and the fact that m is C1 on 0
ds is locally bounded which follows from the assumption that  is
0 2s  udmucid1712
Step 5 Finally iii follows from ii by Sznitman 35 Proposition 22 it suces to check that
t0 goes in law as N   to  independent copies of
for each xed   1 Z N1
Z tt0 for the uniform topology on compact time intervals This clearly follows from ii
t0     Z N
cid3
We now want to show that the constant CT we get can be quite satisfactory
Remark 9 Work under Assumption 7
a Assume that hlipR 
sds  1 subcritical case and that R 
0 2sds   Then ii
of Theorem 8 holds with CT  CT  for some constant C  0 This is a satisfactory slow growth
b Assume that hx    x for some   0 and that t  aebt for some a  b  0
if a  b then point a applies Then mt  EZ t  aa  b2eabt as t   and ii of
Theorem 8 holds with CT  CeabT  for some constant C  0 This is again quite satisfactory
the error is of order N 12mT 
HIGH DIMENSIONAL HAWKES PROCESSES
Proof We start with a Using the notation of the previous proof it suces see 9 to show
that N T   CT N 12 Setting   hlipR 
sds  1 starting from 10 and observing
that N is non-decreasing we nd N t  hlipN 12R t
0 2s udmu12ds  N t whence
0 2s  udmu12ds We thus only have to check that R s
N t  CN 12R t
0 2s  udmu is
bounded on 0 Since R 
0 2sds   it suces to prove that m is bounded on 0 But
udu  h0hlipR t
t  hR t
t  h0 sup0T  m
0 tum
0 tum
and thus sup0T  m
t  h01   for any T  0
We next check b First 8 rewrites mt  t  aR t
0 ebsudmuds with unique solution
aeabt  1
a  b2 eabt
ds Z t
mt  bt
a  b
0 cid16Z s
N t N 12Z t
Next using 10 and the explicit expressions of h  and m we nd
2s  udmucid1712
udu whence sup0T  m
t  sN sds
a  b2
CN 12eabt2  aZ t
ebtsN sds
0 uN sds By Gronwalls lemma
0 CN 12eabs2eatsds On easily deduces since a  b that
Setting uN t  N tebt we get uN t  CN 12eabt2  aR t
uN t  CN 12eabt2  aR t
uN t  CN 12eat so that N t  CN 12eabt The use of 9 ends the proof
32 Large time behaviour We now address the important problem of the large time behaviour
Since the solution Z tt0 to 7 is nothing but an inhomogeneous Poisson process its large-time
behaviour is easily and precisely described provided we have suciently information on the solution
to 8 The question is thus can we use the large time estimates of the mean-eld limit to describe
the large-time behaviour of the true Hawkes process with a large number of particles To x the
ideas we consider the linear case
cid3
We treat separately the subcritical and supercritical cases
Theorem 10 Work under Assumption 7 with  nonnegative and hx    x for some  
0 sds  1 For each N  1 consider the Hawkes process
t0 with parameters GN  N  hN  Consider also the unique solution mtt0
0 Assume also that   R 
     Z NN
to 8
1 We have mt  a0t as t   where a0  1  
2 For any xed i  1 Z Ni
for some constant C
precisely EZ Ni
t mt  1  Cm12
3 For any xed   1 m12
without condition on the regime
t mt tends to 1 in probability as t   uniformly in N  More
mt  1i1 goes in law to N 0 I as t N   
Theorem 11 Work under Assumption 7 with  nonnegative and hx    x for some   0
0ds has at most polyno-
t0 with parameters
Assume also that  R 
mial growth For each N  1 consider the Hawkes process Z N1
GN  N  hN  Consider also the unique solution mtt0 to 8
0 sds  1 Assume nally that t 7R t
     Z NN
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
1 We have mt  a0e0t as t   where 0  0 is determined by L0  1 and where
there is a constant C such that EZ Ni
t mt  1  m12
 CN 121  m1
mt tends to 1 in probability as t N    More precisely
0 R 
a0  2
tte0tdt1
2 For any xed i  1 Z Ni
3 For any xed   1
i m12
ii N 12Z Ni
02R 
mt  1i1 goes in law to N 0 I if t   and N   with mtN  0
t mt  1i1 goes in law to X     X if t   and N   with mtN 
 Here X is a N 0 2-distributed random variable where 2  2
0 e20sm
Let us summarize At rst order law of large numbers the mean-eld approximation is always
good for large times At second order central limit theorem the mean eld approximation is
always good for large times in the subcritical case but fails to be relevant for too large times
depending on N  in the supercritical case the independence property breaks down
In the supercritical case we have the technical condition that t 7 R t
0ds has at most poly-
nomial growth This is useful to have some precise estimates of the solution m to 8 This is eg
always satised when  is bounded and non-increasing as is often the case in applications It is
slightly restrictive however since it forces 0 to be nite
It should be possible to study also the critical case but then the situation is more intricate
many regimes might arise With a little more work we could also study in the supercritical case
the regime where mtN  x  0
In order to prove Theorems 10 and 11 we will use the following central limit theorem for
     M N
martingales
Lemma 12 Let   1 be xed For N  1 consider a family M N1
t0 of -
dimensional local martingales satisfying M Ni
0  0 Assume that all their jumps are uniformly
bounded and that M Ni M Njt  0 for every N  1 i 6 j and t  0 Assume also that
there is a continuous increasing function vtt0  0 7 0 such that for all i  1     
limtN  v2
M Ni M Nit  1 in probability In the case where v  limt vt   as-
sume moreover that for all i  1      all t0  0 uniformly in t  t0 limNM Ni M Nit  v2
in probability
Then v1
 converges in law to the Gaussian distribution N 0 I as t N  
 where I is the    identity matrix
Proof Let tN N 1 be a sequence of positive numbers such that tN   We want to prove that
tN M N1
tN  converges in law to N 0 I For all u  0 1 set
tN   M N
  M N
u  inft  0  v2
t  u v2
tN for all u  0 1 and  N
Since v is increasing and continuous  N is also continuous and increasing for each N  We also
clearly have v2
1  tN  Finally for each u  0 xed the sequence
u is increasing
For all u  0 1 limN v2
 1 in probability Indeed in the case v  
this follows from the facts that limN  N
M Ni M Nit  1 When
v   the additional assumption uniformity in t  t0 of the convergence as N   clearly
suces since the sequence  N
u   and limtN  v2
u is increasing and thus bounded from below
M Ni M Ni N
HIGH DIMENSIONAL HAWKES PROCESSES
We dene the martingales LNi
 All their jumps are uniformly
bounded because those of M Ni are assumed to be uniformly bounded and because supN v1
tN  
since v is increasing We also have LNi LNju  0 for all i 6 j all u  0 1 Furthermore
using that v2
u u01 by LNi
u  v1
tN M Ni
LNi LNiu 
M Ni M Ni N
M Ni M Ni N
u  u
u      LN
in probability Therefore according to Jacod-Shiryaev 22 Theorem VIII-311 the process
uu01 where the Bi are independent stan-
u u01 converges in law to B1
dard Brownian motions In particular LN1
 goes in law to N 0 I To conclude the
proof it thus suces to observe that LNi
 v1
cid3
u     B
     LN
tN M Ni
1  v1
tN M Ni
We can now give the
Proof of Theorem 10 In the present linear case we can rewrite 8 as mt  R t
udmuds  t R t
recalling that  R 
0 s 
0 t  smsds by Lemma 22 This equation is studied in details in Lemma 25
0 sds  1 we have m
t  a0 and mt  a0t as t   where a0  1 
which proves point i The proof is now divided in several steps Step 1 will also be used in the
supercritical case
0  R s
Step 1 Recall that for some iid family ids dzi1 of Poisson measures on 0  0
with intensity measure dsdz
0 Z 
1cid8zN 1 PN
j1 R s
0 sudZNj
u cid9ids dz
0 cid16 Z s
We have EZ Ni
  mt Indeed by exchangeability we see that EZ Ni
  EZ N1
 and that
EZ N1
0 cid16  N 1
s  udEZ Nj
u cid17ds Z t
s  udEZ N1
cid17ds
whence EZ N1
t0 solves 8 of which the unique solution is mtt0 by Lemma 24
We next introduce U Ni
t  Z Ni
t  mt and the martingales here ids dz  ids dz  dsdz
0 Z 
0 sudZNj
j1 R s
u cid9 ids dz
t  N 1PN
1 U Ni
and nally M
 An easy computation using 8 and Lemma 22 shows that
We consider the mean processes Z
N 1PN
1 M Ni
t M Ni
1 Z Ni
1cid8zN 1 PN
t  N 1PN
s  ucid16N 1
t  scid16N 1
s  udZ Nj
u ds  mt
u  dmucid17ds
s  mscid17ds
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
so that
t  M Ni
t  sU
This directly implies that
t  sU
Next we observe that M Ni M Njt  0 for all i 6 j because these martingales as never jump
simultaneously and that M Ni M Nit  Z Ni
t  We thus have
EM Ni
t   N 1mt
t 2  N 1EZ
  mt and EM
2  EZ Ni
t  N 1Z
 Hence M
Step 2 Recalling 16 and using that   R 
sup0t M
s i  1  1Eh sup
0t M
s    sup0t U
0t U
s  Consequently
s i  CN 12m12
0 sds  1 we observe that sup0t U
s  
by the Doob and Cauchy-Schwarz inequalities We easily deduce that
t  sU
s dsi  Eh sup
0t U
s i  CN 12m12
whence nally recalling 15
EU Ni
t mt  1  Cm12
This says that EZ Ni
  m1
and thus proves point 2
Step 3 We then x   1 and use 15 to write for i  1     
t  m12
t  m12
t M Ni
mt  1  m12
EM Ni
  Cm1
t N 12m12
t  Cm12
t  sU
t M Ni
First Em12
s ds  CN 12 which tends to 0 as t N    by the es-
0 t  sU
timate proved in Step 2 To conclude the proof of point 3 we thus only have to prove that
m12
i1 goes in law to N 0 I as t N    To this end we apply Lemma
12 The jumps of the martingales M Ni are uniformly bounded by 1 and we have seen that
M Ni M Njt  0 for all i 6 j The function mtt0 is continuous and increases to innity
It thus suces to check that as t N    m1
M Ni M Nit  1 in probability Since
M Ni M Nit  Z Ni
 this is an immediate consequence of point 2
cid3
We now turn to the supercritical case
Proof of Theorem 11 We rewrite 8 as mt R t
0 s udmuds  t R t
0 t smsds by
Lemma 22 This equation is studied in details in Lemma 26 there is a unique 0  0 such that
L0  1 and dening a0  0 as in the statement we have mt  a0e0t and m
t  a00e0t
as t   which proves point 1 We also know that t  Pn1 nt  a02
0e0t that
t R t
0 sds  a00e0t and further properties of m m   are proved in Lemma 26
Step 1 We adopt the same notation as in the proof of Theorem 10-Step 1 of which all the
0  R s
results remain valid in the present case Point 1 follows from Lemma 26-a
HIGH DIMENSIONAL HAWKES PROCESSES
   U
 Using Lemma 26-e we deduce that
are clearly as cadlag and thus locally bounded
Step 2 First 16 says exactly that U
Since EM
   M
the processes U
t 2  N 1mt by Step 1
t  EM
t  Z t
N 12m12
CN 121  mt
The last inequality easily follows from Lemma 26-b
t  sEM
t  sN 12m12
Using 16 again we see that R t
Ehcid12cid12cid12Z t
s cid12cid12cid12i  EM
t   N 12m12
On the other hand we know from Step 1 that EM Ni
0 t  sU
t   EU
t  sU
s ds  U
t  whence
t  M
t  CN 121  mt  CN 121  mt
2  mt Using 15 we conclude that
EZ Ni
which ends the proof of 2
mt  1  m1
EU Ni
  m12
 CN 121  m1
Step 3 We then x   1 and write for i  1      by 15
t  m1
mt  1  m1
t  m1
t M Ni
t U Ni
t  sU
Step 31 We rst consider the regime t N    with mtN  0 and study
mt  1  m12
t M Ni
t  m12
t  sU
The second term tends to 0 in probability because we can bound using Step 2 its L1-norm
by Cm12
t N 121  mt which tends to 0 in the present regime We thus just have to prove
that m12
t M Ni
i1 goes in law to N 0 I We use Lemma 12 the martingales M Ni have
uniformly bounded by 1 jumps and we have seen that M Ni M Njt  0 for i 6 j The function
mtt0 is continuous and increases to innity It only remains to check that m1
M Ni M Nit
tends to 1 in probability But M Ni M Nit  Z Ni
 so that the conclusion follows from point 2
Step 32 We nally consider the regime t N    with mtN   and study
N 12Z Ni
t mt  1  N 12m1
t M Ni
t  N 12m1
t  sU
t M Ni
First N 12m1
EM Ni
does not depend on i it only remains to prove that V N
using 16 recalling that U
t  0 in probability because its L1-norm is bounded by N 12m12
recall that
goes in law to N 0 2 We write
see Step 2 and integrating by parts recall that
2  mt which tends to 0 in the present regime Since V N
0 t  sU
 N 12m1
   M
t R t
0 sds
t  N 12m1
t  M
t   N 12m1
t  sM
s ds  N 12m1
t  sdM
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
Introduce W N
t  0N 12R t
0 e0sdM
s and observe that since EM
t  N 1mt
t  W N
t 2 EhNZ t
t t  s  0e0s2dM
t t  s  0e0s2m
Lemma 26-c tells us that this tends to 0 as t   We thus only have to prove that W N
in law to N 0 2 as t N   
0 e20sm
bounded by 0N 12 because those of M
This follows again from Lemma 12 with   1 the jumps of the martingale W N
0R t
dened in the statement We thus only have to prove that a v2
as t N    b for all t0  0 uniformly in t  t0 v2
N   By Lemma 12 we will deduce that v1
which of course implies that W N
t t0 are
are bounded by N 1 The function vt 
sds12 is continuous and increasing to the nite limit v   which was
W N  W N t  1 in probability
W N  W N t  1 in probability as
t goes in law to N 0 1 as t N   
t goes in law to N 0 2 as desired
We have since M
t  N 1Z
W N  W N t  02NZ t
e20sdM
s  02Z t
e20sdZ
Using that Z
t  mt and performing an integration by parts we see that
W N  W N t v2
t  02Z t
e20sdU
t  02e20tU
t  23
02Z t
e20sU
Recalling that that EU
t   CN 121  mt we infer
Ehcid12cid12cid1202e20tU
N 12cid16e20t1  mt Z t
t  23
e20sU
02Z t
s dscid12cid12cid12i
e20s1  msdscid17
which is bounded by CN 12 by Lemma 26 We have proved that supt0
CN 12 from which points a and b above immediately follow The proof is complete
EW N  W N t  v2
t  
cid3
4 Nearest neighbour model
We consider here the case where G is a regular grid on which particles interact directly only
if they are neighbours We will work on Zd endowed with the set of edges
E  i j  Zd2 
r12 Thus each point has 2d  1 neighbours including itself
We hesitated to include self-interaction but this avoids some needless complications due to the
periodicity of the underlying random walk on Zd
where i1     id  Pd
i  j  0 or 1
HIGH DIMENSIONAL HAWKES PROCESSES
Assumption 13 i The graph G  SE is S  Zd for some d  1 endowed with the above
set of edges E
ii There is a nonnegative locally integrable function   0 7 0 such that for all
j i  E ji  2d  11
iii For all i  Zd there is i  0 such that hix  i  x The family iiZd is bounded
We next introduce a few notation In the whole section we call vector and write in bold a
family of numbers indexed by Zd We call matrix a family indexed by Zd Zd The identity matrix
I is of course dened as Ii j  1ij We will often use the product of a matrix and a vector
The matrix A  Ai jijZd dened by
Ai j  2d  111ijE
will play an important role Since A is a stochastic matrix we can dene for any   0 1
nAni j
Qi j  Xn0
the unique Hawkes process Z i
the subcritical and supercritical cases
tiZdt0 with parameters G  h For all i  Zd t1Z i
41 Large-time behaviour Under Assumption 13 we can use Theorem 6 with pi  2i see
Remark 5-ii there is a unique Hawkes process Z i
t iZdt0 with parameters G  h such that
t    Let us state the rst results of this section As usual we treat separately
PiZd 2iEZ i
Theorem 14 Work under Assumption 13 and assume further that  R 
probability as t   to PjZd Qi jj
Theorem 15 Work under Assumption 13 and assume further that   R 
and that t 7 R t
L0  1 Assume nally that the mean value
i  r Xir
tiZdt0 with parameters G  h Then for all i  Zd
0 tdt  1
0ds has at most polynomial growth Consider 0  0 uniquely dened by
  lim
r
i  Zd 
Consider the unique Hawkes process Z i
e0tZ i
0 tdt  1 Consider
t goes in
t goes in probability as t   to a0  2
tte0tdt1
0 R 
exists and is positive
Let us comment on these results In the subcritical case the parameter   iiZd is strongly
present in the limiting behaviour the limit of t1Z i
t depends on a certain mean of  around the
site i and thus depends on i In the supercritical case the behaviour is very dierent the limit
value of e0tZ i
t does not depend on i and depends on   iiZd only through a global mean
value Observe also that for a nite-dimensional eg scalar Hawkes process there is no law of
large numbers one can get a limit of something like e0tZ i
t but the limit is random see Zhu
41 Section 54 in particular Theorem 23 and Corollary 1 In that sense we can say that in
the supercritical case the law of large number is reminiscent of the innite dimension and of the
interaction
We will need a precise approximation for Ani j where A is dened by 17 It is given by
the local central limit theorem since A is the transition matrix of an aperiodic symmetric random
walk on Zd with bounded jumps Precisely we infer from Lawler-Limic 25 Theorem 211 and
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
25 that there is a constant C such that for all n  1 all i  Zd
where for t  0 and x  Rd
An0 i  pni 
expcid16 
4t cid17d2
ptx cid16 2d  1
nd22
2d  1x2
cid17
To apply 25 Theorem 211 we needed to compute the covariance matrix  corresponding to our
random walk we found   22d  11Id Id being the d  d identity matrix
Lemma 16 Consider the matrix Ai jijZd dened by 17
i It holds that n PjZd Ani j2 does not depend on i  Zd and tends to 0 as n  
ii Let   iiZd be bounded and satisfy 19 Then for all i  Zd limnAni  
Proof In the following we denote by C a constant depending only on d
Point i is easy
since Ani j  An0 j  i and since A is stochastic one has n 
PjZd An0 j2  supjZd An0 j Moreover by 20 An0 j  pnjCnd22  Cnd2
We conclude that n  Cnd2  0 as desired
Now we turn to the proof of ii Let i  Zd First we show that limnAniPjZd pnjj  
0 Since Ani  PjZd Ani jj  PjZd An0 j  ij and since the family j jZd is
bounded it suces to prove that vn PjZd An0 j  i  pnj  0 We write
vn  Xjn1214d
An0 j  i  pnj  v1
An0 j  i  pnj  Xjn1214d
On the one hand using that PjZd j2An0 j  Cn the variance of the random walk at time n
is of order n so that PjZd j2An0 j  i PkZd i  k2An0 k  Ci2  n and thus
An0 j  i  Cn112d XjZd j2An0 j  i  Cn112di2  n
Xjn1214d
Similarly we have PjZd j2pnj  Cn and thus
Xjn1214d
pnj  n112d XjZd j2pnj  Cn12d
Consequently limn v2
n  0 On the other hand
n  Xjn1214d
An0 j  i  pnj  i  Xjn1214d
pnj  i  pnj
From 20 the rst sum is bounded by Cnd22j  Zd  j  n1214d  Cn34  0
For the second sum we use that with cd  2d  14
pnj  i  pnj  pnjcid12cid12cid121  expcid0
n i2 
ijcid1cid12cid12cid12
Hence for j  n1214d and for n large enough eg so that in1214d  1
pnj  i  pnj  Cpnji2n1  in1214d  Cpnj1  i2n14
Thus Pjn1212d pnj  i  pnj  C1  i2n14 and we deduce that limn v1
HIGH DIMENSIONAL HAWKES PROCESSES
We have shown that lim vn  0 It only remains to check that limnPjZd jpnj   Let
 j  Zd
rkk0 be the increasing sequence of nonnegative numbers such that rkk0  j
and observe that
XjZd
jpnj Xk0
pnrk Xjrk
A discrete integration by parts shows that
vrkpnrk  pnrk1
vrk Xjrk
j  r We easily conclude that limnPjZd jpnj   as desired
j Xk0
jpnj Xk0
pnrk  pnrk1 Xjrk
XjZd
where vr  j  Zd 
because
vrkPjrk
k0 vrkpnrk  pnrk1  1
j  
a limk
b for all k  0 xed limn vrkpnrk  pnrk1  0
c limnP
Point a follows from our condition 19 on  point b is obvious because vrkpnrk 
pnrk1  vrk supiZd pni  Cvrknd2  0 To check c we writeP
k0 vrkpnrk
pnrk1 PjZd pnj PjZd An0 jPjZd pnjAn0 j  1PjZd pnjAn0 j
This tends to 1 because limnPjZd pnj  An0 j  0 as seen in the rst part of the proof
this is vn in the special case where i  0
Let us now give the
cid3
Proof of Theorem 14 We split the proof into several steps We assume that there is at least one
i  Zd such that i  0 because else the result is obvious because then Z i
t  0 for all i  Zd all
t  0 The rst step will also be used in the supercritical case
Step 1 We write as usual for some iid family ids dzi1 of Poisson measures on 0 
0 with intensity measure dsdz
0 Z 
Let us put mi
22 gives us for all i  Zd
t  EZ i
1cid8zi2d11 Pji R s
0 sudZj
ucid9ids dz
t  and mt  mi
tiZd  A simple computation using one more time Lemma
t  smj
t  it Z t
2d  11Xji
Using the vector formalism this rewrites mt  t R t
from Theorem 6 that for all t  0 PiZd 2imi
of class C1 on 0 for each i  Zd that
t   Z t
t cid16I Xn1
t  sAm
and that
nsdscid17
0 t  sAmsds We furthermore know
t   Applying Lemma 27 we see that mi is
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
Lemma 27 also tells us that ut  supiZd sup0tmi
that supiZd sup0t mi
s is also locally bounded because mi
ut  C Z t
t  susds
s is locally bounded which of course implies
0  0 for all i  Zd and that
We introduce the martingales for i  Zd we use a tilde for compensation
ucid9 ids dz
and observe as usual that M i M jt  0 when i 6 j because these martingales as never jump at
the same time while M i M it  Z i
t iZd
and M t  M i
1cid8zi2d11 Pji R s
t  We nally introduce U i
t the vectors U t  U i
0 Z 
t iZd and observe that
0 sudZj
t  Z i
U t  M t Z t
t  sAU sds
Indeed for every i  Zd using Lemma 22 and the equation satised by mi
t we nd
2d  11Xji
t  sZ j
s  mj
sds  M i
t  sAU sids
Equation 25 can be solved as usual as
U t cid16M t Xn1
nt  sAnM sdscid17
Finally we easily check that vt  supiZd sup0t
t  mi
t12  R t
t  2mi
0 usds12 and that A is stochastic
t and satises start from 25 use that EM i
s is locally bounded because EU i
t  EM i M it12  EZ i
t 
t12 
vt cid16Z t
usdscid1712
t  svsds
also mi
Step 2 Here we prove that there is a constant C such that for all i  Zd mi
t  C and thus
t  Ct This follows from 24 which implies that ut  C  ut whence ut  C1  
t  Qit as t   Indeed starting
0 sdsn  n
Step 3 For all i  Zd mi
from 23 using the monotone convergence theorem and that R 
0 nsds  R 
t  Qi whence also mi
nAncid17cid17i
t cid16cid16I Xn1
t
 Qi
Step 4 There is a constant C such that for all i  Zd all t  0 EU i
follows from 27 and Step 2 which imply that vt  Ct12  vt whence vt  Ct121  
t  Ct12 Indeed this
Step 5 The conclusion follows immediately writing
Ehcid12cid12cid12
t  Qicid12cid12cid12i  Ehcid12cid12cid12
t cid12cid12cid12i cid12cid12cid12
t  Qicid12cid12cid12
cid3
which tends to 0 as t   by Steps 3 and 4
We now turn to the supercritical case
HIGH DIMENSIONAL HAWKES PROCESSES
Proof of Theorem 15 We consider m not to be confused with m the unique solution to mt 
0 t smsds where  is the mean value dened by 19 This equation is studied in details
t  a00e0t
t R t
in Lemma 26 with 0 and a0 dened in the statement we have mt  a0e0t and m
as t   as well as t Pn1 nt  a02
Step 1 We adopt the notation introduced in Step 1 of the proof of Theorem 14
t  Ce0t and thus
Step 2 Here we check that that there is C such that for all i  Zd mi
t  Ce0t This follows from 24 which tells us that ut  supiZd mi
t is locally bounded
and satises ut  C R t
0 t  susds we see that ht is locally
bounded from above and from below because u is locally bounded and  is locally integrable
We furthermore have u  h  u   Applying Lemma 26-e we deduce that u  h  h   But
h is bounded from above by C Consequently u  C  C    C1   where  was dened in
Lemma 26 The conclusion follows from Lemma 26-b
0 t  susds Setting ht  ut R t
0e0t and t R t
0 sds  a00e0t
t  mi
Step 3 We now show that for all i  Zd mi
t  mt as t   Let us
0 nsds
x i  Zd and set ri
We know from Lemma 16-ii that n  Ani   tends to 0 as n   Consequently Lemma
26-d tells us that e0tPn1Ani  R t
t  0
as t   Using nally that m
1  a001e0tri
0 nsds tends to 0 as t   Hence e0tri
t  1  ri
t  i   Pn1Ani  R t
t  a00e0t as t   we conclude that mi
t  mt which satises ri
t  mt whence mi
tm
t  1 as desired
Step 4 Here we check that for every i  Zd e0tEU i
t tends to 0 as t   We start from
26 to write
t  M i
t Xn1
nt  sAnM sids
t  EZ i
But EM i
Ce0tPjAni j2  Ce0tn by Lemma 16-i with n  0 as n   Consequently
t12  Ce0t2 by Step 2 and EAnM t2
t 12  mi
i   PjAni j2mj
e0tEU i
t  Ce0t2  Ce0tXn1
nt  se0s2ds
Lemma 26-d allows us to conclude
Step 5 The conclusion follows writing
Ehcid12cid12cid12
a0e0t  1cid12cid12cid12i  Ehcid12cid12cid12
a0e0tcid12cid12cid12i cid12cid12cid12
a0e0t  1cid12cid12cid12
and using Steps 3 4 and that mt  a0e0t by Lemma 26-a
42 Study of an impulsion Here we want to study how an impulsion at time 0 at i  0
propagates To this end we work under Assumption 13 with i  0 for all i  Zd but we assume
that Z 0 has a jump at time 0 Such a study is of course important it allows us to measure in
some sense the range of the interaction
cid3
We rst dene precisely the process under study
Denition 17 We work under Assumption 13-i-ii and consider a family ids dz i  Zd
of iid Ftt0-Poisson measures on 0  0 with intensity measure dsdz We say that a
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
family Z i
tiZdt0 of Ftt0-adapted counting processes is an impulsion Hawkes process if
 i  Zd Z i
0 Z 
1cid8z Xji
2d  11Z s
s  udZ j
u  s1j0cid9ids dz
As said previously the term Pji s1j0 is interpreted as an excitation due to a forced
jump of Z 0 at time 0 simply rewrite it as 10iR s
0 s  uuds
The following proposition is easy
Proposition 18 Adopt the assumptions and notation of Denition 17 There exists a pathwise
unique impulsion Hawkes process Z i
t iZdt0 such that PiZd EZ i
t    for all t  0
Proof The proof resembles much that of Theorem 6 so we only sketch it We start with unique-
ness and thus consider two impulsion Hawkes processes Z i
t iZdt0 such that
s Z i
t  Ei
t which is locally
bounded by assumption We may check that i
sds exactly as in
the proof of Theorem 6 Summing in i and recalling that each site has 2d  1 neighbours we nd
t and t PiZd i
0 Pji t  sj
s i
t  2d  11R t
t   We set i
tiZdt0 and  Z i
0dZ i
0 t  ssds Lemma 23-i tells us that t  0 for all t whence pathwise uniqueness
Lemma 22 shows that mi
t   for all t  0 Set mi
Existence follows from a Picard iteration Let us only check an a priori estimate implying that
t A direct computation using
0 sds Summing in i
0 sds Using Lemma 23-i that  is locally integrable and
cid3
t  and mt  PiZd mi
0 t  smj
t  2d  11PjiR t
0 t  smsds R t
sds  1j0R t
0 sds is locally bounded we deduce that sup0T  mt  CT  as desired
t  EZ i
t  Z i
PiZd EZ i
t R t
PiZd EZ i
we nd mt  R t
that R t
We next compute the probability of the extinction event Point 1 is a noticeable property that
makes the result very easy and precise
Theorem 19 Adopt the assumptions and notation of Denition 17 and consider the impulsion
Hawkes process Z i
tiZdt0
1 The process Zt  PiZ Z i
In other words Ztt0 is a counting process with compensator At R t
0 sds where
t is a scalar impulsion Hawkes process with excitation function 
t  t Z t
t  sdZs
2 We introduce the extinction event dened by e  limtPiZd Z i
t   Setting  
0 sds we have i Pre  0 if    ii Pre  exp if   1 where
  0 1 is characterised by   log1    0 iii Pre  1 if   0 1
Of course we can sometimes use this theorem by a simple comparison argument if ji depends
on i j For example to guarantee non-extinction with probability one it suces that all the ji
are bounded below by some 2d  11 such that R 
0 sds  
HIGH DIMENSIONAL HAWKES PROCESSES
Proof Point 1 is immediate the compensator of the counting process Ztt0 is
2d  11Z s
s  udZ j
u  s1j0ds
At Z t
0 XiZdXji
Z s
0 XjZd
s Z s
s  udZ j
u  s1j0ds
s  udZuds
We next prove point 2 It is well-known Folklore that a scalar impulsion Hawkes process can
be related to a Poisson Galton-Watson process with Poisson reproduction law but we give a
direct proof for the sake of completeness If    it suces to note that Pre  PrZ 
  PrA    PrR 
0 sds    0 When    we introduce the martingale for
  0 1 N 
0 t  sZsds by Lemma 22 We denote
t  EN t  eAtQst1  Zs its Doleans-Dade exponential see Jacod-Shiryaev 22
by M 
Chapter 1 Section 4f Since Z is a counting process we see that
t  Zt  At  Zt  R t
0 sds  R t
t  expcid16Z t
sds  Z t
t  sZsds  log1  Ztcid17
If   log1   0 then M  is bounded because R t
    log1  Zt   and thus converges in L1 Consequently EM 
easily veries using that Z is non-decreasing that limtR t
0 t  sZsds  Z
0 sds R t
Ehexpcid16 cid0log1    cid1Zcid17i  1
0 t sZsds log1 Zt 
  1 and one
But for all x  0 there is a unique x  0 1 such that x  log1  x  x whence
Ehexpcid16xZcid17i  expx
Consequently
Pre  PrZ    lim
Ehexpcid16xZcid17i  exp0
If   0 1 we see that 0  0 so that Pre  1 If now   1 0 is the unique solution
in 0 1 to 0  log1  0  0
cid3
We next study more deeply in the super-critical case how the impulsion propagates Unfortu-
nately the computations are really tedious we decided to restrict ourselves to a particular case
 is an exponential function where some computations are explicit We believe that the result
below can be extended to a general class of functions  but a dicult technical lemma is required
Theorem 20 Work under Assumption 13-i-ii with t  aebt for some a  b  0
Consider the impulsion Hawkes process Z i
0 sds  ab  1 we know from
Theorem 19 that Pre  0 1 We set 0  a b for which L0  1 and we recall that the
Gaussian density ptx is dened by 21
t iZdt0 Since R 
i There are some constants C  0 and t0  0 and a random variable H  0 such that for all
i  Zd all t  t0
Ecid2cid12cid12Z i
t  Hpatie0tcid12cid12cid3 
td213 
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
ii For all x  Rd td2e0tZ xt12
 Hpax in probability as t   Here we dene the
integer part y of y  y1     yd  Rd by y  y1    yd  Zd
iii The random variable H is positive on the event c
This result describes quite precisely how an impulsion propagates Conditional on non extinc-
tiZd resembles a Gaussian prole with height td2He0t and radius t
tion and the process Z i
for some positive random variable H
Compared to the previous result Theorem 15 the growth is only very slightly slower a single
impulsion at the site 0 produces a growth in td2e0t while we have e0t when all the sites are
regularly excited as is eg the case when i  1 for all i
Finally it is important to note that even if the growth near 0 of the process is very fast
exponential the spatial propagation is quite slow of order t
We start with some preliminary computations
Lemma 21 Adopt the notation and assumptions of Theorem 20 Introduce also for i  Zd and
t  0 i t Pn1 An0 int
i For all n  1 all t  0 nt  atn1ebtn  1
ii For all t  0 PiZd i t  e0t
iii There is C such that for all t  0 PiZd i2i t  C1  te0t
iv There are some constants C and t0  0 such that for all t  t0 all i  Zd
td213 
cid12cid12i t  patie0tcid12cid12 
cid12cid12Z t
i sds 
patie0tcid12cid12 
td213
Proof Point i is well-known and can be checked recursively Using that An is a stochastic matrix
Next we recall that A is the transition matrix of a symmetric random walk on Zd with bounded
we see that PiZd i t Pn1 nt Hence ii follows from i
jumps so that there is a constant C such that for all n  0 PiZd i2An0 i  Cn its variance
XiZd i2i t  CXn1
cid3
nnt  CXn1
at time n is of order n Consequently
 Ccid2Xn1
Xn2
atn1ebt
n  1
atn1ebt
n  2
natn1ebt
n  1
This is easily computed it gives Ce0t1  at
Point iv is more complicated First we need the Gaussian approximation of An0 i given by
20 We will also need the following result which can be found eg in 12 Lemma 9-d plus the
fact that for x  0 1 x  1 logx  1 x  x24 for any   0 for X a Poisson-distributed
random variable for any x  0 1
PrX    x  2 expx24
HIGH DIMENSIONAL HAWKES PROCESSES
We now turn to our problem Observing that Pn1 nt  e0t we write
ntAn0 i  paticid12cid12cid12
nt1n1atat23cid12cid12An0 i  pnicid12cid12
i t cid12cid12i t  patie0tcid12cid12 cid12cid12cid12Xn1
nt1n1atat23 Xn1
nt1n1atat23cid12cid12pni  paticid12cid12
We now assume that t is large enough so that ptai  1 for all i and we write
i t Xn1
Xn1
1i t  2i t  3i t
First using point i and 30 with   at and x  at13 we see that if t is large enough so
that at  1
1i t e0tXn1
eat atn1
n  1
1n1atat23  2e0teat134
nd22nt1n1atat23  Catd22Xn1
We next use 20 and assume that t is large enough so that n1at  at23 implies n  at2
2i t CXn1
nt  Ctd22e0t
Finally we observe that tptx  Ctd21 so that if t is suciently large n1at  at23
implies pni  pati  Ctd213 Consequently
3i t  Ctd213Xn1
nt  Ctd213e0t
We have proved that there are C and t0 such that for all t  t0 all i  Zd
cid12cid12i t  patie0tcid12cid12  2e0teat134  Ctd22e0t  Ctd213e0t  Ctd213e0t
which is 28
It remains to deduce 29 from 28 We write
t i cid12cid12cid12Z t
i sds  patie0t0cid12cid12cid12
Z tt12
i sds Z t
tt12cid12cid12i s  pasie0scid12cid12ds
tt12cid12cid12pasie0s  patie0scid12cid12ds  paticid12cid12Z t
1t i  2t i  3t i  4t i
e0sds  e0t0cid12cid12
tt12
First point ii implies that
1t i Z tt12
e0sds  Ce0tt12
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
Next 28 tells us if t is suciently large so that t  t12  t0 and t  t12  t2 that
2t i  CZ t
tt12
sd213e0sds  Ctd213e0t
Recalling that tptx  Ctd21 we get still for t large enough so that t  t12  t2
3t i  CZ t
tt12
sd21t  se0sds  Ctd212e0t
Finally if t is suently large we can bound pati by 1 for all i whence
0 e0t  e0tt12  e0t  Ce0tt12
4t i  1
All in all we have proved that for all t large enough all i  Zd
cid12cid12cid12Z t
i sds  patie0t0cid12cid12cid12  Ce0tt12  Ctd213e0t  Ctd212e0t  Ctd213e0t
cid3
as desired
We nally can give the
Proof of Theorem 20 We divide the proof in several steps
Step 1 As usual we write
0 Z 
1cid8z2d11 Pjicid2 R s
0 sudZj
us1j0cid3cid9ids dz
we set mi
t  EZ i
t and mt  mi
tiZd  A simple computation using Lemma 22 shows that
2d  11Xji
t  smj
sds  10i2d  11Z t
sds
Using the vector formalism and introducing   iiZd dened by i  1i0 this rewrites
0 t  sAmsds Dierentiating this formula see Lemma 27 for the
sds which
mt  AR t
0 sds R t
justication of a very similar dierentiation we nd m
can be solved as see Lemma 27 again m
0 t  sAm
t Pn1 ntAn Hence for all i  Zd
t  At R t
t  Xn1
An0 int
We introduce the martingales for i  Zd we use a tilde for compensation
0 Z 
1cid8z2d11 Pjicid2 R s
0 sudZj
us1j0cid3cid9ids dz
and observe as usual that M i M jt  0 when i 6 j because these martingales as never jump
at the same time while M i M it  Z i
t We will use several times that for any family iiZd 
Ecid2cid0 XiZd
tcid12cid3  XiZd
HIGH DIMENSIONAL HAWKES PROCESSES
t the vectors U t  U i
t iZd and M t  M i
We nally introduce U i
t  Z i
t  mi
exactly as in the proof of Theorem 14-Step 1 that U t  M t  AR t
cid16M t Pn1 AnR t
0 nt  sM sdscid17 and thus for all i  Zd
nt  sAni jM j
t  M i
t  XjZdXn1
s ds  mi
t  M i
t  W i
t iZd and observe
0 t  sU sds whence U t 
the last equality dening W i
Step 2 Here we treat the terms mi
t i Pn1 An0 int Starting from 31 we see that mi
Lemma 21-iv that there are C and t0  0 such that for all i  Zd all t  t0
td213 
t  R t
t  and collect a few more information Recall that
0 i sds and deduce from
cid12cid12mi
patie0tcid12cid12 
Next Lemma 21-ii-iii imply that PiZd mi
se0sds  C1  te0t Finally we observe that
t12 cid16 XjZd
X  XjZd
Step 3 We introduce
t  mi
e0sM j
0 e0sds  Ce0t and PiZd i2mi
t  CR t
tcid1712
 Ce0t2
and show that there are C  0 and t0  0 such that for all i  Zd all t  t0
td213 
We observe that since Ani j  An0 i  j it holds that W i
We also introduce the auxiliary processes
t  patie0tX 
t  PjZdR t
0 i  j t  sM j
t  XjZd
t  XjZd
t  XjZd
Step 31 Here we show that EW i
t  W
t Z t
t12Xn1
t12Xn1
t  W
using 32
i  j t  sM j
patsi  je0tsM j
patie0tsM j
t  C exp0t  02t12 By denition of  and
nt  sEcid2cid12cid12 XjZd
nt  scid0 XjZd
scid12cid12cid3ds
scid112
Ani j2mj
Ani jM j
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
t  Ce0t see Step 2 we see that
s  Ce0s2 Next the explicit expression of n see Lemma 21-i gives
Using that Ani j is bounded by 1 and that PiZd mi
PjZd Ani j2mj
Pn1 nt  s  e0ts We nally nd
t  CZ t
Step 32 We next check that EW
h XjZd
t  Z t12
e0tse0s2ds  Ce0te0t122
t fW i
t   Ctd213e0t Using 32 we get
scid0i  j t  s  patsi  je0tscid12i12
t  W
t fW i
Using Lemma 21-iv i  j t  s  patsi  je0ts  Ct  sd213e0ts if t  s
is large enough which is the case for all s  0 t12 if t is large enough Since furthermore
PiZd mi
t  Ce0t see Step 2 we nd
t  sd213e0s2ds
For t large enough we clearly have t  sd213  2td213 for all s  0 t12 whence
t Ce0tZ t12
t fW i
t Ctd213e0tZ t12
t fW i
Step 33 We now prove that EfW i
t cW i
t  Z t12
cid16 XjZd
EfW i
t cW i
e0s2ds  Ctd213e0t
t   Ctd212e0t As usual we start with
scid0patsi  j  paticid12cid1712
e0tsds
But an easy computation using that tptx  Ctd21 and xptx  Ctd212 shows
that for all t  0 all h  0 t2 all x y  Rd pthx  y  ptx  Chtd21  ytd212
Hence if t is large enough so that t  t12  t2 we can write
e0tsds
e0tsds
EfW i
t cW i
t CZ t12
scid0std21  jtd212cid12cid1712
cid16 XjZd
Ctd212Z t12
scid1712
cid16 XjZd
 Ctd212Z t12
scid1712
cid16 XjZd j2mj
s PjZd j2mj
Finally we know from Step 2 that PjZd mj
s  C1  se0s whence
t Ctd212Z t12
1  s12e0s2e0tsds  Ctd212e0t
Step 34 We nally verify that EcW i
 We note that
t  patie0tX  Ce0t02t12
t cW i
EfW i
e0tsds
e0sM j
t  patie0tX  patie0t XjZd
HIGH DIMENSIONAL HAWKES PROCESSES
For t large enough not depending on i we can bound pati by 1 Hence we infer from 32 and
the fact that PjZd mj
s  Ce0s that
t  patie0tX Ce0tZ t
e0scid0 XjZd
scid112
ds  Ce0tZ 
e0s2ds
EcW i
from which the conclusion follows
Step 35 Gathering Steps 31 to 34 we conclude that indeed there are C  0 and t0  0 such
that for all t  t0 all i  Zd EW i
t  patie0tX  Ce0ttd213
0 patie0t  M i
Step 4 Dene the random variable H  1
t  1
C  0 and t0  0 such that for all t  t0 all i  Zd
td213  Ce0t2 
t  patie0tH 
t  W i
t  patie0tH 
t  patie0tX Gathering Steps 2 and 3 we see that there are
0  X Recall 33 and write Z i
td213 
To prove that H is nonnegative it suces to use the above inequality with i  0 divided
by pat0e0t Recalling that pat0  ctd2 for some constant c we deduce that EH 
t e0tpat0 and is thus
t e0tpat0  Ct13 Consequently H is the limit in L1 of Z 0
nonnegative This ends the proof of i
Step 5 We now check ii which follows from i for x  Rd and t  t0
 EHcid12cid12td2patxt12  paxcid12cid12
 Hpaxcid12cid12cid3 td2e0tEcid2cid12cid12Z xt12
Ecid2cid12cid12td2e0tZ xt12
 He0tpatxt12cid12cid12cid3
The rst term on the RHS is bounded by i by Ct13 which tends to 0 as t   The second
term also tends to 0 simply because
td2patxt12  pacid0t12xt12cid1  pax
as t  
It remains to prove iii First note that H  limt e0tZt in L1 where Zt 
Step 6
PiZd Z i
t Indeed recalling 33
Zt  XiZd
t  XiZd
t  XiZd
t  R t
0 e0sds  1
law as  Ztt0 built as follows
Next we recall that by Theorem 19-i Ztt0 is a scalar impulsion Hawkes process
t  e0tR t
0 s R s
sds therefore e0tZt converges to 1
0  0 since EX  0
0 e0t  1 by Step 2 32 implies that EPiZd M i
We have PiZd mi
0 e0sPiZd M i
t and nallyPiZd W i
PiZd mi
0  X  H as t   in L1 We also note that EH  1
compensator is given by At R t
 consider a Poisson process Ntt0 with intensity tdt observe that N is Poisson-
distributed denote by 0  T1    TN its times of jump we adopt the convention that
Ti   for i  N
 consider an iid family  Z k
t t0 of scalar impulsion Hawkes process with same law as Ztt0
 put Zt  Nt PN
1tTk
0 s  udZuds We claim that Ztt0 has the same
t 2 
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
Indeed  Ztt0 is a counting process with compensator
s Tk ud Z k
uds Z t
1sTks TkZ sTk
t  We obviously have
k1 e0Tk Hk Denoting by p  PrH  0 which also equals Pr H  0 and Pr Hk  0
sXi1
We dene H  limt e0t Zt and for each k  1 Hk  limt e0t Z k
H PN
for all k  1 we deduce by independence of the family  Hkk1 that p Pn1 PrN  npn
Hence p  Pn1 enpnn  e1p Since EH  0 we cannot have p  1 Hence p is the
unique solution in 0 1 to p  e1p Recalling that Pre  exp where   0 1 is
characterised by   log1    0 by Theorem 19-2-ii we easily check that p  Pre
sZ s
s ud Zuds
By denition of H we have e  H  0 Since Pre  PrH  0 we conclude that as
cid3
H  0 on c
We collect here some technical results about convolution equations We start with an identity
5 Appendix convolution equations
t  ssds
of constant use in the paper
Lemma 22 Let   0 7 R be locally integrable and let   0 7 R have nite variations
on compact intervals and satisfy 0  0 Then for all t  0
s  ududs Z t
s  ududs Z t
0 Z s
0 s  udu  R s
Proof First we clearly have that R s
whence R t
0 s  ududs R t
0 R s
0 s  ududs Using twice the Fubini theorem
s  uducid17ds Z t
0 cid16Z t
0 cid16Z tu
0 cid16Z tv
t  vvdv
from which the conclusion follows using the substitution s  t  v
0 s  udu for almost every s  0
s  udscid17du
vdvcid17du
ducid17vdv
0 cid16Z s
cid3
We carry on with a generalized Gronwall-Picard lemma which is more or less standard
Lemma 23 Let   0 7 0 be locally integrable and g  0 7 0 be locally bounded
i Consider a locally bounded nonnegative function u such that for all t  0 ut  gt R t
0 t 
susds for all t  0 Then sup0T  ut  CT sup0T  gt for some constant CT depending only on
T  0 and 
ii Consider a sequence of locally bounded nonnegative functions un such that for all t  0 all
t  CT  for some constant CT depending
s ds Then sup0T Pn0 un
n  0 un1
only on T  0 u0 and 
0 t  sun
 R t
HIGH DIMENSIONAL HAWKES PROCESSES
iii Consider a sequence of locally bounded nonnegative functions un such that for all t  0
t  CT  for some
s ds Then for all T  0 sup0T  supn0 un
0 t  sun
 gt R t
1tsAt  susds Z t
all n  0 un1
constant CT depending only on T  0 u0 g and 
Proof We start with point i Fix T  0 and consider A  0 such thatR T
Then for all t  0 T 
ut  gt Z t
from which we deduce that sup0t us  2 sup0t gs  2AR t
Gronwall Lemma to get sup0T  us  2sup0T  gse2AT 
t  gt R t
innity concludes the proof
s ds By point i sup0T  vn
To check point iii put vn
t  supk0n uk
0 t  svn
1tsAt  susds  gt  AZ t
0 s1sAds  12
usds  sup
0 usds We then can apply the standard
t  One easily checks that for all n  0 vn
t  CT sup0T gt  u0
t  Letting n increase to
Point ii follows from point iii since vn
t satises vn1
0 t  svn
s ds cid3
We next prove an easy well-posedness result for a general convolution equation
Lemma 24 Let h  R 7 0 be Lipschitz-continuous and   0 7 R be locally integrable
The equation
mt Z t
hcid0Z s
s  udmucid1ds
has a unique non-decreasing locally bounded solution Furthermore m is of class C1 on 0
If hx    x for some   0 and if  is nonnegative Equation 34 rewrites as
mt  t Z t
t  smsds
vt Z t
0 t  uvudu
0 cid12cid12dmu  emucid12cid12  CZ t
Proof Let m and em be two such solutions Since h is Lipschitz-continuous
0 s  ucid12cid12dmu  emucid12cid12  CZ t
The last inequality follows from Lemma 22 Lemma 23-i allows us to conclude that vt  0 for all
t  0 because vt  mt  mt is locally bounded whence mt  mt for all t  0 For the existence
ucid1ds
0 hcid0R s
0 s udmn
we consider the sequence of non-decreasing functions m0
 h0t  hlipR t
for every n  0 We easily check that mn1
udu so that supn0 mn
0t  umn
is locally bounded by Lemma 23-iii Setting for n  0 n
u  mn
0dmn1
u one readily gets
t   All
this classically implies the existence of a locally bounded non-decreasing m such that for all t  0
limnR t
mn is C1 for all n  0 and that mn1
0 umn
the inductive assumption Next a direct computation shows that mn1
To prove that m is C1 we use the previous Picard Iteration One easily sees by induction that
udu 
0 t umn
t  is continuous by
t   CR t
0t 
u du for all n  0 Lemma 23-ii thus implies that Pn0 n
udu indeed t 7R t
  mn
tudu is continuous because  is locally integrable and because mn
u  0 Checking that m solves 34 is routine
 hlipR t
0dmu  mn
  hR t
0s  un
0 t umn
t  0 and mn1
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
umn
the uniform convergence on compact time intervals The conclusion classically follows
du Using Lemma 23-ii we deduce that the sequence mn is Cauchy for
u  mn1
The equivalence between 34 and 35 in the linear case directly follows from Lemma 22 cid3
We now investigate the large-time behaviour of mt in the linear case We start with the sub-
critical case
t  a0 and mt  a0t as t   where a0  1    0
0 sds  1 By
Lemma 24 35 has a unique non-decreasing locally bounded solution mtt0 which is furthermore
of class C1 It holds that m
Lemma 25 Consider   0 and a function   0 7 0 such that  R 
Proof We rather use 34 which writes mt  t R t
0 s  um
expression we nd m
ut    ut whence ut  1   for all t  0 and thus lim supt m
next introduce vt  inf st m
vt    vt2R t2
ududs Dierentiating this
s We have
t  1   We
s which is non-decreasing and thus has a limit   0 We have
0 sds     as t   Consequently      whence   1  and
t  a0 and this implies that mt  a0t cid3
t  1 All this proves that m
sds We rst introduce ut  sup0t m
t    R t
nally lim inf t m
0 t  sm
We now turn to the supercritical case
Lemma 26 Consider   0 and a function   0 7 0 such that   R 
0 sds 
1 By Lemma 24 35 has a unique non-decreasing locally bounded solution mtt0 which
is of class C1 Assume furthermore that t 7 R t
0ds has at most polynomial growth Let
t Pn1 nt and t R t
a There is a unique 0  0 such that L0  1 The function  is locally bounded Setting
0 sds
a0  2
tte0tdt1 we have as t  
0 R 
t  a02
0e0t t  a00e0t mt  a0e0t m
t  a00e0t
b There are some constants 0  c  C such that for all t  0 ce0t  t  1  Ce0t
ce0t  t  1  Ce0t ce0t  mt  1  Ce0t and ce0t  m
t  1  Ce0t
c We also have
tZ t
0 cid16 t  s
e0scid172
sds  0
d Consider a real sequence nn1 such that limn n  0 Then we have the property that
limt e0tPn1 nR t
e For any pair of locally bounded functions u h  0 7 R such that u  h  u   there
0 nt  se0s2ds  0
holds u  h  h  
Proof We easily deduce from our assumptions on  that there is some constants C  0 p  0
such that for all t  0 t  C1  tp in particular  is locally bounded Hence its Laplace
transform is clearly well-dened on 0 of class C and lim L  0 Furthermore
L0  R 
0 tdt  1 Hence there indeed exists a unique 0  0 such that L0  1
We now divide the proof into several steps
Step 1 We rst prove that  is locally bounded To this end we introduce n Pn
k1 kt
and observe that n1    n   Since  is locally bounded Lemma 23-iii allows us to
conclude that supn n is locally bounded whence the result
HIGH DIMENSIONAL HAWKES PROCESSES
Step 2 Here we prove e Since h is locally bounded and since  is locally integrable we easily
deduce from Lemma 23-i that the equation v  h  v   with unknown v has at most one
locally bounded solution Since both u and h  h   are locally bounded solutions the conclusion
follows
tf tdt  R 
Step 3 The aim of this step is to verify that t  a02
0e0t as t   Observe that 
solves        and introduce ut  te0t and f t  te0t One easily checks that
u  f  u  f  We now apply Theorem 4 of Feller 11 We have R 
0 f tdt  1 by denition of
t2f tdt  R 
tte0tdt and b2  R 
0 We set b1  R 
t2te0tdt which
clearly both converge since t  C1  tp Finally it is not dicult to check that f t tf t
and t2f t have a bounded total variation on 0 since we have assumed that t 7 R t
0ds
has at most polynomial growth Thus Feller 11 Theorem 4 tells us that ut  1b1 as t  
which gives t  e0tb1 This ends the proof since 1b1  a02
Step 4 We now conclude the proof of a and b Recall that mt  t R t
0 s um
so that m      m Applying e we deduce that m        1   By Step 3
0e0t as t   This obviously implies that t  a00e0t
we know that t  a02
sds  a0e0t Finally b directly follows from a
whence m
and the facts that   m and m are nonnegative and locally bounded
t  a00e0t and nally mt  R t
0 by denition of a0
Step 5 Point d is not very dicult using that t  C1  tp we see that nt 
Cn1  tpn for some constants Cn  0 and pn  0 We next introduce k  supnk n which
decreases to 0 as k   and write for any k  1
lim sup
t
e0tXn1
nZ t
nt  se0s2ds  lim sup
t
e0t
nZ t
Xnk1
Cnt  spn e0s2ds
nt  se0s2ds
 k lim sup
t
e0t
The rst term on the RHS is of course 0 for any xed k We can bound the second one using
b by
k lim sup
t
e0tZ t
t  se0s2ds  Ck lim sup
t
e0tZ t
e0tse0s2ds  Ck
Letting k tend to innity concludes the proof
s  t  smt  0e0s2m
Step 6 It only remains to check point c We use the Lebesgue dominated convergence theorem
sds  0
s  0 Next we use b to write for t
s  Ce0s2e0s  Ce0s which does not depend on t and
Dene ht
First it is obvious from a that for s  0 xed limt ht
large enough so that mt  ce0t ht
is integrable on 0
s1st We have to prove that limtR 
cid3
We next consider briey a vector convolution equation
Lemma 27 Consider a family   iiZd of real numbers such that 0  i  C for all
i  Zd the stochastic matrix Ai jijZd dened by 17 and a locally integrable function  
0 7 0 The equation mt  t R t
tt0iZd
has a unique solution such that for all t  0 PiZd 2i sup0t mi
s   Furthermore mi is
t   R t
0 t  sAm
of class C1 on 0 for all i  Zd and it holds that m
0 t  sAmsds with unknown m  mi
sds and m
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
Proof We proceed in a few steps
s is nite for all t  0 and it holds
0 nsdscid17 Finally ut  supiZd sup0tmi
0 t  susds
cid16I Pn1 AnR t
that ut  C R t
Step 1 We rst note that for any vector x  xiiZd  it holds that PiZd 2iAxi 
2PiZd 2ixi This easily follows from the explicit form of A
Step 2 We next check uniqueness Consider two solutions m and m satisfying the required
t We have ht PiZd 2iR t
condition and put ht PiZd 2i sup0t mi
t mi
0 t sAms
msids Using Step 1 we deduce that ht  2R t
0 t  shsds and thus ht  0 by Lemma 23-i
0 nsdscid17 Using that A is stochastic and that 
t  cid16I Pn1 AnR t
t  C1 Pn1R t
is bounded by C we easily deduce that for all i  Zd mi
function is locally bounded because  is locally integrable use that kt  Pk
satises kt R t
t  CPn1R th
0 nsds This
0 nsds
0 t  sksds and use Lemma 23-iii which provides a uniform
s is nite for all t  0 Similar arguments
th  mi
in k bound Consequently ut  supiZd sup0tmi
t is continuous on 0 because mi
show that mi
0 sds R t
Step 3 We dene m
Step 4 A straightforward consequence of the denition of m
0 t  sAm
ut  C R t
equation satised by m and using Lemma 22 we nd that m  mi
to mt  t R t
t  0 but this obviously follows from the facts that ut is locally bounded and that m0  0
t   
sds Using that A is stochastic and that  is bounded we immediately deduce that
sds Integrating the
tiZdt0 is indeed a solution
t   for all
0 t  sAmsds It only remains to check that PiZd 2i sup0t mi
0 t  susds We nally dene for each i  Zd mi
t is that it solves m
t  R t
cid3
nsds
References
1 Y Ait-Sahalia J Cacho-Diaz RJALaeven Modeling nancial contagion using mutually exciting jump pro-
cesses working paper 2013
2 E Bacry S Delattre M Homann JF Muzy Modelling microstructure noise with mutually exciting point
processes Quantitative Finance 13 2013 6577
3 E Bacry S Delattre M Homann JF Muzy Some limit theorems for Hawkes processes and applications to
nancial statistics Stoch Processes Appl 123 2013 24752499
4 E Bacry and JF Muzy Hawkes model for price and trades high-frequency dynamics arXiv13011135
5 E Bacry and JF Muzy Second order statistics characterization of Hawkes processes and non-parametric
estimation arXiv14010903
6 L Bauwens N Hautsch Modelling nancial high frequency data using point processes ser In T Mikosch
J-P Kreiss R A Davis and T G Andersen editors Handbook of Financial Time Series Springer Berlin
Heidelberg 2009
7 C Blundell KA Heller JF Beck Modelling reciprocating relationships with Hawkes processes Neural Infor-
mation Processing Systems NIPS 2012
8 P Bremaud L Massoulie Stability of nonlinear Hawkes processes Ann Probab 24 1996 15631588
9 J Chevallier Detection de motifs de dependance entre neurones Preprint 2013
10 DJ Daley D Vere-Jones An introduction to the theory of point processes Vol I Probability and its Appli-
cations New York Springer- Verlag New York second edition 2003 Elementary theory and methods
11 W Feller On the integral equation of renewal theory Ann Math Statistics 12 1941 243267
12 N Fournier A Guillin On the rate of convergence in Wasserstein distance of the empirical measure
arXiv13122128
13 S Grun M Diedsmann AM Aertsen Unitary events analysis in Analysis of parallel spike trains S Grun
and S Rotter Spiringer series in computational neurosciences 2010
HIGH DIMENSIONAL HAWKES PROCESSES
14 A Galves E Locherbach Innite systems of interacting chains with memory of variable length - a stochastic
model for biological neural nets J of Statist Physics to appear arXiv12125505
15 A Hawkes Spectra of some self-exciting and mutually exciting point processes Biometrika 58 1971 8390
16 A Hawkes D Oakes A cluster process representation of a self-exciting process J Appl Probability 11 1974
493503
17 NR Hansen P Reynaud-Bouret V Rivoirard Lasso and probabilistic inequalities for multivariate point
processes Bernoulli to appear arXiv12080570
18 A Helmstetter and D Sornette Subcritical and supercritical regimes in epidemic models of earthquake after-
shocks Journal of geophysical research 107 2002 2237
19 P Hewlett Clustering of order arrivals price impact and trade path optimisation In Workshop on Financial
Modeling with Jump processes Ecole Polytechnique 2006
20 J Jacod Calcul stochastique et problemes de martingales Lecture Notes in Mathematics 714 Springer 1979
21 T Jaisson and M Rosenbaum Limit theorems for nearly unstable Hawkes processes Ann App Probab to
appear arXiv13102033
22 J Jacod AN Shiryaev Limit theorems for stochastic processes Second edition Springer-Verlag Berlin 2003
23 F John Partial dierential equations Reprint of the fourth edition Applied Mathematical Sciences Springer-
Verlag 1991
24 YY Kagan Statistical distributions of earthquake numers consequence of branching process Geophysical
Journal International 180 2010 13131328
25 G Lawler V Limic Random walk a modern introduction Cambridge Studies in Advanced Mathematics 123
Cambridge University Press 2010
26 PAW Lewis GS Shedler Simulation of nonhomogeneous Poisson processes by thinning Naval Res Logist
Quart 26 1979 403413
27 Y Ogata The asymptotic behaviour of maximum likelihood estimators for stationary point processes Ann
Instit Math Statist 30 1978 243261
28 Y Ogata On Lewis simulation method for point processes IEEE Transactions on Information Theory 27
1981 2330
29 Y Ogata Seismicity analysis through point-process modeling A review Pure and Applied Geophysics 155
1999 471507
30 M Okatan MA Wilson EN Brown analyzing functional connectivity using a network likelihood model of
ensemble neural spiking activity Neural Computation 17 2005 1927-1961
31 JW Pillow J Shlens L Paninski A Scher AM Litke EJ Chichilnisky EP Simoncelli Spatio-temporal
correlations and visual signalling in a complete neuronal population Nature 454 2008 995999
32 P Reynaud-Bouret and S Schbath Adaptive estimation for Hawkes processes application to genome analysis
Ann Statist 38 2010 27812822
33 P Reynaud-Bouret V Rivoirard F Grammont C Tuleau-Malot Goodness-of-t tests and nonparametric
adaptive estimation for spike train analysis Journal of Math Neuroscience to appear hal-00789127
34 P Reynaud-Bouret V Rivoirard C Tuleau-Malot Inference of functional connectivity in Neurosciences via
Hawkes processes 1st IEEE Global Conference on Signal and Information Processing 2013
35 AS Sznitman Topics in propagation of chaos Ecole dEte de Probabilites de Saint-Flour XIX-1989 Vol 1464
of Lecture Notes in Math Springer 1991 165251
36 A Simma MI Jordan Modeling events with cascades of Poisson processes httpwwweecsberkeleyedu
PubsTechRpts2010EECS-2010-109html
37 S-H Yang H Zha Mixture of mutually exciting processes for viral diusion Proceedings of the 30th Inter-
national Conf on Machine Learning ICML 2013
38 K Zhou H Zha L Song Learning triggering kernels for multi-dimensional Hawkes processes Proceedings of
the 30th International Conf on Machine Learning ICML 2013
39 L Zhu Central limit theorem for nonlinear Hawkes processes J App Probab 50 2013 760771
40 L Zhu Large deviations for Markovian nonlinear Hawkes processes Ann App Probab to appear
arXiv11082432
41 L Zhu Nonlinear Hawkes Processes PhD New York University 2013 arXiv13047531
Sylvain Delattre Laboratoire de Probabilites et Modeles Aleatoires UMR 7599 Universite Paris
Diderot Case courrier 7012 avenue de France 75205 Paris Cedex 13 France
E-mail address sylvaindelattreuniv-paris-diderotfr
SYLVAIN DELATTRE NICOLAS FOURNIER AND MARC HOFFMANN
Nicolas Fournier Laboratoire de Probabilites et Modeles Aleatoires UMR 7599 Universite Pierre-
et-Marie Curie Case 188 4 place Jussieu F-75252 Paris Cedex 5 France
E-mail address nicolasfournierupmcfr
Marc Hoffmann CEREMADE CNRS-UMR 7534 Universite Paris Dauphine Place du marechal De
Lattre de Tassigny 75775 Paris Cedex 16 France
E-mail address hoffmannceremadedauphinefr
