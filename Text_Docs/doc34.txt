Large deviations of Poisson cluster processes
Charles Bordenave and Giovanni Luca Torrisi
Abstract
In this paper we prove scalar and sample path large deviation principles for a large class of
Poisson cluster processes As a consequence we provide a large deviation principle for ergodic
Hawkes point processes
Keywords Hawkes processes Large deviations Poisson cluster processes Poisson processes
Introduction
Poisson cluster processes are one of the most important classes of point process models see Daley
and Vere-Jones 2003 and Mller and Waagepetersen 2004 They are natural models for the
location of objects in the space and are widely used in point process studies whether theoretical
or applied Very popular and versatile Poisson cluster processes are the so-called self-exciting or
Hawkes processes Hawkes 1971a 1971b Hawkes and Oakes 1974 From a theoretical point
of view Hawkes processes combine both a Poisson cluster process representation and a simple
stochastic intensity representation
Poisson cluster processes found applications in cosmology ecology and epidemiology see respec-
tively Neyman and Scott 1958 Brix and Chadoeuf 2002 and Mller 2003 Hawkes processes
are particularly appealing for seismological applications Indeed they are widely used as statistical
models for the standard activity of earthquake series see the papers by Ogata and Akaike 1982
Vere-Jones and Ozaki 1982 Ogata 1988 and Ogata 1998 Hawkes processes have also aspects
appealing to neuroscience applications see the paper by Johnson 1996 More recently Hawkes
processes found applications to nance see Chavez-Demoulin Davison and Mc Neil 2005 and to
DNA modeling see Gusto and Schbath 2005
In this paper we derive scalar and sample path large deviation principles for Poisson cluster pro-
cesses The paper is organized as follows In Section 2 we give some preliminaries on Poisson cluster
processes Hawkes processes and large deviations In Section 3 we provide scalar large deviation
principles for Poisson cluster processes under a light-tailed assumption on the number of points per
cluster As consequence we provide scalar large deviations for ergodic Hawkes processes Section
4 is devoted to sample path large deviations of Poisson cluster processes First we prove a sample
path large deviation principle on D0 1 equipped with the topology of point-wise convergence
under a light-tailed assumption on the number of points per cluster Second we give a sample
path large deviation principle on D0 1 equipped with the topology of uniform convergence under
a super-exponential assumption on the number of points per cluster In Section 5 we prove large
deviations for spatial Poisson cluster processes and we provide the asymptotic behavior of the void
probability function and the empty space function We conclude the paper with a short discussion
INRIAENS Department dInformatique 45 rue dUlm F-75230 Paris Cedex 05 France
e-mail
charlesbordenaveensfr
Istituto per le Applicazioni del Calcolo Mauro Picone IAC Consiglio Nazionale delle Ricerche CNR Viale
del Policlinico 137 I-00161 Roma Italia e-mail torrisiiacrmcnrit
2 Preliminaries
In this section we recall the denition of Poisson cluster process Hawkes process and the notion
of large deviation principle
21 Poisson cluster processes
A Poisson cluster process X  R is a point process The clusters centers of X are given by particular
points called immigrants the other points of the process are called ospring The formal denition
of the process is the following
a The immigrants are distributed according to a homogeneous Poisson process I with points
Xi  R and intensity   0
b Each immigrant Xi generates a cluster Ci  CXi which is a nite point process containing
c Given the immigrants the centered clusters
are independent identically distributed iid for short and independent of I
Ci  Xi  Y  Xi  Y  Ci Xi  I
d X consists of the union of all clusters
The number of points in a cluster is denoted by S We will assume that ES   Let Y be a point
process on R and NY0 t the number of points of Y in the interval 0 t Y is said stationary if
its law is translations invariant is said ergodic if it is stationary with a nite intensity ENY0 1
t
NY0 t
 ENY0 1
By the above denition of Poisson cluster process it is clear that X is ergodic with nite intensity
ES In particular
t
NX0 t
 ES
22 Hawkes processes
We say that X  R is a Hawkes process if it is a Poisson cluster process with b in the denition
above replaced by
b Each immigrant Xi generates a cluster Ci  CXi which is the random set formed by the
points of generations n  0 1    with the following branching structure the immigrant
Xi is said to be of generation 0 Given generations 0 1     n in Ci each point Y  Ci of
generation n generates a Poisson process on Y say  of ospring of generation n  1
with intensity function h  Y  Here h  0  0 is a non-negative Borel function
called fertility rate
We refer the reader to Section 2 in Mller and Rasmussen 2005 for more insight into the branch-
ing structure and self-similarity property of clusters Consider the mean number of points in any
ospring process 
As usual in the literature on Hawkes processes throughout this paper we assume
 Z 
ht dt
0    1
Condition   0 excludes the trivial case in which there are almost surely no ospring Recalling
that the total number of points in a cluster is equivalent to the total progeny of the Galton-Watson
process with one ancestor and number of ospring per individual following a Poisson distribution
with mean  see p 496 of Hawkes and Oakes 1974 the other condition   1 is equivalent to
assuming that ES  11     For our purposes it is important to recall that for Hawkes
processes the distribution of S is given by
P S  k 
ekkk1
k  1 2   
This follows by Theorem 2112 in the book by Jagers 1975 Finally since X is ergodic with a
nite and positive intensity equal to 1   it holds
NX0 t
t
1  
23 Large deviation principles
We recall here some basic denitions in large deviations theory see for instance the book by
Dembo and Zeitouni 1998 A family of probability measures 0 on a topological space
M TM  satises the large deviations principle LDP for short with rate function J and speed
v if J  M  0 is a lower semi-continuous function v  0  0 is a measurable
function which increases to innity and the following inequalities hold for every Borel set B
 inf
xB
Jx  lim inf

log B  lim sup

log B   inf
where B denotes the interior of B and B denotes the closure of B Similarly we say that a family
of M -valued random variables V0 satises the LDP if 0 satises the LDP and
  P V   We point out that the lower semi-continuity of J means that its level sets
are closed when the level sets are compact the rate function J is said to be good
x  M  Jx  a
a  0
3 Scalar large deviations
31 Scalar large deviations of Poisson cluster processes
Consider the ergodic Poisson cluster process X described above In this section we prove that the
process NX0 tt satises a LDP on R Dene the set
DS    R  EeS  
With a little abuse of notation denote by C0 the cluster generated by an immigrant at 0 and let
L  supY C0 Y  be the radius of C0 We shall consider the following conditions
is essentially smooth and 0  D
the function  7 EeS
For the denition of essentially smooth function we refer the reader to Denition 235 in Dembo
and Zeitouni 1998
ELeS   for all   D
Remark 31 Since S  1 we have that the function   EeS is increasing It follows that
S   0 with 0  0 By the dominated convergence theorem we have that  
ESeS and   ES2eS for all   D
S  Hence if 0   to prove that  is essentially
smooth it suces to show that ESe0S   On the other hand if 0   the function  is
always essentially smooth
It holds
Theorem 32 Assume 5 and 6 Then NX0 tt satises a LDP on R with speed t and good
rate function
x  sup
x  
where   EeS  1
It is easily veried that ES  0 Moreover this is the unique zero of  Therefore the
probability law of NX0 tt concentrates in arbitrarily small neighborhoods of ES as t  
as stated by the law of large numbers 1 The LDP is a renement of the law of large numbers in
that it gives us the probability of uctuations away the most probable value
Before proving Theorem 32 we show that the same LDP holds for the non-stationary Poisson
cluster process XtT with immigrant process empty on T   t  T where T  0 is a
xed constant Furthermore the LDP for XtT holds under a weaker condition
Theorem 33 Assume 5 Then NXtT 0 tt satises a LDP on R with speed t and good rate
function 7
Proof  The proof is based on the Gartner-Ellis theorem see for instance Theorem 236 in Dembo
and Zeitouni 1998 We start proving that
t
log EeNX
0t cid26 EeS  1
if   DS
if   DS
For a Borel set A  R let IA  I  A be the point process of immigrants in A Clearly I0t IT0
and IttT  are independent Poisson processes with intensity  respectively on 0 t T 0 and
t T  t Since I0t IT0  and IttT  are independent by the denition of Poisson cluster
process it follows that the random sets Ci  Xi  I0t Ci  Xi  IT0 and Ci  Xi  IttT 
are independent Therefore for all   R
EheNX
We shall show
0ti  Ee
PXiI0t
PXiI0t
NCi 0tPXiIT 0
NCi 0ti Ehe
NCi 0tPXiIttT 
NCi 0ti Ehe
PXiIT 0
NCi 0t
PXiIttT 
NCi 0ti 
t
PXiI0t
log Ehe
NCi 0ti cid26 EeS  1
if   DS
if   DS
PXiIT 0
log Ehe
NCi 0ti  lim
t
log Ehe
PXiIttT 
NCi 0ti  0
for   DS
t
Note that 8 is a consequence of 9 and 10 We rst prove 9 With a little abuse of notation
denote by C0 the cluster generated by an immigrant at 0 Since Xi Ci  Xi  I0t is an
independently marked Poisson process by Lemma 64VI in Daley and Vere-Jones 2003 we have
PXiI0t
NCi 0ti  Ehe
PXiI0t
NCiXi XitXii
 expcid18Z t
 expcid18tZ 1
EheNC0 xtx  1i dxcid19
EheNC0 tz1zt  1i dzcid19 
Therefore if   DS the expectation in 11 goes to EeS  1 as t   by the monotone
convergence theorem Hence for   DS the limit 9 follows from the dominated convergence
theorem For   DS the expectation in 11 goes to  as t   by the monotone convergence
theorem and the limit 9 follows by Fatous lemma We now show 10 Here again since Xi Ci 
Xi  IT0 is an independently marked Poisson process by Lemma 64VI in Daley and Vere-
Jones 2003 we have
PXiIT 0
NCi 0ti  Ehe
PXiIT 0
 expcid18Z T
NCiXi XitXii
EheNC0 xxt  1i dxcid19 
Now note that for   DS  0 we have
PXiIT 0
log Ehe
and for each   0
NCi 0ti 
EheS  1i dx  
EheS  1i 
EheNC0 xxt  1i dx  0
By passing to the limit as t   we get that the rst limit in 10 is equal to 0 The proof for
the second limit in 10 is rigorously the same Hence we proved 8 Using assumption 5 the
conclusion is a consequence of the Gartner-Ellis theorem
cid3
Proof of Theorem 32 The proof is similar to that one of Theorem 33 and is again based on the
Gartner-Ellis theorem We start showing that
t
log EeNX0t cid26 EeS  1
if   D
if   DS
By similar arguments as in the proof of Theorem 33 using the denition of X we have
EheNX0ti  EheNX
0ti EheNX0tNX
0ti 
for all   R t  0
By the computations in the proof of Theorem 33 in order to prove 13 we only need to check
t
log EheNX0tNXtT 0ti  0
for all   D
It is easily veried for   0 the argument of the expectation is bounded below by eS and above
by 1 We only check 14 for   D
S  0 Here again for a Borel set A  R let IA  I  A
denote the point process of immigrants in A Note that
NX0 t  NXtT 0 t  XXiIT 
NCi0 t  XXiItT 
NCi0 t
Clearly IT  and ItT are independent Poisson processes with intensity  respectively on
T  and t  T Thus by the denition of Poisson cluster process it follows that the
random sets Ci  Xi  IT  and Ci  Xi  ItT are independent Therefore for all
  D
S  0
EheNX0tNXtT 0ti  Ehe
PXiIT 
NCi 0ti Ehe
PXiItT 
NCi 0ti 
Since Xi Ci  Xi  IT  and Xi Ci  Xi  ItT are independently marked Poisson
processes by Lemma 64VI in Daley and Vere-Jones 2003 we have
PXiIT 
NCi 0ti  Ehe
PXiIT 
 expcid18Z 
NCiXi XitXii
EheNC0 xtx  1i dxcid19
PXiItT 
NCi 0ti  expcid18Z 
 expcid18Z 
EheNC0 xtx  1i dxcid19
EheNC0 tzz  1i dzcid19 
Now notice that since   0 we have
eNC0 xxt  1  eNC0 R  11x  L
for all x  T
for all z  T 
Relation 14 follows by assumption 6 noticing that the above relations yield
eNC0 tzz  1  eNC0 R  11z  L
PXiIT 
PXiItT 
NCi 0ti  expELeS  1
NCi 0ti  expELeS  1
for all   D
S  0 t  0
for all   D
S  0 t  0
Therefore 13 is proved Now if DS  D
theorem and assumption 5 It remains to deal with the case DS 6 D
S then the claim is a consequence of the Gartner-Ellis
S We shall show the large
deviations upper and lower bounds proving that for any sequence tnn1  0 diverging to
 as n   there exists a subsequence sn  tn such that
lim sup
n
lim inf
n
log P NX0 snsn  F    inf
x
for all closed sets F
log P NX0 snsn  G   inf
x
for all open sets G
where  is dened by 7 then the large deviations upper and lower bounds hold for any sequence
tn and the claim follows By assumption 5 there exists 0  0 such that DS   0 Let
tnn1  0 be a sequence diverging to  as n   and dene the extended non-negative
real number l  0 by
l  lim sup
n
log Ee0NX0tn
Clearly there exists a subsequence sn  tn which realizes this lim sup ie
n
log Ee0NX0sn  l
n
log EeNX0sn  
  R
By 13 it follows that
 
if   0
if   0
 if   0
Note that irrespective to the value of l  is essentially smooth however it may be not lower
semi-continuous We now show that the Legendre transform of  and  coincide ie
x  x
x  R
A straightforward computation gives x  x   for x  0 and 0  0   Now
note that since 0   x and x are both nite for x  0 Moreover since  and  are
essentially smooth if x  0 we have that x  xx  x and x  xx  x where
x respectively x is the unique solution of   x respectively   x on  0 The
claim 17 follows recalling that     EeS  1 on D
S Now applying part a of
Theorem 236 in Dembo and Zeitouni 1998 we have 15 Applying part b of Theorem 236 in
Dembo and Zeitouni 1998 we get
lim inf
n
log P NX0 snsn  G   inf
xGF
x
for any open set G
where F is the set of exposed points of  whose exposing hyperplane belongs to  0 ie
F  y  R     D
S such that for all x 6 y y  y  x  x
We now prove that F  0  For y  0 y   therefore an exposing hyperplane satisfying
the corresponding inequality does not exist For y  0 consider the exposing hyperplane   y
where y is the unique positive solution on  0 of ESeS  y Note that   ESeS
and   ES2eS for all   0 In particular since S  1 we have that  is strictly convex
on  0 Therefore for all x 6 y it follows
yy  y  y  x  xy  x
 yx  x
It remains to check that 0  F Notice that since ESexS  x limx0 x   Also by the
implicit function theorem x 7 x is a continuous mapping on 0 Now assume that 0  F then
there would exist   0 such that for all x  0 0  xx However by the intermediate
values theorem there exists y  0 such that   y and we obtain a contradiction This implies
F  0  as claimed Now recall that x   for x  0 moreover limx0 x  0 
 indeed limx0 x   Therefore
xGF
x  inf
x
for any open set G
Finally by 18 and the above inequality we obtain 16
cid3
32 Scalar large deviations of Hawkes processes
Consider the ergodic Hawkes process X described before In this section we prove that the process
NX0 tt satises a LDP and we give the explicit expression of the rate function Our result is
a renement of the law of large numbers 4 The following theorem holds
Theorem 34 Assume 2 and
Then NX0 tt satises a LDP on R with speed t and good rate function
tht dt  
x 
xx    x
if x  0
if x  0
if x   0
where   x is the unique solution in    1  log  of
EhSeSi  x
or equivalently of
EeS 
  x
Proof  The proof is a consequence of Theorem 32 We start noticing that by 3 we have
EeS Xk1
ekkk1
and this sum is innity for     1  log  and nite for     1  log  apply for instance
the ratio criterion If     1  log  the sum above is nite Indeed in this case
EeS  1Xk1
ekkk1
 1
Therefore DS     1  log  The origin belongs to D
ex  x  1 x 6 0 we have e1
dierentiable in the interior of DS and
S in that by 2 and the inequality
  1 The function  7 EeS is essentially smooth Indeed it is
because
ESe1log S   
ESe1log S   1Xk1
ekkk
k  12k We now check assumption
and this sum is innity since by Stirlings formula ekkk
6 By the structure of the clusters it follows that there exists a sequence of independent non-
negative random variables Vnn1 independent of S such that V1 has probability density h
and the following stochastic domination holds
see Reynaud-Bouret and Roy 2007 Therefore for all     1  log  we have
ELeS  EeS
Vn  EV1ESeS
Since     1  log  we have ESeS   moreover assumption 19 yields
EV1 
Z 
tht dt  
Hence condition 6 holds and by Theorem 32 NX0 tt satises a LDP on R with speed t
and good rate function
x  sup
x   
1log 
x  
Now x   if x  0 in that in such a case limx     If x  0 letting
x     1  log  denote the unique solution of the equation 21 easily follows that
It is well-known see for instance p 39 in Jagers 1975 that for all      1  log 
EeS satises
x  xx  x
therefore dierentiating with respect to  we get
EeS  e expEeS  1
ESeS 
e expEeS  1
1  e expEeS  1
Setting   x in the above equality and using 21 we have
EeS
1  EeS
which yields
EexS
1  EexS
Thus by 22 we have for x  0
EexS 
  x
x  xx   
  x
The conclusion follows noticing that a direct computation gives 0  
cid3
4 Sample path large deviations
Let X be the ergodic Poisson cluster process described at the beginning The results proved in this
section are sample path LDP for X
41 Sample path large deviations in the topology of point-wise convergence
Let D0 1 be the space of cadlag functions on the interval 0 1 Here we prove that  NX0
satises a LDP on D0 1 equipped with the topology of point-wise convergence on D0 1 The
LDP we give is a renement of the following functional law of large numbers

NX0 
  as
where t  ESt As this is a corollary of the LDP we establish we do not include a separate
proof of this result Letting  denote the rate function of the scalar LDP we have
Theorem 41 Assume 5 and 6 If moreover DS is open then  NX0
 satises a LDP on
D0 1 equipped with the topology of point-wise convergence with speed  and good rate function
Jf  cid26 R 1
0  f tdt
iff  AC00 1
otherwise
where AC00 1 is the family of absolutely continuous functions f  dened on 0 1 with f 0  0
While it is tempting to conjecture that the result above holds even if the eective domain of S is not
open we do not have a proof of this claim If we take t  ESt then J  0 Moreover this is
the unique zero of J Thus the law of NX0  concentrates in arbitrarily small neighborhoods
of  as    as ensured by the functional law of large numbers 24 The sample path LDP is
a renement of the functional law of large numbers in that it gives the probability of uctuations
away the most likely path
As in Section 31 denote by XtT the non-stationary Poisson cluster process with immigrant
process empty on T  t  T where T  0 is a xed constant Before proving Theorem
41 we show that the same LDP holds for XtT  Furthermore the LDP for XtT holds under a
weaker condition
Theorem 42 Assume 5 Then NXT 0  satises a LDP on D0 1 equipped with the
topology of point-wise convergence with speed  and good rate function 25
To prove this theorem we need Lemma 43 below whose proof can be found in Ganesh Macci and
Torrisi 2005 see Lemma 23 therein
Lemma 43 Let 1     n  Rn and let w1     wn  0 be such that w1      wn Then
ik iwi  w for all k  1     n for any   maxmaxPn
ik i  k  1     n 0 and
any w  wn
Proof of Theorem 42 With a little abuse of notation denote by C0 the cluster generated by an
immigrant at 0 We rst show the theorem under the additional condition
NC0 0  0
The idea in proving Theorem 42 is to apply the Dawson-Gartner theorem to lift a LDP for the
nite-dimensional distributions of NXtT 0 t to a LDP for the process Therefore we rst
show the following claim
C For all n  1 and 0  t1      tn  1 cid16NXt1T 0 t1     NXtn T 0 tncid17 satises
the LDP in Rn with speed  and good rate function
Jt1tnx1     xn 
tj  tj1cid18xj  xj1
tj  tj1 cid19 
where x0  0 and t0  0
Claim C is a consequence of the Gartner-Ellis theorem in Rn and will be shown in three steps
a For each 1     n  Rn we prove that
log Eexp  n
iNXti T 0 ti 
where the existence of the limit as an extended real number is part of the claim and 
is dened in the statement of Theorem 32
t1tn1     n  lim

tjtj1
b The function t1tn satises the hypotheses of the Gartner-Ellis theorem
c The rate function
Jt1tnx1     xn 
1nRn n
ixi  t1tn1     n
coincides with the rate function dened in 27
Proof of a For a Borel set A  R denote by IA  I  A the Poisson process of immigrants in
A Since for each t I0t and IT0 are independent it follows from the denition of Poisson
cluster process that for each i the random sets Ck  Xk  I0ti and Ck  Xk  IT0 are
independent Therefore
iNXti T 0 ti  E
i XXkI0ti
 E
NCk 0 ti
i XXkIT 0
NCk 0 ti
where we used the independence and the assumption that NC0 0  0 as In order to prove
28 we treat successively the two terms in 29 Viewing I0ti as the superposition of the i
independent Poisson processes Itj1tj  on tj1 tj j  1     i with intensity  we get
i XXkI0ti
NCk0 ti
  E
Xj1 XXkItj1tj 
Xij XXkItj1tj 
Xij XXkItj1tj 
iNCk0 ti
iNCk0 ti
iNCk 0 ti
where in the latter equality we used the independence of Ck  Xk  Itj1tj j  1     n Since
for each j Xk Ck  Xk  Itj1tj  is an independently marked Poisson process by Lemma
64VI in Daley and Vere-Jones 2003 we have
We now show
iNCk0 ti
Xij XXkItj1tj 
exp
Z tj tj1
log E
log E
i XXkI0ti
i XXkI0ti

NCk0 ti
NCk 0 ti
for each 1     n  Rn We rst notice that by 30 and 31 we have
iNC0tj1  s ti  tj1  s
  1
 ds
tj  tj1
tj  tj1Jj
Jj 
tj  tj1Z tj tj1
E
iNC0tj1  s ti  tj1  s
  1
 ds
ij i  DS for each j  1     n Then by
ij i   for all j  1     n
Now suppose that 1     n  Rn is such that Pn
Lemma 43 it follows that there exists   DS such that   0Pn
iNC0tj1  s ti  tj1  s  NC0R
By 33 and the dominated convergence theorem we have
ij i  DS for every j  1     n Now
ij i  DS for some j  1     n We have that

Jj  cid16EhePn
ij iSi  1cid17 
1i  0iS 
Jj is bigger than or equal to
exp
1i  0iS 
Hence we proved 32 whenever 1     n  Rn satisesPn
suppose that 1     n  Rn is such that Pn
tj  tj1Z tj tj1
 Z 1
The expectation in the latter formula goes to EexpPn
  1
iS
exp
convergence theorem Therefore by Fatous lemma we have
exp
Jj  E

  
  1
1i  0iNC00 tj  tj1  s
  1
1i  0iNC00 tj  tj11  z
 dz
ij iS  1 as    by the monotone
Thus since the quantities J1     Jn are bounded below by  we get 32 also in this
case We now show

log E
for all 1     n  Rn such that Pn
that there exists   DS such that   0 Pn
i XXkIT 0
 XXkIT 0
NCk R 
NCk0 ti
  0
i XXkIT 0
ij i   for all j  1     n and
NCk 0 ti   XXkIT 0
NCkR
ij i  DS for each j  1     n By Lemma 43 we have
where   Pii0 i and   0 if i  i  0   Therefore using again Lemma 64 VI in
Daley and Vere-Jones 2003 we have
expcid16T EeS  1cid17  E
i XXkIT 0
NCk0 ti
  expcid16T EeS  1cid17 
Equation 34 follows taking the logarithms in the above inequalities and passing to the limit The
conclusion follows putting together 29 32 and 34
Proof of b and Proof of c Part b can be shown using assumption 5 and following the lines
of the proof of part b of Proposition 22 in Ganesh Macci and Torrisi 2005 The proof of part
c is identical to the proof of part c of Proposition 22 in Ganesh Macci and Torrisi 2005
End of the proof under condition 26 By claim C and the Dawson-Gartner theorem NXT 0 
satises the LDP on D0 1 equipped with the topology of point-wise convergence with speed 
and good rate function
Jf   supn
tk  tk1cid16 f tk  f tk1
tk  tk1
cid17  n  1 0  t1      tn  1o
The conclusion follows noticing that J coincides with J in 25 as can be checked following
the same lines as in the proof of Lemma 516 in Dembo and Zeitouni 1998
Removing the additional condition 26 The general case is solved as follows Since Ck is almost
surely nite there exists a left-most extremal point Yk  Ck such that NCk Yk  0 as Note
that given the immigrants Yk  Xk is an iid sequence Therefore by a classical result on Poisson
processes we have that Yk is a Poisson process with intensity  Viewing XtT as a Poisson cluster
process with cluster centers Yk and clusters Ck the conclusion follows by the rst part of the proof
cid3
Proof of Theorem 41 The proof uses similar steps as in the proof of Theorem 42 Here we sketch
the main dierence Assume the additional condition NC0 0  0 as the general case can
be treated as in the proof of Theorem 42 Dene the following subsets of Rn
1     n  Rn 
1     n  Rn 
A1 
A2 
i  DS for all j  1     n
i  DS for some j  1     n
We start showing that for all n  1 and 0  t1      tn  1
ij icid17
j1tj  tj1cid16Pn
t1tn1     n  Pn
t1tn1     n  lim

log Eexp  n
for 1     n  A1
for 1     n  A2
iNX0 ti
Eexp  n
and  is dened in the statement of Theorem 32 Using the denition of X and the assumption
NC0 0  0 as we have
iNX0 ti  E
i XXkI0ti
 E
 E
NCk 0 ti
NCk 0 ti
i XXkIT 
i XXkIT 0
NCk 0 ti
As noticed in the proof of Theorem 42 we have
iNXti T 0 ti  E
i XXkI0ti
 E
NCk 0 ti
i XXkIT 0
NCk 0 ti
Therefore by the computations in the proof of Theorem 42 to prove 35 we only need to check

log E
i XXkIT 
NCk 0 ti
  0
for all 1     n  A1
Since Xi Ci  Xi  IT  is an independently marked Poisson process by Lemma 64VI in
Daley and Vere-Jones 2003 we have
i XXkIT 
NCk 0 ti
  E
 expcid18Z 
exp XXkIT 
iNCkXkXk ti  Xk
i1 iNC0 xtix  1i dxcid19
Take 1     n  A1 By Lemma 43 we have that there exists   DS such that   0
ij i   for all j  1     n and
iNC0x ti  x  NC0R
NC0R 
where  Pii0 i and   0 if i  i  0   Thus
i1 iNC0 xtix  1  eNC0 R  11x  L
for all x  T
i1 iNC0 xtix  1  eNC0 R  11x  L
for all x  T
The limit 36 follows by assumption 6 noticing that the above relations yield for all 1     n 
i XXkIT 
NCk 0 ti
  expELeS  1
i XXkIT 
NCk0 ti
  expEeS  1L  T 1L  T
Now since DS is open the claim follows by applying rst the Gartner-Ellis theorem in Rn to get
the LDP for the nite-dimensional distributions and then the Dawson-Gartner theorem to have
the LDP for the process argue as in the proof of Theorem 42 for the remaining steps
cid3
42 Sample path large deviations in the topology of uniform convergence
In the applications one usually derives LDPs for continuous functions of sample paths of stochastic
processes by using the contraction principle Since the topology of uniform convergence is ner than
the topology of point-wise convergence it has a larger class of continuous functions Thus it is of
interest to understand if NX0  satises a LDP on D0 1 equipped with the topology of
uniform convergence In this section we give an answer to this question assuming that the tails of
S decay super-exponentially
Theorem 44 Assume
Then  NX0
EeS   for each   R
ELeS   for each   R
speed  and good rate function 25
 satises a LDP on D0 1 equipped with the topology of uniform convergence with
In this section without loss of generality we assume that the points of I are XiiZ where
Z  Z0 Xi  Xi1 and we set X0  0 As usual we denote by XtT the non-stationary
Poisson cluster process with immigrant process empty on T   t  T where T  0 is
a xed constant and by C0 the cluster generated by an immigrant at 0
Before proving Theorem 44 we show that the same LDP holds for XtT  under a weaker con-
dition
Theorem 45 Assume 37 Then NXT 0  satises a LDP on D0 1 equipped with the
topology of uniform convergence with speed  and good rate function 25
To prove Theorem 45 above we use the following Lemma 46 whose proof is omitted since it is
similar to the proof of Lemma 33 in Ganesh Macci and Torrisi 2005 Let SkkZ be the iid
sequence of random variables distributed as S dened by Sk  NCk R
Lemma 46 Assume 37 NC0 0  0 as and dene
It holds
Sk  NCkXk0 Xk n  1
n
log P An  n   for each   0
Proof of Theorem 45 We prove the theorem assuming that NC0 0  0 as The general
case is solved as in the proof of Theorem 42 As usual denote by IA the restriction of I on the
Borel set A  R Dene
Ct  XXkI0t
We prove that NXT 0  and C are exponentially equivalent see for instance
Denition 4210 in the book of Dembo and Zeitouni 1998 with respect to the topology of
uniform convergence Therefore the conclusion follows by a well-known result on sample path large
deviations with respect to the uniform topology of compound Poisson processes see for instance
Borovkov 1967 see also de Acosta 1994 and the references cited therein and Theorem 4213
in Dembo and Zeitouni 1998 Dene
CT t  XXkIT t
Using Cherno bound and condition 37 can be easily realized that the processes C
and CT  are exponentially equivalent with respect to the topology of uniform conver-
gence Therefore it suces to show that CT  and NXT 0  are exponentially equiv-
alent with respect to the topology of uniform convergence Note that the assumption NC0 0 
0 as gives
NXtT 0 t  XXkI0t
NCk 0 t  XXkIT 0
NCk 0 t
t  0 as
Therefore we need to show that

log P M    
for any   0
t01cid12cid12cid12
CT t  XXkI0t
NCk 0 t  XXkIT 0
NCk 0 tcid12cid12cid12
M  M 1
  M 2
 XXkIT 0
and M 2
t01 XXkI0t
Sk  NCk 0 t
the limit 39 follows if we prove

log P M 1
  2  
for any   0

log P M 2
  2  
for any   0
The limit 40 easily follows by the Cherno bound and condition 37 It remains to show
41 Since the random function t 7 NCk 0 t is non-decreasing it is clear that the supremum
over t is attained at one of the points Xn n  1 Thus
n1Xn
Sk  NCk 0 Xn
Note that
  M where M 
n1Xn
Therefore 41 follows if we show
Sk  NCkXk0 Xn  Xk as

log P  M  2  
for any   0
Since Xn n  1 is the sum of n exponential random variables with mean 1 using Cherno
bound and taking the logarithm we have that for all   0 and all integers K  
log P XK     
logcid16 
  cid17
Here the symbol  denotes the integer part of  Next observe that using the union bound we
P  M  2 XK    K max
1nK
Sk  NCkXk 0 Xn  Xk  2cid17
Pcid16
Now we remark that for n  1 Xn  X1     Xn  Xn1 and Xn1     X1 have the same
joint distribution Moreover given I the centered processes Ck  Xk are iid and independent of
the Xk Hence letting An denote the random variable dened in the statement of Lemma 46
we have
P  M  2 XK    K max
1nK
P An  2
The random variables An are increasing in n therefore
and by Lemma 46 we have
P  M   XK    KP AK  2

log P  M  2 XK    
Now note that
P  M  2  P  M  2 XK    P XK  
for arbitrary K   Hence by 43 and44 we have
lim sup

cid3
0cid18  K logcid16 
  cid17cid19  K    K log
log P  M  2  inf
Then we obtain 42 by letting K tend to 
Proof of Theorem 44 Throughout the proof we assume NC0 0  0 as The general case
is solved as in the proof of Theorem 42 Let CT t be the process dened in the proof of Theorem
45 The claim follows if we show that CT  and NX0  are exponentially equivalent
with respect to the topology of uniform convergence Note that the assumption NC0 0  0
as implies
NX0 t  NXtT 0 t  XXkIT 
NCk 0 t
t  0 as
Therefore since we already proved that CT  and NXT 0  are exponentially equiv-
alent with respect to the uniform topology see the proof of Theorem 45 the claim follows if we
prove that

log P 
 XXkIT 
Using the Cherno bound we have for all   0
NCk 0   
  
for any   0
 XXkIT 
NCk 0   
NCk0 
exp XXkIT 
  eE
 e expcid18Z 
 e expcid16EeS  1Lcid17 
EeNC0 xx  1 dxcid19
Taking the logarithm dividing by  letting  tend to  and using assumption 38 we get
lim sup

log P 
for all   0
 XXkIT 
NCk0   
  
Relation 45 follows letting  tend to innity in the above inequality
cid3
5 Large deviations of spatial Poisson cluster processes
51 The large deviations principle
A spatial Poisson cluster process X is a Poisson cluster process in Rd where d  1 is an integer The
clusters centers are the points Xi of a homogeneous Poisson process I  Rd with intensity  
0 Each immigrant Xi  I generates a cluster Ci  CXi which is a nite point process Given
I the centered clusters CXi  Xi are iid and independent of I X is the union of all clusters As
in dimension 1 we denote by S the number of points in a cluster with a little abuse of notation
by C0 the cluster generated by a point at 0 and by L the radius of C0 Moreover we denote by
NXb0 r the number of points of X in the ball b0 r and by
dr 
rdd2
1  d2
the volume of b0 r The following LDP holds
Theorem 51 Assume 5 and
ELdeS  
for all   D
Then NXb0 rdr satises a LDP on R with speed dr and good rate function 7
Before proving Theorem 51 we show that the same LDP holds for the non-stationary Poisson
cluster process XrR with immigrant process empty in Rd  b0 R  r As usual this LDP holds
under a weaker condition
Theorem 52 Assume 5 Then NXrR b0 rdr satises a LDP on R with speed dr
and good rate function 7
Proof of Theorem 52 The proof is similar to that one for the non-stationary Poisson cluster
process on the line Here we just sketch the main dierences As in the proof of Theorem 33
the claim follows by the Gartner-Ellis theorem Indeed letting Ib0r denote the point process of
immigrants in b0 r and Ib0Rrb0r the point process of immigrants in b0 R  r  b0 r we
have for each   R
EheNXrR b0ri  Ehe
PXiIb0r
NCi b0ri Ehe
PXiIb0Rrb0r
NCi b0ri 
As usual with a little abuse of notation denote by C0 the cluster generated by an immigrant at
0 It holds
PXiIb0r
NCi b0ri  exp Zb0r
EheNC0 bxr  1i dx 
for each   R
for   0  DS
1  Ehe
for   0 Therefore
PXiIb0Rrb0r
NCi b0ri  expcid16dR  r  drEheS  1icid17 
PXiIb0Rrb0r
NCi b0ri  expcid16dR  r  drEheS  1icid17 
r
PXiIb0r
log Ehe
NCi b0ri  lim
r
drZb0r
rZb01
 EeS  1
EeNC0 bxr  1 dx
EeNC0 bryr  1 dy
for each   R
and since limr dR  rdr  1 for each   DS 
r
log Ehe
PXiIb0Rrb0r
NCi b0ri  0
The rest of the proof is exactly as in the one-dimensional case
cid3
Proof of Theorem 51 The proof is similar to that one of Theorem 52 and is again based on the
Gartner-Ellis theorem We start showing that
r
log EheNXb0rNXrR b0ri  0
for all   D
This relation is easily veried for   0 Thus we only check 47 for   D
all   D
S  0 We have for
S  0
EheNXb0rNXrR b0ri  Ecid20e
PXiI
Rdb0rR
 exp ZRdb0rR
NCi b0rcid21
EheNC0 bxr  1i dx 
Now notice that since   0 we have
eNC0 bxr  1  eNC0 Rd  11kxk  L  r
for all x  Rd
The limit 47 follows by assumption 46 noticing that the above relations yield for all  
S  0 r  0
PXiI
Ecid20e
Rdb0rR
Now notice that
NCi b0rcid21  expd21  d2EL  rdeS  1
for all   R r  0
EheNXb0ri  EheNXrR b0ri EheNXb0rNXrR b0ri 
Therefore if DS  D
S then the claim is a consequence of the computation of the log-Laplace limit
of NXrR b0 r in the proof of Theorem 52 the Gartner-Ellis theorem and assumption 5 It
remains to deal with the case DS 6 D
S Arguing exactly as in the proof of Theorem 32 it can
be proved that for any sequence rnn1  0 diverging to  as n   there exists a
subsequence qn  rn such that
lim sup
n
lim inf
n
log P NXb0 qndqn  F    inf
x
for all closed sets F
log P NXb0 qndqn  G   inf
x
for all open sets G
where  is dened by 7 Then the large deviations upper and lower bounds hold for any sequence
rn and the claim follows
cid3
52 The asymptotic behavior of the void probability function and the empty
space function
Apart some specic cases the void probability function vr  P NXb0 r  0 r  0 of
a spatial Poisson cluster process is not known in closed form Comparing X with the immigrant
process I we easily obtain
vr  P NI b0 r  0  edr
A more precise information on the asymptotic behavior of v as r   is provided by the
following proposition
Proposition 53 Assume ELd   Then
r
log vr  
Proof Note that
vr  P NCib0 r  0 for all Xi  I
1NCib0 r  0
1NI b0 r  0 YXiIRdb0r
 edrE
 YXiIRdb0r
 edr exp ZRdb0r
1NCib0 r  0
P NC0bx r  0 dx
where in 49 we used Lemma 64VI in Daley and Vere-Jones 2003 Thus the claim follows if we
r
drZRdb0r
P NC0bx r  0 dx  0
For this note that
1NC0 b0 r  0  1kxk  r  L
for all x  Rd r  0
Therefore
drZRdb0r
P NC0bx r  0 dx  E1  Lrd  1
and the right-hand side in the above inequality goes to 0 as r   by the dominated convergence
theorem note that ELd   by assumption
cid3
In spatial statistics a widely used summary statistic is the so-called empty space function which is
the distribution function of the distance from the origin to the nearest point in X see for instance
Mller and Waagepetersen 2004 that is
er  1  vr
Apart some specic cases the empty space function of Poisson cluster processes seems to be in-
tractable Next Corollary 54 concerns the asymptotic behavior of er as r  
Corollary 54 Under the assumption of Proposition 53 it holds
r
log log er1  
Proof The proof is an easy consequence of Proposition 53 By the upper bound 48 we obtain
lim sup
r
log log er1  lim
r
log log1  edr1  
To get the matching lower bound we note that the inequality log1  x  x x  0 1 gives
log er1  vr r  0 and therefore by Proposition 53 we get
lim inf
r
log log er1  lim inf
r
log vr  
cid3
53 Spatial Hawkes processes
Spatial Hawkes processes have been introduced in Daley and Vere-Jones 2003 Bremaud Mas-
soulie and Ridol 2005 considered spatial Hawkes processes with random fertility rate and not
necessarily Poisson immigrants and computed the Bartlett spectrum the reader is directed to
Daley and Vere-Jones 2003 for the notion of Bartlett spectrum Mller and Torrisi 2005 de-
rived the pair correlation function of spatial Hawkes processes we refer the reader to Mller and
Waagepetersen 2004 for the notion of pair correlation function
For the sake of completeness we briey recall the denition of spatial Hawkes process A spatial
Hawkes process is a Poisson cluster process X  Rd where d  1 is an integer The clusters centers
are the points Xi of a homogeneous Poisson process I  Rd with intensity   0 Each
immigrant Xi  I generates a cluster Ci  CXi which is formed by the points of generations
n  0 1    with the following branching structure the immigrant Xi  I is said to be of zero-
th generation Given generations 0 1     n in Ci each point Y  Ci of generation n generates
a Poisson process on Rd of ospring of generation n  1 with intensity function h  Y  Here
h  Rd  0 is a non-negative Borel function In the model it is assumed that given the
immigrants the centered clusters Ci  Xi are iid and independent of I By denition the spatial
Hawkes process is X Si Ci As in the one-dimensional case it is assumed
0   ZRd
h d  1
This assumption guarantees that the number of points in a cluster has a nite mean equal to
11  excludes the trivial case where there are no ospring and ensures that X is ergodic with
a nite and positive intensity given by 1   Due to the branching structure the number S of
ospring in a cluster follows the distribution 3 Finally we note that the classical Hawkes process
considered in the previous sections corresponds to the special case where d  1 and ht  0 for
t  0
as Theorem 51 with 50 and
A LDP for spatial Hawkes processes can be obtained by Theorem 51 The precise statement is
ZRd kkh d  
in place of 5 and 46 moreover the rate function is  dened by 20 Here the symbol k  k
denotes the Euclidean norm
Similarly the asymptotic behavior of the void probability function and the empty space function
of spatial Hawkes processes can be obtained as immediate consequences of Proposition 53 and
Corollary 54 respectively The precise statements are as Proposition 53 and Corollary 54 with
conditions 50 and
in place of ELd  
ZRd kkdh d  
6 Extensions and open problems
In this paper we studied large deviations of Poisson cluster processes Applications of these results
to insurance and queueing models are presently under investigation by the authors
The denition of Hawkes process extends immediately to the case of random fertility rate
h Z where Zks are iid unpredictable marks associated to the points Xk see Daley and Vere-
Jones 2003 for the denition of unpredictable marks and Bremaud Massoulie and Ridol 2005
for the construction of Hawkes processes with random fertility rate specied by an unpredictable
mark Due to the form of the distribution of S in this case see formula 6 in Mller and Rasmussen
2005 it is not clear if the LDPs for Hawkes processes proved in this paper are still valid for Hawkes
processes with random fertility rate
The generalization of our results to non-linear Hawkes processes Kerstan 1964 Bremaud and
Massoulie 1996 Massoulie 1998 Bremaud Nappo and Torrisi 2002 Torrisi 2002 would be
interesting However since a non-linear Hawkes process is not even a Poisson cluster process a
dierent approach is needed
Acknowledgements
We thank Kamil Szczegot for reporting two mistakes and for a careful reading of a rst draft of
the paper
References
Borovkov AA 1967 Boundary values problems for random walks and large deviations for func-
tion spaces Theory Probab Appl 12 575595
Bremaud P 1981 Point Processes and Queues Springer New York
Bremaud P and Massoulie L 1996 Stability of nonlinear Hawkes processes Ann Prob 24
15631588
Bremaud P Massoulie L and Ridol A 2005 Power spectra of random spike elds and related
processes Adv Appl Prob 37 11161146
Bremaud P Nappo G and Torrisi GL 2002 Rate of convergence to equilibrium of marked
Hawkes processes J Appl Prob 39 123136
Brix A and Chadoeuf J 2002 Spatio-temporal modeling of weeds by shot-noise G Cox processes
Biometrical J 44 8399
Chavez-Demoulin V Davison AC and Mc Neil AJ 2005 Estimating value-at-risk a point
process approach Quantitative Finance 5 227234
Daley DJ and Vere-Jones D 2003 An Introduction to the Theory of Point Processes 2nd
edition Springer New York
de Acosta A 1994 Large deviations for vector valued Levy processes Stochastic Process Appl
51 75115
Dembo A and Zeitouni O 1998 Large Deviations Techniques and Applications 2nd edition
Springer New York
Ganesh A Macci C and Torrisi GL 2005 Sample path large deviations principles for Poisson
shot noise processes and applications Electron J Probab 10 10261043
Gusto G and Schbath S 2005 FADO a statistical method to detect favored or avoided
distances between occurrences of motifs using the Hawkes model submitted
Hawkes AG 1971a Spectra of some self-exciting and mutually exciting point processes Biometrika
58 8390
Hawkes AG 1971b Point spectra of some mutually exciting point processes J Roy Statist
Soc Ser B 33 438443
Hawkes AG and Oakes D 1974 A cluster representation of a self-exciting process J Appl
Prob 11 493503
Jagers P 1975 Branching Processes with Biological Applications John Wiley London
Jonnson DH 1996 Point Process Models of Single-Neuron Discharges J Computational Neu-
roscience 3 275299
Kerstan J 1964 Teilprozesse Poissonscher Prozesse Transactions of the Third Prague Confer-
ence on Information Theory Statistical Decision Functions Random Processes 377403
Massoulie L 1998 Stability results for a general class of interacting point processes dynamics
and applications Stoch Proc Appl 75 130
Mller J 2003 A comparison of spatial point process models in epidemiological applications In
Highly Structured Stochastic systems eds PJ Green NL Hjort and S Richardson Oxford Uni-
versity Press 264268
Mller J and Waagepetersen RS 2004 Statistical Inference and Simulation for Spatial Point
Processes Chapman and Hall Boca Raton
Mller J and Rasmussen JG 2005 Perfect simulation of Hawkes processes Adv Appl Prob
37 629646
Mller J and Torrisi GL 2007 The pair correlation function of spatial Hawkes processes
Statistics and Probability Letters to appear
Neyman J and Scott EL 1958 Statistical approach to problems of cosmology JR Statist
Soc B 20 143
Ogata Y and Akaike H 1982 On Linear Intensity Models for Mixed Doubly Stochastic Poisson
and Self-Exciting Point Processes J R Statist Soc B 44 102107
Ogata Y 1988 Statistical models for earthquake occurrences and residual analysis for point
processes J Amer Statist Assoc 83 927
Ogata Y 1998 Space-time point process model for earthquake occurrences Ann Inst Statist
Math 50 379402
Reynaud-Bouret P and Roy E 2007 Some non asymptotic tail estimates for Hawkes processes
Bull Belg Math Soc Simon Stevin 13 883896
Torrisi GL 2002 A class of interacting marked point processes rate of convergence to equilib-
rium J Appl Prob 39 137161
Vere-Jones D and Ozaki T 1982 Some Examples of Statistical Estimation Applied to Earth-
quake Data Ann Inst Statist Math 34 189207
