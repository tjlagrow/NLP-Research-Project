Mon Not R Astron Soc 000 000000 0000
Printed 9 July 2015
MN LATEX style le v22
An analysis of the evolving comoving number density of
galaxies in hydrodynamical simulations
Paul Torrey12cid63 Sarah Wellons3 Francisco Machado1 Brendan Grien1
Dylan Nelson3 Vicente Rodriguez-Gomez3 Ryan McKinnon1 Annalisa Pillepich3
Chung-Pei Ma4 Mark Vogelsberger1 Volker Springel56 and Lars Hernquist3
1 MIT Kavli Institute for Astrophysics  Space Research Cambridge MA 02139 USA
2 TAPIR Mailcode 350-17 California Institute of Technology Pasadena CA 91125 USA
3 Harvard-Smithsonian Center for Astrophysics 60 Garden Street Cambridge MA 02138 USA
4 Astronomy Department University of California at Berkeley Berkeley CA 94720 USA
5 Heidelberger Institut fur Theoretische Studien Schloss-Wolfsbrunnenweg 35 69118 Heidelberg Germany
6 Zentrum fur Astronomie der Universitat Heidelberg ARI Monchhofstr 12-14 69120 Heidelberg Germany
9 July 2015
ABSTRACT
The cumulative comoving number-density of galaxies as a function of stellar mass or
central velocity dispersion is commonly used to link galaxy populations across dif-
ferent epochs By assuming that galaxies preserve their number-density in time one
can infer the evolution of their properties such as masses sizes and morphologies
However this assumption does not hold in the presence of galaxy mergers or when
rank ordering is broken owing to variable stellar growth rates We present an analysis
of the evolving comoving number density of galaxy populations found in the Illustris
cosmological hydrodynamical simulation focused on the redshift range 0  z  3
Our primary results are as follows 1 The inferred average stellar mass evolution
obtained via a constant comoving number density assumption is systematically bi-
ased compared to the merger tree results at the factor of 24 level when tracking
galaxies from redshift z  0 out to redshift z  23 2 The median number density
evolution for galaxy populations tracked forward in time is shallower than for galaxy
populations tracked backward in time 3 A similar evolution in the median number
density of tracked galaxy populations is found regardless of whether number density
is assigned via stellar mass stellar velocity dispersion or dark matter halo mass 4
Explicit tracking reveals a large diversity in galaxies assembly histories that cannot
be captured by constant number-density analyses 5 The signicant scatter in galaxy
linking methods is only marginally reduced by considering a number of additional
physical and observable galaxy properties as realized in our simulation We provide
ts for the forward and backward median evolution in stellar mass and number den-
sity for use with observational data and discuss the implications of our analysis for
interpreting multi-epoch galaxy property observations as related to galaxy evolution
Key words methods numerical  cosmology theory  cosmology galaxy formation
 galaxies abundances
1 INTRODUCTION
Modeling galaxy evolution based on observational data re-
quires a method for linking galaxy populations between
dierent epochs Establishing direct progenitor-descendant
links would allow for reconstruction of the mass size star
cid63 E-mail ptorreymitedu
ccid13 0000 RAS
formation rate color and morphology evolution among
other things of galaxies directly from observational data
However formulating a method that accurately links pro-
genitor and descendant galaxy populations is non-trivial
Incorrectly linking observed galaxy populations between dif-
ferent epochs results in errors in the inferred evolutionary
tracks This eect has come to be known as progenitor
bias eg van Dokkum  Franx 1996 Saglia et al 2010
P Torrey et al
and is a well-known eect that needs to be addressed in
order to infer the mass van Dokkum et al 2010 Bram-
mer et al 2011 Patel et al 2013 van Dokkum et al 2013
size Fan et al 2008 Valentinuzzi et al 2010 Carollo et al
2013 Patel et al 2013 van Dokkum et al 2013 Morishita
et al 2015 star formation rate Papovich et al 2011 and
morphology evolution van Dokkum  Franx 2001 Daddi
et al 2005
Several approximations have been employed to estimate
progenitor-descendant linking of galaxy populations in order
to minimize or remove progenitor bias One method that has
been applied is to select rare or distinct galaxy populations
which one might reasonably be able to recover at dier-
ent observational epochs Such analysis has been applied to
examine the redshift-dependent properties of brightest clus-
ter galaxies BCGs eg Butcher  Oemler 1984 Aragon-
Salamanca et al 1993 Lidman et al 2012 Vulcani et al
2014 as well as to populations of massive early-type galax-
ies ETGs eg Daddi et al 2005 Trujillo et al 2007 Barro
et al 2013 The premise behind this linking metric is that
both massive ETGs and BCGs observed at high redshift will
remain massive ETGs and BCGs into the low-redshift uni-
verse This assumption is generally true However caution
must be taken as the fraction of galaxies that are massive
and quenched grows with time This will drive an increase
in the number of massive ETGs and BCGs that exist in the
local universe compared to the high-redshift universe and
therefore create contamination in the inferred progenitor-
descendant galaxy populations It has been argued in Car-
ollo et al 2013 that this eect alone can result in the in-
ferred size evolution of massive ETGs but see also Belli
et al 2014 Keating et al 2015 for careful analysis that
indicates progenitor bias is insucient to fully explain the
observed size evolution The current uncertainty that sur-
rounds the size evolution of ETGs is dominated by a lack
of theoretical understanding of how to link high and low
redshift galaxy populations
Another approach  which is the focus of this paper 
is to assume that progenitor and descendant galaxy popu-
lations can be linked based on their cumulative comoving
number density eg Wake et al 2006 van Dokkum et al
2010 Papovich et al 2011 Brammer et al 2011 Patel et al
2013 van Dokkum et al 2013 This method is appealing be-
cause it provides a straightforward way to infer information
about galaxy evolution directly from multi-epoch cumula-
tive stellar mass functions Because no assumptions about
galactic characteristics eg massive and quenched are re-
quired this method has been employed to infer the mass
evolution of Milky Way progenitors Patel et al 2013 van
Dokkum et al 2013 the evolution of redquenched galaxy
fractions Brammer et al 2011 and the size and morpholog-
ical evolution of massive galaxies van Dokkum et al 2010
Linking galaxy populations in this fashion implicitly in-
volves two assumptions i that the total number density
of galaxies is conserved and ii that galaxies maintain their
rank order If both of these assumptions are true then the
mostleast massive galaxies at some initial redshift eg
z  2 will still be the mostleast massive galaxies at any
other redshift eg z  0 The two primary issues with this
approach are that galaxies undergo merger events which can
reduce their number density and that individual galaxies
may have scatteredstochastic growth histories which can
break their rank ordering Mergers will drive an evolution in
the number density of any given galaxy population by simply
changing the number density of the total galaxy population
with time even if galaxies remain well rank-ordered On the
other hand scattered growth rates will cause a population
of galaxies with similar initial stellar mass at some initial
redshift eg z  2 to have some potentially wide distri-
bution of masses by the time they evolve to some new ob-
servational epoch eg z  0 To avoid unnecessary biases
when applying constant comoving number-density analysis
to observational datasets it is important to understand the
extent to which galaxy mergers or variable galaxy growth
rates impact number-density matching
Capturing galaxy mass assembly including both merg-
ers and variable mass growth rates can be done in detail by
employing numerical galaxy formation simulations The ef-
ciency of constant comoving number-density selections has
been studied using semi-analytic models Leja et al 2013
Mundy et al 2015 and with abundance matching Behroozi
et al 2013 Leja et al 2013 employed the Guo et al
2011 semi-analytic models based on the Millennium Simu-
lation Springel et al 2005b to compare tracked mass evo-
lution against assumed mass evolution based on number-
density selections They found that a constant comoving
number-density selection yielded inferred median descen-
dant masses of high-redshift galaxy populations which dif-
fered by 40 from the actual descendant masses By apply-
ing a correction to account for the scatter in galaxy growth
rates and mergers they were able to reduce the mass oset
error from a number-density selection to 12 However even
with such a correction signicant scatter remains among the
inferred growth rates
Mundy et al 2015 used several dierent semi-analytic
models also based on the Millennium Simulation Springel
et al 2005b to provide tting functions that describe
the recovery fraction of galaxies with time They found
that for their lowest number-density bin corresponding to
the most massiverare haloes a constant number-density
selection recovered roughly 30 of available descendants
with the majority of the recovered galaxy population be-
ing contamination Behroozi et al 2013 used an abun-
dance matching based on the Bolshoi Simulation Klypin
et al 2011 to infer the number-density evolution of galax-
ies They found a median evolution in the number density
for all galaxy mass bins and provided tting functions for
the median evolution These tting functions have been ap-
plied in Marchesini et al 2014 where the mass and star
formation rate histories of massive galaxies were inferred us-
ing the prescribed number density evolution tracks
Our work builds on these previous theoretical studies
by examining the constant comoving number-density selec-
tion method using a full volume hydrodynamical simula-
tion Multi-epoch constant comoving number-density selec-
tion method has only recently been examined using hydro-
dynamical simulations at high redshifts Jaacks et al 2015
with limited study at z  3 To the extent that both hy-
drodynamical simulations and semi-analytic methods accu-
rately reproduce the evolution of the galaxy stellar mass
function see Somerville  Dave 2014 for a comparison and
discussion it is unlikely that full hydrodynamical simula-
tions would yield very dierent results compared to their
semi-analytic model counterparts However there are some
ccid13 0000 RAS MNRAS 000 000000
subtle but important issues that we might expect to yield
concrete dierences between the previous analyses and what
we present in this paper
Specically the cosmology used in the original Millen-
nium Simulation Springel et al 2005b was based on the
WMAP-1 data release Bennett et al 2003 and therefore
applied a 8 value that is higher than what is currently
accepted This has the consequence of boosting the halo-
halo merger rate which is of direct relevance to galaxy
number-density analysis Leja et al 2013 Mundy et al
2015 A direct comparison of the halo-halo merger rates
between the Millennium Simulation and Illustris shows that
the merger rates are in good agreement despite dierences
in the adopted cosmological parameters Rodriguez-Gomez
et al 2015 The galaxy-galaxy merger rates used in semi-
analytic models can be signicantly oset from the galaxy-
galaxy merger rates found in Illustris Rodriguez-Gomez
et al 2015 which could impose dierences on the number
density evolution However given that the results presented
in Behroozi et al 2013 which used updated cosmological
parameters generally agreed with Leja et al 2013 it is
unlikely that updated cosmological parameters alone would
drive major dierences in the number-density evolution of
galaxies
Perhaps more importantly while semi-analytic models
and hydrodynamical simulations both attempt to include a
similar array of physical processes gas cooling star forma-
tion feedback etc in detail the growth rates of galaxies are
calculated in very dierent ways It is therefore not guaran-
teed that the scattered growth rates that can contribute to
breaking galaxy rank order will be equally realized in semi-
analytic models and hydrodynamical simulations Moreover
while semi-analytic models are able to infer a wide range of
internal galactic properties eg galaxy size bulge-to-disk
ratio etc all of these properties are managed and evolved
at a sub-grid level Although the hydrodynamical simula-
tions employed in this paper also apply sub-grid models to
manage many aspects of galaxy formation physics eg star
formation ISM gas phase structure etc some important
galactic characteristics such as stellar velocity dispersion
can be self-consistently evolved Finally the general anal-
ysis presented in this paper complements nicely the detailed
studies of specic galaxy populations that form in our simu-
lations and have been compared against observations such
as the formation and evolution of compact massive galax-
ies Wellons et al 2015ab
The paper is structured as follows In Section 2 we dis-
cuss our methods including a description of the simulations
that have been employed the construction of galaxy prop-
erty catalogs and the merger trees that form the core of our
analysis In Section 3 we present the simulated multi-epoch
cumulative stellar mass function and the corresponding in-
ferred stellar mass evolution We compare this against the
actual tracked stellar mass evolution found in the simula-
tion We introduce useful tting formulae here which de-
scribe the mass and number-density evolution for the explic-
itly tracked galaxy population In Section 4 we present the
simulated multi-epoch cumulative velocity dispersion func-
tion and consider whether velocity dispersion might act as
a better galactic parameter for linking galaxy populations
In Section 5 we discuss our results with a focus on under-
standing the empirical origin of the trends we nd in our
ccid13 0000 RAS MNRAS 000 000000
Number Density Evolution
simulations and exploring implications for using number-
density analyses on observational data sets We conclude in
Section 6
2 METHODS
In this paper we use the Illustris simulation to study the rela-
tionship between the stellar mass dark matter mass central
stellar velocity dispersion and number-density evolution of
galaxies Full details of the Illustris project can be found
in Vogelsberger et al 2014ab Genel et al 2014
Briey the Illustris simulation is a cosmological hydro-
dynamical simulation run in a periodic box of size L 
1065 Mpc Illustris was run using the AREPO simulation
code Springel 2010 using a physical setup that includes
gravity hydrodynamics radiative cooling of gas Katz et al
1996 star formation with associated feedback Springel 
Hernquist 2003 mass and metal return to the interstel-
lar medium from aging stellar populations Wiersma et al
2009 Vogelsberger et al 2013 and supermassive black hole
growth with associated feedback Di Matteo et al 2005
Springel et al 2005a Sijacki et al 2007 Vogelsberger et al
2013 Sijacki et al 2014 The feedback models employed
in the simulation were chosen to match the redshift z  0
galaxy stellar mass function and cosmic star formation rate
history and it has been subsequently shown that it broadly
reproduces the observed evolving galaxy stellar mass func-
tion out to high redshift Torrey et al 2014 Genel et al
2014 Sparre et al 2015 The relatively large volume allows
for sampling across a range of galaxy environments Vogels-
berger et al 2014a including rare objects eg compact
massive galaxies Wellons et al 2015a with diverse forma-
tion histories Sparre et al 2015 all of which is impor-
tant for the present work The Illustris simulation contains
roughly 18203 baryon and dark matter particles yielding a
baryon mass resolution of Mbar  13  106Mcid12 and a dark
matter mass resolution of MDM  63106Mcid12 The number
of dark matter particles remains exactly xed at 18203 for
the whole run but the number of baryonic resolution ele-
ments changes owing to cell derenement The Plummer-
equivalent gravitational force softening lengths used in the
simulation is   10 h1 ckpc for both dark matter and
baryons until z  1 at which time the baryonic gravita-
tional softening length is capped at a maximum physical
value of   05 h1 pkpc The dark matter gravitational
softening length continues at a xed comoving size to z  0
Several steps have been taken to post-process the
Illustris data output to facilitate the present analysis
First the simulation output is run through SUBFIND to
identify friends-of-friends FoF haloes and bound sub-
haloes Springel et al 2001 Dolag et al 2009 Through-
out this paper we employ the SUBFIND sub-halo catalog
to identify galaxy populations including both centrals and
satellites Wherever we refer to galaxies or galaxy popula-
tions we are in detail referring to the self-bound sub-halo
structures identied by SUBFIND
Second a wide range of physical properties  includ-
ing stellar mass star formation rate half-mass radius etc
 of each structure identied with SUBFIND have been tab-
ulated A catalog of galaxy properties is calculated for each
galaxy and each redshift independently Throughout this
P Torrey et al
paper we use stellar masses and dark matter halo masses
In both cases we calculate the stellar dark matter halo
masses as being the total mass of all gravitationally bound
stellar dark matter particles of a given SUBFIND subhalo
For this paper we have additionally calculated the stellar
velocity dispersion for the galaxy population dened as the
three dimensional standard deviation of stellar particle ve-
locities calculated within the stellar half-mass radius
The third post-processing step is to link the galaxy cat-
alogs together in time using merger trees In this paper we
adopt the SubLink merger trees as described in Rodriguez-
Gomez et al 2015 The merger trees are constructed by
identifying progenitordescendant galaxy pairings based on
overlapping particle compositions identied through particle
identication numbers The merger trees facilitate tracking
of individual galaxies forward and backward in time while
including in situ growth and contributions from mergers
When galaxy mergers occur the progenitors are segregated
into a single main branch and secondary progenitors We de-
ne the main progenitor branch as being the most massive
branch when summed over the entire formation history un-
til that point De Lucia  Blaizot 2007 Rodriguez-Gomez
et al 2015 Other operational denitions of main progeni-
tor branch are possible eg most massive halo at the previ-
ous snapshot Springel et al 2005b and some of the results
quoted in this paper depend on this assumption However
we have veried that this choice has a very limited impact
on our results with all of our results being qualitatively in-
variant to this choice
The full data from the Illustris simulation  including
all data post-processing SUBFIND galaxy property catalogs
merger trees data and basic scripts and procedures required
to reproduce our analysis  have been made publicly avail-
able Nelson et al 20151
3 RESULTS TRACING GALAXIES VIA
STELLAR MASS
31 Cumulative Stellar Mass Function
Perhaps the most relevant aspect of our model for this pa-
per is its ability to reproduce the cumulative galaxy stellar
mass function at many observational epochs It has also been
shown that the feedback model employed by Illustris  de-
scribed in detail in Vogelsberger et al 2013  is capable of
producing a galaxy stellar mass function and star formation
main sequence that broadly matches observations Torrey
et al 2014 Genel et al 2014 Sparre et al 2015 This agree-
ment is achieved through a combination of star formation
driven winds to moderate star formation in low mass galax-
ies and AGN feedback to regulate the growth of massive
galaxies This combination of feedback results in a multi-
epoch galaxy stellar mass function that is similar to mod-
ern semi-analytic models and other hydrodynamical simula-
tions see Somerville  Dave 2014 for comprehensive review
plots and discussion Here we present ts to the redshift
evolution of the cumulative galaxy stellar mass function as
found in our simulations This t is important to the analysis
that we carry out in subsequent sections of the paper
1 httpwwwillustris-projectorg
Figure 1 Cumulative stellar mass functions derived from the
galaxy populations found in Illustris are shown at several red-
shifts as indicated in the legend The grey region identies the
stellar mass range vertical strip and cumulative number density
range horizontal strip that correspond to the Milky Way mass
objects at redshift z  0 as dened and discussed in the text The
dashed lines shown within indicate the multi-epoch CMF tting
functions The tting functions nearly overlap with the actual
CMFs at all redshifts and so we also show the error associated
with these ts in the panel inset with the solid blue band indi-
cating 5 errors The mass evolution of galaxies can be inferred
from the tting functions by identifying the mass associated with
a constant comoving number density at several redshifts eg
where the grey horizontal band intersects the CMFs
Figure 1 shows the cumulative mass function CMF at
several redshifts as realized in the Illustris simulation We t
the simulated cumulative galaxy stellar mass function with
a power law plus exponential dependence of the form
exp M
N  A M Log M
where M  M10Mcid12 The combined power-law ex-
ponential form of Equation 1 is adopted to be similar to
the Schechter 1976 function commonly used to describe
galaxy stellar mass and luminosity functions We allow all
of the t variables to vary with redshift according to
A  a0  a1z  a2z2
  0  1z  2z2
  0  1z  2z2
  0  1z  2z2
where z is redshift Adopting this tting form results in 12
independent coecients all variables on the RHS of equa-
tions 2-5 that are set using an ordinary least squares re-
gression on the CMFs over the redshift range z  0 to
z  6 mass range M  107Mcid12 and number density range
N  3  105Mpc3 The resulting ts are shown in Fig-
ure 1 as dashed lines which can be compared against the
ccid13 0000 RAS MNRAS 000 000000
107108109101010111012M M10-510-410-310-210-1NM Mpc3N174e-3N142e-3z00z10z20z30z40z50z60108109101010111012M M0201000102Log Nsolid lines that trace the CMFs taken directly from the sim-
ulation In the inset of Figure 1 we also show Log10 N  
Log10 NsimNt which gives an impression for the level of
t accuracy Using the power law plus exponential t de-
scribed above we obtain a t to the CMF that is valid from
z  0 to z  6 with typical errors of order 1 which al-
ways remain well below 10 The best t coecients for the
CMF in Illustris in the redshift range 0  z  6 are given
in Table 1 The appropriate limits on this tting function
cover the mass range 107Mcid12  M  1012Mcid12 CMF values
  3  105Mpc3 and redshift range 0  z  6 How-
ever one should additionally bear in mind that the baryon
particle mass in our simulations is  106Mcid12 and so cau-
tion should be taken when considering the low-mass end of
the mass function where only 10  100 stellar particles are
included in each galaxy
Despite its 12 free terms Equation 1 is trivial to calcu-
late Upon evaluation one can easily identify the cumulative
number density of galaxies over the full resolved mass range
in Illustris from 0  z  6 This is generally useful includ-
ing for comparisons with observed cumulative stellar mass
functions  which is outside the scope of this paper2 The
general form allows us to obtain useful ts to a wide variety
of smoothly varying functions making it possible to use ex-
pressions that take a similar form to Equation 1 at several
points in this paper including the cumulative velocity disper-
sion function and tracked galaxy number-density evolution
We are additionally making available with this paper simple
python scripts that allow one to evaluate Equation 13
32 Milky Way mass galaxies constant vs
non-constant number density
We begin our analysis of the evolutionary tracks and evolv-
ing comoving number-densities of Illustris galaxies by con-
sidering the formation history of a population of Milky Way
mass galaxies
We adopt a denition for Milky Way mass galaxies
as those galaxies with a redshift z  0 stellar mass in the
range 4  1010Mcid12  M  5  1010Mcid12 eg McMillan
2011 Bovy  Rix 2013 This corresponds to 410 galaxies
at redshift z  0 including all morphological types forma-
tion histories environments etc sampled in the simulation
volume The vertical grey shaded region in Figure 1 indi-
cates the redshift z  0 mass range adopted for Milky Way
type galaxies in this section The corresponding horizontal
grey shaded region identies the cumulative number-density
range that is associated with the redshift z  0 Milky Way
galaxy mass range We note that in what follows our results
are not very sensitive to this specic choice of initial mass
or number-density range
2 The CMF is most valuable to the present paper where we focus
on the evolution of galaxies in number density space We addition-
ally provide ts of the same form to the dierential stellar mass
function in Appendix A which is the more commonly adopted
form for examining the galaxy stellar mass function
3 httpsgithubcomptorreytorreycmf
ccid13 0000 RAS MNRAS 000 000000
Number Density Evolution
Table 1 Best-t parameters to the redshift-dependent CMF
presented in Equation 1
-2893811
-0625598
-0038895
11523852
0082199
0086216
0025419
-0187102
-0123157
-0049033
-0007130
0021022
Table 2 Best-t parameters to the backward-tracked number-
density evolution The below parameters along with Equation 1
describe the median number density of a redshift z  0 selected
galaxy population at some higher redshift out to z  3
-2643961
-0526844
-0026482
11339278
-0299579
-0138136
-0016006
0391025
-0037861
-0032246
-0005645
-0015732
Table 3 Best-t parameters to the forward-tracked number-
density evolution starting from z  1 The t is only valid from
z  1 to z  0
-3640099
-0797215
-0048383
11827591
1036010
0292991
0033631
-0665051
-0311620
-0077466
-0004868
0184837
Table 4 Best-t parameters to the forward-tracked number-
density evolution starting from z  2 The t is only valid from
z  2 to z  0
-3991685
-0793825
-0038297
11828429
0348706
0019329
-0000232
-0280904
0050966
0036924
0006948
-0030598
Table 5 Best-t parameters to the forward-tracked number-
density evolution starting from z  3 The t is only valid from
z  3 to z  0
-4353012
-0792804
-0029089
11801074
-0438934
-0191351
-0020006
0197901
0229633
0066223
0007395
-0149748
Table 6 Best-t parameters to the redshift-dependent cumula-
tive velocity dispersion function presented in Equation 6
7391498
-6863393
2852083
0067032
5729400
-5273271
1255696
-0048683
-1120552
1104114
-0286638
0007648
P Torrey et al
321 Examples of Individual Galaxy Evolutionary Tracks
Figure 2 shows synthetic stellar light images Torrey et al
2015 Snyder et al 2015 in the SDSS-g -r -i bands made
for a selection of 5 galaxies from the Milky Way mass sample
at 8 redshifts during their formation as labeled within the
top panel of each column The progenitors of these 5 sys-
tems have been determined directly from the galaxy merger
tree which nds the progenitors of any galaxy based on the
particle ID composition of each galaxy If multiple progen-
itor galaxies exist while tracing galaxies backward in time
we always select the main progenitor dened as the pro-
genitor with the most massive history De Lucia  Blaizot
2007 Rodriguez-Gomez et al 2015 We have ordered the
galaxies by their redshift z  3 progenitor masses with in-
dividual mass and number density evolution tracks shown
in the bottom panels
We nd that three of the systems the top three evolve
without signicant inuence from mergers with relatively
smooth mass growth and number density tracks These
three systems preserve their rank order but diverge in their
stellar mass from each other with time By redshift z  3
the top blue and middle green galaxies have stellar
masses that are dierent by an order of magnitude The
bottom two examples were selected to highlight systems that
undergo mergers and change their rank order signicantly
with time For example the top blue and fourth yellow
galaxies have nearly identical mass evolution tracks from
redshift z  0 out to redshift z  15 At that time the
fourth system can be identied through the postage stamp
images to be undergoing a signicant merger event after
which the blue and yellow mass growth tracks diverge De-
spite their nearly identical mass evolution out to redshift
15 these systems are oset by roughly an order of mag-
nitude in their stellar mass by redshift z  3 A similar
qualitative story holds for the bottom red system which
follows a relatively median mass growth track out to red-
shift z  07 but quickly becomes the least massive of these
galaxy progenitors thereafter
The mass growth tracks shown in the left bottom panel
of Figure 2 directly translate via the CMF into the number
density evolution tracks shown in the bottom right panel
We nd that the dark and light blue galaxies which were
already massive systems at redshift z  3 and followed mild
growth paths thereafter are close to remaining on constant
comoving number density evolution tracks In contrast the
red system which grew rapidly since redshift z  3 has an
evolution in number density of nearly an order of magnitude
Figure 2 highlights the diversity in individual growth paths
that occur at a xed z  0 stellar mass Using the full sample
of Milky Way mass galaxies in the simulation we can further
consider the median growth tracks and the dispersion about
those tracks for this galaxy population
322 Population Evolutionary Tracks
We next consider the mass evolution of the full Milky Way
mass selected galaxy population using now two complemen-
tary methods First armed solely with an evolving set of cu-
mulative stellar mass functions we can identify the galaxy
mass associated with a specic number density at any red-
shift If we assume that progenitordescendant galaxy pop-
ulations can be matched between dierent epochs at a con-
stant comoving number density we can infer the mass of
Milky Way progenitor galaxies at higher redshifts by con-
sidering where the horizontal grey strip overlaps with the
CMF at those redshifts as shown in Figure 1 This is the
method commonly adopted when working with multi-epoch
extragalactic observational data Here this is achieved by in-
verting Equation 1 numerically using a Newton-Raphson
root nding algorithm to solve for M  Mz N  given
some constant choice of the galaxies cumulative number
density N as a function of redshift z
Second the stellar mass evolution of the simulated
galaxies can be measured directly from the galaxy merger
tree as was demonstrated in the previous subsection The re-
sults from both mass tracking methods are presented in the
left panel of Figure 3 with the red line indicating the median
stellar mass evolution from number-density selection and the
blue solid line indicating the median stellar mass evolution
from merger tree analysis The blue shaded regions show the
range of stellar masses present from the tracked galaxy pop-
ulation as noted in legend We note that by denition the
blue line overlaps identically with the red line at the redshift
where the galaxy populations is selected
Two conclusions can be drawn from the left panel of
Figure 3 1 The median mass evolution tracks based on the
comoving number-density selection and direct merger tree
tracking are oset from one another and 2 The merger tree
tracking method possess signicant scatter that grows as a
function of redshift indicating that there is a large diversity
in the way galaxies assemble their mass even when these
are selected from a relatively narrow mass bin at z  0
The stellar mass evolution for the explicitly tracked
populations is more rapid than the inferred mass evolution
from number-density selections By redshift z  23 there
is a factor of  24 stellar mass oset between the two
mass tracks The small scatter in the number-density se-
lected mass evolution directly results from the assumption
that galaxies remain rank ordered in their mass at all times
In contrast although all galaxies in the explicitly tracked
galaxy populations are initially clustered in their stellar
masses the range of stellar mass values disperses with time
as galaxies experience variable growth rates and stochastic
evolution
Also shown in the left panel of Figure 3 is a black
dashed line corresponding to the Milky Way mass evolu-
tion derived from 3D-HST and CANDELS survey data us-
ing the constant comoving number-density selection in van
Dokkum et al 2013 see their equation 1 A similar re-
sult was presented in Patel et al 2013 We nd that 
though there are some dierences in their detailed shape 
the simulated and observational comoving number-density
mass evolutions are never separated by more than  20
over the redshift range 0  z  3 This is an indication
that our simulated cumulative stellar mass function evolves
quite similarly to the observed cumulative stellar mass func-
tion Any oset between the van Dokkum et al 2013 line
and the simulation red curve are driven by inconsistencies
between the two sets of mass functions However more im-
portantly both of these mass evolution trajectories are oset
from the explicitly tracked Milky Way mass evolution  by
a factor of  2 by redshift z  2 A factor of  2 median
oset is not very severe in agreement with the conclusions
ccid13 0000 RAS MNRAS 000 000000
Number Density Evolution
Figure 2 Mock stellar light images are shown for 5 galaxies taken from the Milky Way mass galaxy sample as described in the main
text Each system is shown at 8 redshifts from z  0 to z  3 to highlight the variety of formation histories that exist for galaxies
with similar initial stellar masses The rows are ordered by increasing z  3 progenitor mass In some cases the bottom two rows in
particular we nd merger events contribute signicantly to the growth of these systems The bottom two panels show the mass left
and cumulative number density right evolution for the 5 selected galaxies with the color of the line corresponding to the border color
for each image
of Leja et al 2013 and is comparable to other uncertainties
in stellar mass measurements eg initial mass function un-
certainties age-dust degeneracies weakly constrained star
formation histories etc At the low mass end of the z  2
progenitor distribution however we nd that roughly one
third of explicitly tracked systems have masses that are o-
set by more than an order of magnitude from the constant
comoving number-density mass trajectory
The origin of the oset between the mass evolution
tracks is simple galaxies do not remain exactly rank or-
dered nor is galaxy number density a conserved quantity
The right panel of Figure 3 shows the distribution of cumula-
tive number density for the initially selected Milky Way type
ccid13 0000 RAS MNRAS 000 000000
galaxies as they are traced back in redshift The dispersion
of the galaxies cumulative number densities with redshift
is indicated through the dark blue bands as noted in the
legend The mass and number-density evolution shown in
the left and right panels of Figure 3 are exactly interchange-
able as long as we are using the cumulative stellar mass
function to assign rank order Thus we reach the same two
conclusions from the right panel as we did from the left
that the median number density of a tracked galaxy pop-
ulation evolves with time and that the initially clustered
population of galaxies disperses with time such that no sin-
gle comoving number-density selection can fully recover the
initial galaxy sample Correcting the median oset is fairly
P Torrey et al
Figure 3 Left The mass evolution of Illustris Milky Way mass galaxies is shown as a function of redshift for two methods used to
trace galaxy mass growth with time The wide blue band indicates the mass distribution for a population of galaxies traced backward
in time explicitly through the merger tree The red band indicates the inferred mass evolution by assuming constant comoving number
density and applying the CMF tting functions presented in Equation 1 with coecients provided in Table 1 The black dashed line
indicates the observational inferred Milky Way mass evolution from van Dokkum et al 2013 using a constant comoving number-density
assumption Right The number-density evolution of Milky Way mass galaxies is shown as a function of redshift The wide blue band
indicates the distribution of number densities that a tracked galaxy population has when traced backward in time through the merger
tree We note that there is both a median evolution with redshift and signicant scatter both of which are discussed in the text
straightforward and we provide a clear procedure for how
to do so in the next subsection
Fits to the non-constant number density
evolution across galaxy masses
331 Tracing Galaxies Backward in Time
As described above Equation 1 provides a redshift-
dependent t to the number density as a function of mass
and redshift When we performed the regression to deter-
mine the best t parameters in Section 31 we specied a
set of N  M and z points based on data from cumulative
stellar mass functions ie the N and M pairings as shown
in Figure 1 at several redshifts This is sensible because
this would be the only information that an observer would
have on multi-epoch galaxy populations However since the
cumulative stellar mass functions are built independently at
each redshift no information regarding the number-density
evolution of individual galaxies or populations of galaxies is
retained using this approach As a result we nd that when
we track a population of galaxies explicitly in time they
follow a non-constant number-density evolution in time as
shown in Figure 3
Using information on the mass and number-density evo-
lution as a function of redshift we can perform a similar
regression analysis using Equation 1 However here we
want to nd the cumulative number-density evolution track
that best describes the actual tracks taken by galaxies in
our simulation To achieve this we take N  N z to be
the number density of each individual galaxy as it evolves in
time from an initial z  0 mass of M0 The only dierence
between the t that we perform in this section and what we
did in the previous subsection is the way that the N Mz
pairings are constructed Here rather than using the pair-
ings from the CMF which are constructed independently at
each redshift we use N M0z pairings constructed from
the merger tree by tracing each galaxy with redshift z  0
mass M0 backwards in time to obtain the number density
evolution for every galaxy N  N z
The derived parameters from this tting procedure are
given in Table 2 Using this t we are able to infer the ex-
pected median number density a galaxy population will have
at some redshift z given its initial z  0 mass M0 Using
this t in conjunction with the tabulated CMF presented in
Section 31 we can then infer the average mass associated
with this galaxy population at other redshifts
We demonstrate the derived mass and number-density
evolution in the left and right panels of Figure 4 respec-
tively Figure 4 shows the mass and number-density evolu-
tion of a set of four dierent galaxy populations where the
colored bands are constructed from tracking galaxies along
their main progenitor branch as described above All of the
same behavior that was present for the Milky Way mass
bin inspected above is also seen for the other galaxy mass
bins considered here The black solid lines in each panel
indicate the mass and number density evolution that is ob-
tained from the constant comoving number density assump-
ccid13 0000 RAS MNRAS 000 000000
00051015202530z10910101011MM80604020Merger TreeConst Num Densvan Dokkum 201300051015202530z10-310-2NM Mpc380604020Merger TreeConst Num DensNumber Density Evolution
Figure 4 Left The mass evolution of z  0 galaxies tracked backward in time is shown as a function of redshift for three methods used
to trace the stellar mass growth As in Figure 3 the wide colored bands indicate the 20 40 60 80 distribution of galaxies as tracked
backward in time Right The corresponding number-density evolution is shown for the backward-tracked galaxy populations There is
signicant scatter in the number-density evolution which becomes worse for the most rare lowest number-density bins In both panels
black dashed lines indicate the results of the t to the median evolution in number density whose parameters appear in Table 2 In the
left panel the inferred mass evolution is obtained by using the CMF to convert the best-t number density to stellar mass Similarly in
both panels the solid black lines indicate the mass and number density evolution tracks following a constant comoving number density
assumption
tion The black dashed lines in each panel indicate the mass
and number-density evolution that is obtained from the non-
constant comoving number density t
By construction we nd that the non-constant number-
density t follows the appropriate average trend We obtain
the mass evolution shown in the black dashed line left panel
of Figure 4 by converting the evolving number density into
a mass based on the tabulated CMF coecients given in Ta-
ble 1 This procedure can be replicated with observational
data The t parameters from Table 2 are well suited to
describe the median number-density evolution over the re-
solved mass range Mz  0  109Mcid12 and redshift range
0  z  3 The t parameters given in Table 2 can be applied
to identify the progenitor galaxies that properly follow the
median mass evolution of an initially selected galaxy pop-
ulation eg Behroozi et al 2013 Marchesini et al 2014
However we emphasize that while this t does describe the
median number-density evolution it does not capture the
scattered growth rates
332 Tracing Galaxies Forward in Time
An important caveat for the t parameters presented in Ta-
ble 2 is that they were obtained by identifying galaxies at
z  0 and tracing their massnumber density backwards in
time and therefore only apply in that direction This in-
forms us of the mass and number-density evolution of the
main progenitor galaxies of the galaxy population that is
present at redshift z  0 However this analysis is not an in-
ccid13 0000 RAS MNRAS 000 000000
herently reversible procedure owning primarily to asymmet-
ric scattered growth rates when examining the forward and
backward evolutionary paths of galaxy populations There-
fore while the results of the previous section can be used
to identify the past mass or number-density evolution of
present day selected galaxy populations we cannot necessar-
ily use the results of the previous subsection to identify the
present day counterparts to an observed high-redshift galaxy
population Instead to identify the present-day descendants
of a high-redshift galaxy population the analogous galaxy
populations need to be traced forward in time
To perform this analysis we select a galaxy population
at some non-zero redshift and use the merger trees to follow
that galaxy population forward in time Galaxies that merge
with more massive systems are followed until the merger
event after which we assume that the galaxy is no longer
observable  and so it is not included in the tting or analysis
beyond that point Neglecting these branches entirely does
not signicantly change the results but the consumption of
galaxies via mergers can lead to a signicant reduction in the
number of galaxies that are available for forward tracking
We nd a similar result for the survival fraction of galaxies
to z  0 as has been shown in previous work eg Leja et al
2013 Mundy et al 2015 Specically the survival fraction
is not a very steep function of initial stellar mass with only
a weak trend where more massive systems are more likely
to survive For a galaxy population selected at redshift z 
2 roughly two-thirds of those galaxies can be expected to
have redshift z  0 counterparts with the rest having been
00051015202530z1071081091010101110121013MMMerger Tree FitsConst Num DensM1e09MM1e10MM1e11MM1e12M00051015202530z10-510-410-310-210-1100NM Mpc3Merger Tree FitsConst Num DensM1e09MM1e10MM1e11MM1e12M10
P Torrey et al
Figure 5 Same as Figure 4 but with galaxy populations that are tracked forward in time after an initial selection at redshift z  3
Fit parameters appear in Table 5 Contrasting this gure with Figure 4 demonstrates the dierence between tracking galaxy progenitor
and galaxy descendant populations Whereas there is signicant median evolution in the number density of backward tracked galaxy
populations we nd that the overall number density evolution is somewhat weaker for forward tracked galaxy populations This results
in the constant comoving number density inferred mass evolution solid black lines more closely approximating the median merger tree
tracked mass evolution solid colored lines
consumed by some larger system For a z  3 selected galaxy
population the survival fraction drops to roughly half This
can be contrasted with the expectation that 100 of redshift
z  0 selected galaxies have meaningful high-redshift main
progenitors which only requires assuming that the employed
simulation has sucient resolution to continue to track their
formation backward in time
Figure 5 shows the mass and number-density evolution
of a population of galaxies selected at redshift z  3 and
tracked forward in time The mass evolution shown in Fig-
ure 5 is qualitatively consistent with our basic expectations
the median galaxy mass increases with time along with an
increase in the dispersion of the individual galaxy mass dis-
tribution We perform a regression on the N  Mz z pair-
ings to determine the coecients of Equation 1 where we
take Mz to be the stellar mass of each galaxy at some
initial redshift z in place of M0 from the previous subsec-
tion and N  N z is the mass ranked cumulative number
density of each galaxy when traced forward in time We indi-
cate the t mass and number-density evolution tracks with
black dashed lines in both panels of Figure 5 and the best t
coecients are given in Tables 3-5 We nd that the lower
three mass bins are tracked very well in time using this t
The highest mass bin shows some signicant deviation from
the t which is mostly a consequence of the low number of
galaxies in this bin  which decreases as it moves to lower
redshift
Interestingly we nd that the qualitative behaviors of
the number-density evolution for the tracked galaxy pop-
ulations are dierent when tracked forward and backward
in time When tracked backward in time Figure 4 the
number density of the tracked galaxy population steadily
increases However when tracked forward in time the me-
dian number density of the tracked galaxy population re-
mains much more constant For comparison the solid black
lines in Figure 5 indicate evolutionary tracks of constant co-
moving number density We nd that the median mass and
number density evolution for one of the bins  the red band
which was selected to contain galaxies with stellar masses of
M  1010Mcid12 at redshift z  3  almost identically follows
the constant comoving number density trajectory The other
tracked bins are oset from the constant comoving number
density track but remain closer to this constant comoving
number density track than their backward tracking counter-
parts presented in Figure 4
If we compare the resulting mass evolution using the
backward and forward ts as shown in Figure 6 we nd that
tracing galaxies forward in time yields a noticeably shallower
mass evolution The dierences in the forwardbackward
number-density evolution as well as the osets in the for-
wardbackward inferred mass growth rates are both primar-
ily driven by the scattered growth rates of galaxies as we
discuss in Section 53
4 RESULTS TRACING GALAXIES VIA
STELLAR VELOCITY DISPERSION
41 Cumulative Velocity Dispersion Function
Velocity dispersion has been advocated as a stable proxy
for galaxy rank order because of its invariance to growth
ccid13 0000 RAS MNRAS 000 000000
00051015202530z1071081091010101110121013MMMerger Tree FitsConst Num DensM1e08MM1e09MM1e10MM1e11M00051015202530z10-510-410-310-210-1100NM Mpc3Merger Tree FitsConst Num DensM1e08MM1e09MM1e10MM1e11MNumber Density Evolution
Figure 6 The average mass evolution is shown for several mass
bins to contrast the results that are obtained from tracking galax-
ies forward and backward in time Both galaxy merger events and
asymmetric median galaxy growth rates cause the inferred mass
evolution to be dierent at the factor of 2 level depending on the
directionality of the galaxy tracking Note that neither of these
curves is fundamentally more correct than the other but rather
they identify dierent mass evolution tracks as described in more
detail in the in Sections 332 and 53
via galaxy mergers eg Loeb  Peebles 2003 Bezanson
et al 2011 If galaxy growth is driven primarily by mergers
then the central velocity dispersion will evolve by  30
by redshift z  3 Hernquist et al 1993 Hopkins et al
2009 In contrast if internal changes eg pung up via
mass loss from quasars Fan et al 2008 dominate over merg-
ers in determining structure evolution of low redshift galaxy
populations then the velocity dispersion can increase signif-
icantly While this point has been examined through semi-
analytic models in the past Leja et al 2013 Mundy et al
2015 it has not previously been inspected using numerical
simulations where the velocity dispersion of galaxies can be
tracked directly In parallel with the previous section here
we present the multi-epoch cumulative velocity dispersion
function CVDF along with a multi-epoch simple tting
function to determine its ability to reliably link galaxy pop-
ulations in time
To construct the cumulative velocity dispersion func-
tion we dene the central stellar velocity dispersion  as
the three-dimensional standard deviation of the stellar ve-
locities within the stellar half-mass radius We present the
CVDF at several redshifts in Figure 7 We employ a t to
the CVDF of the form
N   A Log
exp
where   10kmsec We perform a regression anal-
ysis to determine the above coecients A   and 
each of which contains a second order redshift dependence
as given in Equations 2-5 The derived coecients are given
ccid13 0000 RAS MNRAS 000 000000
Figure 7 The cumulative velocity dispersion function CVDF
is shown for several redshifts as indicated in the legend In con-
trast to the CMF the CVDF shows comparatively little evolution
with redshift after z  2 Multi-epoch ts given in Equation 6
are indicated with dashed lines with the errors associated with
these ts indicated in the inset plot Fit parameters can be found
in Table 6
in Table 6 with the results shown as dashed lines in Fig-
ure 7 The inset axes show the error associated with the
multi-epoch t which is accurate at the cid46 10 percent level
between redshifts 0  z  6 over the velocity disper-
sion range Logkmsec  18 and number density range
N  3  103Mpc3
We nd that there is relatively limited evolution in the
CVDF from z  2 to z  0 This low level of redshift evo-
lution was not present for the CMF for any mass scale We
do nd that there is evolution in the CVDF beyond redshift
z  2 which can be quite signicant at all velocity dispersion
values
42 Evolutionary Tracks in Velocity Dispersion
The limited evolution in the CVDF is an intriguing feature
for comoving number-density analysis If the CVDF is as-
sembled at early times then perhaps the central velocity
dispersion evolution is restricted in time This would hap-
pen in a scenario where galaxies attain their central velocity
dispersion at early times without signicant evolution there-
after even in the presence of mass growth This is expected
for massive quenched galaxies that assemble at early times
and retain their internal stellar structure while pung up
at late times from minor merger events Naab et al 2007
This scenario is less likely to apply to star forming galaxies
We test the velocity dispersion rank ordering by trac-
ing several galaxy populations back in time similar to what
was done in the previous section The results are shown in
Figure 8 We could select the exact same systems used in
0123z10810910101011M MBackwardForward1820222426Log kmsec10-510-410-310-210-1N Mpc3z00z10z20z30z40z50z601820222426Log kmsec0201000102Log N12
P Torrey et al
Figure 8 Analogous to Figure 4 but where we are now selecting galaxies in bins of number density according to stellar velocity
dispersion rather than stellar mass The initial number density ranges sampled in each bin are chosen to match what was used in
Figure 4 The legend indicates the stellar mass that corresponds to each number density bin We nd that galaxies do not show very
signicant median evolution in their velocity dispersion when traced out to redshift z  3 However we nd there is signicant spread
associated both in terms of the velocity dispersion and number-density distribution for this galaxy population when traced backward in
time The black dashed lines correspond to the same number-density evolution t shown in Figure 4 which was constructed using the
CMF not a new t using the CVDF In the left panel the CVDF was used to convert number density to velocity dispersion Despite
having been constructed using stellar mass the evolving number density t also appropriately follows the velocity dispersion evolution
the previous section to trace backwards in time However
because there is not a perfect 11 correlation between stellar
mass and velocity dispersion using the same mass-selected
galaxy population would introduce a somewhat larger ini-
tial spread in the velocity dispersion-assigned cumulative
number density the introduced extra scatter in number
density is roughly a factor of 3 Given our goal of under-
standing how cumulative number-density selection methods
are able to trace galaxy populations in time we instead se-
lect a galaxy population that uses the same initial number-
density limits as in the previous section but use the CVDF
rather than the CMF to assign number density For the ve-
locity dispersion bin centered around a number density of
6 103 Mpc3 this results in the selection of 466 galaxies
130 of which were also in the mass-selected galaxy sample
in the same number density range Although this is a some-
what dierent initial galaxy selection we can consider the
evolution of this galaxy population in velocity dispersion
and directly compare the evolution in number-density space
against what we found in the previous section
The velocity dispersion evolution is shown in the left
panel of Figure 8 The median velocity dispersion evolu-
tion is shown with the solid colored lines while the shaded
colored regions identify the spread in the evolving velocity
dispersion distribution for the initially selected galaxy pop-
ulation as indicated in the legend We nd that the median
velocity dispersion does not signicantly change over this pe-
riod of time for any of the bins A typical change of 01-02
dex from redshift z  0 out to z  3 is found For com-
parison the solid black line indicates the evolution along an
assumed constant comoving number density trajectory
However we nd that the mild evolution of the velocity
dispersion does not directly translate to the proper recovery
of the initial galaxy population when selected via their co-
moving number density The right panel of Figure 8 shows
the number-density evolution as assigned from the CVDF
for this tracked galaxy population Despite the mild evolu-
tion of the velocity dispersion the divergence of this galaxy
population in number-density space with time is still sig-
nicant There is a median oset in the number density of
this tracked galaxy population that grows with time and
the scatter of the initial galaxy population reaches order of
magnitude or larger levels in comoving number density by
redshift z  3 The general trend that we nd in the evolv-
ing number-density distribution is very similar in terms of
median oset and scatter growth to that found when we
used the CMF to trace galaxies in time To highlight these
similarities the black dashed line in Figure 8 is not a new t
from this data but rather the number-density evolution de-
termined in the previous section using the CMF ie the co-
ecients given in Table 2 We nd that the median number-
density evolution that we derived for the CMF applies very
well to the CVDF number-density evolution
Given the applicability of the CMF number-density
evolution t we can consider the inferred velocity disper-
sion evolution Specically we can calculate N  N z us-
ing the ts from the previous section and then determine
  N z via Equation 6 with the coecients given
ccid13 0000 RAS MNRAS 000 000000
00051015202530z161820222426283032Log kmsecMerger Tree FitsConst Num DensM1e09MM1e10MM1e11MM1e12M00051015202530z10-510-410-310-210-1100N Mpc3Merger Tree FitsConst Num DensM1e09MM1e10MM1e11MM1e12MNumber Density Evolution
in Table 6 The result is shown as the black dashed line
in the left panel of Figure 8 which is in good agreement
with the merger tree tracked velocity dispersion evolution
This is a clear indication that there is a mean evolution in
the number density of galaxies present at nearly the same
level regardless of whether we employ the CMF or CVDF
to Milky Way mass systems
that the median evolution in the number density for a pop-
ulation of explicitly-tracked galaxies behaved nearly iden-
tically to what we found when we used the CMF This il-
lustrates an important point it indicates that there is an
underlying driver of galaxy number-density evolution that
impacts our results regardless of the physical quantity on
which we perform our galaxy rank ordering
5 DISCUSSION
The method of matching galaxies between dierent epochs
observationally based on their number density is both widely
used and reasonably physically justied As has been shown
in the past  and as we have conrmed in this paper  the
errors that are introduced into the inferred stellar mass evo-
lution of galaxies between redshift z  2 and the present day
when one uses a constant number-density selection rather
than the explicit galaxy merger tree mass evolution are not
catastrophic ie of order  03  05 dex By neglecting
the scattered growth histories of galaxies one can imme-
diately link high and low redshift observed galaxy popula-
tions This is one of the principal methods employed to in-
fer galaxy mass buildup size growth and morphology evo-
lution in past literature However such an approach does
not properly link the vast majority of progenitor and de-
scendant galaxies Mundy et al 2015 Depending on the
elapsed time and massnumber-density bin size the true
recovery rate of progenitordescendant galaxies using a con-
stant comoving number-density selection can easily be of
order  10  30 Leja et al 2013 Mundy et al 2015
A crude link does exist between high- and low-redshift
galaxies in their comoving number density but this link
evolves with time and includes signicant intrinsic scat-
ter In this paper we have presented the explicitly tracked
number-density evolution of galaxies based on a hydrody-
namical simulation of galaxy formation We nd a median
oset associated with the growth history of any galaxy
population when compared against the constant comoving
number-density selection methods The magnitude of this
oset is not the same when tracking galaxies forward and
backward in time We nd that tracking galaxies forward
in time yields median mass and number density evolution
tracks that evolve in better agreement with the constant
comoving number density than when systems are tracked
backward in time We have provided simple tting functions
that describe the median number-density evolution  both
forward and backward in time  that can be applied to obser-
vational studies straightforwardly Once we adopt a simple
formulation for the non-constant comoving number-density
evolution we can recover the median mass evolution of our
explicitly traced galaxy population from the CMF alone We
encourage this to enter into future observational analysis as
has been done in Marchesini et al 2014
We have examined the claim that velocity dispersion
can act as a more robust property for linking galaxies to-
gether in time By constructing the CVDF we were able to
apply an identical analysis to the evolution of the velocity
dispersion of our tracked galaxy population Although the
CVDF itself shows limited evolution from z  0 to z  2
there is still signicant evolution in the number density of in-
dividual galaxies as assigned through the CVDF We found
ccid13 0000 RAS MNRAS 000 000000
51 Dependence on Baryon Physics
How much do the prescriptions derived for the galaxy co-
moving number density evolution in this paper depend on
the specic physics implementations that we have employed
in the Illustris simulation The answer to this question is
fairly critical since we have focused only on the number
density evolution of galaxies as characterized by their bary-
onic properties which are subject to inuence from poorly
constrained and crudely modeled sub-grid prescriptions for
many physical processes To address this point we consider
the number density evolution of the dark matter haloes di-
rectly since they are relatively insensitive to the baryonic
models We select four galaxy populations using the same
number density criteria that were employed in Figures 4
and 8 The result of tracking these four galaxy populations
backward in time is shown in Figure 9 We nd that the
characteristic evolution of dark matter halo masses is fairly
dierent from what was found for the stellar mass evolution
 especially at the high-mass end At the high-mass end
massive galaxies tend to quench owing to the AGN feed-
back prescriptions that have been implemented in our simu-
lation This leads to relatively at late-time growth rates for
the stellar masses as shown in Figure 4 In contrast no such
late-time attening of the halo mass growth rate is present
in Figure 9 All haloes continue to grow rapidly until the
present day
We next consider what this means for the number den-
sity evolution of this galaxy population as shown in the right
panel of Figure 9 The black dashed lines indicate the num-
ber density evolution calculated in Section 3 based on galaxy
stellar mass and are therefore identical to those presented in
Figures 4 and 8 We nd that  despite the visible dierences
in the stellar mass and halo mass growth trajectories  the
median number density evolution is nearly identical regard-
less of whether we use stellar mass stellar velocity disper-
sion or dark matter halo mass to trace the number density
of galaxies in time This allows us to conclude that the im-
plementation of baryonic physics and feedback processes as
included in our simulations does not dominate the number
density evolution of galaxies Rather the stochastic growth
rate of the underlying dark matter halo is the primary driver
of the galaxy number density evolution that we nd in our
simulations We have repeated this analysis tracking galax-
ies forward in time and have arrived at the same conclusion
For this reason we consider the derived median forward and
backward number density evolution trends presented in this
paper to be robustly tied to the underlying dark matter halo
growth rates and to be relatively independent of the specic
implementation of baryon physicsfeedback adopted in our
simulation
Nevertheless we still caution that some of the galaxy
properties considered in this paper are subject to inuence
from the adopted physicsfeedback prescriptions employed
P Torrey et al
in our simulations For example the size-mass relation de-
rived for the Illustris galaxy population is shifted to larger
sizes for low mass galaxies when compared against obser-
vations This is likely an indication of a shortcoming in ei-
ther our treatment of the ISM equation of state or feed-
back implementation and could impact the derived veloc-
ity dispersion explored in Section 4 Similarly the galaxy
stellar mass function obtained within the Illustris simula-
tion broadly agrees with observations across a wide range
of redshifts Torrey et al 2014 Genel et al 2014 Sparre
et al 2015 Somerville  Dave 2014 but diers in detail It
is therefore possible that future generations of simulations
or semi-analytic models that better match the galaxy mass
distribution consistent with observations could yield some-
what dierent median or scattered comoving number density
evolution rates Although we feel condent that the non-
constant comoving number density ts prescribed in this
paper are an improvement over the constant comoving num-
ber density assumption commonly applied in the literature
the previously mentioned caveats along with those discussed
in Nelson et al 2015 should be kept in mind when apply-
ing the evolving cumulative number density ts presented
in this paper
52 Additional Parameter Dependencies
A wide range of galaxy properties beyond the stellar mass
velocity dispersion and dark matter halo mass are tracked
in our simulations We can therefore consider the role that
several other galaxy parameters may play in predicting the
scatter seen in the galaxy number-density evolution For ex-
ample it is reasonable to suspect that the relative lateearly
formation times of galaxies can be distinguished based on
galaxy color Given the abundance of basic information we
have about an observable galaxy population at some red-
shift eg z  0 galaxy masses sizes star formation rates
colors etc how deterministically can we predict an indi-
vidual galaxys evolutionary history We have shown in this
paper that galaxy populations of similar stellar mass will
have large scatter in their formation histories and it is not
immediately clear to what extent we can dierentiate be-
tween galaxies that will grow faster or slower compared to
their peers of similar initial mass by considering additional
galaxy properties
We adopt the most straightforward method to identify
additional parameter dependencies that follows the same ap-
proach used throughout this paper Specically we perform
an ordinary linear regression using the redshift z  0 galaxy
stellar masses stellar velocity dispersions sizes star forma-
tion rates and g  r galaxy colors We adopt the stellar
half-mass radii as a proxy for galaxy size and the g  r color
is calculated based on the Bruzual  Charlot 2003 stellar
photometric catalogs as tabulated in Torrey et al 2015
The t that we apply takes the general form
cid88
4cid88
Log10N  
where i is a summation over galaxy properties i  0 is
stellar mass i  1 is stellar velocity dispersion etc j is
a summation over polynomial expansion order and Cij 
c0ij c1ijzc2ijz2 are the redshift-dependent coecients
The regression is performed using the tracked number den-
sity of the galaxy population with redshift N  N z as well
as the redshift z  0 galaxy properties The regression yields
the best possible t to the number-density evolution of the
galaxy population backward in time based on the proper-
ties that are known at redshift z  0 If there are residual
correlations driving the scatter seen in the number-density
evolution in Figures 4 and 8 then they will be captured
with this tting procedure We note that the fourth order
polynomial in Equation 7 gives ts to the number den-
sity evolution which are equally good ie errors of order a
few percent as those given in Section 3 when stellar mass
is the only parameter considered which makes this a fair
comparison
Given the number-density evolution t in Equation 7
we can derive the stellar mass evolution using the tabulated
CMF given in Section 3 We are then able to quantify the
reduction in the scatter of this t by considering the error
in the resulting stellar mass estimates Figure 10 shows the
median and standard deviation of the log ratio of the pre-
dicted mass to the actual mass at several redshifts for the
Milky Way mass selected galaxies using both the mass only
ts given in Section 3 as well as the multi-parameter t
given in Equation 7 We nd that the multi-parameter ts
provide a median error which is similar to the mass-only t
but that the one-sigma standard deviation in the scatter is
reduced by  01 dex While the multi-parameter t is an
improvement over the mass only t this amounts only to
a  20 reduction in the scatter Even with an accounting of
the galaxy stellar masses sizes star formation rates colors
and stellar velocity dispersions entering into our analysis
our improved t still has a 0304 dex standard deviation
by redshift z  23
The lack of signicantly reduced scatter indicates that a
direct and unambiguous linking cannot be achieved between
high and low redshift populations given the simulated galaxy
stellar masses sizes star formation rates colors and stellar
velocity dispersions alone We do not rule out the possibil-
ity of being able to deterministically connect high redshift
and low redshift galaxy populations in a direct progenitor-
descendant link but our results indicate that this would re-
quire information beyond the quantities explored here We
have performed the same exercise tracing galaxies forward
in time and found similar results ie a  20 reduction
in scatter While marginally reduced the scatter is still a
signicant component of the overall mass evolution
We caution again that some of the galaxy properties
considered in this section are subject to inuence from
the adopted physicsfeedback prescriptions employed in our
simulations We specically note that although the sim-
ulated galaxy stellar mass function from Illustris broadly
agrees with observations the most massive galaxies continue
to experience intermittent periods of star formation activity
at late times that can lead to non-zero SFRs and greenish
galaxy colors Both of these may adversely impact our ability
to decompose mass-matched galaxy populations into late-
and early-forming subsamples It will therefore be interest-
ing to reconsider this problem using other currently available
numerical simulations eg Schaye et al 2015 which em-
ploy dierent physicalfeedback prescriptions Crain et al
2015 or with future generations of large volume galaxy for-
mation simulations or semi-analytic models
ccid13 0000 RAS MNRAS 000 000000
Number Density Evolution
Figure 9 Analogous to Figures 4 and 8 but where we are now selecting galaxies in bins of number density according to their dark
matter subhalo mass rather than stellar mass or velocity dispersion As in Figure 8 the black dashed lines are number-density evolution
tracks constructed using the CMF and the cumulative dark matter mass function was used to convert number density to dark matter
mass in the left panel We nd that the dark matter mass growth of these systems looks somewhat dierent from the stellar mass growth
owing to the lack of quenching Regardless of this dierence the number density evolution is nearly identical to what we obtained for
both the central velocity dispersion and stellar mass number density analysis and the t correctly tracks the dark matter mass evolution
53 ProgenitorDescendant Tracking Asymmetry
We have found in Section 332 that tracing galaxies forward
in time yields distinctly shallower inferred mass growth rates
than tracing galaxies backward in time A similar manifes-
tation of this eect is the qualitatively dierent number-
density evolution for galaxies as they are traced forward
and backward in time Physically tracing galaxies forward
and backward captures dierent processes When tracing
galaxies forward in time a signicant fraction of the tracked
galaxy population can be lost owing to merger events
when the galaxy being tracked is swallowed by a more mas-
sive system The forward tracks therefore roughly capture
the median mass evolution of the surviving galaxy popula-
tion Tracing galaxies backward in time contains no analo-
gous loss of systems owing to mergers By denition any
galaxy which exists in the simulation at redshift z  0
is a main branch The backward tracks therefore roughly
capture the median mass evolution of the main progenitor
galaxies Since these two tracking methods capture dierent
physical galaxy populations it should perhaps not surprise
us that they yield qualitatively similar but quantitatively
dierent mass evolution tracks However if we select only
main branches in both the forward and backward tracking
analysis we nd that a nearly identical bias still persists
between the inferred mass evolution in each direction The
reason for this is that while the forward tracking does in-
deed suer from a net reduction of tracked galaxies with
time the systems which are lost owing to mergers are more-
or-less randomly sampled from the initial population there
ccid13 0000 RAS MNRAS 000 000000
are marginal correlations with environment but these leave
a non-detectable signal
The main eect that drives the dierence in forward-
backward mass tracking is the asymmetric sampling of
galaxy scattered growth given the initially selected galaxy
population A population of galaxies selected at low red-
shift will naturally contain some subset of galaxies which
had anomalously fast growth histories ie which originated
from much lower masses Although these anomalously fast
growth histories only apply to a small fraction of the galaxy
population the steep nature of the galaxy stellar mass func-
tion implies a much higher abundance of low-mass galaxies
that are able to follow these tracks Therefore there is a
conditional probability set by the shape of the high-redshift
galaxy stellar mass function that tends to sample fast growth
histories when tracing galaxies backward in time Track-
ing galaxies forward in time yields no similar conditional
probability Instead the primary source of galaxy dispersed
growth histories is simply the scatter in the galaxy stellar
mass function We leave a more formal exploration of the
various mechanisms that drive galaxy number-density evo-
lution to a future study
6 CONCLUSIONS
In this paper we have studied the stellar mass central stellar
velocity dispersion dark matter halo mass and correspond-
ing comoving number-density evolution of galaxies using
the Illustris hydrodynamical galaxy formation simulation
We have compared the evolutionary paths of galaxy pop-
00051015202530z10101011101210131014MDM MMerger Tree FitsConst Num DensM1e09MM1e10MM1e11MM1e12M00051015202530z10-510-410-310-210-1100NMDM Mpc3Merger Tree FitsConst Num DensM1e09MM1e10MM1e11MM1e12M16
P Torrey et al
Figure 10 The median and 1 standard deviation for the log
ratio of the predicted mass to the actual tracked stellar mass from
the merger tree as a function of time for z  0 Milky Way mass
galaxies Red lines indicate the predictions when z  0 stellar
mass is the only parameter considered and blue lines indicate the
predictions when the redshift z  0 stellar velocity dispersions
stellar half mass radii star formation rates and g  r galaxy
colors are also included The scatter is reduced by only  20
when these additional parameters are considered
ulations obtained by assuming that galaxies preserve their
number density in time the so-called constant number den-
sity ansatz and by directly tracking the simulated galaxies
backward and forward in time via the available merger trees
Our main conclusions are as follows
 We provide a simple tabulated function that gives the
cumulative stellar mass function CMF and cumulative
stellar velocity dispersion function CVDF from z  0 to
z  6 in the Illustris Simulation Equation 1 and Tables 1
and 6 This simple function can be used  as we do in this
paper  to infer the stellar mass growth of galaxies at a
xed number density The cumulative stellar mass function
found in the Illustris Simulation can be compared against
observations and we note that previous studies have pre-
sented such a comparison Torrey et al 2014 Genel et al
2014 with favorable results The functional t provided in
this paper for the dierential and cumulative galaxy stellar
mass function should help facilitate future comparisons with
simulated data and semi-analytic results
 We trace galaxies forward and backward in time us-
ing merger trees from the Illustris simulations and nd that
galaxy populations do not evolve along constant comoving
number-density tracks They fail to do so because of the
combined inuence of galaxy mergers and scattered galaxy
growth rates We nd that galaxies that are initially similar
in their stellar mass dark matter mass or central stellar
velocity dispersion diverge with time
 We nd that the central stellar velocity dispersion
evolves only mildly with redshift owing to the combined
eects of mass and size growth Despite the mild velocity
dispersion evolution we nd that velocity dispersion yields
a number density evolution that is not improved over that
found for stellar mass or dark matter mass assigned num-
ber density evolution In fact we nd that the evolution of
the number-density distribution of galaxies evolves nearly
identically regardless of whether one uses stellar mass dark
matter mass or central stellar velocity dispersion to assign
number density
 There is a systematic bias between the median mass
growth rate inferred from constant comoving number-
density analysis and merger tree analysis that we capture
in our simulations This bias is driven by a systematic evo-
lution in the median number density of a galaxy popula-
tion when traced in time The median oset in stellar mass
growth histories is only a factor of 24 when tracing Milky
Way type galaxies out to redshift z  23 However we em-
phasize that this oset is systematic and can be corrected
for by accounting for the median number-density evolution
of galaxies with time
 We provide a simple tabulated function that describes
the number-density evolution of simulated galaxies both for-
ward and backward in time Equation 1 with Tables 2-5
We encourage the use of this simple form in place of the
widely applied constant comoving number density While
the non-constant comoving number-density evolution does
not capture the scattered growth rates that are present for
our simulated galaxy population it does account for the rst
order oset for the median galaxy mass and number density
evolution
 A fundamental asymmetry exists between progenitor
and descendant tracking We nd that the mass trajecto-
ries identied by following progenitor and descendant galaxy
populations in time yield an oset of a factor of a few which
is systemically biased toward faster growth rates when trac-
ing galaxies backward in time This implies that the pro-
genitors of Milky Way or other mass galaxies would in fact
be on average lower in mass than would be implied from a
constant comoving number-density analysis This has direct
implications for quoted eg Milky Way mass progenitor
mass evolutionary histories in the literature
 The scatter in the mass formation histories for any ini-
tially similar galaxy population is large We show that the
simulated progenitors of present day Milky Way mass galax-
ies span at z  2 more than one order of magnitude in stel-
lar masses We apply a regression including several galactic
properties beyond stellar mass size star formation rate
galaxy color and stellar velocity dispersion and nd that
the error in the massnumber-density evolution can only be
improved marginally by 20
 We argue that the intrinsic scatter in galaxy growth
rates implies that one cannot unambiguously identify galaxy
progenitordescendant populations between dierent obser-
vational epochs
In light of these conclusions statistical methods for linking
progenitor and descendant galaxy populations may be better
suited for observationally deriving galaxy mass size and
morphology evolution
ccid13 0000 RAS MNRAS 000 000000
00051015202530z080604020002040608LogMpredMactMass OnlyMulti ParameterACKNOWLEDGEMENTS
Guo Q White S Boylan-Kolchin M et al 2011 MN-
Number Density Evolution
support
PT acknowledges
from NASA ATP Grant
NNX14AH35G SW is supported by the National Science
Foundation Graduate Research Fellowship under grant num-
ber DGE1144152 FM acknowledges support from the MIT
UROP program RM acknowledges support from the DOE
CSGF under grant number DE-FG02-97ER25308 AP ac-
knowledges support from the HST grant HST-AR-13897
Support for C-PM is provided in part by the Miller Insti-
tute for Basic Research in Science University of California
Berkeley VS acknowledges support by the DFG Research
Centre SFB-881 The Milky Way System through project
A1 and by the European Research Council under ERC-StG
EXAGAL-308037 LH acknowledges support from NASA
grant NNX12AC67G and NSF grant AST-1312095
The Illustris-1 simulation was run on the CURIE su-
percomputer at CEAFrance as part of PRACE project
RA0844 and the SuperMUC computer at the Leibniz Com-
puting Centre Germany as part of GCS-project pr85je
The further simulations were run on the Harvard Odyssey
and CfAITC clusters the Ranger and Stampede supercom-
puters at the Texas Advanced Computing Center through
XSEDE and the Kraken supercomputer at Oak Rridge Na-
tional Laboratory through XSEDE The analysis presented
in this paper was conducted on the joint MIT-Harvard com-
puting cluster supported by MKI and FAS
REFERENCES
RAS 413 101
Hernquist L Spergel D N  Heyl J S 1993 ApJ 416
Hopkins P F Hernquist L Cox T J Keres D 
Wuyts S 2009 ApJ 691 1424
Jaacks J Finkelstein S L  Nagamine K 2015 ArXiv
e-prints
Katz N Weinberg D H  Hernquist L 1996 ApJS
105 19
Keating S K Abraham R G Schiavon R et al 2015
ApJ 798 26
Klypin A A Trujillo-Gomez S  Primack J 2011 ApJ
740 102
Leja J van Dokkum P  Franx M 2013 ApJ 766 33
Lidman C Suherli J Muzzin A et al 2012 MNRAS
427 550
Loeb A  Peebles P J E 2003 ApJ 589 29
Marchesini D Muzzin A Stefanon M et al 2014 ApJ
794 65
McMillan P J 2011 MNRAS 414 2446
Morishita T Ichikawa T Noguchi M et al 2015 ApJ
805 34
Mundy C J Conselice C J  Ownsworth J R 2015
ArXiv e-prints150405583
Naab T Johansson P H Ostriker J P  Efstathiou
G 2007 ApJ 658 710
Nelson D Pillepich A Genel S et al 2015 ArXiv e-
prints150400362
Papovich C Finkelstein S L Ferguson H C Lotz
J M  Giavalisco M 2011 MNRAS 412 1123
Aragon-Salamanca A Ellis R S Couch W J  Carter
Patel S G van Dokkum P G Franx M et al 2013
D 1993 MNRAS 262 764
ApJ 766 15
Barro G Faber S M Perez-Gonzalez P G et al 2013
Rodriguez-Gomez V Genel S Vogelsberger M et al
ApJ 765 104
2015 MNRAS 449 49
Behroozi P S Marchesini D Wechsler R H et al 2013
Saglia R P Sanchez-Blazquez P Bender R et al 2010
ApJ 777 L10
AA 524 A6
Belli S Newman A B  Ellis R S 2014 ApJ 783 117
Bennett C L Halpern M Hinshaw G et al 2003
ApJS 148 1
Bezanson R van Dokkum P G Franx M et al 2011
ApJ 737 L31
Bovy J  Rix H-W 2013 ApJ 779 115
Brammer G B Whitaker K E van Dokkum P G
Schaye J Crain R A Bower R G et al 2015 MNRAS
446 521
Schechter P 1976 ApJ 203 297
Sijacki D Springel V Di Matteo T  Hernquist L
2007 MNRAS 380 877
Sijacki D Vogelsberger M Genel S et al 2014 ArXiv
e-prints14086842
et al 2011 ApJ 739 24
Snyder G F Torrey P Lotz J M et al 2015 ArXiv
Bruzual G  Charlot S 2003 MNRAS 344 1000
Butcher H  Oemler Jr A 1984 ApJ 285 426
Carollo C M Bschorr T J Renzini A et al 2013 ApJ
e-prints 150207747
Somerville R S  Dave R 2014 ArXiv e-prints
14122712
773 112
Sparre M Hayward C C Springel V et al 2015 MN-
Crain R A Schaye J Bower R G et al 2015 MNRAS
RAS 447 3548
450 1937
Daddi E Renzini A Pirzkal N et al 2005 ApJ 626
Springel V 2010 MNRAS 401 791
Springel V Di Matteo T  Hernquist L 2005a MN-
RAS 361 776
De Lucia G  Blaizot J 2007 MNRAS 375 2
Di Matteo T Springel V  Hernquist L 2005 Nature
Springel V  Hernquist L 2003 MNRAS 339 289
Springel V White M  Hernquist L 2001 ApJ 549
433 604
Dolag K Borgani S Murante G  Springel V 2009
Springel V White S D M Jenkins A et al 2005b
MNRAS 399 497
Nature 435 629
Fan L Lapi A De Zotti G  Danese L 2008 ApJ
Torrey P Vogelsberger M Genel S et al 2014 MN-
689 L101
RAS 438 1985
Genel S Vogelsberger M Springel V et al 2014 MN-
Torrey P Snyder G F Vogelsberger M et al 2015
RAS 445 175
ccid13 0000 RAS MNRAS 000 000000
MNRAS 447 2753
P Torrey et al
Trujillo I Conselice C J Bundy K et al 2007 MN-
RAS 382 109
Valentinuzzi T Fritz J Poggianti B M et al 2010
ApJ 712 226
van Dokkum P G  Franx M 1996 MNRAS 281 985
 2001 ApJ 553 90
van Dokkum P G Whitaker K E Brammer G et al
2010 ApJ 709 1018
van Dokkum P G Leja J Nelson E J et al 2013 ApJ
771 L35
Vogelsberger M Genel S Sijacki D et al 2013 MN-
RAS 436 3031
Vogelsberger M Genel S Springel V et al 2014a MN-
RAS 444 1518
 2014b Nature 509 177
Vulcani B Bundy K Lackner C et al 2014 ApJ 797
Wake D A Nichol R C Eisenstein D J et al 2006
MNRAS 372 537
Wellons S Torrey P Ma C-P et al 2015a MNRAS
449 361
 2015b in prep
Wiersma R P C Schaye J Theuns T Dalla Vecchia
C  Tornatore L 2009 MNRAS 399 574
APPENDIX A NON-CUMULATIVE GALAXY
STELLAR MASS FUNCTION
In Section 31 we provided tabulated ts to the cumulative
galaxy stellar mass function Although useful for this paper
the CMF is less commonly used in the literature compared
to the dierential galaxy stellar mass function Here we
provide similar ts to the dierential galaxy stellar mass
function from the Illustris simulation that can be used easily
for comparisons against other simulations or observational
data sets We adopt a functional form of
dLogM
 A M Log M
exp M
where M  M10Mcid12 and the t coecients are al-
lowed to vary with redshift as described in equations 2-5
We identify the best t coecients using an ordinary regres-
sion based on the tabulated dierential stellar mass func-
tion over the redshift range 0  z  6 The galaxy stellar
mass functions taken directly from the simulations and the
associated best ts are shown in Figure A1 as solid and
dashed lines respectively The inset shows the errors asso-
ciated with the ts which are marginally larger than what
was found for the CMF However the error remains well
below 10 for the full resolved redshift mass and number
density The appropriate limits on this tting function cover
the mass range 107Mcid12  M  1012Mcid12 mass function val-
ues   3 105Mpc3dex1 and redshift range 0  z  6
The best t coecients can be found in Table A1 and a basic
python script to evaluate the mass functions can be found
online4
4 httpsgithubcomptorreytorreycmf
Figure A1 Galaxy stellar mass functions derived from the
galaxy populations formed in Illustris are shown at several red-
shifts as indicated in the legend The dashed lines shown within
indicate the galaxy stellar mass function tting functions The
tting functions approximate the actual galaxy stellar mass func-
tion at all redshifts reasonably well with the error associated
with these ts in the panel inset
Table A1 The best t parameters to the redshift-dependent
dierential mass function presented in Equation A1 are given
-3082270
-0675004
-0043321
11512307
0091113
0091193
0025282
-0190260
-0125720
-0049466
-0007046
0021313
ccid13 0000 RAS MNRAS 000 000000
107108109101010111012M M10-510-410-310-210-1 Mpc3 dex1z00z10z20z30z40z50z60108109101010111012M M0201000102Log N