Fluctuating tness shapes the clone size distribution of immune repertoires
Jonathan Desponds1 Thierry Mora2 and Aleksandra M Walczak1
1Laboratoire de physique theorique CNRS UPMC and Ecole normale superieure 24 rue Lhomond 75005 Paris France
2Laboratoire de physique statistique CNRS UPMC and Ecole normale superieure 24 rue Lhomond 75005 Paris France
The adaptive immune system relies on the diversity of receptors expressed on the surface of B and
T-cells to protect the organism from a vast amount of pathogenic threats The proliferation and
degradation dynamics of dierent cell types B cells T cells naive memory is governed by a variety
of antigenic and environmental signals yet the observed clone sizes follow a universal power law
distribution Guided by this reproducibility we propose eective models of somatic evolution where
cell fate depends on an eective tness This tness is determined by growth factors acting either
on clones of cells with the same receptor responding to specic antigens or directly on single cells
with no regards for clones We identify uctuations in the tness acting specically on clones as the
essential ingredient leading to the observed distributions Combining our models with experiments
we characterize the scale of uctuations in antigenic environments and we provide tools to identify
the relevant growth signals in dierent tissues and organisms Our results generalize to any evolving
population in a uctuating environment
INTRODUCTION
Antigen-specic receptors expressed on the membrane
of B and T cells BCRs and TCRs  recognize pathogens
and initiate the adaptive immune response 1 An ef-
cient response relies on the large diversity of receptors
that protect us against the many pathogens in the envi-
ronment The adaptive repertoire diversity is maintained
from a source of newly generated cells each expressing
a unique receptor These progenitor cells later divide
or die and their ospring make up clones of cells that
share a common receptor The sizes of clones vary as
they depend on the particular history of cell divisions
and deaths in the clone The clone size distribution thus
bears signatures of the challenges faced by the adaptive
system Understanding the form of the clone size distri-
bution in healthy individuals is an important step in the
characterization of the antigenic recognition process and
the functioning of the adaptive immune system It also
presents an important starting point for describing sta-
tistical deviations seen in individuals with compromised
immune responses
High throughput sequencing experiments in dierent
cell types and species have allowed for the quantication
of clone sizes and their distributions 29 Generically
clone size distributions exhibit heavy tails 2 911the
number of clones of a given size is well described by a
power law over a wide range of clone sizes see Fig 1A-
B Such universal behavior for a variety of cells types
in dierent species B cells T cells naive cells eec-
tor cells in sh mice and humans suggests common
underlying rules for growth death and homeostatic con-
trol of adaptive repertoires Previous work has described
the specics of immune dynamics for a certain cell type
12 13 or a certain signaling pathway using detailed
mechanistic models 1416
It remains unclear how-
ever what essential features of these dynamics may lead
to the observed power-law distributions and what are
the key biological parameters of the repertoire dynamics
that govern its behavior
The wide range and types of interactions that inuence
a B or T cell fate happen in a complex dynamical envi-
ronment with inhomogeneous spatial distributions They
are dicult to measure in vivo making their quantitative
characterization elusive To overcome this we describe
the eective interaction between the immune cells and
their environment as a stochastic process governed by
only a few relevant parameters This eective descrip-
tion is consistent with the idea common in physics that
the apparent universality of the observed distribution is
underlied by broad model universality classes Since the
heavy tail behavior exists in both B and T cells we con-
sider general properties that are common to both cell
types and ignore hypermutations for simplicity
All cells proliferate and die depending on the strength
of antigenic and cytokine signals they receive from the
environment which together determine their net growth
rate This eective tness that uctuates in time is cen-
tral to our description We nd that its general prop-
erties determine the form of the clone size distribution
Two broad classes of models are distinguished according
to whether these tness uctuations are clone specic
mediated by their specic BCR or TCR or cell specic
mediated by phenotypic uctuations such as the num-
ber of cytokine receptors We identify the models that
are compatible with the experimentally observed distri-
butions of clone sizes These distributions do not depend
on the detailed mechanisms of cell signaling and growth
but rather emerge as a result of self-organisation with
no need for ne-tuned interactions
II RESULTS
A Clone dynamics in a uctuating antigenic
landscape
The fate of the cells of the adaptive immune system
depends on a variety of clone-specic stimulations The
recognition of pathogens triggers large events of fast clone
proliferation followed by a relative decay with some cells
being stored as memory cells to fend o future infections
Naive cells which have not yet recognized an antigen
do not usually undergo such extreme events of prolifera-
tion and death but their survival relies on short binding
events called tickling to antigens that are natural to
the organism self-proteins 17 18 Because receptors
are conserved throughout the whole clone ignoring B
cell hypermutations clones that are better at recogniz-
ing self-antigens and pathogens will on average grow to
larger populations than bad binders By analogy to Dar-
winian evolution they are tter in their local time-
varying environment 12 19 20
We denote by ajt the overall concentration of an anti-
gen j as a function of time We assume that after its
introduction at a random time tj this concentration de-
cays exponentially with a characteristic lifetime of anti-
gens 1 ajt  aj0ettj  as pathogens are cleared
out of the organism either passively or through the ac-
tion of the immune response Lymphocyte receptors are
specic to certain antigens but this specicity is degener-
ate a phenomenon refered to as cross-reactivity or poly-
specicity The extend to which a lymphocyte express-
ing receptor i interacts with antigen j is encoded in the
cross-reactivity function Kij which is zero if i and j do
not interact or a positive number drawn from a distribu-
tion to be specied if they do In general interactions
between lymphocytes and antigens eectively promote
growth and suppress cell death but for simplicity we can
assume that the eect is restricted to the division rate
In a linear approximation this inuence is proportional
j Kijajt ie the combined eect of all antigens j
for which clone i is specic This leads to the following
dynamics for the evolution of the size Ci of clone i
tocid80
 Ci  Bit
cid88
 
B2   cid80
Kijajt  
where  and  are the basal division and death rates
and where Bit is a birth-death noise of intensity
j Kijajt  Ci with it a unit Gaus-
sian white noise see Appendix A for details about birth
death noise
New clones with a small typical initial size C0 are
constantly produced and released into the periphery with
rate sC For example a number of the order of sC  108
new T-cells are output by the thymus daily in humans
21 Since the total number of T cells is of the order
of 1011 this means that cells die with an average rate
of 103 days1 in homeostatic conditions 21 Because
the probability of rearranging the exact same receptor
independently is very low  1010 22 we assume that
each new clone is unique and comes with its own set of
cross-reactivity coecients Kij Assuming a rate sA of
new antigens the average net growth rate in Eq 1 is
f0    cid104aj0cid105cid104Kcid105sA1    0 and the stationary
number of clones should uctuate around NC  sCf01
clones This is just an average however and treating each
clone independently may lead to large variations in the
total number of cells ie the sum of sizes of all clones
To maintain a constant population size clones compete
with each other for specic resources pathogens or self-
antigens and homeostatic control can be maintained by
a global resource such as Interleukin 7 or Interleukin 2
Here we do not model this homeostatic control explicitly
but instead assume that the division and death rates  
are tuned to achieve a given repertoire size We veried
that adding an explicit homeostatic control did not aect
our results see Fig S2 and Appendix B
stimulation undergone by a given clone cid80
We simulated the dynamics of a population of clones
interacting with a large population of antigens Each
antigen interacts with each present clone with probabil-
ity p  107 and with strength Kij drawn from a Gaus-
sian distribution of mean 1 and variance 1 truncated to
positive values A typical trajectory of the antigenic
shown in Fig 1E green curve and shows how clone
growth tracks the variations of the antigenic environ-
ment When the stimulation is particularly strong the
model recapitulates the typical behaviour experimentally
observed at the population level following a pathogenic
invasion 23 24 as illustrated in Fig 1D the population
of a clone explodes red curve driving the growth of the
total population blue curve while taking over a large
fraction of the carrying capacity of the system and then
decays back as the infection is cleared
j Kijaj
On average the eects of division and death almost
balance each other with a slight bias towards death be-
cause of the turnover imposed by thymic or bone mar-
row output However at a given time a clone that has
high anity for several present antigens will undergo a
transient but rapid growth while most other clones will
decay slowly towards exctinction
In other words lo-
cally in time the antigenic environment creates a unique
tness for each clone Since growth is exponential in
time these dierential tnesses can lead to very large
dierences in clone sizes even if variability in antigen
concentrations or anities are nominally small We thus
expect to observe large tails in the distrubution of clone
size Fig 2A shows the cumulative probability distri-
bution function CDF of clone sizes obtained at steady
state blue curve showing a clear power-law behaviour
for large clones spanning several decades
The exponent of the power-law is independent of the
introduction size of clones see inset of Fig 2A and the
specics of the randomness in the environment exponen-
tial decay random number of partners random interac-
tion strength as long as its rst and second moment are
kept xed See Fig S3 and Appendix C
B Simplied models and the origin of the power
To understand the power-law behavior observed in the
simulations and its robustness to various parameters and
mean denoted by fit This leads to rewriting Eq 1 as
 f0  fitCit  Bit
with B2  f0  2Ci
The function fit encodes the uctuations of the en-
vironment as experienced by clone i Because antigens
can be recognized by several receptors these uctuations
may be correlated between clones Assuming that these
correlations are weak cid104fitfjtcid48cid105  0 amounts to treat-
ing each clone independently of each other and thus
to reducing the problem to the single clone level The
stochastic process giving rise to fit is a sum of Poisson-
distributed exponentially decaying spikes This process is
not easily amenable to analytical treatment but we can
replace it with a simpler stochastic process with the same
temporal autocorrelation function This autocorrelation
is given by cid104fitfitcid48cid105  A2ettcid48 with the antigenic
0cid104K 2cid1051 and where we recall
noise strength A2  sApa2
that 1 is the characteristic lifetime of antigens The
simplest process with the same autocorrelation function
is given by an overdamped spring in a thermal bath or
Ornstein-Uhlenbeck process
 fi 
2it
with it a Gaussian white noise of intensity 1 and
 quanties the strength of variability of the
antigenic environment see Appendix D This is also the
process of maximum entropy or caliber 25 with that
autocorrelation function see Appendix E and 26
The eect of the birth death noise Bit is negligible
when compared to the tness variations for large clones
and it has no eect on the tail see Fig S5 and Appendix
F It can thus be ignored when looking at the tail of the
distribution and its power law exponent but it will play
an important role for dening the range over which the
power law is satised
The population dynamics described by Eqs 2 and 3
can be reformulated in terms of a Fokker-Planck equation
for the joint abundance  of clones of a given log-size
x  log C and a given tness f 
x f t
 f0  f 
f 
 2 2
f 2  sx f 
where the source term sx f  describes new clones ar-
riving at rate sC with size C0 and normally distributed
tnesses of variance cid104f 2cid105  2 This Fokker-Planck
equation can be solved numerically with nite element
methods with an absorbing boundary condition at x  0
to account for clone extinction The solution represented
by the black curve in Fig 2A matches closely that of
the full simulated population dynamics in blue The
power-law behaviour is apparent above a transition point
that depends on the distribution of introduction sizes of
new clones and the parameters of the model see below
Intuitively the microscopic details of the noise are not
FIG 1 Experimental clone size distributions have heavy tails
A B cell zebrash experimental cumulative clone size distri-
bution for fourteen sh as a function of the fraction of the
population occupied by that clone from data in Weinstein et
2 B Clone size distribution for murine T-cells from
Zarnitsyna et al
11 data plotted as presented in original
paper C The dynamics of adaptive immune cells include
specic interactions with antigens that promote division and
prevent cell death New cells are introduced from the thymus
or bone marrow with novel unique receptors Division death
and thymic or bone marrow output on average balance each
other to create a steady state population D-E Example
trajectories from simulations of the immune cell population
dynamics in Eq 1 The total number of cells D shows large
variations after an exceptional event of a large pathogenic in-
vasion One or a few cells that react to that specic antigen
grow up to a macroscopic portion of the total population
and then decrease back to normal sizes after the invasion A
typical clone size trajectory along with its pathogenic stimu-
j Kijajt shows the coupling between clone growth
and variations of the antigenic environment E Parameters
used sC  2000 day1  C0  2 sA  196  107 day1
aj0  a0  1   2 day1 p  107   098 day1
  118 day1
lationcid80
sources of stochasticity we decompose the overall tness
of a clone at a given time its instantaneous growth rate
into a constant clone-independent part equal to its aver-
age f0  0 and a clone-specic uctuating part of zero
105104103102101103102101100Fraction of populationCumulative distribution100101102103100101102103104105Clone SizeNumber of countsABC05100051152x 109Time in daysNumber of cells  Size of largest cloneTotal number of cells0102102104106108Clone size  1203002468StimulusTime in daysDEDeathDivisionNew clones4
expected to matter when considering long time scales
as a consequence of the central limit theorem How-
ever the long tails of the distribution of clone sizes in-
volve rare events and belong to the regime of large devia-
tions for which these microscopic details may be impor-
tant Therefore the agreement between the process de-
scribed by the overdamped spring and the exponentially
decaying Poisson distributed antigens is not guaranteed
and in fact does not hold in all parameter regimes see
Fig S8
We can further simplify the properties of the noise
by assuming that its autocorrelation time is small com-
pared to other timescales This leads to taking the limit
    while keeping their ratio constant    con-
stant so that fit is just a Gaussian white noise with
cid104fitfitcid48cid105  22t tcid48 see Appendix F and Fig S4
The corresponding Fokker-Planck equation now reads
tx t  f0xx t  22
with sx  sCx  logC0 This equation can be
solved analytically at steady state and the resulting
clone size distribution is for C  C0
xx t  sx
C 
C 1 
with   f02  f0A2 details in Appendix F
The full solution represented in Fig 2A in red captures
well the long-tail behaviour of the clone size distribution
despite ignoring the temporal correlations of the noise
and approaches the solution of the colored-noise model
Eq 3 as     as expected see Fig 2A
The power law behaviour and its exponent depend on
the noise intensity but are otherwise insensitive to the
precise details of the microscopic noise including its tem-
poral properties Fat tails small  are expected when
the average cell lifetime is long small f0 and when the
antigenic noise is high large  or A The explicit ex-
pression for the exponent of the power law 1   as a
function of the biological parameters can be used to in-
fer the antigenic noise strength A2 directly from data
An inverse lifetime of f0  103 days1 of a typical
T-cell can be estimated as the ratio of thymic output to
the total population of lymphocytes in the body 2729
The characteristic lifetime of antigens 1 is harder to
estimate as it corresponds to the turnover time of the
antigens that the body is exposed to but is probably of
the order of days or a few weeks   01 day1 We
estimated   1  02 from the zebrash data of Fig 1A
2 10 using canonical methods of power-law exponent
extraction 30 see Appendix G for details and also
found a similar value in human T cells 31 The result-
ing estimate A  102 day1 is rather striking as it
implies that uctuations in the net clone growth rate A
are much larger than its average f0
While the distribution always exhibits a power law
for large clones this behavior does not extend to clones
of arbitrarily small sizes where the details of the noise
FIG 2 Clone size distributions for populations with uctu-
ating antigenic clone-specic tness A Comparison of sim-
ulations and simplied models of clone dynamics Blue curve
cumulative distribution of clone sizes obtained from the simu-
lation of Eq 1 Black curve a simplied numerically solvable
model of random clone-specic growth also predicts a power-
law behaviour Red curve analytical solution fo the Gaussian
white noise model Eq 4 Parameters used   098 day1
  118 day1   2 day1 sC  2000 day1  C0  2
sA  196  107 day1 Inset the exponent is independent of
the initial clone size Results from simulation with dierent
values of the introduction clone size The cut-o value of the
power law behaviour represented here as a dot is strongly
dependent on the value of C0 Parameters are   02 day1
  04 day1   2 day1   1 day32 and sC  5000
B Value of the cumulative distribution function at the point
of the power law cut-o as a function of the introduction clone
size C0 for dierent values of a dimensionless parameter re-
lated to the eective strength of antigen uctuations relative
to their characteristic lifetime 32 for a xed power law
exponent  We use the cumulative distribution function be-
cause it is robust invariant under multiplicative rescaling of
the clone sizes This way we do not need to correct directly
for PCR multiplication or sampling Parameters are for B
and C   4491 days1   5489 days1 and   0998
C Power-law cut-o as a function of the introduction clone
and how new clones are introduced matter We dene a
power-law cut-o C as the smallest clone size for which
the cumulative distribution function CDF diers from
its best power-law t by less than 10 Using numeri-
cal solutions to the Fokker-Planck equation associated to
the colored-noise model we can draw a map of C as a
100102104106108104103102101100Clone size CCumulative distribution  simulationtime correlated noisewhite noise analytical100102104102100Clone size CCumulative Distribution  C0  2C0  10C0  20101101102Introduction size C0Power law cutoff C      03    05     11020304050104102100Introduction size C0Cumulative at cutoff       03     05     1ABC333333222222function of the parameters of the system In Fig 2B-C
we show how C varies as a function of the introduction
size for dierent values of the dimensionless parameter
related to the eective strength of antigen uctuations
relative to their characteristic lifetime at xed power law
exponents In principle one can use this dependency to
infer eective parameters from data In practice when
dealing with data it is more convenient to consider the
value of the cumulative distribution at C rather than
C itself For example xing C0  4 and tting the
curve of Fig 1A with our simplied model using  as an
adjustable parameter we obtain   014 day1 see Ap-
pendix G which corresponds to a characteristic lifetime
of antigens of around a week Although this estimate
must be taken with care because of possible PCR am-
plication biases plaguing the small clone size end of the
distribution the procedure described here can be applied
generally to any future repertoire sequencing dataset for
which reliable sequence counts are available
C A model of uctuating phenotypic tness
So far we have assumed that tness uctuations are
identical for all members of a same clone However the
division and death of lymphocytes do not only depend on
signaling through their TCR or BCR For example cy-
tokines are also growth inducers and homeostatic agents
32 33 and the ability to bind to cytokines depends on
single-cell properties such as the number of cytokine re-
ceptors on the membrane of a given cell independent of
their BCR or TCR receptor Other stochastic single-cell
factors may aect cell division and death These sig-
nals and factors are cell specic as opposed to the clone
specic properties related to BCR or TCR binding To-
gether they dene a global phenotypic state of the cell
that determines its time-varying tness independent
of the clone and its T-cell or B-cell receptor This does
not mean that these phenotypic tness uctuations are
independent across the cells belonging to the same clone
Cells within a clone share a common ancestry and may
have inherited some phenotypic properties of their com-
mon ancestors making their tnesses eectively corre-
lated with each other However this phenotypic mem-
ory gets lost over time unlike tness eects mediated by
antigen-specic receptors
We account for these phenotypic tness uctuations
by a function fct quantifying how much the tness of
an individual cell c diers from the average tness f0
This tness dierence is assumed to be partially herita-
ble which we model by
 fct 
2cct
where 1 is the heritability or the typical time over
which the tness-determining trait is inherited c quan-
ties the variability of the tness trait and ct is a
cell-specic Gaussian white noise of power 1 Despite its
 fit 
2cit
1cid112Cit
formal equivalence with Eq 3 it is important to note
that here the tness dynamics occurs at the level of the
single cell and its ospring instead of the entire clone
The dynamics of the tness fit of a given clone i can
be approximated from Eq 7 by averaging the tnesses
fct of cells in that clone yielding
 f0  fitCit cid112  Citit
where it and it are clone-specic white noise of in-
tensity 1 and  and  are the average birth and death
rates respectively so that f0   details in Appendix
I The dierence with Eq 3 is the 1cid112Cit prefactor in
the tness noise it which stems from the averaging of
that noise over all cells in the clone by virtue of the law
of large numbers Because of this prefactor the tness
noise is now of the same order of magnitude as the birth-
death noise which must now be fully taken into account
Taking Eq 8 and Eq 9 at the population level gives
a Fokker-Planck equation with a source term account-
ing for the import of new clones We verify the numeri-
cal steady state FokkerPlanck solution against Gillespie
simulations Fig S6 see Appendix H for details
Fig 3A-B show the distribution of clone sizes for dif-
ferent values of the phenotypic relaxation rate  and en-
vironment amplitude c These distributions vary from
a sharp exponential drop in the case of low heritabil-
ity large  to heavier tails in the case of long con-
served cell states small  To quantify the extend
to which these distributions can be described as heavy-
tailed we t them to a power law with exponential cut-
o C  C1eCCm  where Cm is the value below
which the distribution could be interpreted as an imper-
fect power law Fig 3C shows a strong dependency of
this cut-o with the phenotypic memory 1 The longer
the phenotypic memory 1 the more clone-specic the
tness looks like and the more the distribution can be
mistaken for a power law in a nite-size experimental
distribution Larger birth-death noise also extends the
range of validity of the power-law As a result and de-
spite the absence of a true power-law behaviour these
models of uctuating phenotypic tnesses cannot be dis-
carded based on current experimental data
The model can be solved exactly at the two extremes
of the heritability parameter  In the limit of innite
heritability   0 the system is governed by selec-
tive sweeps The clone with the largest tness com-
pletely dominates the population until it is replaced
by a better one giving rise to a trivial clone-size dis-
tribution In the opposite limit when heritability goes
to 0    the Fokker-Planck equation can be
solved analytically see Appendices I and J yielding
an exact power-law with exponential cuto C 
1 and
C1eCCm with   1    222
Cm    1  d2  2
c 2 The numerical so-
lution of Fig 3B is close to this limit Note that even
of the most striking properties of repertoire statistics re-
vealed by high-throughput sequencingthe observation
of power laws in clone size distributionhold true for var-
ious species human mice zebrash cell type B and
T cells and subsets naive and memory CD4 and CD8
and seems to be insensitive to these context-dependent
details These observations call for a stochastic descrip-
tion of the various properties aecting cell fate and their
ubiquity points to some universal features of the dynam-
The model
introduced in this paper describes the
stochastic nature of the immune dynamics with a min-
imal number of parameters easing the numerical and
analytical treatment and helping interpret the dierent
regimes These parameters are eective in the sense that
they integrate dierent levels of signaling pathways and
mechanisms We assumed that they are general enough
that dierent cell types B and T cells or subsets can
be described by the same dynamical equations Most of
these parameters have natural interpretations the typi-
cal lifespan of an infection or antigen stimulation is given
by 1 and the eect of these stimulations by A For
memory cells 1 corresponds to the duration of an in-
fection For naive cells the interpretation is less clear
as non-pathogenic antigens such as self-antigens may not
be as transient as pathogens in this case 1 could cor-
respond to the characteristic timescale of changes in a
clones micro-environment Likewise in the context of
cell-specic noise the parameters 1 and c correspond
to the correlation time and variability of the cell pheno-
type All these parameters may vary greatly across cell
types and species
We showed that the relevant sources of stochasticity
for the shape of the clonesize distributions fall into two
main categories depending on how cell fate is aected by
the environment Either the stochastic elements of clone
growth act in a clone-specic way through their receptor
BCR or TCR leading to power-law distributions with
exponent  1 or in a cell-specic way eg through their
variable level of sensitivity to cytokines and more gener-
ally through any phenotypic trait aecting cell tness
leading to exponentially decaying distributions with a
power-law prefactor These two types of signals clone
specic and cell specic are important for the somatic
evolution of the immune system 20 32 33 3537 and
our analysis shows that the shape of the clone size dis-
tribution is informative of their relative importance to
the repertoire dynamics
It provides a rst theoretical
setting and an initial systematic classication for model-
ing immune repertoire dynamics Our method applied to
high-throughput sequencing data can be used to quantify
how much each type of signal contributes to the over-
all dynamics and what is the driving force for the dif-
ferent cell subsets For example although it is reason-
able to speculate that clone-specic signals should domi-
nate for memory cells through antigen recognition and
cell-specic selection for naive cells through cytokine-
mediated homeostatic division the relative importance
FIG 3 Clone size distributions for populations with a cell
specic uctuating phenotypic tness A Cumulative dis-
tribution of clone sizes for moderate phenotypic heritability
1 The distribution is power-law like for small clone val-
ues and drops above a cut-o around 001 of clone size prob-
ability An experiment that does not sequence the repertoire
deeply enough could report a power law behavior see zoom
Parameters are   017 days1   03 day1   04
days1 and c  05 days32 C0  2 for all three graphs
B An example of a distribution of clone sizes from a cell-
specic model with very low environmental noise close to the
pure birth-death limit The distribution is at   0 and
then drops exponentially
It does not resemble experimen-
tal data Parameters are   01 days1   03 days1
  2 days1 and c  5 days32 C Value of the cu-
mulative distribution at the exponential cut-o as a function
of the speed of environment variations  for dierent birth-
death noise levels Parameters are f0  0998 days1 and
f022
c  0998
with a negligible exponential cuto the predicted   0
contradicts experimental observations
III DISCUSSION
Clone size distributions from high throughput data
have been available for a few years and hold great promise
for understanding the processes that shape the composi-
tion of the repertoire Yet their interpretation requires
models The fate of lymphocytes making up immune
repertoires is governed by a wide variety of mechanisms
and pathways that vary across cell types and species
Previous population dynamics approaches to repertoire
evolution have taken great care in precisely modeling
these processes for each compartment of the population
through the various mechanisms by which cells grow
die and change phenotype 12 13 34 However one
100101102103104103102101100Clone size CCumulative distribution100101102103102101100Clone size C100101102103104105100Clone size CCumulative distribution0123100101102103104Variation speed cCut off clone size    11 f0  19 f0    41 f0AB0510100102104106Correlation time in daysCut off Cm  11 f019 f041 f0Cof these signals for both cell types is yet to be precisely
quantied and may vary across species A clear power
law over several decades would strongly hint at dynamics
dominated by interactions with antigens while a faster
decaying distribution would favor a scenario where indi-
vidual cell tness uctuations dominate Applying these
methods to data from memory cells can give orders of
magnitude for the division and half-life of memory lym-
phocytes as well as the typical number of cells C0 from
a clone that are stored as memory following an infection
The application of our method to data from the rst
immune repertoire survey B cell receptors in zebrash
2 suggests that clone-specic noise dominates in that
case allowing us to infer a relation between the dynami-
cal parameters of the model from the observed power-
law exponent  2 However there are a few issues
with applying our method directly to data in the cur-
rent state of the experiments First the counts ie how
many cells have the same receptor sequence and belong
to the same clone from many high-throughput reper-
toire sequencing experiments are imperfect because of
PCR bias and sampling problems New methods using
single-molecule barcoding have been developed for RNA
sequencing 8 38 39 but they do not solve the problem
entirely as the number of expressed mRNA molecules
may not faithfully represent the cell numbers because
of possible expression bias
In addition most studies
with the exception of 40 have been sequencing only
one of the two chains of lymphocyte receptors which is
insucient to determine clone identity unambiguously
As methods improve however our model can be applied
to future data to distinguish dierent sources of tness
stochasticitiy and to put reliable constraints on biological
parameters
Thanks to its generality our model is also relevant
beyond its immunological context and follows previous
attempts to explain power laws in other elds 4143
The dynamics described here corresponds to a general-
ization of the neutral model of population genetics 44
where thymic or bone marrow outputs are now rein-
tepreted as new mutations or speciations and where we
have added a genotypic or phenotypic tness noise re-
ceptor or cell-specic noise respectively It was recently
shown that such genotypic tness noise strongly aects
the xation probability and time in a population of two
alleles 45 46 Our main result Eq 6 shows how t-
ness noise can cause the clone-size distribution called
frequency spectrum in the context of population genet-
ics to follow a power law with an arbitrary exponent  1
in a population of xed size while the classical neutral
model gives a power law of exponent 1 with an exponen-
tial cut o as shown in our exact solution with c  0
Our results can be used to explain complex allele fre-
quency spectra using uctuating tness landscapes
Acknowledgements This work was supported in
part by grant ERCStG n 306312
FIG S1 We compare results from a full Gillespie simulation
blue crosses of a system with only birth-death dynamics
with analytical prediction for a discrete system black crosses
Eq A3 and a continuous system red curve Eq A12 The
prediction with discrete variables is more accurate for small
clones but the behaviour of all systems is the same for large
populations The parameters are   145 day1   15
day1 C0  2 and we introduce 2000 new clones per day
Appendix A Simple birth-death process with no
tness uctuations and its continuous limit
In this Appendix we derive the steady-state clone size
distribution for a system that does not experience any
environmental stimulation or noise but is governed by a
birth death process We will show that the small number
uctuations arising from the discrete nature of birth and
death are not sucient to explain the observed distribu-
tions We also show that our choice of a continuous birth
death process is equivalent to its discrete version
The multiplicative birthdeath process corresponds to
the following discrete dynamics
cid40
P n  n  1  ndt
P n  n  1  ndt
where  is the division rate  the death rate We assume
that the population of cells of size n is maintained out
of equilibrium by a source of new cells The steady state
solution for cell numbers above the value of the source
satises detailed balance
P nn  P n  1n  1
and assuming the death rate is larger than the birth rate
takes the form
P n  K
en log 
100101102104103102101100Clone sizeCumulative distribution  Simulated solutionAnalytical continuous solutionAnalytical dicrete solutionand the corresponding Fokker-Planck equation reads
The continuous counterpart of this discrete stochastic
process corresponds to the following linear-noise approx-
imation
tCi  f0Ci cid112  Ci
where cid104ititcid48cid105  t  tcid48 and f0      0 and
we use the Ito convention  In terms of x  log C the
Langevin equation is
  ex2  ex   
tx  f0 
cid18
cid19
cid19
cid18   
t  xf02
ex
ex
  
where sx is the distribution of sizes of newly arriving
clones At steady state we nd
K  sCx  x0  f0 
  
excid48
where K is an integration constant Dening
Cm    2f0
cid90 x
for x  x0 we obtain
x  eexCm K
and for x  x0
cid104
exeexCm  KCm1eex1Cm 
cid105
eex0 Cm
To ensure convergence we set K  sCf0Cm and the
steady solution of the Fokker-Planck equation is
KeexCm  Ke1Cm
eexCm 
x  eexCm Cm
 sCf0Cm
sCf0Cm
cid40 sCf0 1  eex1Cm  if x  x0
sCf0 eex0 Cm  eC1
cid40 1
C 1  eC1Cm  if C  C0
eC0Cm  eC1
m  eCCm
 if C  C0
m eexCm  if x  x0
x 
C 
or in terms of the clone size
This result is exactly equivalent to that of Eq A3 when
  f0 cid28   The accuracy of the approximation is
veried in Fig S1 Even for very large exponential cuto
values Cm the apparent exponent is   0 correspond-
ing to a at cumulative distribution This distribution is
inconsistent with experiments regardless of sequencing
depth and we conclude that pure birth-death noise is not
sucient to explain the observed distributions
Appendix B Eects of explicit global homeostasis
In the simulations of clone dynamics in a uctuating
environment presented in the Clone dynamics in a uc-
tuating antigenic landscape Results section of the main
text we did not explicitly include a homeostatic control
term but tuned the division and death rates to achieve
a given repertoire size Here we add an explicit homeo-
static term to the growth and degradation terms in the
Langevin simulations described by Eq 1 of the main text
cid20cid80
cid21r
where N is a carrying capacity h is the homeostatic con-
stant multiplicator and r is the exponent of homeostatic
response that described the sharpness of the response
when approaching then carrying capacity limit Com-
paring in Fig S2 the resulting clone size distribution
obtained with the explicit homeostatic term to the dis-
tribution from the simulations in the main text we see
that the explicit homeostatic term does not have an eect
on the form of the distribution It does have an eect on
the trajectory of certain clones and in particular on the
response of the system to a very large invasion making
it an important feature of the dynamics of the immune
system However as shown by the results in Fig S2 its
net eect on the clone size distribution can be taken into
account by tuning division and death When consider-
ing specic trajectories in the mean eld approximation
homeostatic control will add a systematic negative drift
to the clonal population and can be accounted for by an
additional contribution to f0
Appendix C Details of noise partition do not
inuence the clone size distribution function
In the simulation of the dynamics of receptors expe-
riencing a clone-specic tness presented in the Clone
dynamics in a uctuating antigenic landscape Results
section of the main text we distributed the noise be-
tween the dierent random distributions
the poisson
distributed number of new antigens sA the variance of
the initial concentrations aj0 and the variance of the
binding probability the values of Kij We made specic
choices for this reparation by picking specic parameters
of the random processes Here we show that these specic
choices of repartitioning the contributions to the noise do
not inuence the clone size distributions Fig S3 com-
pares clone size distributions obtained with dierent val-
ues of the poisson distributed number of newly arriving
antigen Na and the variance of the Gaussian distributed
binding probabilities Kij reproducing the same distribu-
tions in both cases
FIG S3 Repartitioning the sources of stochasticity between
the number of new antigens per time unit or the variability of
binding probabilities does not inuence the clone size distri-
butions We compare simulations of the full system dynamics
dened by Eq 1 of the main text with two sets of values
sA of the poisson distributed number of newly arriving anti-
gen Na and the variance of the Gaussian distributed binding
probabilities Kij that give the same total environmental noise
0cid104K 2cid1051 The parameters were taken to be as
A2  sApa2
in Fig 1 sC  2000 day1  C0  2 day1 aj0  a0  1
  2 day1 p  107   098 day1   118 day1
For the red curve the variance of the entries of Kij is 1 so
that cid104K 2cid105  2 and sA  196  107 while for the black curve
the variance of the entries of Kij is 3 so that cid104K 2cid105  4 and
sA  098  107
cid18
cid104fi02cid105  2
cid19
genic environment The autocorrelation function of this
Ornstein-Uhlenbeck process is
cid104fitfitcid48cid105  ettcid48
ettcid48
We pick the steady-state value of the initial tness dis-
tribution to cancel the rst in Eq D3cid104fi02cid105  2
and obtain
cid104fitfitcid48cid105 
ettcid48
conditioned on the integral of the net growth rate f  f0
being positive so that the clone does not go extinct Set-
ting x  log C we obtain a new set of Langevin equations
txi  f0  fi 
 fi 
2i
  exi2i  exi
  
where the birth-death noise is now treated in the Ito
convention The corresponding Fokker-Planck equation
for the distribution of tness and clone size at time t
FIG S2 Adding an explicit homeostatic control term does
not aect the clone size distribution compared to tuning the
degradation and death rates to obtain a given repertoire size
as is done in the main text Comparison of the clone size
distribution with an explicit homeostatic control term given
by Eq B1 black line to the distribution presented in the
main text red line We simulate the Langevin equation for
a division rate   02 days1 death rate   04 days1
introduction size C0  2 environmental correlation time of
1  05 days and an amplitude of variations of the environ-
ment A  141 days1 without any homeostatic control for
the red curve and with carrying capacity N  4 1010 h  1
and a homeostatic exponent r  3 for the black curve
Appendix D Model of temporally correlated
clone-specic tness uctuations
In the Simplied models and the origin of the power
law Results section of the main text we make a series
of approximations to eectively describe the dynamics of
immune cells we rst approximate the antigenic environ-
ment by a random process with time correlated colored
noise and we later neglect these temporal correlations
In this section and Appendix F we give the details that
lead to the specic forms of the eective equations In
this Appendix we derive the Fokker-Planck equations for
the time correlated noise model In Appendix F we will
consider the limit of an innitely quickly changing envi-
ronment
The Langevin equations describing the dynamics of
cells experiencing clone specic tness uctuations with
a nite correlation time are
 f0  fitCit cid112  Citit
2it
where cid104ititcid48cid105  t tcid48 represents birth death noise
in the linear-noise approximation with the Ito conven-
tion and cid104ititcid48cid105  t  tcid48 is the noise of anti-
 fit 
100102104106106104102100Clone size CCumulative dsitribution  No homeostatic controlHomeostatic control10010510101015104103102101100Clone sizeCumulative distribution  VarKij1  s A196107VarKij 3 s A098107x f t veries
t  xf0  f f   2
cid19
ex
cid18
f 2 
ex
  
cid18   
sx f 
cid19
where sx f  is the source of new clones We solve this
equation numerically using nite element methods to ob-
tain clone size distributions for the clone-specic tness
Appendix E The Ornstein Uhlenbeck process and
maximum entropy
In this Appendix we show that the maximum en-
tropy or maximum caliber process with autocorrelation
function cid104xtxt  scid105  A2es corresponds to the
Ornstein-Uhlenbeck process We consider this continu-
ous maximum entropy process as the continuous limit
of a simpler maximum entropy system in discrete time
Burgs maximum entropy theorem 47 states that the
maximum entropy process in discrete time that con-
strains cid104Xnt2cid105  A2 and cid104XntXn1tcid105  A2e
corresponds to the following Markovian dynamics
1  e2 A
Xn1  e Xn 
where  is Gaussian white noise In the limit of   0
we recover the constrained autocorrelation function in
the vicinity of s  0 cid104xt2cid105  A2 ddscid104xtxt 
scid105s0  A2 and Eq E1 converges to an Ornstein-
Uhlenbeck process
cid112
Appendix F Model solution for white-noise
clone-specic tness uctuations
In the limit of innitely quickly uctuating environ-
ments    and    while keeping their ra-
tio    constant the autocorrelation of the tness
noise approaches a Dirac delta function and the uctu-
ating part of the growth rate fit converges to Gaussian
white noise cid104fitfitcid48cid105  22t  tcid48 Eectively the
immune cell dynamics are now described by a one dimen-
sional Langevin equation for the clone size
2Cii cid112  Citi
tCi  f0Ci 
where cid104ititcid48cid105  t  tcid48 follows the Stratanovich
convention and i is as before The equation for the log-
arithm of the clone size x  log C is
txi  f0
2i
  exi2iexi
  
We explicitly checked that the numerical solution to
the clone specic tness model in Eqs D1 and D2 con-
verged to the dynamics described by Eq F1 as demon-
strated in Fig S4
FIG S4 Comparison between clone size distribution obtained
as solutions of the time-correlated and time-uncorrelated
noise models without birth death noise As the values of
the dimensionless parameter related to the eective strength
of antigen uctuations relative to their characteristic lifetime
32 grow the time correlated noise prediction converges to
the exact power-law solution of the white-noise model The
cut-o value of the power law decreases with 32 All sim-
ulations performed at a constant value of   f022 set
to 05 The value of f0 is kept xed to 05 days1 for all
solutions
We now solve this equation analytically starting with
the case of no birth-death noise Eq F1 simplies to
tCi  f0Ci 
2Cii
The equation for x  log C using the Stratanovich con-
vention is
txi  f0 
2i
with the corresponding Fokker Planck equation
tx t  xf0 
x22x  sx
where sx is the source term describing the size of newly
introduced clones Assuming a constant initial clone size
sx  sCx  x0 the steady state solution is
cid2Kex  K  sC2ex  sC2ex0cid3 
x  ex 1
where we have dened
  f02
and K is an integration constant Imposing that  van-
ishes at innity sets K  sC2 and the nal form of the
steady state clone size distribution is
cid40 sCf0 1  ex if x  x0
sCf0 ex ex0  1 if x  x0
x 
1001021041061080020010001002003004005006007Clone size CPcolored  Pwhite  32  0132  0432  2532  1011
Assuming that the initial size is constant the steady state
solution is given by the solution of the inhomogeneous
linear equation
K  sCx  x0  f0  2cid48  ex   
cid48
The full solution is the sum   0  1 of the particular
solution
cid40 Kf0 for x  x0
KsCf0
for x  x0
0x 
and the solution 1 to the homogeneous equation
of solution
1x  Kcid48
f01  2cid48
cid48
1  ex   
cid35
cid34
ex  
1  
with   f02 Therefore for x  x0
cid34
cid35
x  Kcid48
ex  
1  
K  s
we set K  s for convergence and obtain the steady state
clone size distribution for large x
cid20
cid21
  
Ccid0C  
cid1 
C 
or in terms of the clone size
We see that the white noise solution with birthdeath
noise has the same large clone power law behaviour as
without birthdeath noise Fig S5 illustrates how birth
death noise in the clone-specic tness models with time
correlated noise also does not aect the power law expo-
nent but only the cut o of the power law
Appendix G Data analysis
In the main text we report values of the power law
exponents and power law cut o values obtained from
the high throughput sequencing repertoire study of clone
size distributions of zebrash B-cell heavy chain recep-
tors of Weinstein et al 2 We extracted the power law
exponent and the best t for the starting point of the
power law dened as its lower bound cuto from the
discrete clone size distributions plotted in Fig 1 of the
main text using the methods discussed by Clauset and
Newman 30 Specically for each point of the cumu-
lative clone size distribution we compute an estimate of
t  xf0 
x22x  2
cid18
ex
cid19
ex
cid18   
cid19
  
 sx
C 
x 
FIG S5 We compare simulations of the Langevin dynamics
with time correlated antigenic noise with birth-death noise
black line to the same dynamics without the birth-death
noise red line All other parameters are kept xedWe nd
similar values of the power law exponents but dierent small
clone behaviours The parameters are   02 day1   04
day1 for red curve simply f0  02 day1  C0  2   2
day1 and   1 day32
or in terms of clone size C  ex
cid40 sCf0C
cid01  1
cid1 if C  C0
cid0 1
Cx0  1cid1 if C  C0
In all simulations and solutions we nd that for large
clones the model of temporally correlated tness uctua-
tions behaves as the its white noise limit This behaviour
can be explained by the fact that large clones need a long
time to become large At these long timescales the char-
acteristic time of noise correlation is negligible and the
noise may be approximated as white For this reason
the exponent  of the power law computed assuming a
white noise for the tness uctuations is still valid even
when that noise is actually correlated in time
Next we re-introduce the birth-death noise and solve
the general equation The Langevin equation for x 
2 
tx  f0 
  ex2  ex   
results in the Fokker-Planck equation for the distribution
of clone sizes
100105104103102101100Clone size CCumulative Distribution  Without birth death noiseWith birth death noisecid34 ncid88
cid19cid35
cid18 Ci
the power law exponent with that point as cuto ie the
best t of the power law including only the values of the
distribution above that point using
Cmin  1  n
where Cmin is the cut o and n is the number of points
with y-axis values above Cmin For each of these cut-o
values we compute the Kolmogorov-Smirnov distance be-
tween the data and the estimated power law distribution
dCmin  maxCCminFdC  FeC Cmin
where the maximum is taken over all values above the
cut o Cmin Fd is the cumulative distribution function
CDF of the data and FeC Cmin is the CDF of the
estimated power law distribution with Cmin as a cuto
using Eq G1 The the cut o is taken to be the minimum
of this distance over all possible cut o values and the
exponent is the exponent found for this value
The obtained power law parameters are presented in
Table I The power law exponent gives reproducible val-
ues for dierent individuals and agrees with values of the
same exponent obtained from human data 31 We note
that the power law exponent of the cumulative distri-
bution function is  for a power law distribution with
exponent 1   As discussed in detail in the main text
the reliability of the cuto estimate C is sensitive to ex-
perimental precision of capturing the rare clones In the
presented dataset the reads were not barcoded and the
counts had to be renormalized by a known PCR ampli-
cation factor Therefore these normalized counts could
not to used as normal counts making the denition of
a cut-o clone size problematic To overcome this prob-
lem we estimate the power law cut-o from the value of
the cumulative distribution function at the cut-o clone
size instead of the cut-o clone size itself That value
is invariant under rescaling of absolute clone size values
unlike C
We notice that the steady state solution is invariant
under a full rescaling of time in the equations of the dy-
namics This means that the system can be described by
two dimensionless parameters   f022 and 32
and the introduction size C0 Fitting  to data and as-
suming value for C0 we can compare the value of the
power law cut-o in data and in simulations to t the
remaining dimensionless parameter 32 Estimating
f0 based on thymic output we can predict the order of
magnitude of  and 
Appendix H Cell specic simulations
In the A model of uctuating phenotypic tness
Results section of the main text we present results of
Fokker-Planck simulations for the cells dynamics Here
we verify that the stochastic dynamics of cells subject to
Fish 1  
log1  CDFC
A 20591 326445
B 20214 107231
C 20708 167386
D 20670 149313
E 20529 82685
F 20006 58972
G 19867 522909
H 22242 321719
20835 184385
16907 444885
K 17641 36030
L 19417 185298
M 19901 185531
N 18877 1084732
- 31389
-18644
-24655
-21492
-18332
-16161
-27329
-26877
-22757
-22877
-09907
-22730
-22031
-27984
TABLE I Fit of the power law exponent of the clone size
distribution 1 and power law cut-o value C for zebrash
B-cell heavy chain D segment data from Weinstein et al 2
presented in Fig 1 The t for 14 sh named A to N shows
a similar t of the power law exponent
a uctuating cell-specic tness are well approximated at
the population level by a Fokker-Planck equation with a
source term accounting for the import of new clones by
comparing its numerical steady-state solution obtained
by a nite elements method to explicit Gillespie simu-
lations We simulated the dynamics of clones using a
Gillespie algorithm where cell division and death are ac-
counted for explicitly and depend linearly on a tness
fct uctuating according to Eq 7 The death rate is
kept constant above the average birth rate and the uc-
tuations of the tness only aect the birth rate with the
constraint that the birth rate is always positive The
agreement between the results of this detailed simulation
and the Fokker-Planck solution shown in Fig S6 vali-
dates the linear-noise approximation for the birth-death
noise as well as the averaging argument leading to Eq 8
and 9 This allows us to rely on the Fokker-Planck solu-
tion to explore parameter space
Appendix I Model of cell-specic tness
uctuations and its limit of no heritability
The cell specic tness model described in the A
model of uctuating phenotypic tness Results section
of the main text arises as a description of a population
where each cell experiences its own growth uctuations
but cells deriving from the same lineage remain corre-
In this Appendix we derive the equations that
describe the dynamics of clones in this system
Each cell c experiences a time-correlated multiplicative
noise from environmental growth factors For cells j in a
given cell lineage or clone i each individual cells tness
FIG S6 Comparison of the Fokker-Planck solution red line
and explicit Gillespie simulations of the dynamics blue line
for the cell specic tness model discussed in the A model
of uctuating phenotypic tness Results section of the main
text show good agreement allowing us to use the population
level Fokker-Planck solution to explore parameter space Pa-
rameters were taken to be   05 day1   08 day1
C0  2   4 days1 and c  4 day32
FIG S7 Varying the dimensionless parameter related to the
eective strength of antigen uctuations relative to their char-
acteristic lifetime 32 does not aect the exponent of the
power law if the ratio between exponential decay  and stan-
dard deviation of the variation  is kept constant For all
three curves the exponent is   08 and   05 days1
  08 days1 C0  2 while  and  vary
where sx f  is the joint distribution of size and tness
or newly arriving clones from thymic or bone marrow
output This is the full Fokker-Planck equation that
is solved numerically in the main text using the nite
elements method
Because of the 1
Ci prefactor in front of the noise
term we could expect tness uctuations to behave like a
birth-death noise in the limit of low heritability   
In the remainder of this Appendix we show that this is
not the case and we show how to take the limit of no
heritability properly
Consider the limit of    and c   keeping the
ratio c constant so that f does not become innites-
imally small The equation for the environmental stimu-
lation f in x  log C space is given by in Stratanovich
convention
tf  f 
2cex2
follows the stochastic dynamics
tfct  fc 
where cid104ctctcid48cid105  t tcid48 Averaging over all cells in
the clone we obtain
2cc
tCi  f0Ci  fiCi cid112  Cii
tfi  fi 
ci
where fi is the average tness in clone i
cid114 2
cid88
fit 
cid112  Cii We use the Ito convention for the birth-
and where we have added a birth-death noise term
death noise cid104ititcid48cid105  t  tcid48 and the Stratanovich
one for the environmental noise cid104ititcid48cid105  t  tcid48
The equivalent equations for x  log C are
txi  f0  fi 
tfi  fi 
  exi2  exi
2exi2ci
and the Fokker-Planck equation is
  
tt x f    f0  f x  f f   exc2
xex
xex 
  
  
 sx f 
100101104103102101100Clone size CCumulative distribution  Simulation of cell by cell dynamicsNumerical solution to Fokker Planck100101102103104103102101100Clone size CCumulative distribution  cid1043cid9728cid1043cid97216cid1043cid97232where Kt is a constant to control the variations of the
integral of  with probability  where Kt   11
2  with  the CDF of a standard Gaussian distribution
The second sub-integral is
cid90 k
euextu2t  udu
1  ek
 ext2t
cid114
 and in the limit of    and
We choose k 
c   keeping c  const we obtain the nal form
of environmental uctuations
f t 
extt
where t means the left-hand limit f t depends only
on the past which means that in x  log C space the
noise is similar to a birth-death noise in the Ito conven-
tion Yet in terms of clone sizes C additional Ito terms
make the eect of environmental uctuations dierent
from classical birth-death dynamics
Appendix J Model solutions for cell-specic tness
uctuations in the limit of no heritability
In this Appendix we solve the model of cell-specic t-
ness uctuations in the limit where trait heritability is
low In this limit the dynamics is described by a model
with an instantaneous random tness that is uncorre-
lated for cells in the same clone The resulting Langevin
equation reads
cid112
2 cid112  Cii
 f0Ci 
where all noise is treated in the Ito convention and
c 2 comes the converting back
where the extra term 2
the low-heritability limit of the tness uctuations given
by Eq I12 into C  ex space We note that although the
tness and birth-death noise have very similar forms the
birth-death noise is self-generated and intrinsic while the
tness noise is environmental and extrinsic This small
dierence greatly aects the steady-state clone size dis-
tribution
To see this we rst consider the case of no birth-death
noise In the cell-specic tness model consider the fol-
lowing equations with the Stratanovich rule
cid40tCi  f0Ci  f Ci
cid113 2
cid40
tfi  fi 
ci
txi  f0  fi
tfi  fi  exi2ci
and its equivalent for x  logC
FIG S8 Large deviations can inuence the eect of Poisson
noise on the simulated clone size distributions and create a
discrepancy between Poisson noise red line and the Gaussian
approximations black line we assume in the main text The
discrepancy is most apparent for small clones We simulated
the Langevin dynamics of the Gaussian model with   05
day1   1 day1 C0  2   3 day1 and   1 day32
and the same dynamics with Poisson noise and   05 day1
  1 day1 C0  2   3 day1 and sA  107 day1 In
both cases we introduce sC  2000 new clones per day
and we divide the integral into two sub-integrals for k  0
Direct integration gives
cid90 t
f t 
cid90 t
cid90 k
f t 
euextu2t  udu
euextu2t  udu
euextu2t  udu
With innite precision for any value of t we set the
integral of  to be bounded and obtain the rst integral
is with probability 1   smaller in norm than
tKek
100101102103104103102101100Clone size CCumulative distribution  Poisson noise simulationGaussian noise simulationIn Appendix I we have shown that in the limit of   
and c   the system reduces to the one dimensional
equation
txi  f0  exi2
with the Ito rule for the white noise i The correspond-
ing Fokker-Planck equation is
t  xf0 
 sx
cid21
cid20 22
2 ex
Assuming a deterministic introduction size sx 
sCx  x0 at steady-sate we get
K  sCx  x0  f0  ex 2
2 cid48  2
2 ex
which for x  x0 is solved by
x  eexCmxcid104
KEiexCm  KEiC1
 sC2
cid105
where K is an integration constant Ei is the exponential
integral function and
f02 
c  and
x 
The divergence of Ei at innity sets K  sC22
the clone size distribution is
cid40cid0EiexCm  EiC1
cid0Eiex0Cm  EiC1
cid40
eCCmcid0EiCCm  EiC1
eCCmcid0Eiex0Cm  EiC1
m cid1 eexCmx for x  x0
m cid1 eexCmx for x  x0
m cid1 for C  C0
m cid1 for C  C0
or in terms of x  log C
C 
The validity of this solution is checked in Fig S9 and the
convergence of the full solution of Eq I6 with no birth-
death noise to the analytical solution in the limit of no
heritability    is show in Fig S10
For comparison
in a pure birth-death process no
tness uctuations the clone-size distribution is
C large enough C  eCCm C where Cm 
  2   as shown in Appendix A These two
solutions both have an exponential cuto but have very
dierent power-law exponents corresponding to   0
and   1 respectively
We now add the birth-death noise ie consider both
types of noise still in the limit of no heritability The
corresponding Langevin equation reads
txi  f0 
  exi2  exi
  
 exi2
FIG S9 The result of a simulation of the Langevin equation
of the white noise cell-specic tness model blue line com-
pared to the analytical prediction of Eq J11 red line show
very good agreement The parameters are   02 day1
  04 day1 C0  2   4 day1 and c  8 day32
FIG S10 Convergence of the cell-specic tness models
Eq I6 without birth-death noise to Eq J11 in the limit
of no heritability    For all four curves   02 Pa-
rameters used   02 day1   025 day1 C0  2 and
1000 new clones introduced each day
where all noise is in the Ito convention Integrating the
Fokker Planck associated to this equation gives at steady
state condition
cid20   
cid21
excid48 2
2 ex
KsCxx0  f0
In order for  to be well dened we set K  sC For x 
x0 the equation is homogeneous and solved by separation
100101102104103102101100Clone size CCumulative distribution  Simulated Langevin eqAnalytical solution100101102103103102101100Clone size CCumulative distribution  3c2008 3c20323c208Analytical solution in 1 D16
cid21
cid18
cid19
2 ex
cid20   
of variables
and gives the solution
C 
KeCCm
cid18
  
cid191
  2
which is a power-law with an exponent 0  1    1
and an exponential cuto
cid18   
cid19
Cm    1
The convergence of the solution of the full system Eq I6
to this solution is checked in Fig S11
FIG S11 Convergence of the cell-specic models Eq I6
with birth-death noise to the analytical result of Eq J15 red
line Keeping constant  while    and c   we
recover the solution of Eq J15 Parameters are the same as
in Fig S10
1 Janeway C 2005 Immunobiology Garland Science
2 Weinstein JA Jiang N White RA Fisher DS Quake
SR 2009 High-throughput sequencing of the zebrash
antibody repertoire Science 324807810
3 Ndifon W et al 2012 Chromatin conformation governs
T-cell receptor J gene segment usage Proc Natl Acad
Sci USA 1091586570
4 Thomas N et al 2014 Tracking global changes induced
in the CD4 T cell receptor repertoire by immunization
with a complex antigen using short stretches of CDR3
protein sequence bioRxiv
5 Larimore K McCormick MW Robins HS Greenberg PD
2012 Shaping of human germline IgH repertoires re-
vealed by deep sequencing J Immunol
6 Sherwood AM et al 2011 Deep sequencing of the hu-
man TCR and TCR repertoires suggests that TCR re-
arranges after and T cell commitment Sci Transl Med
390ra6190ra61
7 Robins HS et al 2009 Comprehensive assessment of
T-cell receptor beta-chain diversity in alphabeta T cells
Blood 1144099107
8 Zvyagin IV et al 2014 Distinctive properties of identi-
cal twins TCR repertoires revealed by high-throughput
sequencing Proceedings of the National Academy of Sci-
9 Warren RL et al
2011 Exhaustive T-cell repertoire
sequencing of human peripheral blood samples reveals
signatures of antigen selection and a directly measured
repertoire size of at least 1 million clonotypes Genome
Research 21790797
10 Mora T Walczak AM Bialek W Callan CG 2010 Max-
imum entropy models for antibody diversity Proceedings
of the National Academy of Sciences of the United States
of America 10754055410
11 Zarnitsyna VI Evavold BD Schoettle LN Blattman JN
Antia R 2013 Estimating the diversity completeness
and cross-reactivity of the T cell repertoire Front Im-
munol 4485
12 De Boer RJ Freitas AA Perelson AS 2001 Resource
competition determines selection of B cell repertoires
Journal of theoretical biology 212333343
13 Stirk ER Lythe G van den Berg HA Molina-Pars C
2010 Stochastic competitive exclusion in the mainte-
nance of the nave T cell repertoire Journal of Theoret-
ical Biology 265396410
14 Almeida ARM et al 2012 Quorum-Sensing in CD4 T
Cell Homeostasis A Hypothesis and a Model Frontiers
in Immunology 3115
15 Hapuarachchi T Lewis J Callard RE 2013 A mecha-
nistic model for naive CD4 T cell homeostasis in healthy
adults and children Frontiers in Immunology 427
16 Reynolds J Coles M Lythe G Molina-Pars C 2012
Deterministic and stochastic nave T cell population dy-
namics  symmetric and asymmetric cell division Dy-
namical Systems 2775103
17 Troy AE Shen H 2003 Cutting edge homeostatic pro-
liferation of peripheral T lymphocytes is regulated by
clonal competition Journal of immunology Baltimore
Md  1950 170672676
18 Mak T Saunders M 2006 The Immune Response Basic
and Clinical Principles The Immune Response Basic
and Clinical Principles ElsevierAcademic No vol 1
1994 T cell repertoires
and competitive exclusion Journal of theoretical biology
169375390
19 De Boer RJ Perelson AS
20 Freitas AA Rosado MM Viale AC Grandien A 1995
The role of cellular competition in B cell survival and
selection of B cell repertoires European Journal of Im-
100101102103103102101100Clone size CCumulative distribution  3c2008 3c20323c208Analytical solution in 1 Dmunology 2517291738
21 Bains I Antia R Callard R Yates AJ 2009 Quantifying
the development of the peripheral naive CD4  T-cell
pool in humans Blood 11354805487
22 Murugan A Mora T Walczak AM Callan CG 2012
Statistical inference of the generation probability of T-
cell receptors from sequence repertoires Proceedings of
the National Academy of Sciences 1091616116166
23 Murali-Krishna K et al 1998 Counting antigen-specic
CD8 T cells A reevaluation of bystander activation dur-
ing viral infection Immunity 8177187
24 Kaech SM Wherry EJ Ahmed R 2002 Eector and
implications for vaccine
memory T-cell dierentiation
development Nature reviews Immunology 2251262
25 Presse S Ghosh K Lee J Dill KA 2013 Principles
of maximum entropy and maximum caliber in statistical
physics Reviews of Modern Physics 8511151141
26 Cavagna A et al 2014 Dynamical maximum entropy
approach to ocking Phys Rev E 89042707
27 Goronzy JJ Lee WW Weyand CM 2007 Aging and
T-cell diversity Exp Gerontol 42400406
28 Westera L et al 2013 Closing the gap between T-cell
life span estimates from stable isotope-labeling studies in
mice and humans Blood 12222052212
29 Vrisekoop N et al 2008 Sparse production but prefer-
ential incorporation of recently produced naive T cells in
the human peripheral pool Proceedings of the National
Academy of Sciences 10561156120
30 Clauset A Shalizi CR Newman MJ 2009 Power-law
distributions in empirical data SIAM Rev 51661703
31 Bolkhovskaya OV Zorin DY Ivanchenko MV 2014
Assessing T Cell Clonal Size Distribution A Non-
Parametric Approach PLoS ONE 9e108658
32 Schluns KS Kieper WC Jameson SC Lefrancois L
2000 Interleukin-7 mediates the homeostasis of nave
and memory CD8 T cells in vivo Nature immunology
1426432
33 Tan JT et al
2001 IL-7 is critical for homeostatic
proliferation and survival of naive T cells Proceedings of
the National Academy of Sciences 9887328737
34 Stirk ER Molina-Pars C van den Berg HA 2008
Stochastic niche structure and diversity maintenance in
the T cell repertoire J Theor Biol 255237249
35 Seddon B Zamoyska R 2002 TCR signals mediated by
Src family kinases are essential for the survival of naive
T cells Journal of immunology 16929973005
36 Tanchot C Lemonnier FA Perarnau B Freitas AA
Rocha B 1997 Dierential requirements for survival
and proliferation of CD8 nave or memory T cells Sci-
ence 27620572062
37 Nesic D Vukmanovic S 1998 MHC class I is required
for peripheral accumulation of CD8 thymic emigrants
Journal of immunology 16037053712
38 Best K Oakes T Heather JM Taylor JS Chain B 2014
Sequence and primer independent stochastic heterogene-
ity in PCR amplication eciency revealed by single
molecule barcoding bioRxiv 201417
39 Vollmers C Sit RV Weinstein JA Dekker CL Quake
SR 2013 Genetic measurement of memory B-cell recall
using antibody repertoire sequencing Proceedings of the
National Academy of Sciences 110134638
40 Dekosky BJ et al 2014 In-depth determination and
analysis of the human paired heavy- and light-chain an-
tibody repertoire Nature Medicine 2118
41 Sornette D Cont R 1997 Convergent multiplicative
processes repelled from zero power laws and truncated
power laws J Phys I France
42 Marsili M Maslov S Zhang YC 1998 Dynamical Op-
timization Theory of a Diversied Portfolio Physica A
43 Mitzenmacher M 2004 A brief history of generative
models for power law and lognormal distributions Inter-
net Mathematics 1226  251
44 Kimura M 1983 The Neutral Theory of Molecular Evo-
lution Cambridge University Press Cambridge Books
Online
45 Cvijovic I Good BH Jerison ER Desai MM 2015 The
fate of a mutation in a uctuating environment Preprint
46 Melbinger A Vergassola M 2015 Evolutionary tness
in variable enviroments Arxiv 9209316
47 Cover TM Thomas JA 1991 Elements of Information
Theory Wiley-Interscience New York NY USA
