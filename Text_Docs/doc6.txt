The inuence of T cell development on pathogen specicity and autoreactivity
Andrej Kosmrlj1 2 Mehran Kardar2 and Arup K Chakraborty1 3 
1Ragon Institute of MGH MIT  Harvard Boston MA 02129 USA
2Department of Physics Massachusetts Institute of Technology Cambridge MA 02139 USA
3Departments of Chemical Engineering Chemistry and Biological Engineering
Massachusetts Institute of Technology Cambridge MA 02139 USA
T cells orchestrate adaptive immune responses upon activation T cell activation requires suf-
ciently strong binding of T cell receptors on their surface to short peptides derived from foreign
proteins bound to protein products of the major histocompatibility MHC gene products which
are displayed on the surface of antigen presenting cells T cells can also interact with peptide-MHC
complexes where the peptide is derived from host self proteins A diverse repertoire of relatively
self-tolerant T cell receptors is selected in the thymus We study a model computationally and
analytically to describe how thymic selection shapes the repertoire of T cell receptors such that T
cell receptor recognition of pathogenic peptides is both specic and degenerate We also discuss the
escape probability of autoimmune T cells from the thymus
Keywords statistical mechanics thymic selection T cell pathogen specicity autoimmune T cells
INTRODUCTION
Despite constant exposure to infectious microbial
pathogens higher organisms are rarely sick This is be-
cause the innate immune system is quite successful in
clearing pathogens before they can establish an infection
However the components of the innate immune system
respond only to common evolutionary conserved mark-
ers expressed by diverse pathogens Some bacteria and
most viruses have evolved strategies to evade or over-
come these innate mechanisms of protection A second
arm of the immune system adaptive immunity combats
pathogens that escape the innate immune response The
adaptive immune system is remarkable in that it mounts
pathogen-specic responses against a diverse and evolv-
ing world of microbes for which pathogen specicity
cannot be pre-programmed During an infection cells
of the adaptive immune system that are specic for the
pathogen proliferate Once the infection is cleared most
of these cells die but some remain as memory cells which
respond rapidly and robustly to re-infection by the same
pathogen This immunological memory is the basis for
vaccination
T cells play a key role in orchestrating the adaptive
immune response They combat pathogens that have in-
vaded host cells Pathogen-derived proteins in infected
host cells are processed into short peptides p which
can bind to major histocompatibility MHC proteins
expressed in most host cells The resulting pMHC com-
plexes are presented on the surface of host cells as molec-
ular markers of the pathogen T cells express a protein on
their surface called the T-cell receptor TCR Each T-
cell receptor TCR has a conserved region participating
in the signaling functions and a highly variable segment
responsible for pathogen recognition Because the vari-
able regions are generated by stochastic rearrangement of
the relevant genes most T cells express a distinct TCR
When we say that a given T cell recognizes a particular
pMHC complex we mean that its TCR binds suciently
strongly to it to enable biochemical reactions inside the
T cell that result in activation and proliferation of this
particular pathogen-specic T cell clone
The diversity of the T cell repertoire enables the im-
mune system to recognize many dierent pathogenic
pMHCs Peptides presented on MHC class I are typically
811 amino acids long 1 TCR recognition of pMHC is
both degenerate and specic It is degenerate because
each TCR can recognize several peptides 2 It is specic
because most point mutations to the recognized peptide
amino acids abrogate recognition 3 4
Host proteins eg those that are misfolded are also
processed into short peptides and are presented on the
surface of cells in complex with MHC proteins The
gene rearrangement process ensuring the diversity of
TCR may result in generating T cells harmful to the
host because they bind strongly to self pMHCs T
cells which bind too weakly to MHC are also not use-
ful as they cannot interact with pathogenic peptides
Such T cells which bind too weakly or too strongly to
self pMHC molecules are likely to be eliminated during
T cell development in the thymus 58
Immature T
cells thymocytes move around the thymus and interact
with a diverse set 103-104 of self pMHCs presented on
thymic cells Thymocytes expressing TCRs that bind too
strongly to any self-pMHC are likely to be deleted a pro-
cess called negative selection However a thymocytes
TCR must also bind suciently strongly to at least one
self-pMHC to receive a survival signal and emerge from
the thymus a process called positive selection The
threshold binding strength required for positive selection
is weaker than that which is likely to result in negative
selection
Signaling events gene transcription programs and cell
migration during T cell development in the thymus have
been studied extensively 514 An understanding of
how interactions with self-pMHC complexes in the thy-
mus shape the peptide binding properties of selected
TCR amino acid sequences such that mature T cells ex-
hibit their special properties is also beginning to emerge
Recently experiments carried out by Huseby et al 3 4
provided important clues in this regard Experiments
were carried out to contrast T cells that developed in a
normal mouse with a diversity of self pMHC molecules
in the thymus and those that developed in a mouse that
was engineered to express only one type of self pMHC
in the thymus For T cells that developed in a normal
mouse pathogen recognition was found to be very sen-
sitive to most point mutations of recognized pathogenic
peptides In contrast T cells that developed in the engi-
neered mouse were found to be much more cross-reactive
To address these issues we previously studied a sim-
ple model where TCRs and pMHCs were represented by
strings of amino acids 15 Fig 1a using numerical 16
and analytical 17 methods Our results provided a sta-
tistical perspective on the origin of how T cells recognize
foreign pathogens in a specic yet degenerate manner
They also provided a conceptual framework for diverse
experimental data 18 19 In this paper we extend the
model and study new phenomena that include 1 How
TCR-MHC interactions dier upon development against
dierent numbers of peptides in the thymus and how this
inuences T cell cross-reactivity 2 What are the se-
quence characteristics of pathogenic peptides recognized
by T cells 3 How does stochastic escape from negative
selection in a normal thymus inuence T cell specicity
for pathogenic peptides 4 How does the frequency of
autoimmune T cells change upon modulating the number
of peptides encountered during T cell development
To describe the interactions between TCRs and
pMHCs we model them as strings of amino acids These
strings indicate the amino acids on the interface between
TCRs and pMHCs In the simplest incarnations of the
model it is assumed that each site on a TCR interacts
only with a corresponding site on a pMHC Fig 1a The
binding interface of a TCR is composed of a more con-
served region that is in contact with the MHC molecule
and a highly variable region that makes the majority of
contacts with the peptide Therefore we explicitly con-
sider only amino acids of the latter part of the TCR
but not the former Similarly there are many possible
peptides that can bind to MHC and their sequences are
considered explicitly Prior to our work 1618 TCR-
pMHC interactions have been represented using string
models 1315 but these studies did not have an ex-
plicit treatment of amino acids or consider the mecha-
nistic issues we did including connections to human dis-
ease 18
To assess the eects of
thymic development on
pathogen recognition characteristics we evaluate the free
energy of interaction between TCR-pMHC pairs The in-
teraction free energy is composed of two parts a TCR
interaction with MHC and a TCR interaction with the
peptide The former is given a value Ec which may be
varied to describe dierent TCRs and MHCs The lat-
ter is obtained by aligning the TCR and pMHC amino
acids that are treated explicitly and adding the pairwise
interactions between corresponding pairs For a given
TCR-pMHC pair this gives
Eintcid0Ec t scid1  Ec 
J ti si 
where J ti si is the contribution from the ith amino
acid of the TCR ti and the peptide si and N  5 is
the length of the variable TCR-peptide region The ma-
trix J encodes the interaction energies between specic
pairs of amino acids For numerical purposes we use the
Miyazawa-Jernigan matrix 20 that was developed in the
context of protein folding but as will be described later
the qualitative results do not depend on the form of J
To model thymic selection we start by randomly gen-
erating a set of M self peptides where amino acids
are picked with frequencies corresponding to the human
proteome 16 21 using the mouse proteome does not
change the qualitative results 16 Then we randomly
generate TCR sequences with the same amino acid fre-
quencies To mimic thymic selection TCR sequences
that bind to any self-pMHC too strongly Eint  En are
deleted negative selection However a TCR must also
bind suciently strongly Eint  Ep to at least one self-
pMHC to receive survival signals and emerge from the
thymus positive selection Recent experiments show
that the dierence between the thresholds for positive
and negative selection is relatively small a few kBT  12
The threshold for negative selection En is quite sharp
while the threshold for positive selection Ep is soft Re-
placing soft thresholds with perfectly sharp thresholds at
En and Ep does not change the qualitative behavior of
the selected T cell repertoire see below and ref 16
However we do carry out calculations with soft thresh-
olds as well to study the escape of potentially autoim-
mune T cells and their pathogen recognition character-
istics
To completely specify the interaction free energy be-
tween a TCR and pMHC we need to specify the value of
Ec In previous studies 16 17 we xed the value of Ec
for all TCRs at some moderate value because too strong
binding to MHC large Ec would result in negative se-
lection with any peptide and too weak a binding to MHC
small Ec would result in TCR not being positively se-
lected Each human can have up to 12 dierent MHC
types A TCR that binds strongly to more than one
MHC type is likely to be eliminated during negative se-
A I T N D G
C L P F E R
peptide
M  1 0 0
M  1 0 1
M  1 0 2
M  1 0 3
M  1 0 4
            -   0 1 2 3 4
UTOCTMTM
AERHWCTMTM
M  1 0 0
M  1 0 1
M  1 0 2
M  1 0 3
M  1 0 4
FIG 1 Eects of thymic selection on the characteristics of selected TCRs a Schematic representation of the interface between
TCR and pMHCs The region of the TCR contacting the peptide is highly variable and is modeled by strings of amino acids of
length N  The peptide is also treated similarly The binding free energy between the TCR and the entire pMHC is computed
as described in the text b Amino acid composition of TCR selected against M types of self peptides in the thymus The
ordinate is the ratio of the frequency of occurrence of an amino acid in the peptide contact residues of selected TCRs and the
pre-selection frequency TCRs selected against many types of self-peptides in the thymus have peptide contact residues that
are enriched in amino acids that interact weakly with other amino acids Amino acids on the abscissa are ordered according
to their largest interaction strength with other amino acids in the potential matrix J c Probability density distribution
of Ec values strength of TCR binding to MHC of TCRs selected against M types of self peptides TCRs selected against
many types of self peptides are more likely to bind weakly to MHC The parameter values are N  5 Ep  En  25kBT 
Ecmax  Ep  N J  Ecmin  En  N J  We have used the Miyazawa-Jernigan matrix J 20 and amino acid frequencies fa
from the human proteome 16 21 using the mouse proteome does not change the qualitative results 16
lection Therefore we consider TCRs that are restricted
by a particular MHC type We expect that variations
in Ec for selected TCRs are small A rough estimate on
the bounds can be obtained from the condition that the
average interaction free energy between TCR and pMHC
for selected TCRs is between the thresholds for positive
and negative selection
En  Ec  N J  Ep
where J is the average value of interaction between amino
acids The upper lower bound Ecmax  Ep  N J
Ecmin  En  N J ensures that on average interac-
tions result in positive selection and not negative selec-
tion Since for selection it is enough that a TCR se-
quence is positively selected by one of many self pep-
tides and avoid being selected by encountered self pep-
tides the actual bounds for Ec might be dierent but
we expect that the range of Ec values is still small viz
Ecmax  Ecmin  Ep  En To every TCR sequence we
assign a random value of Ec chosen uniformly from the
interval Ecmin Ecmax and subject it to the selection
processes Note that TCRs with interactions with MHCs
that are too weak are unlikely to be oriented on MHCs
properly and hence will be unable to interact with the
peptide Thus one cannot tune Ec to very low values to
escape negative selection
RESULTS
TCRs selected against many self peptides are
enriched with weakly interacting amino acids and
bind more weakly to MHCs
First we study how thymic selection shapes TCR se-
quences and TCR interactions with MHC A million
randomly generated TCR peptide contact residues with
randomly assigned Ec values are generated and selected
against M randomly generated self peptides according to
the thymic selection rules described in the previous sec-
tion For the set of selected TCRs we assess their amino
acid composition and their interactions with MHC Ec
values The whole process is repeated thousand times
to obtain proper statistics The peptide contact residues
of TCR sequences selected against many self peptides
are statistically enriched with weakly interacting amino
acids Fig 1b and TCRs with weaker binding to MHC
within the allowed range are more likely to get selected
Fig 1c This is because negative selection imposes a
strong constraint When selected against many self pep-
tides TCR sequences with peptide contact residues con-
taining strongly interacting amino acids eg hydropho-
bic amino acids or those with exible side chains or
TCRs that bind strongly to MHC are more likely to bind
strongly with at least one self-pMHC and thus be nega-
tively selected This qualitative result agrees with exper-
iment 4 16 and is independent of details of the inter-
action potential J or the sharpness of the thresholds for
positive and negative selection as will be shown next
The selection of a given TCR sequence t is determined
by the strongest interaction with all self peptides and a
TCR is selected when
En  min
sMcid8Eintcid0Ec t scid1cid9  Ep
In Ref 17 we showed that by using the Extreme Value
Distribution one nds that the strongest interaction en-
ergy with M random self peptides is sharply peaked
Vti 4
Eti vuut2 ln M 
by Ga  P20
E0cid0Ec tcid1  Ec 
where Ea  Jti aa and a  cid2Jti a2cid3a 
Jti a2
a are the average and the variance of the inter-
action free energy of amino acid a with all others We
have denoted the average over self amino acid frequencies
a1 faGa From this equation and the
selection condition 3 we see that as the number of self
peptides M  increases the chance of negative selection
does too To counterbalance this pressure for large M 
TCRs are enriched with weakly interacting amino acids
in their peptide contact residues and TCRs that interact
weakly with MHC small Ec value see Fig 1 A simi-
lar eect can be obtained with amino acids with smaller
variance of interactions but this eect is less pronounced
because of the square root Even if it were in eect it
would pick out TCRs with smaller variance which for the
case where the means were the same also imply selecting
the more weakly binding amino acids These results are
independent of the form of the statistical potential be-
tween contacting amino acids Dierent potentials only
change the identities of weak and strong amino acids
The probabilities with which amino acids are chosen
for the selected TCRs in the T cell repertoire depend
on the conditions eg the number of peptides present
in the thymus This dependency can be formalized by
using statistical mechanical methods that apply in the
limit of very long peptides and remarkably the results
seem to be accurate even for short peptides 17 The
thymic selection condition
En  E0cid0Ec tcid1  Ep
can be interpreted as a micro-canonical ensemble of se-
quences t  which are acceptable if the value of the Hamil-
tonian E0cid0Ec tcid1 falls on the interval En Ep In the
limit of long peptides canonical and micro-canonical en-
sembles are equivalent Thus the probability for TCR
selection is governed by the Boltzmann weight
pcid0Ec tcid1   N
fti Ec expcid20  E0cid0Ec tcid1cid21
Here fa and Ec are the natural frequencies of the dif-
ferent amino acids and the distribution of Ec values prior
to selection whereas the eect of thymic selection is cap-
tured in the parameter  which is determined by the
condition that the average free energy falls in the inter-
val En Ep The complication presented by the square
root term in Eq 4 for determining parameter  is easily
dealt with by Hamiltonian minimization 22 and intro-
ducing an eective Hamiltonian
H0cid0Ec tcid1  Ec 
Xi1cid2Eti  Vticid3  ln M2 7
This corresponds to Boltzmann weights
pcid0Ec tcid1  Ec exp Ec
i1 fti exp  Eti  Vti
for which thermodynamic quantities are easily computed
  pln M 2N hVi is determined by minimizing
the eective Hamiltonian H0cid0Ec tcid1 with respect to 
which ensures that the average free energies hE0cid0Ec tcid1i
and hH0cid0Ec tcid1i are the same the averaging is done over
all TCR sequences t weighted with Boltzmann weights
6 and 8
 is determined by constraining the average free energy
to the range En Ep while maximizing entropy Given
the bounded set of free energies the parameter  can
be either negative or positive The values for E0cid0Ec tcid1
span a range from Emin to Emax and a corresponding
number of states E0 is bell-shaped between these ex-
tremes with a maximum at some Emid If Emid  Ep
we must set  such that hE0cid0Ec tcid1i  Ep In this case
  0 positive selection is dominant and selected TCRs
contain peptide contact residues with stronger amino
acids and TCRs that interact strongly with MHCs
Emid  En we must set  such that hE0cid0Ec tcid1i  En
now   0 negative selection is dominant and TCRs
with peptide contact residues with weaker amino acids
and TCRs that interact weakly with MHCs are selected
For En  Emid  Ep we must set   0 and there
is no modication due to selection The resulting phase
diagram of parameter  is shown in Figure 2a
For the relevant parameters in mouse ie N  5
Ep  En  25kBT  Ecmax  Ep  N J Ecmin  En 
N J and M  103 we nd   306kBT 1 and
  094kBT 1 negative selection is dominant and
weaker amino acids are selected This result is consistent
with experiments 16 With these parameters we can
calculate the amino acid frequencies of selected TCRs as
f sel
fa expcid2  cid0Ea  Vacid1cid3
b1 fb expcid2  cid0Eb  Vbcid1cid3
and the distribution of selected TCRs interactions with
STRONG AA
E n  E c mi nN
  k BT  1
WEAK AA
simulation
EVD in large N limit
L F I V M W C Y A H T P G R Q S N E D K
weak aa
strong aa
simulation
EVD in large N limit
FIG 2 Analytical results for characteristics of selected TCRs a Representation of the dependency of the parameter  a
measure of amino acid composition of selected TCRs and a measure of selected TCR binding strengths to MHCs see text on
the number of self-peptides ln MN  and the threshold for negative selection En with Ep  EnN  Ecmax  EcminN 
05kB T  The region between the black lines corresponds to   0 to the right left of which negative positive selection is
dominant and weak strong amino acids are selected The blue dashed lines indicate the relevant parameter values for thymic
selection in mouse b Amino-acid composition of selected TCR sequences ordered in increasing frequency along the abscissa
c Probability density distribution of Ec values strength of TCR binding to MHC of selected TCRs b-c The data points
in black are obtained numerically with the parameters relevant to mouse see text The error bars reect the sample size
used to generate the histograms and dierences for dierent realizations of M self-peptides The red lines are the result of the
EVD analysis in the large N limit from Eqs 9 and 10 and the agreement is quite good In both cases we have used the
Miyazawa-Jernigan matrix J 20 and amino acid frequencies fa from the human proteome 16 21
MHCs as
selEc 
Ec exp Ec
E expEdE
R Ecmax
where Ec is the distribution of TCR interactions with
MHCs before selection which is taken to be a uniform
distribution in our simulations We nd Figs 2b and 2c
that the analytical results above agree very well with
the numerical results of simulations for N  5 and the
parameters presented above
Selection against many self peptides is required for
pathogen-specic T cells
How does such a T cell repertoire lead to specic
recognition of pathogenic peptide To study the speci-
city of mature T cells for pathogenic peptide recogni-
tion we challenge selected TCR sequences with a col-
lection of many randomly generated pathogenic peptides
where amino acid frequencies correspond to L monocy-
togenes 16 23 a pathogen that infects humans TCR
recognition of pathogenic peptide occurs if TCR-pMHC
binding is suciently strong Eint  Er where the
recognition threshold in mouse experiments is such that
Er  En 24 For each TCR that recognizes a partic-
ular pathogenic sequence the specicity of recognition
was tested Each site on the peptide was mutated to
all other 19 possibilities and recognition of the reactive
TCRs was again assessed If more than half the muta-
tions at a particular site abrogated recognition by the
same TCR this site was labeled an important contact
For each strongly bound TCR-pMHC pair the number
of important contacts was determined After summing
over all selected TCRs and pathogenic peptides we ob-
tained a histogram of the number of important contacts
Fig 3a The higher the number of important contacts
the more specic is the TCR recognition of pathogenic
peptide Small numbers of important contacts corre-
spond to cross-reactive TCRs that are able to recognize
many pathogenic peptide mutants The obtained result
is qualitatively the same as the one obtained in previous
studies 16 17 where the binding free energy of TCRs
with MHC was xed
In agreement with experiments 3 4 we nd in our
model that TCRs selected against many dierent self
peptides are very specic while TCRs selected against
only one self peptide are more cross-reactive Fig 3a
Based on the amino acid composition of selected TCRs
see previous section we can provide a mechanistic
explanation for the specicitydegeneracy of pathogen
recognition Because TCR peptide contact residues are
enriched with weakly interacting amino acids and TCRs
are more likely to react moderately to MHC they can in-
teract suciently strongly for recognition to occur only
with pathogenic peptides that are statistically enriched in
amino acids that are the stronger binding complements
of the peptide contact residues of the TCR Fig 3b
M  10 0
M  10 1
M  10 2
M  10 3
M  10 4
M  10 0
M  10 1
M  10 2
M  10 3
M  10 4
L F I M V W C Y A H T P G Q R S N E D K
strong aa
weak aa
number of important contacts for TCR recognition of pathogenic peptides
FIG 3 Characteristics of TCR recognition of pathogenic peptides a Histogram of the number of important contacts dened
in text with which T cells recognize pathogenic peptides T cells selected against many self peptides recognize pathogenic
peptides via many important contacts and are thus specic
In contrast T cells selected against few types of self peptides
recognize pathogenic peptides with only a few important contacts and are thus cross-reactive b Amino acid composition of
pathogenic peptides that are recognized by at least one of the selected TCRs TCRs selected against many types of self peptides
recognize pathogenic peptides that are enriched with strongly interacting amino acids In contrast TCRs selected against few
types of self peptides may also recognize pathogenic peptides that contain weakly or moderately interacting amino acids We
used the same set of parameters as in Figure 1 to obtain these results
Such TCR-peptide interactions generate weak to moder-
ate interactions which sum up to provide sucient bind-
ing strength for recognition each interaction contributes
a signicant percentage of the total binding anity If
there is a mutation to a peptide amino acid of a rec-
ognized peptide it is likely to weaken the interaction
it participates in as recognized peptides are statistically
enriched in amino acids that interact strongly with the
TCRs peptide contact residues Weakening an interac-
tion that contributes a signicant percentage of the bind-
ing free energy is likely to abrogate recognition because
the recognition threshold is sharply dened 12
This statistical view of TCR specicity for antigen may
describe the initial step of binding which may then al-
low modest conformational adjustments 19 This mech-
anism also suggests an explanation for why TCR recog-
nition of pathogenic peptides can be degenerate There
are many combinatorial ways of distributing strongly in-
teracting amino acids along the peptide which lead to
suciently strong binding with TCR for recognition
In agreement with experiments 4 for T cells that de-
velop in mice with many peptides in the thymus suf-
ciently strong binding for recognition is achieved via
many moderate bonds and each of these bonds is impor-
tant for recognition In contrast TCR sequences selected
against only one type of self-peptide have a higher chance
of containing strongly interacting amino acids and have a
higher chance to bind more strongly to the MHC Fig 1
Such TCRs can recognize a lot more pathogenic peptides
including the ones that contain weakly or moderately in-
teracting amino acids Fig 3b In many cases mutat-
ing such amino acids on the peptide does not prevent
recognition of the same TCR because a small number of
strong contacts dominate recognition Fig 3a and experi-
ments 4 and unless these specic ones are disrupted by
mutations to the peptide recognition is not abrogated
Accordingly TCR recognition of pathogenic peptides is
more cross-reactive
It may also happen that the binding interaction be-
tween a TCR and pathogenic peptide-MHC is suciently
strong that a single mutation of peptide amino acids
cannot prevent recognition which results in 0 impor-
tant contacts This may happen because of the stronger
binding of TCRs to MHC and because of the higher
chance of TCRs having strongly interacting peptide con-
tact residues When selected against fewer types of self-
peptides TCRs that bind strongly to MHC can escape
Fig 1c Thus in this case the escape of TCRs that bind
strongly or moderately to more than one MHC type or
MHC with mutations might also be possible leading to
more cross-reactivity to MHC types or substitutions of
MHC amino acids 3
Characteristics of foreign peptides recognized by T
Once T cells complete thymic selection a set T of
TCRs K in number is released in the blood stream
where they try to identify infected cells A T cell rec-
ognizes infected cells when its TCR binds suciently
strongly Eint  Er to foreign peptide-MHC Experi-
mental evidence 24 suggests that the negative selection
threshold in the thymus is the same as the recognition
threshold in the periphery ie Er  En This means
that a foreign peptide of sequence s is recognized if its
strongest interaction with the set of TCRs exceeds the
threshold for recognition ie
Ect T cid8Eintcid0Ec t scid1cid9  En
Eq 11 casts the recognition of foreign peptides as
another extreme value problem To calculate the proba-
bility Prec s  that a foreign peptide sequence s is recog-
nized by T cells and to calculate the amino acid compo-
sition of recognized foreign peptides in the limit of long
peptide sequences we use the same procedure that was
used in Ref 17 briey discussed in previous section
to calculate the properties of selected TCRs Therefore
here we just briey summarize the necessary steps
Let us indicate by  xs  the probability density func-
tion PDF of the interaction free energy between the for-
eign peptide s and a random TCR that is selected in the
thymus Then the probability that foreign peptide s is
recognized is obtained by integrating the extreme value
distribution EVD  xs  over the allowed range
xs  dx with
Prec s   Z En
xs   K xs cid21  P  E  xs cid3K1
where P  is the cumulative probability of the PDF
If we model the set T of selected T cells as K
strings in which each amino acid is chosen independently
with frequencies f sel
ie we ignore the correlations
among dierent positions on the string then in the
limit of long peptide sequences large N  we can ap-
proximate the PDF  xs  with a Gaussian with mean
i1 E si and variance V  s  
i1 V si The mean E si and the vari-
ance V si of the amino acid interaction free energies
are obtained as in the previous section by appropriately
replacing fa with f sel
 The mean hEci and the variance
c i  hEci2 of selected TCR interactions with
XEc expEcdEc
avs   hEci  PN
c ic  PN
c ic  hE2
MHCs are dened as hXi 
R Ecmax
Ec expEcdEc
where  Ec is distribution of Ec values before selec-
In the limit of large number of T cells K  1
the extreme value distribution  xs  is sharply peaked
i1 E si
0 s   hEci PN
r2 ln KhhE2
c ic PN
i1 V sii
and in the large N limit the condition for recognition of
foreign peptides becomes
0 s  En
The probability for a sequence s
nized is governed by the Boltzmann weight p s  
cid16QN
fsicid17 exp E 
0 s  wheren fao are natural fre-
0 s i and hH 
0 s   hEci   hE2
the same average energies hE 
0 si  En while maximizing entropy If E 
    pln K 2hE2
quencies of dierent amino acids in the pathogen pro-
teome while the eect of TCR recognition is captured
in the parameter  As in the previous section we in-
troduce a new Hamiltonian H 
i1 E si   V si  ln K 2  and to ensure
0 s i we set
c ic  2N hV i Finally the value
of  is determined by constraining the average energy
mid  En
we must set  such that hE 
dened as in the previous section In this case   0
and only foreign peptides with stronger amino acids are
recognized If E 
mid  En we must set   0 and there
is no modication due to recognition ie every foreign
peptide is recognized Note that unlike for the thymic
selection of T cell receptors the parameter  the pa-
rameter  cannot be negative because there is no lower
energy bound for recognition in Eq 14 With all pa-
rameters determined we can calculate the amino acid
frequencies of recognized foreign peptides
0 si  En where E 
f rec
fa expcid2cid0E a   V acid1cid3
fb expcid2cid0E b   V bcid1cid3
Figure 4 depicts variation of  as a function of the
number of selected TCRs lnKN  the number of
self peptides lnM N  against which TCRs were se-
lected and the threshold for negative selection EnN
with Ep  EnN  05kBT  The region   0 is pos-
sible only for K  M and for parameters where  is
small cf Fig 2a That is all foreign peptides are rec-
ognized when there are lots of TCRs or when TCRs are
selected against a small number of self peptides M  in
the thymus neither condition is biologically true
We also compared the analytical results which are ex-
act in the limit N   with numerical simulations for
N  5 Fig 5 From the set of parameters that are
relevant for thymic selection in the mouse ie N  5
EpEn  25kBT  Ecmax  EpN J Ecmin  EnN J
and M  103 we generated a pool of K  103 selected
TCRs Then we randomly generated 106 foreign pep-
tides with amino acid frequencies fa which were repre-
sentative of L monocytogenes 16 23 and checked the
amino acid composition of foreign peptides that were rec-
ognized by at least one TCR We nd that selected TCRs
recognize only foreign peptides that are enriched with
strongly interacting amino acids Fig 5 Increasing ex-
perimental evidence indicates that this may be true 19
The physical reason for this was discussed in the previ-
ous section The quantitative agreement between sim-
ulations black line and the analytical result red line
  049kBT 1 and    180kBT 1 is not very
good Fig 5
   k BT   1
   0
   0
   0
   0
   k BT   1
l n K N
8 7 6 5 4 3 2
E n  Ec  mi nN
FIG 4 Color representation of the dependence of the parameter   on the number of selected TCRs lnKN  the number
of self peptides lnM N  against which TCRs were selected and threshold for negative selection EnN  Parameters are
Ep  EnN  05kB T and Ecmin  Ecmax  En  Ep in the limit of large N  Solid black lines separate regions with    0
and    0 The regions below the black dashed line in a and between the black dashed lines in b correspond to   0
every TCR is selected In a Ecmin  En  N J and in b lnKN  15
simulation
EVD in large N limit
simulation  uncorrelated TCRs
F L I W M V Y C R H K T A E D G S N Q P
weak aa
strong aa
FIG 5 Amino-acid composition of recognized foreign pep-
tides The amino acids are ordered in decreasing frequency
along the abscissa The data points in black are obtained
numerically with the parameters relevant to TCR selection
in the mouse and K  103 TCRs which where than chal-
lenged with L monocytogenes peptides see text The blue
data points are for similarly challenged K  103 uncorrelated
TCRs The error bars reect the sample size used to gen-
erate the histograms and dierences for dierent realizations
of M self peptides black or K uncorrelated TCRs blue
The red line is the result of the EVD analysis in the large
N limit from Eq 15 where TCR amino acid frequencies
were obtained from Eq 9
In all cases we have used the
Miyazawa-Jernigan matrix J 20 amino acid frequencies fa
from the human proteome using the mouse proteome does
not change the qualitative results 16 and amino acid fre-
quencies fa from the L monocytogenes proteome 16 21
This suggests that our assumption in the analytical
model that the pool T of selected TCRs is uncorrelated
might not be good for short sequences To test the eect
of correlations we generated a set of K  103 uncorre-
lated TCRs with amino acid frequencies f sel
obtained
from Eq 9 and with MHC binding strengths drawn
from the distribution in Eq 10 and then checked the
amino acid composition of foreign peptides recognized
by this set Figure 5 shows better agreement between
the analytical result red line and simulations blue data
points with uncorrelated TCRs However the analytical
results still vary signicantly from simulations The large
discrepancy is likely due to the inaccurate approximation
of micro-canonical with the canonical ensemble of recog-
nized foreign peptides for short peptides N  5 which
only holds in the limit of large peptides N   Worse
agreement between the numerical blue line and analyt-
ical results red line for the amino acid composition of
recognized peptides Fig 5 compared to the results for
the amino acid composition of selected TCRs Fig 2b
might be due to lower magnitude of numerically obtained
parameters   049kBT 1    306kBT 1
and the exponential dependence of amino acid frequen-
cies on parameters  and  Eqs 9 and 15 On the
other hand the large dierence between the numerically
obtained results in black and blue lines is only due to the
correlations of the selected TCRs in the thymus
To examine this further we have also tested the eect
of correlations in the limit of a large number K of selected
T cells since a mouse has  108 distinct T cells and a
human has  109 distinct T cells Both numbers are
larger than the total number of possible sequences 20N
for N  5 in TCR peptide binding regions This sug-
gests that the sequence length N should be larger N  6
or N  7 or that TCRs dier also in regions that do not
bind peptide eg dierent TCR binding strengths to
the same MHC type dierent sets of TCR pools that
correspond to dierent MHC types each human has up
to 12 dierent MHC types For the values of K that are
of the order of the total number of sequences the EVD
 probes the tails of distribution  xs  where it is
no longer Gaussian Because the distribution  xs 
is bounded in the large K limit the EVD approaches a
delta-function centered at the K-independent value cor-
responding to the optimal binding energy
0 s   min
Ect T Ec 
Jti si 
In the limit N   a pool of TCR sequences is uncor-
related and the optimal binding energy can be written
0 s   Ecmin 
Jminsi
where Jmina  minb Jb a The condition for recogni-
tion of foreign peptides is
0 s   En
and the probability for a sequence s to be recog-
nized is governed by the Boltzmann weight p s  
cid16QN
fsicid17 exp E 
0 s  wheren fao are natural fre-
quencies of dierent amino acids in the pathogen pro-
teome while the eect of TCR recognition is captured
in the parameter  The value of  is determined by
constraining the average energy hE 
0 s i  En while
maximizing entropy in the same manner as described be-
fore see the paragraph after Eq 14 The condition
for   0 can be simplied to
En  Ecmin
a1 Jmin fa exp Jmina
 hJminai  P20
fa exp Jmina
With the parameter  determined we can calculate the
amino acid frequencies of recognized foreign peptides
fa exp Jmina
fb exp Jminb
f rec
For the relevant parameters in mouse ie N  5
EpEn  25kBT  Ecmax  EpN J Ecmin  EnN J
and M  103 we obtain   0 which means that every
foreign peptide is recognized We tested this numerically
by checking the properties of foreign peptides recognized
by a complete pool of selected TCR For each of the 20N
possible TCR sequences t we calculated the strongest
interaction with M  103 self peptides Emincid0tcid1 
cmin E 
cmin E 
The actually selected Ec values for a given TCR se-
of Ec values that could result in the TCR selection
minsMnPN
as cid0E 
quence t are obtained by intersecting thecid0E 
of selected TCRs with weights  Eccid16QN
i1 Jti sio and constructed an interval
cmaxcid1  cid0En  Emincid0tcid1  Ep  Emincid0tcid1cid1
cmaxcid1
i1 fticid17 
interval with the allowed interval Ecmin Ecmax be-
fore selection
Thus we obtained a complete pool
EcEcminEcmaxE 
cmax where  is an indicator
function with a value of 1 if a TCR with given Ec and
t is selected and 0 otherwise The complete pool of se-
lected TCRs was then challenged against 105 randomly
generated foreign peptides that were representative of L
monocytogenes and the whole process was repeated 1 000
times with dierent realizations of M  103 self peptides
Fig 6 shows a large disagreement between numerical sim-
ulations black data points where only foreign peptides
with strongly interacting amino acids are recognized and
the analytical result red line Eq 20 where every for-
cminE 
simulation
EVD in large N limit
simulation  uncorrelated TCRs
F L I W M V Y C R H K T A E D G S N Q P
weak aa
strong aa
FIG 6 Amino-acid composition of foreign peptides recog-
nized by a complete pool of selected TCRs The amino acids
are ordered in decreasing frequency along the abscissa The
data points in black are obtained numerically where a com-
plete pool of selected TCRs obtained from thymic selection
of all 20N TCR sequences against M  103 self peptides is
challenged with L monocytogenes peptides see text The
error bars reect the dierences for dierent realizations of
M  103 self peptides The red line is the result of the EVD
analysis in the large N limit from Eq 19 The data points
in blue are obtained numerically where a complete pool of
uncorrelated TCRs which is equal to the complete pool of
20N sequences see text are challenged with L monocyto-
genes peptides In this case there are no error bars because
we use the complete pools of TCRs and foreign peptides with
appropriate weights In all cases we have used the Miyazawa-
Jernigan matrix J 20 amino acid frequencies fa from hu-
mans using the mouse proteome does not change the qual-
itative results 16 and amino acid frequencies fa from the
L monocytogenes 16 21
eign peptide is recognized Because the selected TCR
sequences are correlated we also tested the eect of cor-
relations Since f sel
 0 for every amino acid a and
sel Ec  0 for all allowed Ec values the complete pool
of uncorrelated TCRs correspond to all 20N sequences
and all possible interaction values with MHCs Ec with
 When a foreign peptide is
tested against the complete pool of TCRs it nds a TCR
that results in optimal binding energy Eq 17 To
numerically calculate the amino acid frequencies of for-
eign proteins recognized by complete uncorrelated pool
of TCRs we generate all possible 20N foreign peptide se-
weights sel EcQN
i1 f sel
fsicid17 A foreign
quences with appropriate weights cid16QN
peptide sequence s is then recognized if the optimal bind-
ing energy Eq 17 exceeds the recognition threshold
Eq 18 The numerical result for uncorrelated TCRs
blue data points agrees very well with the analytical
results red line which indicates that the correlations
in selected TCR sequences black data point have an
important role
Escape of autoimmune T cells
Thymic selection is not perfect and autoimmune T
cells which interact strongly with self pMHCs can es-
cape from the thymus Due to stochastic eects it may
happen that a diusing T cell in the thymus never in-
teracts with some peptides that would lead to negative
selection Also even if a TCR binds strongly to a self-
pMHC it can escape with some probability because the
negative selection threshold is not sharp Here we only
focus on the latter eect which can be modeled with a
soft threshold for negative selection For a TCR t that
interacts with self-peptide s  the probability of negative
selection is assumed to be
Pncid0t scid1 
1  expcid2cid0Eintcid0t scid1  Encid1 ncid3
where the parameter n denotes the softness of negative
selection threshold For a TCR that interacts strongly
with self-pMHC Eint  En the probability of negative
selection is close to 1 while for a TCR that interacts
with self-pMHC weakly Eint  En the probability of
negative selection is small Similarly we can dene the
probability for positive selection Pp with the correspond-
ing softness p From experiments 12 we know that
the threshold for positive selection is softer p  n
In this case thymic selection is modeled by testing each
TCR sequence with all self-pMHCs for each self-peptide
we calculate the corresponding probabilities Pp and Pn
of positive and negative selection then we draw two uni-
formly distributed random numbers rp and rn from the
0 1 interval and a TCR is positively negatively se-
lected if rp  Pp rn  Pn After thymic selection is
completed we check if any of the selected TCRs inter-
acts strongly with any self-peptide Eint  Er  En
Deterministic criteria are now used because strong in-
teraction free energy leads to high probability of T cell
activation Any other deterministic or stochastic crite-
ria would not qualitatively change the results We nd
that the introduction of soft thresholds for positive and
negative selection does not qualitatively change the re-
sults reported earlier regarding the composition of se-
lected TCRs etc Fig 7a and data not shown Fig 7b
shows that increasing the softness of the threshold for
negative selection n increases the chance of escape of
autoimmune TCRs This is because strongly interact-
ing TCRs are negatively selected with lower probability
when the threshold for negative selection is softer Inter-
estingly the ratio of the number of autoimmune T cells
to the number of selected T cells seems to be roughly con-
stant with the number M of self-peptides used during the
development in thymus Fig 7c The fraction of autoim-
mune T cells increases with M  but the rate of increase
is small for large M  Note that with increasing number
of self peptides M both the nominator and denominator
are decreasing but the ratio is roughly constant
DISCUSSION
In this paper we extend our understanding of the prob-
lem of how the thymus designs a T cell repertoire that
is both specic and degenerate for pathogenic peptide
recognition Previously 1618 we argued that for selec-
tion against many self-peptides negative selection im-
poses a constraint which results in selected TCR se-
quences composed of predominantly weakly interacting
amino acids We now nd additionally that negative se-
lection also results in selected TCRs that bind relatively
weakly to MHC But interactions with MHC cannot be
arbitrarily weak as that would prevent proper TCR ori-
entation on MHC and peptide recognition
Binding of such TCRs to pathogenic peptides is su-
ciently strong for recognition only when pathogenic pep-
tides are composed of predominantly strongly interacting
amino acids This is not too restrictive for the immune
system because several pathogenic peptides are derived
from pathogenic proteins and presented to T cells
is enough for T cells to recognize just a few pathogenic
peptides to activate the immune system and clear the
infection This may contribute to why there are only a
few immunodominant peptides corresponding to any in-
fection
Equations 15 and 20 provide an analytical expres-
sion that captures the characteristics of amino acids of
the recognized foreign peptides Figures 5 and 6 show
that the analytical result is not very accurate for short
N  5 peptide sequences and we showed Figs 5 and
6 that this is due to the correlations in selected TCR
M  1 0 0
M  1 0 1
M  1 0 2
M  1 0 3
M  1 0 4
number of important contacts
for TCR recognition of pathogenic peptides
FIG 7 Thymic selection with soft thresholds for positive and negative selection a Histogram of the number of important
contacts dened in text with which T cells recognize pathogenic peptides This result and other characteristics of selected
TCRs data not shown are qualitatively equivalent to the results obtained with sharp thresholds for positive and negative
selection Figs 1 and 3 b Ratio of the numbers of escaped autoimmune TCRs and selected TCRs as a function of the
softness of the threshold for negative selection n Fraction of autoimmune TCRs increases with n until the softness of the
thresholds becomes of the same order as the separation between the thresholds of positive negative selection n p  Ep En
p  1kBT  M  103 c Ratio of the numbers of escaped autoimmune TCRs and selected TCRs as a function of the number
of types of self peptides M  Fraction of autoimmune TCRs increases with M and is roughly constant for large M  however
the absolute numbers of TCRs are decreasing with M  p  1kBT  n  01kBT  The error bars in b and c correspond to
the standard deviation of the fractions of escaped TCRs obtained from repeating the thymic selection process many times
sequences In the future it would be interesting to study
how or if these correlations vanish as peptide sequence
length N  is increased
It is known that people who express a particular MHC
type called HLA-B57 are more likely to control HIV infec-
tion than people without this MHC 25 26 In a previous
study 18 we found that HLA-B57 bind  6 times fewer
peptides than MHC molecules that are associated with
faster progression to AIDS This means that TCRs re-
stricted for HLA-B57 are selected against fewer types of
self peptides in the thymus which results in a more cross-
reactive T cell repertoire Fig 3a and Fig 7a In that
study we showed that more cross-reactive T cell reper-
toire could contribute to better control of HIV infection
Interestingly people expressing HLA-B57 are also more
prone to autoimmune diseases 27 28 We also studied
the escape of autoimmune T cells from the thymus as a
function of the number of self peptides M  While the
ratio of escaped autoimmune T cells to selected T cells is
roughly independent of M in the relevant regime M 
a few thousands Fig 7c the absolute numbers of es-
caped autoimmune T cells is higher This implies that
the rate of escape of autoimmune T cells could be higher
in people expressing HLA-B57
Note however that allowing escape of autoimmune
TCRs by having a soft threshold for negative selection
does not alter our qualitative results regarding the char-
acteristics of selected TCRs and the origins of specic
and degenerate TCR recognition of pathogen
This work was supported by the Ragon Institute
AKC AK National Institutes of Health NIH
Grant No
1-PO1-AI071195-01 AKC MK NSF
Grant No DMR-08-03315 MK and a NIH Directors
Pioneer award to AKC
 Electronic address arupcmitedu
1 C Janeway P Travers M Walport and M Shlomchik
Immunobiology Garland Science New York 2004 6th
2 E R Unanue Annu Rev Immunol 2 395 1984
3 E S Huseby J White F Crawford T Vass D Becker
C Pinilla P Marrack and J W Kappler Cell 122 247
2005
4 E S Huseby F Crawford J White P Marrack and
J W Kappler Nat Immunol 7 1191 2006
5 H von Boehmer I Aifantis F Gounari O Azogui
L Haughn I Apostolou E Jaeckel F Grassi and
L Klein Immunol Rev 191 62 2003
6 G Werlen B Hausmann D Naeher and E Palmer
Science 299 1859 2003
7 K A Hogquist T A Baldwin and S C Jameson Nat
Rev Immunol 5 772 2005
8 O M Siggs L E Makaro and A Liston Curr Opin
Immunol 18 175 2006
9 P Bousso N R Bhakta R S Lewis and E Robey
Science 296 1876 2002
10 J A M Borghans A J Noest and R J de Boer Eur
J Immunol 33 3353 2003
11 A Scherer A Noest and R J de Boer Proc R Soc
London Ser B 271 609 2004
12 M A Daniels E Teixeiro J Gill B Hausmann
D Roubaty K Holmberg G Werlen G A Hollander
N R J Gascoigne and E Palmer Nature 444 724
2006
13 V Detours and A S Perelson Proc Natl Acad Sci
USA 96 5153 1999
21 P Flicek B L Aken K Beal B Ballester M Caccamo
Y Chen L Clarke G Coates F Cunningham T Cutts
et al Nucleic Acids Res 36 D707 2008
22 M Kardar Phys Rev Lett 51 523 1983
23 I Moszer P Glaser and A Danchin Microbiol UK 141
14 V Detours R Mehr and A S Perelson J Theor Biol
261 1995
200 389 1999
15 D L Chao M P Davenport S Forrest and A S Perel-
son Eur J Immunol 35 3452 2005
16 A Kosmrlj A K Jha E S Huseby M Kardar and
A K Chakraborty Proc Natl Acad Sci USA 105
16671 2008
17 A Kosmrlj A K Chakraborty M Kardar and E I
Shakhnovich Phys Rev Lett 103 068103 2009
18 A Kosmrlj E L Read Y Qi T M Allen M Altfeld
S G Deeks F Pereyra M Carrington B D Walker
and A K Chakraborty Nature 465 350 2010
19 H N Eisen and A K Chakraborty Proc Natl Acad
Sci USA 107 22373 2010
20 S Miyazawa and R L Jernigan J Mol Biol 256 623
1996
24 D Naeher M A Daniels B Hausmann P Guillaume
I Luescher and E Palmer J Exp Med 204 2553
2007
25 S G Deeks and B D Walker Immunity 27 406 2007
26 S A Migueles M S Sabbaghian W L Shupert M P
Bettinotti F M Marincola L Martino C W Hallahan
S M Selig D Schwartz J Sullivan et al Proc Natl
Acad Sci USA 97 2709 2000
27 J Bhalerao and A M Bowcock Hum Mol Genet 7
1537 1998
28 D Chessman L Kostenko T Lethborg A W Purcell
N A Williamson Z Chen L Kjer-Nielsen N A Mif-
sud B D Tait R Holdsworth et al Immunity 28 822
2008
