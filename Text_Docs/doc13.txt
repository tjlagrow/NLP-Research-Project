A dynamical model of the adaptive immune system
eects of cells promiscuity antigens and B-B interactions
Silvia Bartolucci1 and Alessia Annibale 12
1 Department of Mathematics Kings College London The Strand London WC2R 2LS UK
2 Institute for Mathematical and Molecular Biomedicine Kings College London Hodgkin
Building London SE1 1UL UK
Abstract We analyse a minimal model for the primary response in the adaptive immune system
comprising three dierent players antigens T and B cells We assume B-T interactions to
be diluted and sampled locally from heterogeneous degree distributions which mimic B cells
receptors promiscuity We derive dynamical equations for the order parameters quantifying the B
cells activation and study the nature and stability of the stationary solutions using linear stability
analysis and Monte Carlo simulations The systems behaviour is studied in dierent scaling
regimes of the number of B cells dilution in the interactions and number of antigens Our analysis
shows that i B cells activation depends on the number of receptors in such a way that cells
with an insucient number of triggered receptors cannot be activated ii idiotypic ie B-B
interactions enhance parallel activation of multiple clones improving the systems ability to ght
dierent pathogens in parallel iii the higher the fraction of antigens within the host the harder
is for the system to sustain parallel signalling to B cells crucial for the homeostatic control of cell
numbers
Contents
1 Introduction
2 The model
21 Dynamical equations                                  
3 Overview of results
4 Eects of receptors promiscuity
41 A toy model with two B-clones
                           
42 The case of P B clones with a variable number of receptors             
421 Bifurcations near the critical temperature and stability region in the regime
of competing clones
                             
Sequential B-clones activation critical temperature and interference eects
                             
423 Numerical examples
5 Idiotypic interactions
51 Dynamical equations for two B clones                         
52 Generalisation to P clones                               
521 Linear stability analysis and phase diagram                 
6 Antigen eect
7 Conclusions
8 Acknowledgements
1 Introduction
The immune system is a complex collection of organs tissues and cells which is present in all
vertebrates and protects the organism from external pathogens 1
In this work we introduce
a minimal model to describe the primary response of the adaptive immune system a network
of highly specialised cells that produces a targeted reaction to specic antigens ie viruses
The main players are B and T cells two dierent types of lymphocytes They independently
recognise the antigen binding it with their receptors g 1 Each group of T and B cells sharing
the same receptors structure clone is able to recognise and ght only a particular virus with
complementary epitope
The immune response by B cells is activated or suppressed according to a conrmation signal
sent by T cells in the form of excitatory or inhibitory proteins the cytokines Such response
when activated consists in the secretion of antibodies proteins able to chemically bind and
neutralise the antigen hence possibly avoiding the propagation of the infection This two-
signals mechanism prevents erroneous B cells activations against mismatching antigens or other
cells of the organism
In recent years this system composed by a large number of interacting agents - T B cells
and antigens - has been looked at through the prism of statistical mechanics to understand its
global features and functionalities 2 3 4 5 Following this promising line of research we propose
here a model for the dynamics of T and B cells and antigens extending preliminary proposals see
5 6 and references therein to incorporate important biological features of real immune systems
In particular we study the eect of having B cells with a variable number of receptors on their
surfaces one of the most important mechanisms preventing autoimmune reactions and diseases
a receptor editing process is indeed very commonly observed during the B cell maturation where
self-reactive cells which may be responsible for the onset of autoimmune responses are suppressed
at an early stage of the development by changing the number of receptors 7 We also introduce
interactions between B cells the so-called idiotypic network rst hypothesised by Jerne 8 B cells
receptors can not only recognise antigens but also other B cells with complementary receptors
In the presence of an antigen antibodies with complementary receptors called idiotypes and
denoted with Ab1 are produced and recognised by complementary antibodies Ab2 which share
structural features with the original antigen According to recent experimental studies 9 10 11
the idiotypic network seems to play a central role in autoimmune diseases supporting a cascade
of autoantibodies production which recognise each other and modulate the immune response
Finally we incorporate the eect of an external antigenic eld to investigate the immunological
memory 12 ie the ability of the immune system to produce a more eective and faster response
at a second encounter with an antigen
From a statistical mechanics perspective this system is modelled as a bipartite network where
links between B and T-cells are sparse as biologically required We introduce a phenomenological
Hamiltonian description of the system and carry out a dynamical analysis of the network evolving
via a Glauber sequential update Via non equilibrium statistical mechanical techniques initially
Figure 1 Schematic representation of the antigen recognition process and immune response
activation by T and B cells The best-matching B and T cells independently detect the antigen
the active T clone sends excitatory cytokines green links to the B clone to start the antibodies
production and suppress the non-complementary B clones with inhibitory signals red The other
T cells are in a quiescent state
developed for Hopeld neural networks and spin glasses 13 14 15 16 17 we derive the equations
for the time evolution of a set of parameters quantifying the immune response strength We
analyse the systems behaviour in dierent regions of the parameters space ie number of
clones and triggered receptors noise level etc through linear stability analysis and Monte Carlo
simulations The paper is structured as follows in Sec 2 we dene the model in Sec 3 we give
an overview of the results that we derive in Sec 4 5 and 6 We summarise our conclusions in 7
2 The model
We model T-cells as binary variables or spins i  1 i  1     N  which can be active
ie secreting cytokines 1 or quiescent 1 B cells and antigens are characterised via their
concentration respectively b  R   1     P and a  R a  1     A with respect to a
reference level Both the number of B clones and the number of antigens are sub-linear in the
system size N  with P  N    0 1 and A  N a a  0 1 In the absence of antigens and
interactions with T cells the B clone sizes b can be regarded as Gaussian variables 12 Without
loss of generality we take their mean to be zero and we denote by A1 their covariance matrix
The interactions between the i-th T clone and the -th B clone mediated via the cytokines are
i  11 0 respectively corresponding to excitatory inhibitory
represented by the variables 
or absent signals We will regard those as random variables drawn from
cid19
where the qs are drawn from a distribution Pq  P 1cid80
cid20 q
1  q
cid0
cid89
cid18
cid1 
cid21
P  
i 1  
i 1
q  ON 0 
 qq and control the degree of B
cells promiscuity ie their ability to communicate with dierent T cells via dierent receptors
TTTTBBBBYYYYYYYYYYYYYYYAAfor   0
The fraction of non-zero B-T links determines the degree of dilution of the system
the system is nitely diluted whereas for   0 the system is extremely diluted The combined
interacting system of B-T cells and the antigens can be phenomenologically described by the
following Hamiltonian
H b   Pcid88
cid32 Acid88
a
a  N 1
bAb
cid33
Ncid88
Pcid88
1
The rst term takes into account the interactions between antigens and B cells via the matrix
a  the second term is related to B - T interactions mediated by cytokines the third one takes
into account the eect of the idiotypic network B-B interactions g 2 B-B interactions are
mediated via A  A according to the theory of idiotypic interactions 8 20 B clones can
recognise not only antigens but also antibodies with complementary epitopes creating a network
of imitative interactions between B cells We represent epitopes as binary strings and assume
that complementary strings like eg 010    and 101    excite each other Also we assume that
we can order the strings on a ring in such a way that each string sits close to ane strings and
opposite to complementary ones g 3 right Hence we suppose that the -th B clone expansion
is triggered by the   P2-th B clone which is precisely complementary to that B clone g
3 left While complementary B cells excite each other we assume that each B cell suppresses
itself to prevent uncontrolled production of a single cell type Therefore we are led to use for the
B-B interactions the Toeplitz matrix
A    kP2 mod P 
with k  0 1 representing the strength of idiotypic interactions Its inverse is
A1 
1  k2  
1  k2 P2 mod P 
We note that A is positive denite and symmetric and the following relations hold A  A
with An  P   An and An  An The eigenvalue spectrum a of A has a nite limit
as N   ensuring the correct scaling of the Hamiltonian B-antigen interactions are taken
into account via the matrix 
a  antigens will excite complementary B and they will repress the
identical one in a similar way as B clones detect and excite each other as shown in g 4 We
can further investigate the B-Antigen interactions analysing the stochastic process that governs
the dynamics of B cells concentration Assuming that the B cells concentration evolves according
to a gradient descent on the Hamiltonian 2 we have
Acid88
Ncid88
  H
 noise 
a
a  N 1
i i  1
Pcid88
Ab  noise
Denoting with  the concentration of the antigen complementary to the b clone we need the b
concentration to increase when  cid54 0 Also we assume that clone bp2 complementary to b
and thus carrying the same epitope as antigen  is inhibited by the presence of antigen  and
we denote k1 the strength of this inhibition This leads to a matrix for the B-Antigen interaction
in the form
a  a  k1aP2 mod P
According to 5 the concentration of the -th clone also increases in the presence of excitatory
signals received by T cells second term while the third suppressive term is related to B-B
interactions acting as a threshold to be overcome to start the immune response Assuming that
the total B clones concentration is conserved on average leads to a relation between k and k1
cid88
b  0  1  k1
1  k
cid80
 bcid80
which depends on the steady state concentrations of B cells and antigens and on the inverse noise
 For simplicity we will set k  k1 which leads to   A and to an equilibrium ratio
between B cells and antigens concentration only controlled by the noise level in the system
Figure 2 Schematic interactions between B T cells and the antigen A In the presence of an
antigen with concentration  the complementary B cell will detect it B-A interactions mediated
via the matrix  and will receive a conrmatory signal from the active T cells represented by up
arrows via the cytokines 
21 Dynamical equations
At equilibrium at inverse noise level
expect the joint distribution P  b to be given by the Boltzmann distribution
 consistent with our assumption b  N 0 A1 we
Hb
e
cid90
P  b 
P  
Zcid48 e
The equilibrium marginal distribution for the  is found by integrating out the variables b
a N 1cid80
a a
 bcid80
cid80
cid80
cid80
ij ij
cid20
N 21
i i 1
cid80
ia iacid80
j N 1cid80
 bA b
 
i A1 
 
a A1 
cid21
TBBYYT cellsB cellsAAntigenTFigure 3 Left B-B interaction via A The expansion of the -th clone is triggered by its
complementary clone Right We represent the epitopes as binary strings organising them on a
ring and assuming that the complementary strings interact
Figure 4 Scheme of B-B and B-A interactions Antigens and B cells are denoted by variables
0 1 representing the shape of their receptors 0  1 variables represent complementary receptors
key-lock mechanism Dierent B cells excite each other and each of them represses itself while
the antigen will excite complementary B repressing the identical one 0-0
in the Boltzmann form with eective Hamiltonian H involving only interactions between T
N 21cid88
cid88
H  1
j  N 1cid88
iacid88
i A1
a A1
with the separable form Jij  N 21iA1j where i  1
i  and thus describing
an associative network with diluted patterns  encoding ghting strategies against dierent
antigens 6 In the regime we consider here   1 the associative network is away from saturation
Analysis near saturation have been carried out in statics for A  1 mostly for Pq  q  c
18 19 We can rewrite the Hamiltonian 10 as
i      P
H  1
MT A1M  T A1M
BYBY  P2----11011000YB cellAntigen00Y--1in terms of the order parameters M  M1     MP  where
M 
N 1
Ncid88
i
quanties the strength of the excitatory signal on B clone  and thus its activation Here
  1     P  and we denotes vT the transpose of v Next we assume a Glauber
sequential dynamics for the variables  converging to the equilibrium measure P  so that
the instantaneous probability of nding the system in state   1     N  at time t is governed
by the master equation
Ncid88
cid2PtFiwiFi  Ptwicid3 
Pt
where Fi is the i-th spin-ip operator Fi1  i  N   1 i N  and transition rates
between  and Fi have the Glauber form
1  i tanh he
wi 
i  
with eective eld
i  N 1cid0MT A1i  T A1i
cid1
ensuring convergence to 9 Here T  1 represents the rate of spontaneous spin-ip hence the
eective noise of the T cell dynamics Using 13 we write the dynamics for the B cells activation
described by the probability of nding the system in a macroscopic state M at time t namely
PtM 
PtM  M
Via a Kramers-Moyal expansion for large system size and away from the saturation regime it is
possible to show that PtM evolves according to a Liouville equation 6 It follows that M evolve
deterministically with a dynamics described by
cid88
T tanhcid2cid0MT A1  T Ccid1cid3cid29
cid28
cid21cid29
cid28
cid20
MT A1  T 
 tanh
 M 
where C  A1 and cid104  cid105 denotes the average over the distribution 1 For  dened in 6
and k  k1 we have C  1 and each order parameter M evolves accordin
Dierent choices of the matrix  or of the constants k k1 will lead to dierent forms of the matrix
C however the choice C  1 seems to ensure the strongest excitatory signal to antigen-activated
B clones As an illustration let us consider the simple case where we have just one antigen ie
1 for the choice C  1 the eld acting on the i-th T cell exciting the complementary clone b1 is
1 hence i receives an activation signal only from the clone B activated by the antigen With two
antigens present whose complementary B cells are signalled by dierent cytokines from the same
Figure 5 Left eect of having C  1 in the presence of two antigens whose complementary
B cells are signalled by dierent cytokines from the same T cell the eld acting on the T cell
is 1  2 and T gets activated only if 1  2 Right an illustration of the eect of having
C  A1 which may result in an inhibitory signal on T cells from inactive B cells
T cell the eld acting on the latter is 1  2 and the T cell will get activated only if 1  2 as
biologically desired g 5 left For C cid54 1 there might be a negative interference on the desired
signal For example for the alternative choice   1 leading to C  A1 the eld acting on T
in the presence of a single virus 1 cid54 0 would be 1
2  meaning that for 1  1
2  1 the T cell would receive besides the excitatory signal from the B cell activated by the
antigen an inhibitory signal from a non-activated B-cell g 5 right As a result the overall
eld and immune response will decrease Similar arguments can be given for  dened in 6 with
k1 cid54 k
i  k1 P
1k2 1
3 Overview of results
The sparsity of the B-T connections makes the system able to activate multiple B clones in
parallel This multitasking capability is one of the core features of the immune system that
in normal conditions can control and block several simultaneous antigenic invasions We nd
that the parallel activation of B clones may occur in symmetric fashion where all infections are
fought with the same strength or in a hierarchical fashion where the system prioritises immune
responses against specic pathogens We are able to identify the systems parameters such as
noise number of links number of dierent infections which induce the switch from the symmetric
to the hierarchical operational mode This might be potentially useful to investigate the causes of
dramatic failures in the functioning of the immune system The switch to a hierarchical immune
response is in fact mostly related to the presence of strong infections such as hepatitis and
autoimmune disorders while the immune system invests the highest amount of resources tackling
the main disease the progression of minor infections may become lethal 21 22
An important feature of the model is the dependence of the B cells activation on the number of
receptors on their surface Results in Sec 4 show that cells with few receptors may be transiently
activated but fail to sustain the signal even if strongly excitatory g 6 The number of triggered
receptors aects both the immune response strength and the critical temperature at which they
get activated both decrease with the number of triggered receptors In addition competition
BBB cellsAAntigen1TT cellsA212BBB cellsAAntigenTT cellsemerges between B clones to be activated As the number of activated B clones increases signalling
pathways to inactive clones get more noisy due to the interference of active clones The critical
temperature for the activation of inactive clones is a decreasing function of the fraction of active
clones 73
Another result of biological interest is that idiotypic ie B-B interactions contribute to the
overall stability of the immune system preventing unwanted activation and increasing the region
where all clones are equally activated and ready to start an immune response upon arrival of
new infections Sec 5 In particular including B-B interactions in the model aects the critical
temperature in this case widening the region where a symmetric immune response is stable as
the interactions strength k is increased g 22
Finally the role of antigens in B cells activation is understood by our model as that of
external elds on coupled ferromagnetic systems 6 One of the interesting consequences is then
the presence of hysteresis phenomena 23 which could explain short-term memory eect in the
immune response 12 24 even in the absence of memory cells The eect of antigens on the
immune system basal activity and surveillance is also of interest the response of non-infected B
clones decreases with the fraction of infected clones due to the interference of strongly activated
B cells and is activated at a lower T  making the whole system unresponsive to new incoming
viruses g 23
4 Eects of receptors promiscuity
We rst consider the case where there is no antigen a  0  a and no B-B interactions ie A  1
and focus on the eect of having a variable number of triggered receptors on dierent B clones
ie heterogeneous q in 1 In order to compare activation of B clones with dierent numbers
of receptors it is convenient to look at the activation per receptor given by the normalised order
parameters m  Mq   1     P  which take values in the range 1 1 for all clones 
The dynamical equations 18 then read
 tanh
qm
 m 
One can show that at the critical temperature Tc  qmax where qmax  maxq the system
undergoes a phase transition with the equilibrium phase at T  Tc characterised by m  0 and
B clones activation occurring at T  Tc where m cid54 0 At the steady state dmdt  0 we have
M  N cid104 tanh
Mcid105 
cid32
cid88
cid33cid29
Taking the scalar product with M and using the inequality  tanh x  x yields
M2  N 
Mcid104cid105  
  qmaxM2 
cid88
This implies M2  0 hence m  0 for qmax  1 meaning that none of the B cells can get
activated for noise levels above the critical value T  qmax Although m  0 is a steady state
cid28
cid88
cid88
cid88
solution of 19 for any value of T  a linear stability analysis shows that it becomes unstable for
T  qmax To this purpose we compute the Jacobian of the linearised dynamics about the steady
state mcid63  0
 m 
q cid104 tanh
qmcid105  m
Pcid88
cid12cid12cid12cid12mmcid63
J 
F 1
which gives
cid88
N q
cid1041  tanh2
qmcid63
cid105  
J 
Substituting mcid63  0 we get J  q  1 This is a diagonal matrix hence the largest
eigenvalue which gives the stability of mcid63  0 is max  qmax  1 This gets positive for
qmax  1 showing that non-zero solutions m cid54 0 will bifurcate away from m  0 at T  qmax
We inspect the structure and the stability of the bifurcating solutions rst for a toy model with
just two B-clones and then for the general case with P B-clones
41 A toy model with two B-clones
Here we study a toy model with P  2 B clones and assume q1  q2 For   0 this model reduces
to two independent Curie-Weiss ferromagnets with critical temperatures q1 and q2 respectively
see discussion in Sec 42 Hence the most interesting case is obtained for   0 The state
mcid63  0 0 is the only steady state of the system for T  q1 but it destabilises for T  q1
We can understand the systems behaviour below criticality by solving numerically its dynamical
equations
 1  q2 tanhq1m1 
 1  q1 tanhm2 
tanhq1m1  q2m2  tanhq1m1  q2m2  m1 
tanhq1m1  q2m2  tanhq1m1  q2m2  m2 
In g 6 we show the ow diagram and the stable xed points at dierent temperatures rst we
notice that B cells with a higher promiscuity produce a higher immune response m1 whereas
a lower promiscuity q results in a lower or null activation m2 depending on the temperature
Hence the number of receptors on B cells surface aects the responsiveness of B clones
particular
if T is high only clones with the highest number of receptors are activated and
the systems xed point corresponds to the pure state m1 cid54 0 m2  0 Lowering T induces
the activation of cells with fewer receptors but with a lower intensity m1  m2 Theoretical
results are consistent with Monte Carlo simulations shown in g 7 Furthermore Monte Carlo
simulations match experimental results 25 showing that cells with very few receptors are triggered
transiently but fail to be activated in the long run since the number of receptors is not sucient
to allow these cells to sustain the signal even if strongly excitatory Fig 8 shows that our model
can reproduce this eect cells with few receptors green have a lower activation even if triggered
by a strong signal initial condition and tends to be switched o after a short transient conversely
cells with a higher number of receptors blue produce a strong immune response even if triggered
by a low signal initial condition Analytically we can investigate the structure of the rst states
Figure 6 Phase portrait of the dynamical system 24 25 for q1  06 q2  04 at low
temperature T  001 left and high temperature T  02 right Red lines represent null-clines
and stationary states are at the intersection of null-clines
Figure 7 Monte Carlo simulations with 104 spins for q1  06 q2  04 at low temperature
T  001 left and at high temperature T  02 right Markers represent the numerical solutions
of 24 25 
to bifurcate below Tc by expanding the steady state equations obtained setting dm12dt  0 in
24 25 for small m1 m2 close to criticality ie at q1  1   We get as possible solutions
1  3  3
1    3
as well as m1  0 m2  0 Solution 27 is unphysical as it stays O1 at   0 for q1 cid54 q2 hence
m2  0 Inserting m2  0 in 26 we get m2
1  3 Hence the rst state bifurcating away from
cid4510cid4505000510cid4510cid4505000510m1q1m2q2cid4510cid4505000510cid4510cid4505000510m1q1m2q2q1m1-06-04-020020406q2m2-02-0100102q1 m1-06-04-020020406q2m2-01-005000501Figure 8 Monte Carlo simulations with N  104 spins with q1  06 q2  04 at T  02 Clone
activation m1 m2 as a function of time for dierent initial conditions Cells with few receptors
q2 green fail to be activated even if triggered with a strong signal
m  0 0 is in the form m  
3 0 At high temperature below criticality only the clone
with the higher number of receptors is switched on For q1  q2 we clearly retrieve the results
in 6 and both B clones are activated with the same intensity below criticality Next we derive
the region in the phase diagram where cells with fewer receptors become responsive Naively one
might expect that m2 becomes active at T cid39 q2 In reality heterogenities in the cell promiscuities
deeply aects cell responsiveness and cells with fewer receptors will remain quiescent even at very
low T  By Taylor expanding 19 for small m2 in powers of   q2  1 we obtain
cid19
cid18 q1
m1  tanhq1m1 cid39 tanh
2  3  3
Since m1 is O1 the non-zero solution for m2 is impossible close to T  q2 The pure state
m  m1 0 will then have a wider stability region that can be found by analysing the eigenvalues
of the Jacobian 22 at mcid63  m1 0
1  q1  q1 tanh2q1m1  1 
2  q2  q1q2 tanh2q1m1  1 
Analytically we can calculate 12 near T cid39 0
1 cid39 1 
2 cid39 q2  q1q2  1 
and near Tc ie at q1  1  
1 cid39 2 
2 cid39 q2  q2  3q1q2  q1
 O2 
0246810121416182001001020304050607tm  For intermediate T we compute 12 numerically Plots of eigenvalues as a function of the
Figure 9 Eigenvalues 31 as a function of T for q1  08 and q2  07 Left 1 the red dashed
line represents the behaviour near T cid39 Tc 35 Right 2T  the red marker represents the limit
at T cid39 0 33
temperature are shown in g 9 where the theoretical predictions for T cid39 0 33 and T cid39 Tc
35 are highlighted We note that 1  0 T  hence the stability of the pure state is determined
by the sign of 2 In g 10 we show a contour plot of 2  0 in the T  q2 plane for dierent
values of q1 The linear behaviour can be understood as follows In the pure state region we have
Figure 10 Phase diagram in the space T q2 xing q1  08 obtained from the condition 2  0
31 The dotted line represents the theoretical critical temperature 38 In the PS region the
pure state is stable m1 cid54 0 m2  0 At low T  B clones are hierarchically activated H
using the steady state equation m1  tanhq1m1
1  q11  m2
2  q21  q1m2
1  1 
1  1 
As T decreases below q2 m1 increases so that the eigenvalues stay negative and stability is
ensured until m1 reaches its maximum value m1  1 At this point a further decrease of the
02040608Tcid4510cid4508cid4506cid4504cid45021cid230cid23002040608Tcid4502cid4501012TPSH00020406080002040608Tq2Figure 11 Plot of m1 m2 as a function of q2 Left  q1  08 at T  q2 Right q1  08
T  001 005 01 03
temperature will make 2 positive destabilising the pure state and a new state m1 m2 will take
over The temperature at which bifurcations from the pure state are expected is thus found from
the condition 2T m1  1  0 as
T  q21  q1
which is in agreement with the critical temperature computed numerically g 10 Deviations
from the linear behaviour are expected in the regime q1 cid39 q2 where a symmetric activation occurs
for q1  13 6 In g 11 we plot m1 m2 as a function of q2 in the PS region left and crossing
the critical line where m2 becomes non-zero right In the latter region ie for q2  T 1  q1
the stable state is m  1 m2 where m2 is the T -dependent stationary solution of 25 at m1  1
In particular for T  0 the stable state is
m1  1 
m2  1  q1 
in agreement with simulations and ow diagrams g 6 7 In conclusion the system can activate
clones with dierent numbers of receptors simultaneously for T  q21  q1 The activation is
hierarchical H with clones with higher promiscuity being prioritised with respect to the others
In particular clones with the highest number of receptors are activated with the strongest possible
signal in a wide region of the phase diagram
42 The case of P B clones with a variable number of receptors
Next we study the case where the number of B clones is P  N  where   0 1 and N is the
number of T-clones The dynamical equations are
which can be rewritten as
qm
 m 
cid28
cid28
cid32
 tanh
cid32
cid88
cid88
cid54
cid33cid29
cid33cid29
qm 
qm
 m 
cid540
02040608q20204060810mm2m102040608q20204060810mm2Tcid6103m2Tcid6101m2Tcid61005m2Tcid61001m1Upon introducing the noise distribution Pzm q  cid104z cid80
cid90
cid54 qmcid105 on clone  we
dzPzm tanh qm  z  m
where Pzm q can be written using the Fourier representation of the Dirac delta and
carrying out the average over  as
Pzm q 
ei q mcid105 
cid54
N  cosq m 1 44
cid90 
cid80
cid90 
eizcid104 Pcid89
cid54
If   0 extending the sum in the exponent to all patterns will add a negligible contribution in
the thermodynamic limit hence as N   all clones will have the same noise distribution
Pzm q  PP zm q  cid104z  Pcid88
qmcid105
We note that the sum on the RHS of 45 is at most O N  hence for    it is negligible
in the thermodynamic limit This yields PP zm q  z as N   so that equations 43
decouple and the system reduces for    to a set of indipendent Curie-Weiss ferromagnets
each evolving according
 tanhqm  m
At the steady state each B clone  becomes active at its own critical temperature Tc  q
In contrast for    the noise distribution
independently of the other clones g 12 left
PP zm q has a nite width due to clonal interference and the equations for the evolution of
clonal activations are coupled In this regime clones compete to be activated and the ones with
fewer triggered receptors will fail to be switched on g 12 right In the following section we
will analyse the eect of receptors heterogeneity in the regime of competing clones We will show
that clonal interference aects both critical temperature and intensity of B clones activations
421 Bifurcations near the critical temperature and stability region in the regime of competing
clones
In this section we study the bifurcations away from m  0     0 below the critical
temperature Tc  qmax Without loss of generality we assume qmax  q1 We Taylor expand the
steady state equations obtained by setting dmdt  0 in 41 for small m at q1  1  
Pcid88
m cid39 N 
qcid104cid105m  N 
qqqcid104cid105mmm 
 qm  3q3
  
N  m
For any  m  0 is always a solution Non-zero solutions are given for   1 by
q1  1  3q3
N  m2
1  3
N  q1
Pcid88
cid54
Pcid88
Pcid88
Figure 12 Monte Carlo simulations with N  104 spins q  q T  001   07 q1  6
Left   02   025 In the non-competing regime    all clones are activated Right
    025 In this case only few clones with the highest number of receptors are active
that at q1  1   and for large N yield
1  3  3
For  cid54 1 we have
Pcid88
q  1  3q3
N  m2
which gives for N   and to O0
1  3
cid19
Pcid88
1q  q3
cid18
Summing over   1 we get
Pcid88
Pcid88
N  q
  3
Pcid88
cid18 Pcid88
  ON 
cid19
q  q1
Since q  q1   1 this equality can never be satised showing that m  0  1
Substituting this result into 50 we nd m2
1  3 hence the rst state to bifurcate away
from m  0     0 is m  
3 0     0 Next we calculate the region where the pure state
m1 0     0 stays stable by inspecting the sign of the eigenvalues of the Jacobian of the linearised
equations of motion about the steady state
For a steady state with the general structure m  m1 m2     mn 0     0 where n is the
fraction of activated clones the Jacobian 23 has a block structure where diagonal terms are
t05101520m-1-05005105101520020020406081tmfor   n
and for   n
J  q1  cid104tanh2qm 
ncid88
cid54
qmcid105  1
J  q1  cid104tanh2
qmcid105  1
while o-diagonal elements are for    n
ncid88
ncid88
J  q
N  cid104tanh2
qmcid105  1
and J  0 otherwise For N   the matrix becomes diagonal with eigenvalues   J given
by 54 for   n and 55 for   n In the pure state mcid63  m1 0     0 where only one clone
is activated we have
1  q11  cid104tanh2q1m1cid105  1 
  q1  cid104tanh21q1m1cid105  1
  1 
Near the critical temperature Tc  q1 setting q1  1   and using m2
1  q1  1  3m2
1  2  0
1qcid1042
  q  1  3q2
1cid105  1  
showing that for q  q1 the pure state is stable near criticality as opposed to the case q  q1
studied in 6 where all clones are activated with the same intensity below Tc In the opposite
limit T  0 we get from 57 58
1 cid39 3 gives
 1 cid39 q  1 
cid18
1 cid39 1 
 cid39 q
1  q1
cid18
1cid89
1  qj
cid19
cid19
showing that the pure state is unstable at low temperature
In particular at T  0 we expect all clones to be activated
Indeed as the temperature is lowered below q1 we expect clones with fewer receptors to
get active
in a hierarchical
fashion whereby the system sends the highest possible signal to the clone with maximum number
of receptors the clone with second highest number of receptors is signalled by the remaining
N  q1N 1 spare T cells and so on This leads to the following heuristic rule for noiseless clone
activations
  1     P
in agreement with Monte Carlo simulations shown in g 13
Figure 13 Monte Carlo simulations with N  104 spins q  q T  0001   07 q1  6
    025 The markers represents the theoretical predictions at T  0 63
422 Sequential B-clones activation critical temperature and interference eects
In this section
we calculate the critical temperature at which clones   2 with fewer receptors get activated
We focus on the the regime of clonal interference    as for    each clone  gets active at
its own critical temperature T  q Without loss of generality we can set P  N  for   
where   1 for    and    for    In the following we will consider q1  q2    qP 
Assuming that m bifurcates continuously from the pure state we can Taylor expand 41 at the
steady state for small m with  cid54 1 while m1  O1 For  cid54 1 we have
1q1m1 
qm
cid28
 tanh
cid32
cid32
Pcid88
cid28
Pcid88
 tanh
qm
cid33cid29
 ON
cid540
Pcid88
cid33cid29
Pcid88
Pcid88
cid54
cid39 
qcid104cid105cid540m  3
cid104cid105cid540mmmqqq 
cid39 qm  3q3
cid54
  3qm
Pcid88
  3q
cid54
The solutions are m  0 or
1  q  3q3
Hence for 1 q  0 m  0 while for 1 q  0 the -th clone may be activated Hence the
rst state to bifurcate away from the pure state is m  m1 m2 0     0 at T  q2 Its amplitude
0510152000102030405060708091tmPcid88
Pcid88
cid32
cid32
at q2  1   is
2 cid39 3  3q3
2N  m2
cid32
cid28
2  3ON As T is lowered below q2 we expect that the clones will activate sequentially
ie m2
one after the other each one at its own temperature In particular assuming m12  O1 we
have for   2
 tanh
and expanding for m2 small at T  q2 shows that m3 becomes non-zero at T  q3  ON
Generalizing for n cid28 N  activated clones m1     mn  O1 we have for   n
cid540
qm
 ON
 tanh
qm
giving as bifurcation temperature Tn  qnOnN As the number of activated clones increases
their cumulative eect on the activation temperature of the remaining clones increases and can no
longer be neglected for n  ON  The activation temperature of pattern n  1 when n  N 
clones have been activated can be worked out from
cid540
 OnN
that gives upon insertion ofcid82 dzz cid80n
cid20
qn1mn1 
qm
1 qm  1
dzPnzm q tanhqn1mn1  z 
with Pnzm q dened in 45 Taylor expanding for mn1 small we have to leading orders
dzPnzm q
1  tanh2zqn1mn1  Om2
where we have used Pnzm q  Pnzm q A solution is mn1  0 and a non-zero solution
is possible for
cid21
cid33cid29
cid33cid29
ncid88
cid28
cid28
cid90
cid90
cid33cid29
qn1 
For n cid28 N  Pnzm q  z and we retrieve qn1  1 for the temperature at which mn1
becomes non-zero For Pnzm q having a small but nite width we can use tanhz cid39 z
1 cid82 dzPnzm q tanh2z
qn1 cid39 1 
cid39 1 
cid104z2cid105
cid80n
1 q3
n1N 
showing that Tn1  qn1 and deviations from qn1 depend on the promiscuity distribution of
the activated clones Equation 73 shows that as more clones are activated these create an
interference encoded in Pnzm q that decreases the activation temperature of the inactive
ones Furthermore it suggests that the number n of clones that the system can activate ie the
number of O1 order parameters m at small but nite temperature is ON 
In this section we test 73 and look at the eect of receptors
423 Numerical examples
heterogeneity on the intensity of B clones activation for three simple cases that can be treated
analytically with q1  q2 and P  N 
i q  q1 q2     q2 only one clone has a higher number of receptor
ii q  q1     q1 q2     q2 half of the clones have promiscuity q1 and half have promiscuity
iii q  q1     q1 q2 only one clone has a smaller number of receptors
Our goal is to analyse the increasing interference eect due to the activated clones with more
receptors on the quiescent ones with less receptors According to 73 active clones should play
the role of interference terms that lower the critical temperature of the quiescent clones
i Clones with the same number of receptors will be activated with the same intensity 6 and
the activation vector bifurcating away from the pure state will have the form see Sec 521
for a rigorous derivation m  m1 m2     m2 The amplitudes m1 and m2 are found from
cid32
cid28
1 tanh
cid32
1q1m1  q2
m
cid33cid29
Pcid88
cid33cid29
Pcid88
q1m1  q2m2
PP1zq tanh q1m1  q2m2z
PP2zq tanh q11m1  q2m21  z
PP2zq tanh q2m21  z  ON
cid28
cid88
cid88
cid88
cid88
Pnzq  cid104z  ncid88
cid105
Using 44 we can write PP zq  eq2Izq2 where Izx is the modied Bessel function
of the rst kind 26 and PP1zq cid39 PP2zq cid39 PP zq The activation temperature of
the clones with smaller promiscuity follows from Taylor expansion of 76 for small m2 giving
PP2zqq2m21  z  1
q2m231  z3  ON
 q2m2  1
 q2m2  1
q2m231  3cid104z2cid105  ON
q2m231  3q2  ON
where we used the parity of Pnzq  Pnzq  n and cid104z2cid105 cid80
z PP zqz2  q2 We
retrieve q2  1  ON for the activation teperature of m2 consistently with 73 for
n  1 The activation intensity at q2  1   follows from 78 as
1  3q2
as one expects for homogeneous clones in the absence of clone   1 6 In g 14 we plot
the amplitudes m1 m2 resulting from 75 76 as a function of the temperature left and
those resulting from Monte Carlo simulations as a function of time right The latters are
seen to relax to the theoretically predicted steady state A contour plot of m2  0 in the
Figure 14 Left steady state solutions m1 m2 of the dynamical system 75 76 as function
of the temperature T  for q1  08 q2  04 Right Monte Carlo simulations with N  104 spins
    025 T  03 q1  08 q2  04 The markers are the theoretically predicted steady state
activations 75 76
T  q2 plane computed numerically from 76 is shown in g 15 Deviations from the line
T  q2 are consistent with nite size eects N
In conclusion the presence of one clone with a higher number of receptors does not aect
in the thermodynamic limit the activation temperature nor the activation intensity of clones
with fewer receptors
ii In this case we expect a transition from the state m  m1     m1 0     0 to m 
m1     m1 m2     m2 with
cid88
cid88
PP2z1qPP2z2q tanhq1m11  z1  q2m2z2 
PP2z1qPP2z2q tanhq2m21  z2  q1m1z1 
The temperature at which the on-set of non-zero m2 occurs is found by Taylor expanding
0204060810T0204060810mm2m105101520080604020020406081tmFigure 15 Contours of constant m2 with q  q1 q2     q2 The contour indicating the on-set
of a non-zero value of m2 is very close to the blue dotted line T  q2 theoretically predicted
Deviations are within nite size eects ON
80 for small m2 with m1  O1
cid88
PP2z1qPP2z2qcid2tanhq1m1z1  1  tanh2q1m1z1q2m21  z2  Om2
2cid3
cid88
PP2z1q1  tanh2q1m1z1
 q2m2
giving m2 cid54 0 for
1 cid80
z PP2zq tanh2q1m1z
The theoretically predicted critical line 82 is in excellent agreement with the contour plot
of m2 cid54 0 in the T  q2 plane shown in g 16 left computed numerically from 80
The plot shows that in the presence of ON  clones with higher numbers of receptors the
activation temperature of those with smaller promiscuity q2 will deviate from the line T  q2
iii This is the case where deviations from the line T  q2 are expected to be largest From 41
cid32
cid28
1 tanh
cid32
we have
cid28
cid88
cid88
cid33cid29
Pcid88
cid33cid29
1q1m1 
qm
Pcid88
qm
q1m1 
PP2zq tanhq1m11  z  q2m2n
PP2zq tanhq1m11  z  ON
00020406080102030405060708Tq2Figure 16 Contour plot of m2 in the T q2 plane for q  q1     q1 q2     q2 left and
q  q1     q1 q2 right The blue dotted line represents the theoretical critical temperature
line computed using respectively the self-consistent equations 80 left and 83right together
with the theoretical predictions for the critical temperature 82left and 86right Deviations
from the numerical results when q2 cid39 q1 are due to the fact that 73 is obtained assuming
m2 cid28 m1 condition which is not satised when q2 cid39 q1
cid32
cid28
cid88
Pcid88
cid33cid29
q2m2 
qm
PP1zq tanhq2m2  q1m1z
cid542
When clones with fewer receptors get active we expect m1  O1 and m2 small Taylor
expanding for m2 small and using the parity of Pnzq  Pnzq  n
PP1zqtanhq1m1z  1  tanh2q1m1zq2m2  Om2
PP1zq tanh2q1m1z  Om2
cid88
 q2m21 cid88
1 cid80
we obtain for the activation temperature of the only clone with lowest number of receptors
z PP1zq tanh2q1m1z
in agreement with the contour plot of m2 cid54 0 in the T  q2 found numerically shown in g
16 right Deviations are compatible with nite size eects and are largest for q2 cid39 q1 where
the assumption m2 cid28 m1 is no longer valid Monte Carlo simulations with 10 B clones one
of which has a lower promiscuity q2  06 are shown in g 17 at T  q2 the pattern with
lowest receptors is inactive and it is activated only at a much lower temperature T cid39 02
00020406080102030405060708Tq200020406080102030405060708Tq2Figure 17 Time evolution of B clones activation in Monte Carlo simulations with 104 spins and
q  q1     q1 q2 case iii with q1  08 blue and q2  06 violet The activation for the
clone with less receptors violet decays to 0 for T  05 left and stays non-zero for T  02
right ie at temperatures considerably lower than that in the absence of clonal interference
T  q2
Figure 18 Plot of m2 as a function of T in the dierent cases 1 q  q1 q2     q2 2
q  q1     q1 q2     q2 3 q  q1     q1 q2
Increasing the interference due to clones
activated at a higher temperature the m2 intensity decreases
Finally in g 18 we plot m2 as a function of the temperature in the three dierent cases with
promiscuity i q  q1 q2     q2 ii q  q1     q1 q2     q2 iii q  q1     q1 q2
The presence of clones with higher promiscuity q1 and activation intensity m1 does not
only aect the activation temperature of clones with lower promiscuity q  q2 but also the
intensity m2 of their immune responses In conclusion clones with fewer triggered receptors
are activated at a lower temperature and will produce a weaker response than clones with a
higher number of active receptors
051015200010203040506070809tm0510152000102030405060708091tmcid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid224cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid236cid23602040608T01020304050607mcid2363cid2242cid23015 Idiotypic interactions
In this section we study the eect of the idiotypic interactions on the ability of the system to
activate multiple clones in parallel For simplicity here we will assume homogeneous receptor
promiscuities ie q  c  so that the dynamical equations 18 read
cid104 tanhc
A1mcid105  m
Matrix A is positive denite for k  0 1 and symmetric hence the free-energy of the system is
a Lyapunov function for the dynamics 27 and the system will converge to a steady state Next
we compute the critical temperature at which clonal activation emerges in the steady state
cid104 tanhc
 mA1
mA1m 
By summing overcid80
cid88
cid88
A1mcid105
mA1 tanhc
cid88
A1mcid105
using the inequality  tanhx  x and averaging over the disorder we obtain
mA1m  c
mA2m
Next we diagonalise the matrix A by means of the similarity transformation D  P1AP where
D is the diagonal matrix constructed from the eigenvalues P
1 of A and P is the matrix of
eigenvectors which is unitary ie P1  PT  since A is symmetric Hence we can rewrite the
equation above for the transformed vector v  P1m as
cid88
cid88
cid104cid88
cid88
vT D1v  cvT D2v  0
which gives cid88
cid18 v
cid192
c    0
1  1  k
2  1  k
deg1  P2
deg2  P2
yielding v  0 for c  min where min  min  The eigenvalues of A are
hence above the critical temperature Tc  cmin1  c1  k we have m  0 whereas below
criticality m cid54 0 is possible and expected Remarkably the critical temperature increases with
k meaning that idiotypic interactions enhance immune systems activation Next we investigate
the structure of the states bifurcating away from m  0 below Tc and their stability
Figure 19 Flow diagram in the plane m1 m2 left and Monte Carlo simulations with 104 spins
right for the dynamical system 95 with T  17 c  055 k  07 Tc  183
51 Dynamical equations for two B clones
As before it is useful to consider rst the toy model with P  2 clones For k cid54 0 the dynamics
of dierent clones is always coupled for all   0 We rst look at the case   0 where the
system evolves according to the equations
cid18 c
cid18 c
cid18 c
cid18 c
1  k
1  k
 1  c tanh
 1  c tanh
 tanh
cid19cid21
cid19cid21
1  k2 m1  km2
m1  m2
1  k2 km1  m2
m1  m2
cid19
cid19
cid20
cid20
1  k
cid18 c
cid18 c
1  k
m1  m2
cid19
cid19
m1  m2
The state m  0 0 is a xed point of the dynamics at all temperatures but we expect it to
become unstable below Tc  c1  k In order to inspect the structure of the bifurcating state
it is convenient to analyse the steady state equations in terms of the variables x  m1  m2 and
y  m1  m2
cid4510cid4505000510cid4510cid4505000510m1m2051015202530005000501015020250303504tm  m1 simm2 simm1m2 theoFigure 20 Flow diagram in the plane m1 m2 left and Monte Carlo simulations with 104 spins
right for the dynamical system 95 for T  065 c  055 k  07 Tc  183
cid20
cid20
 1  c
cid18 c
cid19
cid19
cid18 cx
cid19cid21
cid18 c
1  k2 x  k  1m2
1  k
cid19
cid18 cy
cid19
cid18 c
1  k2 x  k  1m1
cid19cid21
cid18 c
1  k2 x  k  1m2
1  k
1  k2 x  k  1m1
 1  c
x  c tanh
y  c tanh
 tanh
 x  k  1m12  x  k  1m1x  k  1m2
We note that x  y  0 is always a solution corresponding to m  0 0 A solution y cid54 0 is
not possible as in 97 terms O0 do not simplify Hence y  0 is the only solution implying
m1  m2 In contrast in 96 rst order terms simplify hence we can have x cid54 0 Therefore
mixtures bifurcate from m  0 0 in a symmetric fashion m  m1 1 We can compute the
Assuming continuos bifurcations we Taylor expand for small m near c  1  k ie
  c
1k  1   obtaining to leading orders
cid20
x  c x  1
c 3x3  1  c x  1  c
31  k2
x  k  1m22
 x  k  1m12  x  k  1m1x  k  1m2
y  c y  1
c 3y3 
1  c1  k
1  k
y  1  c1  k
31  k3
cid21
cid20
cid21
x  k  1m22
cid4510cid4505000510cid4510cid4505000510m1m20510152002030405060708091tm  m1 simm2 simm1 theo m2 theoamplitude m Taylor expanding 95 at the steady state near Tc for small m
m  m  1
3m3  c 3m3
yielding at   1  
or the trivial solution m  0 Flow diagrams and Monte Carlo simulations are in agreement with
theoretical predictions showing that close to criticality both B clones are activated with the same
intensity g 19 Next we investigate the stability of symmetric solutions by computing the
eigenvalues of the Jacobian
J 
F 1
 m 
cid104 tanhc
A1mcid105  m 100
cid12cid12cid12cid12mmcid63
cid88
cid88
cid18 mc
cid192cid19
1  k
A1mcid63
cid105    ON
cid182mc
cid192
1  k
cid192  
1  k
 1 
1  k
One has
J  cA11  cid104tanh2c
and substituting m  m1 1 we nd for the eigenvalues
 1  c1  c
cid18
1  k
1  tanh
1  k
c1  c
cid18 mc
1  k
2  6c
2  6c  2k  2k  4kc  4kc
These can be calculated analytically near criticality ie at c1  k  1   where
and for T  0 where
1  1 
1  k
1  3c1  k
 1 
We deduce that 1 is always negative hence the stability of symmetric solutions is determined by
2 A plot of 2 as a function of T is shown in g 21 left for xed dilution and B-B interaction
strength k The critical line where 2  0 in the T  c plane for dierent values of k is shown
in g 21 right Remarkably the region S where activation of parallel immune responses is
accomplished with the same intensity gets wider as k increases For   0 the system evolves
Figure 21 Left 2T as a function of T for c  03 and k02 The value at T  0 matches the
analytical prediction 2T  c21  k red marker Right Contour plot of 2  0 with dierent
interaction strengths k  08 k  05 k  02 in the parameter space T c The region where
clones are activated in parallel with the same intensity S becomes wider as k increases
according to the equations
cid18 c
cid18 c
1  k2 m1  km2
1  k2 km1  m2
cid19
cid19
One can show again that m  0 0 is the only xed point above Tc  c1  k and symmetric
mixtures m  m1 1 bifurcate away from m  0 0 at Tc Now however symmetric mixtures
remain stable for any T  Tc see Sec 521 with the intensity m of the symmetric activation
found from
cid19
cid18 cm
1  k
m  tanh
Hence for   0 the system reduces to independent Curie-Weiss ferromagnets even in the presence
of idiotypic interactions with the critical temperature Tc  c1 k increasing with the strength
of interactions
52 Generalisation to P clones
In this section we turn to the case of P  N  0    1 B clones Again we expect clones to
be activated at Tc  c1  k in a symmetric fashion For    we expect symmetric solutions
to be stable for all T  Tc whereas for    we expect them to destabilise at low temperature
Without loss of generality we can set P  N  with   1 for    and the cases    and
   retrieved in the limits   0 and    respectively
To inspect the behavior of the system near criticality it is convenient to write the steady
cid230cid230005010015020025030035Tcid450050050102T000204060810000204060810TCk0000204060810000204060810TCk05000204060810000204060810TCk02000204060810000204060810TCk09000204060810000204060810TCPSHcid88
Pcid88
cid21
state equations in terms of the rescaled matrix A  A1  k with eigenvalues
1  1 
1  k
deg1  P2
deg2  P2 
Taylor expanding the steady state equations 88 for small m near Tc we have with   c
1k 
m cid39 N 
 A1
 mcid104cid105  3
cid104123cid105m1
A11m2
A22m3
A33
cid20 cid88
112233
cid88
 A1
 m
cid88
 A1
  m2
To make progress we project m on the eigenvectors of A1 A1vj  jvj
and averaging over the disorder gives
cid88
m  
 A1
cid88
 m  3
Pcid88
 A3
 m3
  3 c
cid88
  
cid88
 3 c
aiivi
ajjvj
cid88
  3
cid88
cid54
ajakjkvj
 vk
aiajakijkvi
 vj
 vk
Next we split the sum into j  1     P2 and j  P2  1     P  substitute the eigenvalues
110 111 and equating linear terms we get
P2cid88
Pcid88
At   1 linear terms cancel only if cid80P
 1   
jP21
1  
jP21 ajvj
1  k
  0   which implies vj
  0  j 
2  1     P   We note that the eigenvectors of A1 are in the form
cid19
j  1  P2 
m cid80P
 cid80P2
j1 ajm hencecid80P2
j1 ajvj
Therefore we have for all  m  mp2 and vj
j  P2  1  P 
  m  j  1     P2 This implies
j1 aj  1 If we plug these conditions into 114
m1    3
  3 c
N  m
we have at   1  
m  1
  c
N  mm2  0 
  0 
m  mP2 
m  mP2 
cid18
cid88
cid54
where m2 cid80
 yielding m  0 or
  3  3c
N  m2
Each clone activation m depends on the whole vector m hence all clones will have the same
activation strength m  m m 0 Assuming the non-zero components are a fraction   
of the total number of components P  we have m2  N m2 yielding
1  3c
We will see in the next section that while for k  0 stability of symmetric mixtures is only ensured
for   1 in the presence of idiotypic interactions ie for k cid54 0 values  cid54 1 are possible
521 Linear stability analysis and phase diagram In this section we study the stability of
symmetric clonal activation m  m1     1 0    0 with n  N  activated clones below
criticality in the presence of idiotypic interactions To this purpose we study the eigenvalues of
the Jacobian of the dynamical system 87 which has a block structure with diagonal elements
given for   n by
J  A11  cid104tanh2
A1m 
A1mcid105  1
cid88
cid54
and for   n by
J  A11  cid104tanh2 
while o-diagonal elements are for    n
A1mcid105  1
cid88
cid88
cid88
cid54
and null otherwise For N   the matrix becomes diagonal and eigenvalues are given by the
A1mcid105  1
cid54
cid104tanh2
diagonal elements At the symmetric xed point usingcid80
cid33
J  A1
cid32
1 cid88
cid32
1 cid88
Pnz tanh2 m1  z
Pnz tanh2 mz
cid33
A1  11  k   we get
deg1  n 
deg1  P  n
with Pnz dened by 77 with q  c1     1 and given by Pnz  ecIzc where Izx
is the modied Bessel function of the rst kind Close to criticality by Taylor expanding in power
of     1 we obtain
2  k1  3c
1  k1  3c
  k1  3c
1  k1  3c
In contrast to the case k  0 where 2  0 and symmetric activation is stable only if it involves
all clones in the presence of idiotypic interactions ie for k cid54 0 both eigenvalues are negative at
criticality showing the emergence of local minima where not all the clones are activated In the
opposite limit ie T  0 we get
ecI1c  1
ecI0c  1
For      0 hence using the properties of Bessel functions I10  0 and I00  1 we get
1  0 and 2  0 Since 2 has degeneracy P  n symmetric mixtures m  m1     1 ie with
n  P will be stable for all T  Tc In contrast for    ie  cid54 0 1  0 as I1x  0 for any
x  0 meaning that symmetric mixtures are unstable at low temperature for any n Finally for
   one has    in the thermodynamic limit so Inc cid39 c12  n and symmetric
mixtures will gain stability at low temperature as N  
Let us now compute the critical line in the phase diagram where symmetric mixtures become
unstable We note that 2  1 for T  0 and for T  Tc and deduce that 2  1 for all
T  Tc Hence stability of n-mixtures m  m1     1 0     0 is given by the region where
2  0
In g 22 left we show the critical lines where 2 gets zero in the space of scaled
parameters T  T c   c for dierent values of k and   1 As k increases the region where
clones are activated with the same intensity gets wider When 2 destabilises symmetric mixtures
can only be stable for n  P  ie for   1 in the region where 1  0 A contour plot of 1  0
for   1 in the T  k plane is shown in g 22 right
Figure 22 Left Contour plot of 2  0 obtained from 126 for   1 as a function of the
scaled parameters  T  T c   c for dierent value of B-B interaction strength k Increasing
k the region where symmetric mixtures are stable to the right of the critical line becomes wider
Right Contour plot of 1  0 obtained from 125 for     1 as a function of the scaled
temperature T  T c and strength k of the idiotypic interactions
000204060810000204060810Tfk05000204060810000204060810Tfk09000204060810000204060810Tfk02000204060810000204060810Tfk005SH000204060810000204060810Tcid96k6 Antigen eect
In this section we investigate the eect of antigens on the basal activity of the immune system
analysed in the previous sections We will carry out the analysis for homogeneous promiscuities
and in the absence of idiotypic interactions We suppose to have A  N a antigens in the presence
of which dynamical equations 17 become
cid104 tanh 
m  cid105  m 
where   c and  is the antigenic eld associated to B clone  At the steady state we have
two sets of equations those for clones   1     A complementary to the incoming viruses and
those for non-activated clones   A  1     P  performing basal activities
Pcid88
m  cid104tanh m   
 
mcid105 
m  cid104tanh m  
 
Acid88
cid54
Acid88
cid54
Pcid88
Pcid88
cid54
cid54
mcid105 
cid90
cid90
dzP zm tanh m    z 
dzP zm tanh m  z 
  1     A 
  A  1     P
  1     A 
We rst look at the case A cid28 N  where the equations can be written as
where P zm is the large N limit of Pzm 1 which was dened in 44 and only depends
on the vector m of basal activation
 mcid105 cid39 z and the equations decouple
For P cid28 N  we have P zm  cid104z cid80P
  A  1     P 
hence there is no interference between infected and non-infected clones
m  tanh m   
m  tanh m 
  1     A 
  A  1     P 
For the infected clones the presence of the eld induces hysteresis eect in the clonal activation
23 This may explain immunological memory eects 24 12 without the requirement of
dedicated memory cells after an infection the responsive B cells may retain a non-zero activation
as the antigen is fought and its concentration is sent to zero and on a successive encounter with
the same antigen they will provide a higher and faster response
For P  ON  P zm in 134 135 has a nite width and both antigen-induced and
basal activities reduce due to clonal interference and hysteresis cycles become smaller However
the presence of antigens does not aect the basal activity of uninfected clones   A  1     P 
as long as A cid28 N 
Next we investigate the scenario where the number of antigens is A  ON  and ask whether
the system is able to ght against all of them in parallel For simplicity we set P  N  and
A  1N  with 1 denoting the fraction of infected clones and we assume that all viruses have
the same concentrations ie   1     1 0     0 This leads to the steady state equations
m  cid104tanh m   
m   
mcid105
  1     A
Acid88
Pcid88
Acid88
m   
Pcid88
mcid105
m  cid104tanh m 
  A  1     P
Now antigen interference on the basal activity is relevant and will aect the activation of the
non-infected clones In the small eld limit we can Taylor expand 138 near   1   and small
m obtaining
m  3 
N  m  
m  
cid88
cid54
m cid39 1  m  1    1
For   A infected clones we have for  cid28 
1  
 m1 
  1     A 
where the expansion holds for eld  cid28  otherwise m  O1 For   A   0 we have
cid19
m cid39 1  m  1
N  m
m  2
cid19
hence m  0 is always a solution uninfected clones may not be activated together with
cid18
cid88
cid54
cid18
cid88
Pcid88
Acid88
  3  3c
m  2 
 3  3c
2m1  2 
  A  1     P 
This shows that uninfected clones are symmetrically activated each one with intensity
3  3c1221    1
31  2c1 
1  3c2
1  3c2
where 2  1  1 is the fraction of active uninfected clones Hence for  cid28  clonal activation
close to criticality will have the form m  m1     m1 m2     m2 0     0 However upon
increasing the fraction 1 of infected clones or the antigenic eld  143 shows that non-
zero values of m2 may become impossible and uninfected clones may get activated at a lower
temperature similarly to clones with smaller numbers of triggered receptors we dealt with in Sec
4 This is conrmed by numerical results in Fig 23 showing that the response of uninfected B
clones and their activation temperature decrease for increasing fractions of infected clones This
results in a reduced basal activity of the immune system which is vital to keep cells signaled
In g 24 we study the impact of antigen concentration on
and accomplish homeostasis 18
Figure 23 3D plot of the activation m2 of non-infected clones versus the fraction of infected
clones 1  1c and the scaled temperature T  T c for xed   01 Increasing 1 both the
intensity and the critical activation temperature decrease due to the antigenic interference
Figure 24 Critical line for the activation of uninfected clones in the space of scaled parameters
T  T c   c otained from the condition m2 cid54 0 141 for dierent values of the antigenic
eld  Increasing  the region where uninfected clones are signaled shrinks
the critical temperature at which uninfected B clones become responsive by plotting the critical
temperature versus the fraction of infected clones for dierent values of antigen concentration
This shows that as the fraction of infected clones and the eld increase the basal activity is more
and more compromised
Next we inspect the stability region of m  m1     m1 m2     m2 0     0 by looking at
the eigenvalues of the Jacobian of the dynamical system 131 This has a diagonal structure in
the thermodynamic limit where o-diagonal elements become negligible and diagonal terms are
005Tcid960051cid961005m2cid230cid230cid230cid230cid230cid230cid230cid230cid230cid2300304050607080910000204060810Tcid96cid961cid230cid61001cid224cid224cid224cid224cid224cid224cid224cid224cid224cid2240304050607080910000204060810Tcid96cid961cid224cid6102cid242cid242cid242cid242cid242cid242cid242cid242cid242cid2420304050607080910000204060810Tcid96cid961cid242cid6105cid42cid42cid42cid42cid42cid42cid42cid42cid42cid420304050607080910000204060810Tcid96cid961cid42cid61005for   n1  1N 
J  1  cid104tanh2 m   
n2cid88
m 
n1cid88
m  cid105
for n1    n2  2N 
J  1  cid104tanh2 m 
n11
n2cid88
n1cid88
m 
m  cid105
J  1  cid104tanh2 
m  cid105
n2cid88
n11
m 
n11
n1cid88
Evaluating the Jacobian at the symmetric xed point mcid63 and introducing the distribution
l cid105  cid96 gives
Pn1z1Pn2z2 tanh2   m11  z1  m2z21 deg1  n1
Pn1z1Pn2z2 tanh2   m1z1  m21  z2 1
Pn1z1Pn2z2 tanh2   m1z1  m2z2 1
deg2  n2
deg3  Pn1n2 149
and for   n2
Pnz  cid104z cid80cid96n
1  1cid88
2  1cid88
3  1cid88
cid88
cid88
with m1 m2 following from 140 141 as
Pn1z1Pn2z2 tanh   m11  z1  m2z2
Pn1z1Pn2z2 tanh   m1z1  m21  z2
and Pnz  ecIzc for n  N  where Izx is the modied Bessel function of the rst kind
In Fig 25 left we show the critical lines 1  0 2  0 and 3  0 in the space of scaled
parameters T  T c 2  2c As temperature is lowered 3 is the rst eigenvalue to destabilise
meaning that clonal activation will get in the form m  m1     m1 m2     m2 Decreasing
the temperature further the system will rst prioritise activation of infected clones while keeping
activation of uninfected clones symmetric and later at low temperature will activate uninfected
clones in a hierarchical fashion see g 25 right panel Near the critical temperature symmetric
mixtures with 2  1  1 are stable To investigate the optimal value of 2 we calculate the
free-energy as a function of 2 for xed T 1
F 1 2   1
Pn1z1Pn2z2 log2 coshcm1  z1  m2z2 
2 151
which is minimal g 26 at 2  1  1 meaning that the system will keep all uninfected clones
signalled
1  2m2
cid88
Figure 25 Left Phase diagram in the space of scaled parameters T  T c 2  2c with
1  04 Lines represent contours of 1  0 circles 2  0 triangles and 3  0 squares
To the right of the line 3  0 solutions where uninfected clones are partially activated are
stable Lowering down the temperature and crossing the line 1  0 the m1 symmetric mixtures
destabilise meaning that infected clones are hierarchically activated Crossing the line 2  0
the m2 symmetric mixtures destabilise and uninfected clones are hierarchically activated Right
Plots of 1  0 circles 2  0 triangles in the space T  T c 2  2c for 2  1  1
Figure 26 Free energy as a function of the fraction of active uninfected clones 2 for 1  05
T  07 c  02   005
7 Conclusions
In this paper we presented a minimal model for interacting cells in the adaptive immune systems
constituting of B cells T cells and antigens Our model is able to capture important collective
features of the real immune system such as the ability of simultaneously handling multiple
infections the dependence of B clones activation on the number of receptors on clonal surface and
the role of idiotypic interactions in enhancing parallel response to multiple infections We analysed
the dynamics of the systems order parameters quantifying the B clones activation via linear
stability analysis and Monte Carlo simulations We found the regions in the parameters space
where the system activate B clones symmetrically ie with the same intensity or hierarchically
whereby the system prioritises responses to particular infections We showed that clones with
fewer receptors are less likely to be activated Sec 4 and idiotypic interactions contribute to
the overall stability of the immune system preventing unwanted activation and increasing the
00020406081000010203040506Tf2l2000020406081000010203040506Tf2l1000020406081000010203040506Tf2l30cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid242cid2420001020304000204060810Tcid96cid962cid2422cid610cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid230cid2300001020304000204060810Tcid96cid962cid2301cid61001020304052cid4505175cid4505170cid4505165f2region where all clones are equally activated and ready to start an immune response upon arrival
of new infections Sec 5 Furthermore we investigated how the immune system responds to
antigens showing in particular that multiple antigens create an interference that leads to less
eective response to individual antigens and a reduction in the basal activity of the uninfected B
cells Sec 6 For higher noise level the system tends to simultaneously ght all the antigens
despite losing in terms of response strength whereas for lower noise level it will prioritise some
infections over others Finally we showed that short term memory may emerge as an hysteresis
eect without the requirement of dedicated memory cells
8 Acknowledgements
It is our great pleasure to thank ACC Coolen for many useful discussions
References
1 Abbas A K Lichtman A H Pillai S 2014 Cellular and Molecular Immunology with STUDENT CONSULT
Online Access Elsevier Health Sciences
2 Parisi G 1990 Proc Natl Acad Sci USA 87 429
3 Weisbuch G De Boer R J Perelson A S 1990 Journal of theoretical biology 1464 483-499
4 Mora T Walczak A M Bialek W Callan Jr C G 2010 Proc Natl Acad Sci USA 107 5405
5 Agliari E Barra A Bartolucci S Galluzzi A Guerra F and Moauro F 2013 Phys Rev E 87 042701
6 Bartolucci S and Annibale A 2014 J Phys A Math Theor 47 415001 doi1010881751-81134741415001
7 Kousko V Lacaud G Pape K Retter M Nemazee D 2000 Proc Natl Acad Sci USA Vol 97 Issue 13
8 Jerne N K 1974 Annales dimmunologie 125C 12 373389
9 Menshikov I
Immunology Vol 20 No
and Beduleva L
International
193198
doi101093intimmdxm131
10 Pendergraft W F  Preston G A Shah R R Tropsha A Carter C W Jennette J C Falk R J 2004 Nature
medicine 101 72-79
11 Shoenfeld Y 2004 Nature medicine 101 17-18
12 Janeway CA Jr Travers P Walport M Shlomchik M 2001 Immunobiology The Immune System in
Health and Disease 5th edition New York Garland Science Immunological memory Available from
httpwwwncbinlmnihgovbooksNBK27158
13 Hopeld J J 1982 Proc Natl Acad Sci USA 79 2554-2558
14 Amit D J Gutfreund H and Somplinsky H 1895 Phys Rev A 32 10071018
15 Mezard M Parisi G and Virasoro A 1987 Spin glass theory and beyond World Scientic Singapore 
16 Amit D J 1989 Modelling brain function Cambridge University Press
17 Coolen ACC Kuehn R and Sollich P 2005 Theory of neural information processing systems  Oxford
University Press Oxford
18 E Agliari A Annibale A Barra ACC Coolen D Tantari 2013 J Phys A Math Theor 46 41
19 P Sollich D Tantari A Annibale A Barra 2014 Phys Rev Lett 113 23 238106
20 Ra M 1977 Nature 265 205 - 207  doi101038265205a0
21 Gao L Zhou F Li X Jin Q PLoS One 5 e10736 2010
22 Zonana-Nacach A Camargo-Coronel A Yanez P Sanchez L Jimenez-Balderas F J Fraga A 2001 Lupus
107 505-510
23 Kochmanski M Paszkiewicz T Wolski S 2013 Eur J Phys 34 1555 doi1010880143-08073461555
24 De Monvel J H B and Martin O C 1995 Bulletin of mathematical biology 571 109-136
25 Viola A and Lanzavecchia A 1996 Science Vol 273
26 Abramowitz M and Stegun I A 1972 Handbook of Mathematical Functions Dover New York
27 Laughton S N and Coolen A C C 1995 J Stat Phys 80 1-2 375-387
