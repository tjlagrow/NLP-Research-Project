Nonlinear Hawkes Processes
Lingjiong Zhu
A dissertation submitted in partial fulllment
of the requirements for the degree of
Doctor of Philosophy
Department of Mathematics
New York University
May 2013
Professor S R S Varadhan
ccid13 Lingjiong Zhu
All Rights Reserved 2013
Dedication
To the memory of my grandpa
Zhixuan Zhu 1923-2001
Acknowledgements
It is dicult to overstate my gratitude to my adviser Professor Varadhan
Working with Professor Varadhan has been an absolutely amazing experience for
me I thank him for always keeping his door open and patiently answering my
questions
I thank him for his superb guidance understanding and generosity
I thank him for suggesting the topic for my thesis which would not be possible
without his deep wisdom and sharing of many new ideas He has been everything
that one can reasonably ask for in an advisor and more and I am truly grateful
to him
I want to thank the Courant community for guiding me through this process
and for putting up with me in general Tamar Arnon does her job exceptionally
well and her eorts are much appreciated I want to thank the faculty for many
well taught and interesting classes I am indebted to Gerard Ben Arous Sourav
Chatterjee and Raghu Varadhan for writing me recommendations for my rst
academic job I also want to thank Peter Carr for his interest in my thesis
I remember a joke told by Jalal Shatah that the most important thing as an
undergraduate student is to go to a top graduate program But once you are
already at a graduate school the most important thing is to get out of it This
would not be possible without the nal step ie thesis defense I am grateful to
have Henry McKean Chuck Newman and Raghu Varadhan as the three readers
and Gerard Ben Arous and Lai-Sang Young as the two non-readers on my thesis
committee
Most importantly I want to thank my fellow colleagues for all the fun memories
that I take with me from Courant New York City without good friends can be
the most populated lonely place in the world but thankfully the constant friend-
ship of my fellow Courant colleagues has made these ve years some of the most
entertaining and pleasurable of my life I thank Antoine Cerfon Shirshendu Chat-
terjee Oliver Conway Snziana Datcu Partha Dey Thomas Fai Max Fathi Mert
Gurbuzbalaban Matan Harel Miranda Holmes-Cerfon Arjun Krishnan Shoshana
Leer Sandra May Jim Portegies Alex Rozinov Patrick Stewart Adam Stinch-
combe Jordan Thomas Chen-Hung Wu and many others for their friendship In
particular I want to thank Dmytro Karabash Behzad Mehrdad and Sanchayan
Sen They are not only my good friends but coauthors as well I also thank my
oce neighbor Cheryl Sylivant for her friendship
By living in New York City I had the great opportunities to visit as many
museums and go to as many concerts as possible I am grateful to the New York
Philharmonic and Metropolitan Opera House for their student ticket oers and
also many wonderful student recitals and concerts at Juilliard School which have
made my stay in New York City much more enjoyable
I also want to thank the professors at the University of Cambridge who pro-
vided me a solid undergraduate education In particular I am grateful to Rachel
Camina as well as Houshang Ardavan and Tom Korner I also want to thank Ste-
fano Luzzatto for supervising me on an undergraduate research project at Imperial
College London
I am very much indebted to my family back home I thank my parents for so
many years of love and understanding They are truly the best parents one could
ask for I also thank my grandmas uncles and aunts for their support Finally I
dedicate this thesis to the memory of my late grandpa I miss him dearly
Abstract
The Hawkes process is a simple point process that has long memory clustering
eect self-exciting property and is in general non-Markovian The future evolution
of a self-exciting point process is inuenced by the timing of the past events There
are applications in nance neuroscience genome analysis seismology sociology
criminology and many other elds We rst survey the known results about the
theory and applications of both linear and nonlinear Hawkes processes Then we
obtain the central limit theorem and process-level ie level-3 large deviations for
nonlinear Hawkes processes The level-1 large deviation principle holds as a result
of the contraction principle We also provide an alternative variational formula for
the rate function of the level-1 large deviations in the Markovian case Next we
drop the usual assumptions on the nonlinear Hawkes process and categorize it into
dierent regimes ie sublinear sub-critical critical super-critical and explosive
regimes We show the dierent time asymptotics in dierent regimes and obtain
other properties as well Finally we study the limit theorems of linear Hawkes
processes with random marks
Contents
Dedication                                   
Acknowledgements                              
Abstract                                    
List of Figures                                 
Introduction                                  
1 Hawkes Processes
Introduction                               
12 Applications of Hawkes Processes                   
13 Related Models                             
14 Linear Hawkes Processes                        
15 Nonlinear Hawkes Processes                      
16 Multivariate Hawkes Processes                     
2 Central Limit Theorem for Nonlinear Hawkes Processes
21 Main Results
                             
22 Proofs                                  
3 Process-Level Large Deviations for Nonlinear Hawkes Processes 57
31 Main Results
                             
32 Lower Bound                              
33 Upper Bound                              
34 Superexponential Estimates
                     
35 Concluding Remarks                           100
4 Large Deviations for Markovian Nonlinear Hawkes Processes
41 An Ergodic Lemma                            103
42 Large Deviations for Markovian Nonlinear Hawkes Processes with
Exponential Exciting Function                      106
43 Large Deviations for Markovian Nonlinear Hawkes Processes with
Sum of Exponentials Exciting Function                 125
44 Large Deviations for a Special Class of Nonlinear Hawkes Processes
An Approximation Approach                      131
5 Asymptotics for Nonlinear Hawkes Processes
51 Sublinear Regime                             145
52 Sub-Critical Regime
                          148
53 Critical Regime                              150
54 Super-Critical Regime
                         161
55 Explosive Regime                             165
6 Limit Theorems for Marked Hawkes Processes
Introduction and Main Results                      172
62 Proof of Central Limit Theorem                     175
63 Proof of Large Deviation Principle
                  177
64 Risk Model with Marked Hawkes Claims Arrivals
          187
65 Examples with Explicit Formulas
                   191
Bibliography
List of Figures
11 This is a comparison of a Hawkes process with a Poisson process
The gure on the left shows the histogram of a Hawkes process with
t12 and z  1  9
ht  1
histogram of a Poisson process with constant intensity   3
10z and the gure on the right the
the gure each column represents the number of points that arrived
in that unit time subinterval
                    
12 Plot of intensity t for a realization of Hawkes process Here ht 
t12 and z  1  09z
                      
51 Plot of intensity t for a realization of Hawkes process Here ht 
t  1 1
2 and z  1  z 1
2                       144
52 Plot of intensity t for a realization of Hawkes process Here ht 
In this case cid107hcid107L1   and  is
t13 and z  1  z 1
sublinear and Lipschitz It will converge to the unique stationary
version of the Hawkes process                      144
53 Plot of intensity t for a realization of Hawkes process Here ht 
t13 and z  1  z In this case cid107hcid107L1  1
2  1 It is in the
sub-critical regime This is a classical Hawkes process and it will
converge to the unique stationary version of the Hawkes process   145
t13 and z  1  z In this case cid107hcid107L1  1 cid82 
54 Plot of intensity t for a realization of Hawkes process Here ht 
thtdt  
and  is linear It is therefore in the critical regime From the
T 2 converges tocid82 
graph we can see that t grows linearly in t which will be proved
in this chapter Indeed we will prove that NT
as T   where s is a squared Bessel process            146
0 sds
55 Plot of intensity t for a realization of Hawkes process Here ht 
t13 and z  1  z In this case cid107hcid107L1  3
super-critical regime We expect that t would grow exponentially
2  1 and it is in the
in this case
                               147
56 Plot of intensity t for a realization of Hawkes process Here ht 
t13 and z  1  z 3
is a little bit cheating because it is impossible to plot explosion
2  This is in the explosive regime The plot
Nevertheless you can think it as an illustration It appears that
the process explodes near time t  6
                 148
Introduction
This thesis is about the nonlinear Hawkes process a simple point processes
that has long memory the clustering eect the self-exciting property and is in
general non-Markovian The future evolution of a self-exciting point process is
inuenced by the timing of the past events There are applications in nance
neuroscience genome analysis sociology criminology seismology and many other
elds
Chapter 1 includes the introduction of the model and the survey of the results
already known in the literature about Hawkes processes That includes the stability
results limit theorems power spectra of linear Hawkes processes and stability
results of nonlinear Hawkes processes
Chapter 2 is about the functional central limit theorem of nonlinear Hawkes
processes A Strassens invariance holds under the same assumptions The work
in Chapter 2 is based on Zhu 114
Chapter 3 is dedicated to the process-level large deviations ie
level-3 large
deviations of the nonlinear Hawkes processes The proofs consist of the proofs of
the lower bound the upper bound and the superexponential estimates The level-1
large deviation principle is derived as a result of the contraction principle This
chapter is based on Zhu 113
Chapter 4 is dedicated to the study of level-1 large deviation principle for
nonlinear Hawkes processes when the exciting functions are exponential or sums
of exponentials It is based on the observation that when the exciting functions are
exponential or sums of exponentials the process is Markovian and a combination of
Feynman-Kac formula for the upper bound of large deviations of Markov processes
and tilting of the intensity function of Hawkes processes for the lower bound will
establish a level-1 large deviation principle with the rate function expressed in
terms of some variational formula This chapter is based on Zhu 112
Chapter 5 is about the asymptotics for nonlinear Hawkes processes
In this
chapter we drop the usual assumptions on nonlinear Hawkes processes and study
the phase transitions in dierent regimes We categorize nonlinear Hawkes pro-
cesses into the following regimes sublinear regime sub-critical regime critical
regime super-critical regime and explosive regime Dierent time asymptotics
and various properties are obtained in dierent regimes This chapter is based on
Zhu 117
Chapter 6 is about the limit theorems for linear Hawkes processes with random
marks The Central limit theorem and the large deviation principle are derived
We end this chapter with a simple application to a risk model This is based on
the joint work with my colleague Dmytro Karabash see 62
During my time as a PhD student at Courant Institute I have the joy to work
on some other problems either by myself or with my colleagues For example I
studied the large deviations of self-correcting point processes with Sanchayan Sen
see 100 and also did some work on biased random walks on Galton-Watson trees
without leaves with Behzad Mehrdad and Sanchayan Sen see 75 But since they
are not closely related to the topics of my thesis I do not include them here
Chapter 1
Hawkes Processes
Introduction
Hawkes process is a self-exciting simple point process rst introduced by Hawkes
51 The future evolution of a self-exciting point process is inuenced by the timing
of past events The process is non-Markovian except for some very special cases
In other words Hawkes process depends on the entire past history and has a long
memory Hawkes process has wide applications in neuroscience see eg Johnson
59 Chornoboy et al 25 Pernice et al 93 Pernice et al 94 Reynaud et al
98 seismology see eg Hawkes and Adamopoulos 53 Ogata 87 Ogata 88
Ogata et al
90 genome analysis see eg Gusto and Schbath 46 Reynaud-
Bouret and Schbath 96 psycology see eg Halpin and De Boeck 48 spread of
infectious disease see eg Meyer et al 76 nance see eg Bauwens and Hautsch
7 Bowsher 13 Hewlett 56 Large 67 Cartea et al 22 Chavez-Demoulin et
al 23 Errais et al 36 Embrechts et al 35 Muni Toke and Pomponio 83
Bacry et al 3 4 1 and in many other elds
Let N be a simple point process on R and F
 N C C  BR C 
 t be an increasing family of -algebras Any nonnegative F
-progressively
measurable process t with
Ecid2N a bF
cid3  E
cid20cid90 b
sdscid12cid12F
cid21
as for all intervals a b is called the F
-intensity of N  We use the notation
Nt  N 0 t to denote the number of points in the interval 0 t
A nonlinear Hawkes process is a simple point process N admitting an F
intensity
t  
cid18cid90 t
cid19
ht  sN ds
We always assume that cid107hcid107L1 cid82 
 ht  sN ds stands forcid82
cid82 t
where   R  R is locally integrable and left continuous h  R  R
0 htdt   unless otherwise specied Here
t ht  sN ds which is important for F
predictability The local integrability assumption of  is to avoid explosion
and the left continuity assumption of  is to ensure that the process is F
predictable
In the literature h and  are usually referred to as exciting function and
rate function respectively
A Hawkes process is said to be linear if  is linear and it is nonlinear other-
wise For a linear Hawkes process we can assume that the intensity is
t   
ht  sN ds
cid90
t
In this thesis unless otherwise specied we assume the following
   R  R is continuous and non-decreasing
 h  R  R is continuous and non-increasing
 N  0  0 ie the Hawkes process has empty past history
Throughout we dene Zt as Zt cid82 t
0 ht  sN ds Thus t  Zt
The rst assumption says that the occurence of the past and present events have
positive impact on the occurence of the future events The second assumption says
that as time evolves the impact of the past events is decreasing For most of the
results in this paper these two assumptions may not be necessary We nevertheless
make them to avoid some technical diculties
If one looks at 12 it is clear that if you witness some events occuring t
increases since  is increasing and you would expect even more events occuring
This is called the self-exciting property Because of this you would expect to see
some clustering eects
Figure 11 shows the histograms of a Hawkes process and a usual Poisson pro-
cess A Poisson process is stationary with independent increments On the con-
trary the Hawkes process has dependent increments and has clustering eects As
a result in the picture the Poisson process is more or less at whilst the Hawkes
process has peaks when it gets excited and has valleys when it cools down
Figure 12 shows the plot of the intensity t of a Hawkes process Unlike the
usual Poisson process for which the intensity is a positive constant the intensity of
Hawkes process increases when you witness arrivals of points and it decays when
there are no arrivals of points
The self-exciting and clutstering properties of the Hawkes process make it ideal
to characterize the correlations in some complex systems including the default
clustering eect in nance
One generalization of classical linear Hawkes process is the so-called multivari-
ate Hawkes process We will dene the multivariate Hawkes process and discuss
some basic results in Section 16 of Chapter 1 The multivariate Hawkes process
has been well studied in the literature and we would like to point out that if you
have the result for the univariate Hawkes process mathematically it is not too
dicult to generalize your result to multivariate Hawkes process
Unlike the univariate Hawkes process which only has the self-exciting property
the multivariate Hawkes process also has the mutually-exciting property In the
context of industry consider that you have a large portfolio of companies then the
failure of one company can have impact on the performance of other companies
In other words multivariate Hawkes process captures the cross-sectional clustering
eect That is why in most applications of Hawkes processes in nance people
usually consider multivariate Hawkes processes We will review some basic results
about multivariate linear Hawkes process in Chapter 1
Another possible generalization to Hawkes process is the marked Hawkes pro-
cess ie Hawkes process with random marks Just like univariate Hawkes process
vesus multivariate Hawkes process if you have the results in unmarked Hawkes
process usually it can be generalized to marked Hawkes process without much
diculty For instance the large deviations for linear Hawkes process is proved
in Bordenave and Torrisi 11 and the large deviations for linear marked Hawkes
process is then proved in Karabash and Zhu 62 We will discuss the details of
limit theorems of linear marked Hawkes process in Chapter 6
Most of the literature on Hawkes processes studies only the linear case which
has an immigration-birth representation see Hawkes and Oakes 54 The stabil-
ity law of large numbers central limit theorem large deviations Bartlett spectrum
etc have all been studied and understood very well Almost all of the applications
of Hawkes processes in the literature consider exclusively the linear case Daley
and Vere-Jones 27 and Liniger 71 provide nice surveys about the theory and
applications of Hawkes processes
One special case of the Hawkes process is when the exciting function h is
exponential In this case the Hawkes process is a continuous time Markov process
If  is linear the process is a special case of ane jump-diusion process and
is analytically tractable This special case was for example studied in Oakes 85
and Errais et al 36
Because of the lack of computational tractability and immigration-birth repre-
sentation nonlinear Hawkes process is much less studied However some eorts
have already been made in this direction For instance see Bremaud and Mas-
soulie 14 for stability results and Bremaud et al 15 for the rate of convergence
to stationarity Karabash 63 recently proved the stability results for a wider class
of nonlinear Hawkes processes
As to the limit theorems Bacry et al 2 proved the central limit theorem for
linear Hawkes process and Bordenave and Torrisi 11 proved the large deviation
principle for linear Hawkes process
For nonlinear Hawkes process there is no explicit expression for the variance
in the central limit theorem or the rate function for the large deviation principle
The method is more abstract and much more involved Zhu 114 proved a cen-
tral limit theorem for ergodic nonlinear Hawkes processes Zhu 112 studied the
Figure 11 This is a comparison of a Hawkes process with a Poisson process The
gure on the left shows the histogram of a Hawkes process with ht  1
t12 and
z  1  9
10z and the gure on the right the histogram of a Poisson process with
constant intensity   3
In the gure each column represents the number of
points that arrived in that unit time subinterval
large deviations in the Markovian case ie when h is exponential or sum of
exponentials And Zhu 113 proved the large deviation principle for more general
nonlinear Hawkes processes at the process-level ie level-3
Figure 12 Plot of intensity t for a realization of Hawkes process Here ht 
t12 and z  1  09z
051015202530246810120510152025300510152025300510152025300246810121412 Applications of Hawkes Processes
121 Applications in Finance
The applications of Hawkes processes in nance include market orders mod-
elling see eg Bauwens and Hautsch 7 Bowsher 13 Hewlett 56 Large 67 and
Cartea et al 22 value-at-risk see eg Chavez-Demoulin et al 23 and credit
risk see eg Errais et al 36 Embrechts et al 35 applied Hawkes processes to
model the nancial data Muni Toke and Pomponio 83 applied Hawkes processes
to model the trade-through Bacry et al 3 used Hawkes processes to reproduce
empirically microstructure noise and discussed the Epps eect and lead-lag The
self-exciting and clustering properties of Hawkes processes are especially appealing
in nancial applications
Currently most of the applications of Hawkes process in the nance literature
are about market orders modelling see eg Bauwens and Hautsch 7 Bowsher
13 and Large 67
Recently Chavez-Demoulin and McGill 24 used Hawkes processes to study
the extremal returns in high-frequency trading The Hawkes process captures
the volatility clustering behavior of the intraday extremal returns and provides
a suitable estimation of high-quantile based risk measures eg VaR ES for
nancial time series
Filimonov and Sornette 39 used Hawkes process to model market events with
the aim of quantifying precisely endogeneity and exogeneity in market activity By
using Hawkes process Filimonov and Sornette 39 analyzed E-mini SP futures
contract over the period 1998-2010 and discovered that the degree of self-reexivity
has increased steadily in the last decade an eect they attribute to the increased
deployment of high-frequency and algorithmic trading When they calibrated over
much shorter time intervals 10 minutes the Hawkes process analysis is found to
detect precursors of the ash-crash that happened on May 6th 2010 An early
detection can benet market regulators
Very recently Hardiman et al 50 used linear Hawkes process to model the
arrival of mid-price changes in the E-Mini SP futures contract Using several
estimation methods they found that the exciting function h has a power-law
decay and cid107hcid107L1 is close to 1 They pointed out that markets are and have always
been close to criticality challenging the studies of Filimonov and Sornette 39
which indicates that self-reexivity endogeneity has increased in recent years as
a result of increased automation of trading
Egami et al 33 studied the credit default swap CDS markets in both Japan
and US They made a dynamic analysis of the bid-ask spreads in both countries
which surged dramatically during the 2008-2009 nancial crisis and they used the
Hawkes process to predict the bid-ask spreads
As pointed out in Errais et al 36 The collapse of Lehman Brothers brought
the nancial system to the brink of a breakdown The dramatic repercussions point
to the exisence of feedback phenomena that are channeled through the complex
web of informational and contractual relationships in the economy This and
related episodes motivate the design of models of correlated default timing that
incorporate the feedback phenomena that plague credit markets According to
Peng and Kou 92 We need better models to incorporate the default clustering
eect ie one default event tends to trigger more default events both across
time and cross-sectionally The Hawkes process provides a model to characterize
default events across time and if one uses a multivariate Hawkes process that
would describe the cross-sectional clustering eect as well
Hawkes processes have been proposed as models for the arrival of company
defaults in a bond portfolio starting with the papers Giesecke and Tomecek 42
and Giesecke et al 41 It is not hard to see that when the exciting function h is
exponential the linear Hawkes processes are ane jump-diusion processes see for
instance Errais et al 36 With the help of the theory of ane jump-diusions one
can then analyze price processes related to certain credit derivatives analytically
122 Applications in Sociology
The Hawkes process has also been applied to the study of social interactions
Crane and Sornette 26 analysed the viewing of YouTube videos as an example of a
nonlinear social system They identied peaks in the time series of viewing gures
for around half a million videos and studied the subsequent decay of the peak to
a background viewing level In Crane and Sornette 26 the Hawkes process was
proposed as a model of the video-watching dynamics and a plausible link made to
the social interactions that create strong correlations between the viewing actions
of dierent people Individual viewing is not random but inuenced by various
channels of communication about what to watch next Mitchell and Cates 77
used computer simulation to test the the claims in Crane and Sornette 26 that
robust identication is possible for classes of dynamic response following activity
bursts They also pointed out some limitations of the analysis based on the Hawkes
process
In sociology Hawkes process has also been used by Blundell et al
10 to
study the reciprocating relationships Reciprocity is a common social norm where
one persons actions towards another increases the probability of the same type of
action being returned eg if Bob emails Alice it increases the probability that
Alice will email Bob in the near future The mutually-exciting processes eg
multivariate Hawkes processes are able to capture the causal nature of reciprocal
interactions
123 Applications in Seismology
Ogata 87 used a particular case of the Hawkes process to predict earthquakes
and the Hawkes process appears to be superior to other models by residual analysis
The specic model used by Ogata 87 is now known as ETAS Epidemic Type
Aftershock-Sequences model The discussions of ETAS model can be found in
Daley and Vere-Jones 27
124 Applications in Genome Analysis
Gusto and Schbath 46 used the Hawkes process to model the occurences along
the genome and studied how the occurences of a given process along a genome
genes or motifs for instance may be inuenced by the occurrences of a second
process More precisely the aim is to detect avoided andor favored distances
between two motifs for instance suggesting possible interactions at a molecular
level The statistical method proposed by Gusto and Schbath 46 is useful for
functional motif detection or to improve knowledge of some biological mechanisms
Reynaud-Bouret and Schbath 96 provided a new method for the detection of
either favored or avoided distances between genomic events along DNA sequences
These events are modeled by the Hawkes process The biological problem is actu-
ally complex enough to need a non-asymptotic penalized model selection approach
and Reynaud-Bouret and Schbath 96 provided a theoretical penalty that satises
an oracle inequality even for quite complex families of models
125 Applications in Neuroscience
Chornoboy et al 25 used the Hawkes process to detect and model the func-
tional relationships between the neurons The estimates are based on the maximum
likelihood principle
In most neural systems neurons communicate via sequences of action poten-
tials Johnson 59 used various point processes including Poisson process renewal
process and the Hawkes process and showed that neural discharges patterns convey
time-varying information intermingled with the neurons response characteristics
By applying information theory and estimation theory to point processes Johnson
59 described the fundamental limits on how well information can be extracted
from neural discharges
More recently Pernice et al
93 and Pernice et al
94 have used Hawkes
process to model the spike train dynamics in the studies of neuronal networks
As pointed out in Pernice et al
93 Hawkes point process theory allows the
treatment of correlations on the level of spike trains as well as the understanding
of the relation of complex connectivity patterns to the statistics of pairwise cor-
relations Reynaud et al 98 proposed new non-parametric adaptive estimation
methods and adapted other recent similar results to the setting of spike trains anal-
ysis in neuroscience They tested homogeneuous Poisson process inhomogeneous
Poisson process and the Hawkes process A complete analysis was performed on
single unit activity recorded on a monkey during a sensory-motor task Reynaud
et al 98 showed that the homogeneous Poisson process hypothesis is always re-
jected and that the inhomogeneous Poisson process hypothesis is rarely accepted
The Hawkes model seems to t most of the data
The application of the Hawkes process in neuroscience has also been mentioned
in Bremaud and Massoulie 14
126 Applications in Criminology
Hawkes processes have also been used in criminology Violence among gangs
exhibits retaliatory behavior ie given that an event has happened between two
gangs the likelihood that another event will happen shortly afterwards is increased
A problem like this can be modeled naturally by a self-exciting point process
Mohler et al 78 and Egesdal et al 34 have successfully modeled the pairwise
gang violence as a Hawkes process As pointed out in Hegemann et al
55 in
real-life situations data is incomplete and law-enforcement agencies may not know
which gang is involved However even when gang activity is highly stochastic lo-
calized excitations in parts of the known dataset can help identify gangs responsible
for unsolved crimes The works before Hegemann et al 55 incorporated the ob-
served clustering in time of the data to identify gangs responsible for unsolved
crimes by assuming that the parameters of the model are known when in reality
they have to be estimated from the data itself Hegemann et al 55 proposed an
iterative method that simultaneously estimates the parameters in the underlying
point process and assigns weights to the unknown events with a directly calculable
score function
Hawkes processses have also been used in the studies of terrorist activities For
example Porter and White 95 used Hawkes process to examine the daily number
of terrorist attacks in Indonesia from 1994 through 2007 Their model explains the
self-exciting nature of the terrorist activities It estimates the probability of future
attacks as a function of the times since the past attacks
Lewis et al
69 used Hawkes process to model the temporal dynamics of
violence and civilian deaths in Iraq
13 Related Models
There are other generalizations or variations of the Hawkes processes in the
literature For example Bormetti et al 12 introduced a one factor model where
both the factor and the idiosyncratic jump components are described by a Hawkes
process Their model is a better candidate than classical Poisson or Hawkes models
to describe the dynamics of jumps in a multi-asset framework Another example
is a multivariate Hawkes process with constraints on its conditional density intro-
duced by Zheng et al
111 Their study is mainly motivated by the stochastic
modelling of a limit order book for high frequency nancial data analysis Dassios
and Zhao 28 proposed a dynamic contagion process It is basically a combination
of a marked Hawkes process with exponential exciting function and an external
shot noise process Their model is Markovian They also applied their model to
insurance see eg Dassios and Zhao 29
In 116 Zhu incorporated Hawkes jumps into the classical Cox-Ingersoll-Ross
model and obtained limit theorems and various other properties
In seismology Wang et al
104 proposed a new model ie
the Markov-
modulated Hawkes process with stepwise decay MMHPSD to investigate the
variation in seismicity rate during a series of earthquakes sequence including mul-
tiple main shocks The MMHPSD is a self-exciting process which switches among
dierent states in each of which the process has distinguishable background seis-
micity and decay rates Stress release models are often used in seismology
Bremaud and Foss 17 they created a new earthquake model combining the clas-
sical stress release model for primary shocks with the Hawkes model for aftershocks
and studied the ergodicity of this new model
In addition to the classical Hawkes process one can also study the spatial
Hawkes process see eg Mller and Torrisi 81 Mller and Torrisi 82 Bordenave
and Torrisi 11 In addition the space-time Hawkes process has been used see
eg Musmeci and Vere-Jones 84 and Ogata 88
14 Linear Hawkes Processes
In this section let us review some known results about linear Hawkes process
Unlike the nonlinear Hawkes process the linear Hawkes process has been very well
studied in the literature Hawkes and Oakes 54 introduced an immigration-birth
representation of the linear Hawkes process which can be viewed as a special case
of the Poisson cluster process The stability results of the linear Hawkes process
ie existence and uniqueness of a stationary linear Hawkes process have been sum-
marised in Chapter 12 of Daley and Vere-Jones 27 The rate of convergence to
equilibrium has been stuided by Bremaud et al 15 The second-order analysis
ie the Bartlett spectrum etc have been studied in Hawkes 51 and Hawkes 52
Reynaud-Bouret and Roy 97 considered the linear Hawkes process as a special
case of Poisson cluster process and studied the non-asymptotic tail estimates of
the extinction time the length of a cluster and the number of points in an inter-
val Reynaud-Bouret and Roy 97 also obtained some so-called non-asymptotic
ergodic theorems The limit theorems have also been studied for linear Hawkes
process The central limit theorem was considered in Bacry et al
2 the large
deviation principle was obtained in Bordenave and Torrisi 11 and very recently
the moderate deviation principle was proved in Zhu 115 The simulations and
calibrations of linear Hawkes process have been studied in Ogata 89 Mller and
Rasmussen 80 79 Vere-Jones 110 Ozaki 91 and many others
Immigration-Birth Representation
Consider the linear Hawkes process N with empty history ie N  0  0
cid90 t
t   
ht  uN du
  0
and intensity
wherecid82 
0 htdt  1 It is well known that it has the following immigration-birth
representation see for example Hawkes and Oakes 54 The immigrant arrives
according to a homogeneous Poisson process with constant rate  Each immigrant
reproduces children and the number of children has a Poisson distribution with
parameter cid107hcid107L1 Conditional on the number of the children of an immigrant
the time that a child was born has probability density function ht
 Each child
cid107hcid107L1
produces children according to the same laws independent of other children All
the immigrants produce children independently Now N 0 t is the same as the
total number of immigrants and children in the time interval 0 t
142 Stability Results
Consider the linear Hawkes process N with empty history ie N  0  0
and intensity
wherecid82 
cid90 t
t   
ht  uN du
0 htdt  1 We review here the known results of existence and uniqueness
of a stationary version of the process We follow the arguments of Chapter 12 of
Daley and Vere-Jones 27
The existence of a stationary version of the process can be seen from the
immigration-birth representation of the linear Hawkes process To show unique-
ness let us do the following Let N be a stationary version with intensity
ht  uN
sdu
t   
ht  uNdu
 For both N and N we consider the
and mean intensity   E
shifted versions sN and sN that bring the origin back to zero sN can be split
1cid107hcid107L1
into two components the one with the same structure as sN  being generated from
the clusters initiated by immigrants arriving after time s and the component N
that counts the children of the immigrants that arrived before time s On R
the contribution from the latter form a Poisson process with intensity
st 
cid90 t
cid90 s
For any T  
s0 T   0  Ecid104
1  ecid82 T
cid20cid90 T
stdtcid105
cid21
stdt
 T
cid90 
hudu  0
as s   Let P and P represent the probability measures corresponding to N
and N For any T  0 we have
cid107sP  Pcid1070T   PN
s0 T   0  0
as s   where cid107  cid107 denotes the variation norm This implies the weak conver-
Under a stronger assumption cid82 
gence and thus the weak asymptotic stationarity of N 
thtdt   ie
the mean time to the
appearance of a child is nite Since the mean number of ospring is also nite
because cid107hcid107L1  1 the random time T from the appearance of an ancestor to
the last of its descendants has nite mean ie ET    Thus we have
s0  0  1  ecid82 
PT udu  0
as s   and cid107sP  Pcid1070  0 as s   which implies that the process
starting from empty history is strongly asymptotically stationary
Bremaud et al 15 studied the rate of convergence to the equilibrium in a more
general setting ie Hawkes process with random marks Here we only consider
the unmarked case Assume N  0  0 and let N denote the unique stationary
Hawkes process The convergence in variation is seen via coupling namely N and
N are constructed on the same space and there exists a nite random time T such
PN t  Nt for all t  T   1
In the exponential case there exists some   0 such that cid82 
0 ethtdt  1
Let us dene
cid90 
hsds
Ht 
1  cid107hcid107L1
If etHt is directly Riemann integrable on R then for any
cid82 
cid82 
0 etHtdt
tethtdt
there exists t0K such that PT  t  Ket for any t  t0K
In the subexponential case the distribution function G with density gt 
cid107hcid107L1
is subexponential in the sense that
Further assume thatcid82 
1  Gnt
1  Gt
for any n  N
t
thtdt   Then for any
cid107hcid107L1
1  cid107hcid107L12 
there exists some t0K such that for any t  t0K we have
PT  t  K
Gudu
cid90 
where G  1  G
143 Bartlett Spectrum for Linear Hawkes Processes
The methods of analysis for point processes by spectrum were introduced by
Bartlett 5 and 6 We refer to Chapter 8 of Daley and Vere-Jones 27 for a
detailed discussion
Let N be a second-order stationary point process on R For the denition
of second-order stationary point process we refer to Daley and Vere-Jones 27
Dene the set S as the space of functions of rapid decay ie   S if
cid12cid12cid12cid12 dkx
cid12cid12cid12cid12  Ck r
1  xr 
for some constants Ck r   and all positive integers r and k
For bounded measurable  with bounded support and also   S there exists
a measure  on B such that
cid18cid90
cid19
xN dx
cid90
 d
where  cid82
R eiuudu is the Fourier transform of   is refered to as the
Bartlett spectrum We also have
cid18cid90
cid19
xN dx
cid90
cid90
 d
xN dx
Hawkes 52 proved that for the linear stationary Hawkes process with
t   
ht  sN ds
cid90 t
  0 and cid107hcid107L1  1 the Bartlett spectrum is given by
d 
21  cid107hcid107L11  h2
Moreover if    EdN t   dN tdt2  2 is the covariance density
 then Hawkes 51 proved that        0 satises
where  
1cid107hcid107L1
the equation
   h  
cid90 
ht  vvdv
Since      we have
   h  
cid90 
cid90 
h  vvdv 
h  vvdv
  0
In general   may not have an analytical form However when h is exponen-
tial say ht  et Hawkes 51 showed that
  
2  
2  2 e 
  0
The Bartlett spectrum analysis has later been generalized to marked linear
Hawkes processes and some more general models We refer to Bremaud and Mas-
soulie 18 and Bremaud and Massoulie 19
144 Limit Theorems for Linear Hawkes Processes
When  is linear say z    z for some   0 and cid107hcid107L1  1 the
Hawkes process has a very nice immigration-birth representation see for example
Hawkes and Oakes 54 For such a linear Hawkes process the limit theorems are
very well understood Consider a stationary Hawkes process N with intensity
t   
ht  sNds
cid90 t
Taking expecatations on the both sides of the above equation and using stationar-
ity we get
  E
t    
cid90 t
ht  sE
sds    cid107hcid107L1
which implies that  
1cid107hcid107L1
 By ergodic theorem we have
1  cid107hcid107L1
as t   as
Moreover Bordenave and Torrisi 11 proved a large deviation principle for  Nt
t  
Theorem 1 Bordenave and Torrisi 2007 Ntt   satises a large deviation
principle with the rate function
cid16
x log
cid17  x  xcid107hcid107L1  
if x  0
otherwise
xcid107hcid107L1
Recently Bacry et al
2 proved a functional central limit theorem for linear
multivariate Hawkes process under certain assumptions That includes the linear
Hawkes process as a special case and they proved that
Theorem 2 Bacry et al 2011
Nt  t
 B
as t  
where B is a standard Brownian motion The convergence is weak convergence
on D0 1 the space of cadlag functions on 0 1 equipped with Skorokhod topology
1  cid107hcid107L1
and 2 
1  cid107hcid107L13 
Unlike the central limit theorem and the law of the iterated logarithm there are
not as many good crietria one can use to prove the moderate deviation principle for
nonlinear Hawkes processes which would ll in the gap between the central limit
theorem and the large deviation principle Nevertheless due to the analytical
tractability and birth-immigration representation of linear Hawkes process Zhu
115 proved the moderate deviations for linear Hawkes processes
Theorem 3 Assume z  z   0 cid107hcid107L1  1 and supt0 t32ht  C  
t cid28 at cid28 t we have the
For any Borel set A and time sequence at such that
following moderate deviation principle
 inf
Jx  lim inf
t
 lim sup
t
at2 log P
at2 log P
cid18Nt  t
cid18 Nt  t
cid19
cid19
  inf
where Jx  x21cid107hcid107L1 3
The proof of Theorem 3 will be given in Section 145
In a nutshell linear Hawkes processes satisfy very nice limit theorems and the
limits can be computed more or less explicitly
145 Proof of Theorem 3
Since a Hawkes process has a long memory and is in general non-Markovian
there is no good criterion in the literature for moderate deviations that we can use
directly For example Bacry et al 2 used a central limit theorem for martingales
to obtain a central limit theorem for linear Hawkes processes But there is no
criterion for moderate deviations for martingales that can t into the context of
Hawkes processes Our strategy relies on the fact that for linear Hawkes processes
there is a nice immigration-birth representation from which we can obtain a semi-
explicit formula for the moment generating function of Nt in Lemma 1 A careful
asymptotic analysis of this formula would lead to the proof of Theorem 3
Proof of Theorem 3 Let us rst prove that for any   R
t
By Lemma 1 for xed   R and t suciently large we have
t Nttcid105
21  cid107hcid107L13 
at2 log Ecid104
Ecid104
cid105
 ecid82 t
0 Gtsds
t cid82 s
0 huGtsudu  1 0  s  t Here Gts is simply the
where Gts  e
F s  1 in Lemma 1 Because at
t  depends on t we write Gts instead of Gs
to indicate its dependence on t Clearly Gts is increasing in s and Gt is the
t cid107hcid107L1 xt  1 See the proof of Lemma
minimal solution to the equation xt  e
1 and the reference therein Since cid107hcid107L1  1 it is easy to see that xt  Oatt
Since xt  Oatt we have Gts  Oatt uniformly in s By Taylors
expansion
Gts 
cid90 s
cid18 at
cid192
huGts  udu
cid192
cid18cid90 s
cid90 s
huGts  udu  Ocid0att3cid1 
huGts  udu
Let Gts  at
t G1s 
cid16 at
cid172
G2s  ts where
cid90 s
136 G2s 
cid90 s
G1s  1 
huG1s  udu
huG2s  udu 
 2G1s  1 
G1s  12
Substituting 135 and 136 back into 134 and using the fact Gts  Oatt
uniformly in s we get ts  Oatt3 uniformly in s Moreover we claim that
t
t
cid21
cid90 t
cid20
cid90 t
G1sds  t
G2sds 
21  cid107hcid107L13 
To prove 137 notice rst that
cid90 t
cid90 t
cid90 t
cid90 t
cid90 t
cid90 s
cid90 t
cid90 tu
cid90 t
G1sds  1 
huG1s  ududs
G1s  udsdu
G1sdsdu
G1sdsdu  1
cid90 t
cid90 t
G1sdsdu
cid90 t
1  1
G1sds 
cid82 t
0 hucid82 t
1 cid82 t
tu G1sdsdu
0 hudu
Therefore
cid20
cid35
 
cid35cid12cid12cid12cid12cid12  t
tu G1sdsdu
0 hudu
0 hucid82 t
cid82 t
1 cid82 t
cid82 
t hudu
1  cid107hcid107L12  0
For the rst term in 141 we have
cid12cid12cid12cid12cid12 t
1 cid82 
0 hudu
0 hudu
cid82 
as t   since by our assumption supt0 t32ht  C   which implies that
t hudu  t
at  0 as t  
u32 du  2C
cid21
G1sds  t
cid19
1 cid82 
1  cid107hcid107L1
G1s 
0 hudu
0 hudu
cid90 t
cid18
cid90 t
cid34
1 cid82 t
cid34
1 cid82 t
cid82 
For the second term in 141 we have
cid12cid12cid12cid12cid12 
cid82 t
0 hucid82 t
1 cid82 t
lim sup
t
cid12cid12cid12cid12cid12  lim
tu G1sdsdu
0 hudu
t G1t lim sup
t
cid82 t
0 huudu
1  cid107hcid107L1
This is because 135 is a renewal equation and cid107hcid107L1  1 By the application
of the Tauberian theorem to the renewal equation see Chapters XIII and XIV of
 Moreover our assumptions supt0 t32ht 
cid90 1
Feller 38 limt G1t 
1cid107hcid107L1
C   and cid107hcid107L1   imply that
cid90 t
cid90 t
huudu  1
huudu 
u12 du  0
as t  
To prove 138 notice that limt G1t 
1cid107hcid107L1
and again by the appli-
cation of the Tauberian theorem to the renewal equation see Chapters XIII and
XIV of Feller 38 we have
t
G2sds  lim
t G2t
cid90 t
cid16
cid17
cid16
cid172
1cid107hcid107L1
1cid107hcid107L1
1  cid107hcid107L1
21  cid107hcid107L13 
Finally from 133 and the denitions of G1s G2s and ts we have
at2 log Ecid104
t Nttcid105
cid90 t
cid20
cid90 t
at2 
Gtsds  
G1sds  t
cid21
cid90 t
G2sds 
cid90 t
tsds
Hence by 137 138 and the fact that ts  Oatt3 uniformly in s we
conclude that for any   R
t
at2 log Ecid104
t Nttcid105
21  cid107hcid107L13 
Applying the Gartner-Ellis theorem see for example 30 we conclude that for
any Borel set A
 inf
Jx  lim inf
t
 lim sup
t
at2 log P
at2 log P
cid18Nt  t
cid18 Nt  t
cid19
cid19
  inf
cid26
x 
cid27
x21  cid107hcid107L13
21  cid107hcid107L13
Jx  sup
Lemma 1 For   cid107hcid107L1  1  log cid107hcid107L1
EeNt  ecid82 t
0 F s1ds
where F s  ecid82 s
0 huF su1du for any 0  s  t
Proof The Hawkes process has a very nice immigration-birth representation see
for example Hawkes and Oakes 54 The immigrant arrives according to a homo-
geneous Poisson process with constant rate  Each immigrant produces a number
of children this being Poisson distributed with parameter cid107hcid107L1 Conditional on
the number of the children of an immigrant the time that a child is born has
probability density function ht
cid107hcid107L1
 Each child produces children according to the
same laws independent of other children All the immigrants produce children
independently Let F t  EeSt where St is the number of descendants an
immigrant generates up to time t Hence we have
cid88
Ecid2eNtcid3 
 ecid82 t
0 F s1ds
cid90
cid90
et 1
t1t2tk
F t1 F tkdt1  dtk
By page 39 of Jagers 58 for all   cid107hcid107L1  1  log cid107hcid107L1 EeS is
the minimal positive solution of
EeS  e expcid8EeS  1cid9 
Let K be the number of children of an immigrant and let S1
     SK
the number of descendants of immigrants kth child that were born before time t
including the kth child if and only if it was born before time t Then
F t 
cid88
Ecid2eStK  kcid3 PK  k
cid105k PK  k
Ecid104
cid88
cid19k
cid18cid90 t
cid88
 ecid82 t
0 hsF ts1ds
F t  sds
cid107hcid107L1
eS1
ecid107hcid107L1
cid107hcid107k
146 Simulations and Calibrations
Assume the past of a Hawkes process is known up to present time zero say the
conguration of the history is  Let 1 be the rst jump after time zero Then
it is easy to see that
P1  t  ecid82 t
0 
s   cid80
where 
 hs    This leads to a straight forward simulation
method which is applicable for any simple point process This algorithm and its
theoretical foundation go back to a thinning procedure given Lewis and Shedler
70 In the context of Hawkes processes this simulation method was rst used in
Ogata 89 It is sometimes called Ogatas modied thinning algorithm
If we want to simulate the stationary version of the Hawkes process on a nite
time interval then the standard method for the simulation method described above
does not work as the past of the process is not known and cannot be simulated at
least not completely
If one ignores the past of the process and simply starts to simulate the process
at some given time one speaks about an approximate simulation In this case
one is actually simulating a transient version and not the stationary version of the
process But if one simulates for a long enough time interval then the transient
version converges to the stationary one Such an approximate simulation method
of Hawkes processes was discussed in Mller and Rasmussen 80 A simulation
method which directly simulates the stationary version without approximation is a
so-called perfect simulation method The idea is to incorporate somehow the eect
of past observations without actually simulating the past of the process For point
processes this type of simulation has rst been described in Brix and Kendall 20
In the context of Hawkes processes the perfect simulation method was discussed
in Mller and Rasmussen 79
The calibrations ie the estimation of the parameters of Hawkes processes
was rst studied in Vere-Jones 110 and Ozaki 91 based on a maximum likeli-
hood method for point processes introduced by Rubin 99 The properties of the
maximum likelihood estimator was analyzed in Ogata 86
In Marsan and Lengline 73 an Expectation-Maximization EM algorithm
called Model Independent Stochastic Declustering MISD is introduced for the
background rate For linear Hawkes process with intensity t  t cid80
nonparametric estimation of self-exciting point processes with time-homogeneous
 t ht  
t is the background rate and h is the exciting function
The ecacy of the MISD algorithm was studied in Sornette and Utkin 101
where the authors found that the ability of MISD to recover key parameters such as
cid107hcid107L1 depends on the values of the model parameters In particular they pointed
out that the accuracy of MISD improves as the timescale over which the exciting
function h decays shortens In Lewis and Mohler 68 they introduced a Max-
imum Penalized Likelihood Estimation MPLE approach for the nonparametric
estimation of Hawkes processes The method is capable of estimating t and ht
simultaneously without prior knowledge of their form Analogous to MPLE in
the context of density estimation the added regularity of the estimates allows for
higher accuracy andor lower sample sizes in comparison to MISD
15 Nonlinear Hawkes Processes
Consider a simple point process with intensity
t  
ht  sN ds
cid18cid90 t
cid19
where   R  R and h  R  0 Bremaud and Massoulie 14
studied the existence and uniqueness of a stationary nonlinear Hawkes process
that satises the dynamics 155 as well as its stability in distribution and in
variation They allow h to take negative values as well In this thesis we always
consider h to be nonnegative
The following result is about the existence of a stationary nonlinear Hawkes
process satisfying the dynamics 155 We do not need  to be Lipschitz
Theorem 4 Bremaud and Massoulie 14 Let  be a nonnegative nondecreas-
ing and left-continuous function satisfying z  C  z for any z  0 for some
C  0 and   0 and let h  R  R be such that cid82 
0 htdt  1 Then
there exists a stationary point process N with dynamics 155
The following results concerns the uniqueness and stability in distribution and
in variation of a nonlinear Hawkes process
Theorem 5 Bremaud and Massoulie 14 Let  be -Lipschitz such that
cid107hcid107L1  1
i There exists a unique stationary distribution of N with nite average inten-
sity EN O 1 and with dynamics 155
ii Let at  cid82 t
cid82
R hs  uN duds The dynamics 155 are stable
in distribution with respect to either the initial condition 156 or the condition
157 below
at   as and lim
t at  0 ae for every a  0
Eat   and lim
t
Eat  0 for every a  0
iii The dynamics 155 are stable in variation with respect to the initial
condition
cid90
cid90
cid90 0
ht  sN ds   as
htN t 0dt 
if we assume further thatcid82 
thtdt  
Massoulie 74 extended the stability results to nonlinear Hawkes processes with
random marks He also considered the Markovian case and proved stability results
without the Lipschitz condition for 
Very recently Karabash 63 proved stability results for a much wider class of
nonlinear Hawkes process including the case when  is not Lipschitz
Moreover Bremaud et al
15 considered the rate of extinction for nonlin-
ear Hawkes process that is the rate of convergence to the equilibrium when the
stationary process is an empty process Indeed they considered a more general
setting ie Hawkes process with random marks Let N be a nonlinear Hawkes
process which is empty on  0 ie N  0  0 which satises the dynamics
t  t  
ht  sN ds
cid18cid90 t
cid19
where   R  R is locally integrable   R  0 0  0  is 1-
Lipschitz and h  R  R is measurable and not necessarily nonnegative and
htdt  1 The unique stationary process N 0 corresponding to the dynamics
cid82 
cid19
cid18cid90 t
0 tdt  cid82 
is the empty process Assumecid82 
ht  sN 0ds
thtdt   and t cid55 ht is
locally bounded
Then tN converges in variation to the empty process The convergence in
variation takes place via coupling in the sense that there exists a nite random
time T so that
PN t  0 for any t  T   1
Depending on whether the tail of ht is exponential or subexponentail the
following was obtained by Bremaud et al 15
In the exponential case let   0 be such that cid82 
0 ethtdt  1 Assume
ett is directly Riemann integrable Then for any K with
cid82 
cid82 
0 ettdt
tethtdt
there exists t0K for any t  t0K
PT  t  Ket
In the subexponential case assume that distribution functinon G with density
cid82 
0 htdt is subexponential  is bounded and that B  lim supt t
 where G  1  G Then for any
there exists t0K such that for any t  t0
htdt
1 cid82 
cid90 
PT  t  K
Gsds
Kwiecinski and Szekli 66 considered the nonlinear Hawkes process as a special
case of self-exciting process Let N R be the space of point processes on R
which can be regarded as an element of DR the space of functions which
are right-continuous with left limits equipped with Skorohod topology For any
   N R  N  if B  B for any bounded set B  BR For any
   N R  D  if and only if t D t for the corresponding functions
t  0 t t  0 t  DR ie t  t for all t  0
Now for a simple point process N with intensity t N  and compensator
t N  cid82 t
any    N R
0 s N ds we say that N is positively self-exciting wrt N if for
 N  implies that for any t  0 t   t 
and N is positively self-exciting wrt D if for any    N R
 D  implies that for any t  0 t   t 
Kwiecinski and Szekli 66 pointed out that if h is nonnegative and 
nondecreasing then N is positively self-exciting with respect to N  and that
if h is nonnegative and nondecreasing and  is nondecreasing then N is
positively self-exciting with respect to D
Let F be a Polish space with a closed partical ordering  A probability
measure on F is associated  if
P C1  C2  P C1P C2
for all increasing sets C1 C2  F a set C is increasing if x  C and x  y implies
y  C
Kwiecinski and Szekli 66 proved that if N is positively self-exciting point pro-
cess wrt N resp D then N is associated N  resp D Therefore it
implies that for a nonlinear Hawkes process if h is nonnegative and  nonde-
creasing then N is associated N  and if h is nonnegative and nondecreasing
and  is nondecreasing then N is associated D
Next let us consider the limit theorems for nonlinear Hawkes process When
 is nonlinear the usual immigration-birth representation no longer works and
you may have to use some abstract theory to obtain limit theorems Some progress
has already been made
Bremaud and Massoulie 14s stability result implies that by the ergodic the-
   EN 0 1
as t   where EN 0 1 is the mean of N 0 1 under the stationary and ergodic
measure
In this thesis we will obtain a functional central limit theorem and a Strassens
invariance principle in Chapter 2 and a process-level ie
level-3 large deviation
principle in Chapter 3 and thus a level-1 large deviation principle by contraction
principle We will also obtain an alternative expression for the rate function for
level-1 large deviation principle of Markovian nonlinear Hawkes process as a vari-
ational formula in Chapter 4
16 Multivariate Hawkes Processes
We say N  N1     Nd is a multivariate Hawkes process if for any 1  i  d
Ni is a simple point process with intensity
cid90 t
dcid88
it  i 
hijt  sdNjs
where i  R and hij  R  R Then   1     d is a vector and
h  hij1ijd is a d  d matrix-valued function
Let us assume that for any i jcid82 
K of the matrix K  cid82 
0 hijtdt   and that the spectral radius
0 htdt satises K  1 Then Bacry et al
proved a law of large numbers ie
cid107T 1NT u  uI  K1cid107  0
u01
as T   almost surely and also in L2P If we assume further that for any
1  i j  d
cid90 
cid18 1
hijtt12dt  
Then Bacry et al 2 proved the following central limit theorem
NT u  uI  K1
u  0 1
cid19
converges in law as T   under the Skorohod topology to
I  K112Wu
u  0 1
where  is the diagonal matrix with ii  I  K1i 1  i  d
It is well known that under the assumption that K  1 there exists a
unique stationary version of the multivariate Hawkes process satisfying the dy-
namics 170 The rate of convergence to the stationary version of the multivari-
ate Hawkes process was obtained in Torrisi 103 The Bartlett spectrum of the
multivariate Hawkes process was derived in Hawkes 52 Some non-asymptotics
estimates for multivariate Hawkes processes were obtained in Hansen et al 49
A nice survey on multivariate linear Hawkes processes can be found in Liniger
Chapter 2
Central Limit Theorem for
Nonlinear Hawkes Processes
21 Main Results
In this chapter we obtain a functional central limit theorem for the nonlinear
Hawkes process under Assumption 1 Under the same assumption a Strassens
invariance principle also holds Let us recall that N is a nonlinear Hawkes process
with intensity
t  
cid18cid90
t
cid19
ht  sN ds
Assumption 1 We assume that
 h  0  R is a decreasing function andcid82 
thtdt  
  is positive increasing and -Lipschitz ie x  y  x  y for
any x y and cid107hcid107L1  1
Bremaud and Massoulie 14 proved that if  is -Lipschitz with cid107hcid107L1  1
there exists a unique stationary and ergodic Hawkes process satisfying the dynam-
ics 12 Hence under our Assumption 1 which is slightly stronger than 14
there exists a unique stationary and ergodic Hawkes process satisfying the dynam-
ics 12
Let P and E denote the probability measure and expectation for a stationary
ergodic Hawkes process and let PF
 and EF
 denote the conditional
probability measure and expectation given the past history
The following are the main results of this chapter
Theorem 6 Under Assumption 1 let N be the stationary and ergodic nonlinear
Hawkes process with dynamics 12 We have
Nt  t
 B
as t  
where B is a standard Brownian motion and 0     where
cid88
2  EN 0 1  2  2
EN 0 1  N j j  1  
The convergence in 22 is weak convergence on D0 1 the space of cadlag func-
tions on 0 1 equipped with Skorokhod topology
Remark 1 By a standard central limit theorem for martingales ie Theorem 9
it is easy to see that
Nt cid82 t
0 sds
 
B
as t  
where   EN 0 1
In the linear case say z    z Bacry et al
proved that 2 in 23 satises 2 
surprising because Nt  t should have more uctuations than Nt cid82 t
0 sds
Therefore we guess that for nonlinear  2 dened in 23 should also satisfy
2    EN 0 1 However it might not be very easy to compute and say
1cid107hcid107L1 3   
 That is not
1cid107hcid107L1
something about 2 in such a case
variance 1 we have the central limit theorem 1
cid80n
In the classical case for a sequence of iid random variables Xi with mean 0 and
i1 Xi  N 0 1 as n   and
cid80n
n log log n  0 in probability as n   but the convergence does not
we also have
hold as The law of the iterated logarithm says that lim supn
cid80n
n log log n 
as A functional version of the law of the iterated logarithm is called Strassens
invariance principle
It turns out that we also have a Strassens invariance principle for nonlinear
Hawkes processes under Assumption 1
Theorem 7 Under Assumption 1 let N be the stationary and ergodic nonlinear
Hawkes process with dynamics 12 Let Xn  N n  1 n   Sn cid80n
i1 Xi
n  t and for t  0 1 let nt be the usual linear
n gt  supn  s2
n  ES2
interpolation ie
nt 
Sk  s2
nt  s2
cid1122s2
k1  s2
n log log s2
k1Xk1
k  s2
nt  s2
k1 k  0 1     n  1
Then ge   n n  ge is relatively compact in C0 1 the set of contin-
uous functions on 0 1 equipped with uniform topology and the set of limit points
cid82 1
is the set of absolutely continuous functions f  on 0 1 such that f 0  0 and
0 fcid48t2dt  1
22 Proofs
This section is devoted to the proof of Theorem 6 We use a standard central
limit theorem ie Theorem 8 In our proof we need the fact that EN 0 12  
which is proved in Lemma 3 Lemma 3 is proved by proving a stronger result rst
ie Lemma 2 We will also prove Lemma 4 to guarantee that   0 so that the
central limit theorem is not degenerate
Let us rst quote the two necessary central limit theorems from Billingsley 8
In both Theorem 8 and Theorem 9 the ltrations are the natural ones ie given
a stochastic process XnnZ F a
Theorem 8 Page 197 8 Suppose Xn n  Z is an ergodic stationary sequence
such that EXn  0 and
b  Xn a  n  b for   a  b  
cid88
cid107EX0F
n cid1072  
0   2cid80
n  B weakly
where cid107Y cid1072  EY 212 Let Sn  X1   Xn Then Sn
where the weak convergence is on D0 1 equipped with the Skorohod topology and
2  EX 2
Theorem 9 Page 196 8 Suppose Xn n  Z is an erogdic stationary se-
n   and let
quence of square integrable martingale dierences ie 2  EX 2
n  B weakly where
EXnF
n1  0 Let Sn  X1    Xn Then Sn
EX0Xn The series converges absolutely
the weak convergence is on D0 1 equipped with the Skorohod topology
Now we are ready to prove our main result
Proof of Theorem 6 Since in the stationary regime EN n n  1  EN 0 1 for
any n  Z and let us denote EN 0 1   In order to apply Theorem 8 let us
rst prove that
cid110Ecid104cid0EN n n  1  F
cid12cid105cid11112
cid88
1 N n n  1 and E
2 N n n  1 be two independent copies of EN n n 
Let E
1F
cid1052cid27
2 N n n  1
2 N n n  12cid105
 It is easy to check that
1 N n n  1  E
cid26cid104E
Ecid104E
Ecid104E
1 N n n  12cid105
 Ecid104E
 Ecid2EN n n  1F
2cid3  2
2cid3 
 Ecid2EN n n  1  F
1 N n n  1E
2 N n n  1
cid105
Therefore we have
Ecid2EN n n  1  F
cid26cid104E
cid26cid104E
cid26cid104E
2cid3
cid26cid104E
1 N n n  1  E
2 N n n  1
1 N n n  1  E
N n n  1
1 N n n  1  E
N n n  1
cid1052cid27
cid1052cid27
cid1052cid27
cid1052cid27
N n n  1
2 N n n  1  E
where E
N n n  1 denotes the expectation of the number of points in n n 
1 for the Hawkes process with the same dynamics 12 and empty history ie
N  0  0
Next let us estimate E
1 N n n  1  E
N n n  1 E
1 N n n  1 is
the expectation of the number of points in n n  1 for the Hawkes process with
1 under P
 It is well dened for ae 
intensity t  
 
because under Assumption 1
cid16cid80
cid17
1 0t ht   
cid20cid90 t
cid21
210 Et  0  E
ht  sN ds
 0  cid107hcid107L1EN 0 1  
which implies that t   P-as
It is clear that E
1 N n n  1  E
N n n  1 almost surely so we can use
a coupling method to estimate the dierence We will follow the ideas in Bremaud
and Massoulie 14 using the Poisson embedding method Consider FP the
canonical space of a point process on RR in which N is Poisson with intensity
1 under the probability measure P Then the Hawkes process N 0 with empty past
0
cid16cid82
N 0C cid82
cid16cid82
DnC cid82

history and intensity 0
t satises the following
cid17
0t ht  sN 0ds
C N dt  0 0
t  R
C  BR
For n  1 let us dene recursively n
t  Dn and N n as follows
0t ht  sN n1ds cid80
ht   

cid17
C N dt  n1
N nC  N n1C  DnC
t  R
C  BR
C  BR
Following the arguments as in Bremaud and Massoulie 14 we know that each n
is an F N
is the -algebra generated by N up to time
t -intensity of N n where F N
t By our Assumption 1  is increasing and it is clear that nt and N nC
increase in n for all t  R and C  BR Thus Dn is well dened and also
that as n   the limiting processes t and N exist N counts the number of
points of N below the curve t cid55 t and admits t as an F N
monotonicity properties of n
t -intensity By the
t and N n we have
cid90
cid90
t  
t  
ht  sN ds 
ht   
ht  sN nds 
ht   
cid88
cid88


 
 
cid88
Letting n   it is valid since we assume that  is Lipschitz and thus continu-
t N  N 0 cid80
ous we conclude that N  t satises the dynamics 12 Therefore with intensity
i1 Di is the Hawkes process with past history 
We can then estimate the dierence by noticing that
1 N n n  1  E
N n n  1 
EPDin n  1
Here EP means the expectation with respect to P the probability measure on the
canonical space that we dened earlier
We have
cid21
EPD1n n  1
 EPcid20cid90 n1
cid90 n1
cid90 n1
cid88
1t  0tdt
 cid88
 tN 0
ht   dt
  
 cid88
 tN 0
 dt
ht   
ht   

where the rst equality in 216 is due to the construction of D1 in 212 the
second equality in 216 is due to the denitions of 1 and 0 in 212 and nally
the inequality in 216 is due to the fact that  is -Lipschitz Similarly
EPD2n n  1  E
 cid88
cid34
cid90 n1
cid90 n1
cid88
cid90 t
D1 t
cid35
ht   dt
ht  shs   dsdt

Iteratively we have for any k  N
EPDkn n  1  cid88
cid90 n1
cid90 tk
cid90 t2

htk  tk1htk1  tk2
cid88

Kkn  
 ht2  t1ht1   dt1  dtk 
Now let Kn   cid80
cid26cid104E
cid88
cid34cid88
cid88
 cid88
ij0

k1 Kkn   Then
1 N n n  1  E
N n n  1
2
Kn  
cid1052cid27
cid35
Kn iKn jN i i  1N j j  1
ij0
Kn iKn jEN i i  1N j j  1
cid8EN i i  12  EN j j  12cid9
cid332
Kn iKn j
ij0
cid32cid88
 EN 0 12
Kn i
Here EN 0 12   by Lemma 3 Therefore we have
cid110Ecid104cid0EN n n  1  F
cid88
0cid88
cid1122EN 0 12
cid90 tk
cid90 
cid1122EN 0 12
cid88
cid88
i
Kn i
cid12cid105cid11112
cid90 0
cid90 t2
htk  tk1htk1  tk2 ht2  t1ht1  sdsdt1  dtk
Let Ht cid82 
t hsds It is easy to check thatcid82 
0 Htdt cid82 
thtdt   by
Assumption 1 We have
cid90 0
cid90 t2
cid90 t2
cid90 
cid90 tk
cid90 
cid90 tk
cid90 
cid90 
cid90 
cid90 
htk  tk1htk1  tk2 ht2  t1ht1  sdsdt1  dtk
htk  tk1htk1  tk2 ht2  t1Ht1dt1  dtk
htk  tk1dtkhtk1  tk2dtk1  Ht1dt1
cid90 
 kcid107hcid107k1
Ht1dt1  kcid107hcid107k1
thtdt
Since cid107hcid107L1  1 we conclude that
cid110Ecid104cid0EN n n  1  F
cid12cid105cid11112
cid88
cid90 
cid88
cid1122EN 0 12kcid107hcid107k1
cid90 
cid1122EN 0 12 
thtdt
1  cid107hcid107L1
thtdt  
Hence by Theorem 8 we have
Nt  t
2  EN 0 1  2  2
 B as t  
cid88
EN 0 1  N j j  1    
By Lemma 4   0 Now nally for any   0 for t suciently large
cid18
0s1
cid12cid12cid12cid12 Nst  st
cid12cid12cid12cid12  
cid19
cid12cid12Nst  Nst  st  stcid12cid12  
cid19
cid12cid12Nst  Nst
cid19
 Nst  st
cid12cid12    
N k k  1  
t  
0s1
0s1
cid18
cid18
cid18
cid19
0ktkZ
 t  1PN 0 1  
 t  1
cid90
t  2
N 01
t  
N 0 12dP  0
as t   by Lemma 3 Hence we conclude that Ntt
 B as t  
The following Lemma 2 is used to prove Lemma 3
Ecid104
0 htsN dscid105
cid82 t
cid27
Lemma 2 There exists some   0 such that supt0
Proof Notice rst that for any bounded deterministic function f 
cid26cid90 t
cid90 t
f sN ds 
ef s  1sds
is a martingale Therefore using the Lipschitz assumption of  ie z 
0  z and applying Holders inequality for 1
q  1 we have
Ecid104
0 htsN dscid105
cid82 t
 Ecid104
cid82 t
cid82 t
 Ecid104
0 ephts1sdscid105 1
0 ephts1sds 1
0 htsN ds 1
cid82 t
 Ecid104
0 ephts10cid82 s
cid82 t
 Ecid104
cid82 t
p ephts1cid82 s
0 ephts1sdscid105
cid82 t
0 hsuN dudscid105 1
cid82 
0 ephs10ds
0 hsuN dudscid105 1
Let Ct cid82 t
pephts  1ds Then for any t  0 T 
p ephts1cid82 s
Ecid104
0 hsuN dudscid105
cid82 t
 Ecid104
cid82 t
p ephts1Ctcid82 s
 Ecid20 1
cid90 t
ephts  1eCtcid82 s
Ecid104
0 hsuN ducid105
eCcid82 s
0 hsuN dudscid105
 sup
0sT
cid21
0 hsuN duds
cid82 t
where in the rst inequality in 227 we used the Jensens inequality since x cid55 ex
pephts 1ds  1 and in the second inequality in 227
is convex and 1
pephts  1ds  1 Now
we used the fact that Ct  C and again 1
choose q  1 so small that qcid107hcid107L1  1 Once p and q are xed choose   0 so
small that
cid82 t
C 
cid90 
ephs  1ds  
This implies that for any t  0 T 
Ecid104
0 htsN dscid105  sup
cid82 t
Ecid104
0 hsuN ducid105 1
ecid82 s
cid82 
0 ephs10ds
0sT
Hence we conclude that for any T  0
Ecid104
0 htsN dscid105  e
cid82 
ecid82 t
0 ephs10ds  
0tT
Lemma 3 There exists some   0 such that EeN 01   Hence EN 0 12 
Proof By Assumption 1 h is positive and decreasing Thus   inf t01 ht 
0 Hence
eN t1t  E
cid82 t
0 htsN ds
By Lemma 2 we can choose   0 so small that
eN t1t  
lim sup
t
Finally EeN 01  lim inf t E
eN t1t  
It is intuitively clear that   0 But still we need a proof
Lemma 4   0 where  is dened in 223
Proof Let n  cid80
EN j j  1  F
n1 where   EN 0 1 n is well
dened because we proved 27 To see this notice that
cid13cid13cid13cid13 cid88
cid88
cid107ncid1072 
by 27 Also it is easy to check that
cid13cid13cid13cid132
EN j j  1  F
cid107EN j j  1  F
n1cid1072  
En1  n  N n n  1  F
EN j j  1  F
cid34 cid88
cid34 cid88
cid88
cid35
cid12cid12cid12cid12F
cid35
cid12cid12cid12cid12F
cid88
EN j j  1  F
 N n n  1  
EN j j  1  F
n1 
EN j j  1  F
 N n n  1    N n n  1    0
Let Yn  n1  n2  N n  2 n  1   This is an ergodic stationary
sequence such that EYnF
n    and by Theorem 9
j1 Yj It is clear that   cid48   since for any
Scid48
n1  0 By 27 EY 2
n  cid48B where Scid48
n cid80n
  0
cid33
cid27cid19
1 
cid19
kcid88
cid32
cid18
cid18cid26
 ncid88
1knkZ
1knkZ
j1  j2  
k1  1  
cid19
cid27cid91cid26
cid18
1knkZ
k1 
k1 
cid19
cid18
cid18
cid90
1 
1 
1 
cid19
12dP  0
 n  1P
 4n  1
as n   where we used the stationarity of P Chebychevs inequality and 27
Now it becomes clear that
2  cid482  EY 2
 E 0  1  N 1 0  2
EN j j  1  F
cid32 cid88
cid332
EN j j  1  F
cid88
Consider D     cid54  0 1   Notice that P    0 By
Jensens inequality and Assumption 1 we have
cid90
 Ecid104
 exp
 ht dtcid105
N 0 1  0Pd
ecid82 1
0 cid80
cid32cid88
cid40
cid90 1
cid40
cid90 1

cid88
ht   
cid33
cid41
cid41
 exp
0  E
ht   dt

 exp0  EN 0 1  cid107hcid107L1  0
It is clear that given the event D
EN j j  1  F
cid88
EN j j  1  F
EN j j  1  F
 cid54
cid33
EN j j  1  F
cid88
cid88
cid32 cid88
Therefore
which implies that   0
Proof of Theorem 7 By Heyde and Scott 57 the Strassens invariance principle
holds if we have 27 and   0
Chapter 3
Process-Level Large Deviations
for Nonlinear Hawkes Processes
31 Main Results
In this chaper we prove a process-level ie
level-3 large deviation principle
for nonlinear Hawkes processes As a corollary a level-1 large deviation principle
is obtained by a contraction principle
Let us recall that N is a nonlinear Hawkes process with intensity
cid18cid90
cid19
t  
ht  sN ds
t
Throughout this chapter we assume that
 The exciting function ht is positive continuous and decreasing for t  0
and ht  0 for any t  0 We also assume thatcid82 
0 htdt  
 The rate function   0  R is increasing and limz z
z  0 We
also assume that  is Lipschitz with constant   0 ie x  y 
x  y for any x y  0
Let  be the set of countable locally nite subsets of R and for any   
and A  R write A    A For any t  R we write t  t Let
N A   A denote the number of points in the set A for any A  R We also
use the notation Nt to denote N 0 t the number of points up to time t starting
from time 0 We dene the shift operator t by ts  t  s We equip the
sample space  with the topology in which the convergence n   as n   is
dened by
cid88
n
f   cid88

f  
for any continuous f with compact support
This topology is equivalent to the vague topology for random measures for
which see for example Grandell 45 One can equip the space of locally nite
random measures with the vague topology The subspace of integer valued random
measures is then the space of point processes A simple point processes is a point
process without multiple jumps The space of point processes is closed But the
space of simple point processes is not closed
Denote F s
t  s t for any s  t ie the -algebra generated by all the
possible congurations of points in the interval s t Denote M the space of
probability measures on  We also dene MS as the space of simple point
processes that are invariant with respect to t with bounded rst moment ie for
any Q  MS EQN 0 1   Dene ME as the set of ergodic simple
point processes in MS We dene the topology of MS as follows For a
sequence Qn in MS and Q  MS we say Qn  Q as n   if and only if
cid90
f dQn 
cid90
cid90
N 0 1Qnd 
N 0 1Qd
as n   for any continuous and bounded f and
cid90
as n   In other words the topology is the weak topology strengthened by the
convergence of the rst moment of N 0 1 For any Q1 Q2 in MS one can
dene the metric d by
dQ1 Q2  dpQ1 Q2 cid12cid12EQ1N 0 1  EQ2N 0 1cid12cid12 
where dp is the usual Prokhorov metric Because this is an unusual topology
the compactness is dierent from that in the usual weak topology later when we
prove the exponential tightness we need to take some extra care See Lemma 22
and iii of Lemma 21
We denote by C the set of real-valued continous functions on  We sim-
 the set of all bounded F
ilarly dene C  R We also denote by BF
progressively measurable and F
predictable functions
Before we proceed recall that a sequence PnnN of probability measures on a
topological space X satises the large deviation principle LDP with rate function
I  X  R if I is non-negative lower semicontinuous and for any measurable set
 inf
Ix  lim inf
n
log PnA  lim sup
n
log PnA   inf
Here Ao is the interior of A and A is its closure See Dembo and Zeitouni 30
or Varadhan 106 for general background regarding large deviations and their
applications Also Varadhan 107 has an excellent survey article on this subject
In the pioneering work by Donsker and Varadhan 31 they obtained a level-3
large deviation result for certain stationary Markov processes
We would like to prove the large deviation principle for nonlinear Hawkes pro-
cesses by proving a process-level also known as level-3 large deviation principle
rst We can then use the contraction principle to obtain the level-1 large deviation
principle for Ntt  
Let us dene the empirical measure for the process as
RtA 
Astds
cid90 t
for any A where ts  s for 0  s  t and tst  ts for any s Donsker
and Varadhan 31 proved that in the case when  is a space of cadlag functions
 on   t   endowed with Skorohod topology and taking values in a
Polish space X under certain conditions P 0xRt   satises a large deviation
principle where P 0x is a Markov process on 0 with initial value x  X The
rate function HQ is some entropy function
Let h  be the relative entropy of  with respect to  restricted to the
-algebra  For any Q  MS let Q
distribution of Q Similarly we dene P 
be the regular conditional probability
Let us dene the entropy function HQ as
HQ  EQhQ
 P 
Notice that P 
It has rate cid80
ned for almost every  under Q if EQN 0 1   since EQcid80
cid107hcid107L1EQN 0 1   implies cid80
describes the Hawkes process conditional on the past history
0s hs    at time 0  s  1 which is well de-
 h  
 h    for all
 hs     cid80
0  s  1
When HQ   hQ
 P 
   for ae  under Q which implies that
Q cid28 P 
1  By the theory of absolute continuity of point processes see
for example Chapter 19 of Lipster and Shiryaev 72 or Chapter 13 of Daley and
Vere-Jones 27 the compensator of Q
density  say such that by the Girsanov formula
is absolutely continuous ie it has some
where   
0  s  1 For the equality in 39 we used the fact that Nt cid82 t
 Both  and  are F
a martingale under Q and for any f  s which is bounded F
-predictable for
 sds is
progressively
measurable and predictable we have
f  sdNsQd 
cid90
cid90 1
f  s sdsQd
cid90
cid90 1
cid90
cid90
cid16
cid90 cid20cid90 1
cid34cid90 1
cid17
  
cid90 1
 s   s  log
cid16cid80
cid17
0s hs   
cid21
logdNs
cid32  s
cid33
Qd
dQ
cid35
Qd
 s
We will use the above fact repeatedly in this chapter
The following theorem is the main result of this chapter
Theorem 10 For any open set G  MS
lim inf
t
log P Rt  G   inf
and for any closed set C  MS
lim sup
t
log P Rt  C   inf
We will prove the lower bound in Section 32 the upper bound in Section
33 and the superexponential estimates that are needed in the proof of the upper
bound in Section 34
Once we establish the level-3 large deviation result we can obtain the large
deviation principle for Ntt   directly by using the contraction principle
Theorem 11 Ntt   satises a large deviation principle with the rate function
I given by
Proof Since Q cid55 EQN 0 1 is continuous cid82
QMS EQN 01x
 N 0 1dRt satises a large de-
viation principle with the rate function I by the contraction principle For a
discussion on contraction principle see for example Varadhan 106
cid90 t
cid90 t1
N 0 1dRt 
cid90
Notice that
N 0 1stds
N s s  1ds 
cid90 t
N s s  1tds
cid90 t
0  1
N s s  1tds  1
N t  1 t  N 0 1
cid90 t1
N s s  1ds 
cid20cid90 t
Nsds 
cid90 1
cid21
Nsds
cid90 t1
N s s  1ds  Nt1  N1
 N t  1 t  N1
 N t  1 t  N1
cid90
N 0 1dRt  Nt
N t  1 t  N1
For the lower bound for any open ball Bx centered at x with radius   0
 Bx
N 0 1dRt  B2x
cid18 Nt
cid19
cid18cid90
cid18 N t  1 t
cid19
cid18N1
cid19
cid19
For the upper bound for any closed set C and C  cid83
cid19
cid18 N1
cid19
cid18cid90
cid18 N t  1 t
N 0 1dRt  C 
cid18 Nt
cid19
xC Bx
cid19
Finally by Lemma 17 we have the following superexponential estimates
lim sup
t
 lim sup
t
 
cid18 N t  1 t
cid19
cid19
cid18 N1
Hence for the lower bound we have
lim inf
t
and for the upper bound we have
lim sup
t
cid18 Nt
cid18 Nt
cid19
 Bx
 Ix
cid19
  inf
which holds for any   0 Letting   0 we get the desired result
32 Lower Bound
Lemma 5 For any    0      log  0
cid105
  1  log
Proof Write      log  
 Thus it is sucient
to show that F x  x 1 log x  0 for any x  0 Note that F 0  F   0
and F cid48x  1  1
x  0 when 0  x  1 and F cid48x  0 when x  1 and nally
F 1  0 Hence F x  0 for any x  0
cid104
Lemma 6 Assume HQ   Then
EQN 0 1  C1  C2HQ
where C1 C2  0 are some constants independent of Q
Proof If HQ   then hQ
that Q cid28 P 
under Q
and P 
  for ae  under Q which implies
and thus At cid28 At where At and At are the compensators of Nt
 P 
respectively For the theory of absolute continuity of point
processes and Girsanov formula see for example Lipster and Shiryaev 72 or Daley
0  sds we have At cid82 t
and Vere-Jones 27 Since At cid82 t
cid20cid90 1
cid21
cid17 ds
 By the Girsanov formula
cid16
    log
HQ  EQ
 sds for some
Notice that EQN 0 1 cid82cid82 1
cid90 cid90 1
dsdQ
cid90 cid90 1
cid90
cid88
dsdQ  
hs   dsdQ  C
cid90 cid88
h0N 0 1dQ  
h dQ  C
 h0  cid107hcid107L1EQN 0 1  C
 h0  cid107hcid107L1
cid90 cid90 1
dsdQ  C
  1KdsdQ  Kh0  cid107hcid107L1
cid90 cid90 1
dsdQ  KC
Therefore we have
cid90 cid90 1
On the other hand by Lemma 5
cid90 cid90 1
cid104
HQ 
     log
 log K  1
  1KdsdQ
cid90 cid90 1
cid105  1KdsdQ
cid90 cid90 1
dsdQ  Kh0  cid107hcid107L1
cid90 cid90 1
dsdQ  KC 
log K  1
Choosing K  e and  
Kh0cid107hcid107L1  we get
EQN 0 1 
1  Kh0  cid107hcid107L1
log K  1Kh0  cid107hcid107L1
Lemma 7 We have the following alternative expression for HQ
f sBF
CR0s1
1  ef ds 
cid20cid90 1
cid90 1
cid21
Q also cid80
Proof EQN 0 1   implies that EQ
 h    since EQcid80
cid90 1
N 0 1  EP 
EP 
N 0 1   for almost every  under
 h   cid107hcid107L1EQN 0 1  
 cid88
0s
 ds
h   
hs   
cid88

 C  h0EP 
N 0 1  
so EP 
N 0 1   by choice of   1
13 of Daley and Vere-Jones 27 if EQ
By the theory of absolute continuity of point processes see for example Chapter
N 0 1   Q cid28 P 
0   sds are the compensators
If thats the case we can write At 
if and only if At cid28 At where At and At cid82 t
cid82 t
  sds for some  and there is Girsanov formula
of Nt under Q
N 0 1 EP 
and P 
respectively
dQ
dP 
which implies that
HQ  EQ
cid90 1
cid16
cid17
  ds 
cid90 1
cid12cid12cid12cid12F 0
cid16
cid21
cid17 ds
    log
cid20cid90 1
For any f  f  1  ef    log     and the equality is achieved when
f  log Thus clearly we have
cid20cid90 1
cid90 1
cid21
f sBF
CR0s1
1  ef ds 
 HQ
On the other hand we can always nd a sequence fn convergent to log and
by Fatous lemma we get the opposite inequality
Now assume that we do not have Q cid28 P 
for ae  under Q That
implies that HQ   We want to show that
f sBF
CR0s1
1  ef ds 
cid21
cid90 1
cid20cid90 1
Let us assume that
f sBF
CR0s1
cid20cid90 1
1  ef ds 
cid21
cid90 1
We want to prove that HQ  
Let P 
be the point process on 0 1 with compensator At   At Clearly
At cid28 At   At and Q cid28 P 
1  ef dAs   As  f d As
For any f 
cid20cid90 1
cid20cid90 1
cid20cid90 1
cid20cid90 1
cid20cid90 1
1  ef f 0dAs   As  f f 0d As
1  ef f0dAs   As  f f0d As
cid21
cid21
dAs   As
dAs   As
 C  h0  cid107hcid107L1EQN 0 1
f sBF
CR0s1
cid21
cid21
cid21
cid21
1  ef f0dAs  f f0d As
1  ef f0dAs  f f0d As
cid21
cid90 1
1  ef ds 
cid21
cid20cid90 1
cid20cid90 1
cid20cid90 1
Therefore
  lim inf
 lim inf
cid20cid90 1
1  ef dAs   As  f d As
f sBF
CR0s1
f sBF
CR0s1
cid34cid90 1
cid32
1  ef  f 
cid33
dAs   As
dAs   As
cid21
cid35
 lim inf
EQhQ
 P 
 EQhQ
 P 
  HQ
by lower semicontinuity of the relative entropy h Fatous lemma and the fact
that P 
weakly as   0 Hence HQ  
  P 
Lemma 8 HQ is lower semicontinuous and convex in Q
Proof By Lemma 7 we can rewrite HQ as
f sBF
CR0s1
f sBF
CR0s1
cid20cid90 1
cid20cid90 1
cid21
cid90 1
1  ef   f ds
1  ef ds 
cid21
If Qn  Q then EQnN 0 1  EQN 0 1 and Qn  Q weakly Since f  s 
C  R  BF
0 f  sdNs is continuous on  and since f is uniformly
cid82 1
cid20cid90 1
boundedcid82 1
0 f  sdNs  cid107fcid107LN 0 1 Hence
cid20cid90 1
cid21
f  sdNs
cid21
f  sdNs
 s hM s   cid1 where hM s  hssM  Then M  s 
0 M 1  ef sds  C Also cid82 1
0 M 1  ef sds 
Let M  cid0cid80
C  R and thus cid82 1
cid20cid90 1
K1  ecid107fcid107L N M 1 where K  0 is some constant Therefore
cid20cid90 1
cid21
M 1  ef sds
M 1  ef sds
as n   Next notice that
cid12cid12cid12cid12EQ
cid20cid90 1
M 1  ef sds
 EQ1  ecid107fcid107L EQN 0 1
hsds  0
cid21
cid21
cid20cid90 1
cid90 
cid21cid12cid12cid12cid12
1  ef sds
cid21
 EQn
cid20cid90 1
1  ef sds
M 1  ef sds
as M   Similarly we have
lim sup
M
lim sup
n
cid20cid90 1
cid12cid12cid12cid12EQn
cid20cid90 1
cid21
cid20cid90 1
 s1  ef sds
 s1  ef sds
cid21cid12cid12cid12cid12  0
cid21
The supremum is taken over a linear functional of Q which is continuous in Q
therefore the supremum over these linear functionals will be lower semicontinuous
Similarly since in the variational formula expression of HQ in Lemma 7 the
supremum is taken over a linear functional of Q HQ is convex in Q
Lemma 9 HQ is linear in Q
Proof It is in general true that the process-level entropy function HQ is linear
in Q Following the arguments in Donsker and Varadhan 31 there exists a subset
0 measurable and a F
0   which is F
0 measurable map Q  0  ME
such that Q0  1 for all Q  MS and Q  Q  Q  1 for all Q  ME
Therefore there exists a universal version say Q
independent of Q such that
Qd  Q Since that is true for all Q  ME it also holds for
cid82 Q
Q  MS Hence
HQ  EQcid104
hQ
cid105
 EQcid104
 P 
h Q
 P 
cid105
ie HQ is linear in Q
In this chapter we are proving the large deviation principle for Hawkes pro-
cesses started with empty history ie with probability measure P
 But when
time elapses the Hawkes process generates points and that create a new history
We need to understand how the history created aects the future What we want
to prove is some uniform estimates to the eect that if the past history is well
controlled then the new history will also be well controlled This is essentially
what the following Lemma 10 says Consider the conguration of points starting
from time 0 up to time t We shift it by t and denote that by wt such that wt  
where  is  restricted to R These notations will be used in Lemma 10
Remark 2 At the very beginning of the chapter we dened t It should not be
confused with wt in this section
Lemma 10 For any Q  ME such that HQ   and any open neighborhood
cid96   1 as cid96   and
N of Q there exists some K
cid96 such that   K
cid96 and QK
lim inf
t
w0K
cid96
log P w0Rt  N wt  K
cid96   HQ
Proof Let us abuse the notations a bit by dening
  
hs   
 cid88
0s
 
For any t  0 since   c  0 and  is Lipschitz with constant  we have
w0  ds 
w0  ds 
hs   ds 
cid88
cid19
cid90 t
cid90 t
cid90 t
cid18 
cid18
cid88
w0  
hs   dNs
cid19
w0
w0
cid90 t
cid90 t
cid90 t
dP 
cid12cid12cid12cid12F 0
Dene
By the maximal ergodic theorem
cid96    N t 0  cid961  tt  0 
QK
cid96 c  Q
cid18
cid18
cid18
cid19
N t 0
N t  1 0
 cid96
t  1
N n 0
 cid96
n1nN
 EQN 0 1
cid96
cid19
 cid96
cid19
as cid96   Thus QK
cid96   1 as cid96  
Fix any s  0 and   K
cid96  Since h is decreasing hcid48  0 integration by parts
shows that
cid88

hs    
cid90 
cid90 
cid90 
 
hs  dN  0
N  0hcid48s  d
cid961  hcid48s  d
cid90 
hs  d
 cid96hs  cid96
 cid96hs  cid96Hs
t hsds
where Ht cid82 
cid90 t
cid88
w0
Therefore uniformly for  w0  K
cid96 
where ut cid82 t
cid90 t
Dene
0 Hsds and
cid88
w0
cid96t 
hs   ds  2cid96cid107hcid107L1  2cid96ut
hs   dNs  2cid96
cid90 t
hs  HsdNs
cid26
2cid96
cid90 t
hs  HsdNs  cid962cid107hcid107L1  ut
cid27
Then uniformly in t  0
cid96tc  2EQN 0 1
c  cid96
as cid96   Thus inf t0 QK 
cid96t  1 as cid96  
Hence uniformly for  w0  K
cid96 and   K 
cid96t
dP 
 2cid96cid107hcid107L1  2cid96ut  cid962cid107hcid107L1  ut
 C1cid96  C2cid96ut
cid12cid12cid12cid12F 0
where C1cid96  2cid96cid107hcid107L1  cid962cid107hcid107L1 and C2cid96  2cid96  cid962
Observe that
lim sup
t
 lim sup
t
Let Dt  Rt  N wt  K
cid96 
Uniformly for w0  K
cid96t
cid90 t
Hsds  0
P w0Dt
 etHQC1cid96C2cid96ut
cid34
cid40
dP 
dQ
 etHQC1cid96C2cid96ut
cid12cid12cid12cid12F 0
cid34
cid41
 HQ  
cid40
dP 
dQ
cid40
cid12cid12cid12cid12F 0
dP 
 HQ  
cid12cid12cid12cid12F 0
cid41
 C1cid96  C2cid96ut
cid35
 K 
cid96 
cid96t  K
cid41cid35
Since Q  ME by ergodic theorem
t QRt  N   1
and since  t  log dQ
cid12cid12F 0
satises
 t  s   t  t s EQ t  tHQ
for almost every  under Q
t
dP 
dQ
cid12cid12cid12cid12F 0
 HQ
Q is stationary so Qwt  K
inf t0 QK 
cid96t  1 as cid96   Remember that lim supt ut
cid96   QK
cid96   1 as cid96   Also QK 
cid96t 
t  0 By choosing cid96
big enough we conclude that
lim inf
t
w0K
cid96
log P w0Rt  N wt  K
cid96   HQ  
Since it holds for any   0 we get the desired result
Theorem 12 Lower Bound For any open set G
lim inf
t
log P Rt  G   inf
Proof It is sucent to prove that for any Q  MS HQ   for any
t log P Rt  N   HQ Since for every
neighborhood N of Q lim inf t 1
invariant measure P  MS there exists a probability measure P on the space ME
QP dQ for any Q  MS such that
of ergodic measures such that P cid82
HQ   without loss of generality we can assume that Q cid80cid96
j1 j  1 By linearity of H HQ cid80cid96
j  0 1  j  cid96 andcid80cid96
j1 jHQj
Divide the interval 0 t into subintervals of length jt let tj 1  j  cid96 be the
j1 jQj where
right hand endpoints of these subintervals and let t0  0 For each Qj take K
in Lemma 10 We have min1jcid96 QjK
M   1 as M   Choose neighborhoods
Nj of Qj 1  j  cid96 such thatcid83cid96
cid96cid89
Rt  N   P
j1 jNj  N  We have
Rt1  N1 wt1  K
w0K
tj1tj2
P w0Rtjtj1  Nj wtjtj1  K
Now applying Lemma 10 and the linearity of H
lim inf
t
jHQj  HQ
Rt  N    cid96cid88
33 Upper Bound
Remark 3 By following the argument in Donsker and Varadhan 31 if  cid55
P 
is weakly continuous then
lim sup
t
log P Rt  A   inf
for any compact A If the Hawkes process has nite range of memory ie h
n   we
has compact support and if it is continuous then for any a  b if 
cid12cid12cid12cid12cid90 b
cid90 b
cid12cid12cid12cid12

cid90 b
n   sds 
cid88
hs     cid88


cid12cid12cid12cid12cid12cid12
  sds
hs   
cid12cid12cid12cid12cid12cid12 ds  
as n   which implies that P 
n  P 
If the Hawkes process does not have nite range of memory then we should use
the specic features of the Hawkes process to obtain the upper bound
Before we proceed let us prove an easy but very useful lemma that we will use
repeatedly in the proofs of the estimates in this chapter
Lemma 11 Let f  s be F
progressively measurable and predictable Then
Ecid104
cid105  Ecid104
cid82 t
cid110cid82 t
0 2f  sdNs cid82 t
0 e2f s1sdscid10512
cid82 t
cid111
0 e2f s  1 sds
0 f sdNs
Proof Since exp
is a martingale by
Cauchy-Schwarz inequality
Ecid104
cid105
cid82 t
0 f sdNs
 Ecid104
 Ecid104
cid82 t
cid82 t
0 e2f s1sdscid10512
0 2f sdNs 1
0 e2f s1sds 1
cid82 t
0 e2f s1sdscid105
cid82 t
Dene CT
cid26
F  
cid90 T
cid90 T
f  sdNs 
ef s  1 sds
f  s  BF 0
s   C  R
cid27
Here  s is F
s   C  R means that f is F 0
progressively measurable and predictable and f  s 
s progressively measurable predictable and
also bounded and continuous
Lemma 12 For any T  0 and F  CT  we have for any t  0
cid104
0 F sdscid105  1
cid82 t
Proof For any t  0 writing s cid80
0 F sdscid105
cid82 t
cid104
kskTt F skT 
0 sdscid105
cid82 T
cid2escid3 ds  1
cid104
cid90 T
cid2escid3  1 by iteratively conditioning
by Jensens inequality and the fact that EP
since EP cid2eF cid3  1 for any 
 the F
Remark 4 Under P
progressively measurable rate function  is well
dened since it only creates a history between time 0 and time t Similary in
the proof in Lemma 12 EP cid2eF cid3  1 for any  should be interpreted as
the expectation is 1 given any history created between time 0 and t which is well
dened
Next we need to compare 1
cid82 t
0 F stds and 1
cid82 t
0 F sds
Lemma 13 For any q  0 T  0 and F  CT 
cid20
cid26
cid12cid12cid12cid12 1
cid90 t
lim sup
t
F stds  1
cid90 t
cid12cid12cid12cid12cid27cid21
F sds
F stds  1
F sds
cid90 t
cid12cid12cid12cid12
cid90 t
cid12cid12cid12cid12 1
cid90 t
cid12cid12cid12cid12 1
cid90 t
cid90 T
f u sdNuds  1
cid90 t
cid90 T
cid12cid12cid12cid12 1
cid90 t
cid90 T
It is easy to see thatcid82 T
0 f u sdNuds is F s
cid90 T
cid90 T
cid90 T
f u stdNuds
ef us  1s ududs
ef ust  1st ududs
cid12cid12cid12cid12
sT -measurable and
cid12cid12cid12cid12
cid12cid12cid12cid12
f u sdNuds 
f u stdNuds
for any 0  s  t  T  Hence
cid12cid12cid12cid12 1
cid90 t
cid90 T
cid90 t
 cid107fcid107L
 cid107fcid107L
cid107fcid107L
cid90 t
cid90 T
cid90 t
cid107fcid107L
cid90 T
cid90 t
f u sdNuds  1
f u sdNuds 
cid90 T
cid90 t
f u stdNuds
f u stdNuds
N s s  T ds 
N s s  T tds
N t  T t  T   N t  T t  T t
N t  T t  T   N t  T T   N 0 T  
By Holders inequality and Lemma 17 we have
cid104
cid104
cid82 t
cid82 T
0 f usdNuds 1
0 f ustdNudscid105
cid82 T
N tTtT N tTT N 0T cid105
cid82 t
cid107fcid107L
lim sup
t
 lim sup
t
cid90 T
cid90 t
cid12cid12ef us  ef ustcid12cid12 s ududs
ef us  1s ududs  1
ef ust  1st ududs
cid12cid12cid12cid12
ef ust  1st u  s u duds
Furthermore
cid90 T
cid90 t
cid90 T
cid90 t
cid90 t
cid90 T
cid12cid12cid12cid12 1
For the rst term
cid90 t
cid90 T
cid12cid12ef us  ef ustcid12cid12 s ududs
cid90 T
cid90 t
cid12cid12ef us  ef ustcid12cid12 s ududs
cid90 T
cid90 t
 2ecid107fcid107L
 duds
cid90 T
cid90 t
2ecid107fcid107L
hu  s   
s ududs
0us
 cid88
cid90 t
cid90 t
cid90 t
cid90 T
cid90 T
2ecid107fcid107L
2ecid107fcid107L
 2ecid107fcid107L T C 
 2ecid107fcid107L T C 
cid88
0us
hu  s   duds
N 0 u  sh0duds
 2ecid107fcid107L T C  2ecid107fcid107L 
 2ecid107fcid107L T C  2ecid107fcid107L T N 0 t  N t t  T h0
N 0 s  T h0ds
Therefore
lim sup
t
cid104
cid82 t
0 ef usef ustsududscid105  c
cid82 T
where c  0 as   0 in other words it vanishes
For the second term
cid90 T
cid90 t
 ecid107fcid107L  1
cid90 T
cid90 t
 ecid107fcid107L  1
ecid107fcid107L  1
ecid107fcid107L  1
ef ust  1st u  s u duds
0us
cid12cid12cid12cid12cid12cid12
cid90 t
cid90 t
cid90 t
t0ust
cid88
cid90 T
cid90 T
cid90 T
hu  s     cid88
cid88
cid88
cid88
hu  s   duds
hu  s   duds
hu  s   duds
t0us
0us
t
cid12cid12cid12cid12cid12cid12 duds
hu  s   
Assume that h is decreasing and limz z
z  0 By applying Jensens inequal-
ity twice we can estimate the second term above
ecid107fcid107L 1
cid20
cid90 t
cid90 t
cid90 t
 eCThC
 eCThCEP
cid21
cid82 T
husvdNvduds
husvdNvducid105
cid82 t
cid82 us
cid104
eecid107fcid107L 1cid82 T
cid82 us
cid90 T
cid104
eecid107fcid107L 1Tcid82 us
cid90 T
cid104
CThvdvcid10512
cid82 us
cid90 T
cid90 t
cid2eCThN 0ush0cid312
cid2eCThN 0tT h0cid312
husvdNv
cid105
where C T h  exp2ecid107fcid107L  1T h0  1 Thus
cid20
cid82 t
cid82 T
cid82 us
ecid107fcid107L 1
husvdNvduds
cid21
lim sup
t
Similarly we can estimate the rst term
For the third term by Jensens inequality we have
ecid107fcid107L 1
t hus duds
cid20
cid82 T
cid82 t
0 cid80
cid90 T
cid104
eexpcid107fcid107L 1cid82 t
cid104
eexpcid107fcid107L 1cid82 t
cid104
eexpcid107fcid107L 1cid82 t
cid21
t hus dscid105
cid80
t hs dscid105
k0 hskttudNudscid105
cid80
cid80
cid82 t
Since h is decreasingcid82 k1t
cid88
hs  kt  t  u  hs  t  u 
Let C f   expcid107fcid107L  1 and Ht cid82 
hsds  thk  1t Thus
cid90 
hvdv
stu
t hsds Then
cid104
k0 hskttudNudscid105
eexpcid107fcid107L 1cid82 t
cid82 t
cid80
cid104
0 hstudsdNucid105
0 cid82 t
t HstudNudsCf cid82 t
eCf cid82 t
cid82 t
0 Cf hstudsdNucid105
cid104
cid82 t
0 HstudsdNucid82 t
0 cid82 t
cid82 t
0  Cf 
Notice that
cid104
cid82 t
0  Cf 
cid104
e Cf 
0 HsdsNtcid105
cid82 t
0 HstudsdNucid105  EP
cid82 t
cid82 t
0 Hsds  0 as t   which implies that
cid104
cid82 t
0  Cf 
0 HsudsdNucid105
cid82 t
lim sup
t
where Cf 
Moreover
cid104
0 Cf hstudsdNucid105
0 cid82 t
cid82 t
cid104
0 Cf hstuds1uducid10512
cid82 t
0 e2cid82 t
cid104
cid82 t
cid82 t
0 e2cid82 t
0 Cf hstuds1duEP
cid82 t
cid82 t
0 e2Cf cid107hcid107
0 e2Cf Htu1duEP
cid82 t
0 e2Cf Hu1duEP
ee2Cf cid107hcid107
cid104
cid104
 u hu ducid10512
0 2Cf hstuds1cid80
cid82 t
 u hu ducid10512
L1 1cid80
cid10512
L1 1cid107hcid107L1 Nt
cid82 t
0 e2Cf Hu  1du  0 as t  
Notice that it holds for any   0 and that 1
which implies
lim sup
t
cid104
0 Cf hstudsdNucid105
0 cid82 t
cid82 t
Putting all these things together and applying Holders inequality several times
we nd that for any q  0 T  0 and F  CT 
lim sup
t
F stds  1
cid20
cid26
cid12cid12cid12cid12 1
cid90 t
cid90 t
cid12cid12cid12cid12cid27cid21
F sds
Lemma 14
cid90
T
F Qd  HQ
Proof Assume HQ   For any   0 there exists some f such that
cid20cid90 1
cid90 1
We can nd a sequence fT  Bcid16FT1
fdNs 
cid21
ef  1ds
 HQ  
cid17 CR  f as T   By Fatous
lim inf
T
 lim inf
T
cid90
cid20cid90 1
cid90 1
cid21
efT  1ds
 HQ  
F Qd
fT dNs 
If HQ   then for any M  0 there exists some fM such that
cid20cid90 1
cid90 1
cid21
fM dNs 
efM  1ds
Repeat the same argument as in the case that HQ  
Lemma 15 For any compact set A
lim sup
t
log P Rt  A   inf
Proof Notice that
3100
cid2eN 0tcid3  EP
cid104
ee21cid82 t
0 sdscid10512  EP
cid104
ee21h0N 0tCe21cid10512
By choosing   0 small enough we have EP
eN 0t  eCt for some constant
C  0 Therefore
3101
lim sup
lim sup
which implies by comparingcid82
cid96
t
N 0 t  cid96t  
 N 0 1dRt and N 0 tt and the superexponential
estimates in Lemma 17
3102
lim sup
cid96
lim sup
t
cid18cid90
cid19
N 0 1dRt  cid96
 
Therefore we need only to consider compact sets A such that for any Q  A
EQN 0 1  
Now for any A compact consisting of Q with EQN 0 1   and for any
F  CT and for any p q  1 1
q  1 by Holders inequality Chebychevs
inequality and Lemma 12
3103
cid90
cid26
0 F stdscid105  exp
Rt  A
cid82 t
0 F sdscid1051p EP
cid104
0 F stdscid82 t
pT cid82 t
cid82 t
cid26
cid90
cid26
0 F sdscid1051q  exp
pT cid82 t
0 F stdscid82 t
cid104
cid104
cid104
cid27
0 F sdscid1051q
cid27
cid90
F Qd
F Qd
cid27
F Qd
By Lemma 13
3104
lim sup
t
Rt  A   1
cid90
F Qd
Since it holds for any p  1 we get
3105
lim sup
t
Rt  A   inf
cid90
F Qd
cid82
For any compact A given Q  A and   0 by Lemma 14 there exists TQ  0
and FQ  CTQ such that 1
integral is a continuous functional of Q see the proof of Lemma 8 there exists
 FQQd  inf AQ HQ  1
2 Since the linear
Q  GQ Since A is compact there exists GQ1     GQcid96 such that A cid83cid96
cid82
 FQQd  inf AQ HQ   for all
j1 GQj 
a neighborhood GQ of Q such that
3106
cid90
1jcid96
Note that for any A and B
F Qd  inf
HQ  
3107
log P Rt  A  B
cid26
lim sup
t
 max
Thus for A cid83cid96
j1 Gj
lim sup
t
log P Rt  A lim sup
t
cid27
log P Rt  B
cid90
F Qd
3108
lim sup
t
log P Rt  A   inf
1jcid96
whence lim supt 1
t log P Rt  A   inf QA HQ for any compact A
Theorem 13 Upper Bound For any closed set C
3109
lim sup
t
log P Rt  C   inf
Proof For any closed set C and compact An which is dened in Lemma 22 we
3110
cid26
lim sup
t
 max
log P Rt  C
lim sup
t
log P Rt  C  An lim sup
t
cid27
log P Rt  Anc
Since C  An is compact Lemma 15 implies
3111
lim sup
t
log P Rt  C  An   inf
QCAn
HQ   inf
Furthermore by Lemma 21
3112
lim sup
t
log P Rt  Anc
cid33
cid90 t
cid91
cid181
 lim sup
Rt 
cid26
t
 max
lim sup
t
lim sup
t
lim sup
t
as n   Hence
cid32
cid181
cid181
cid90 t
cid90 t
N 01jstds  j
N 01j2stds  1jg1j
N 0 1N 01cid96stds  mcid96
cid19
cid19
cid19cid27
 
3113
lim sup
t
log P Rt  C   inf
34 Superexponential Estimates
In order to get the full large deviation principle we need the upper bound
inequality valid for any closed set instead of for any compact set which requires
some superexponential estimates
Lemma 16 For any q  0
cid104
cid105
eqcid82 t
0 htsdNs
lim sup
t
3114
3115
cid104
eqcid82 t
0 htsdNs
cid105  EP
cid104
cid82 t
0 e2qhts1cid80
cid104
eCh0Ntcid82 t
0 s hs dscid10512
0 e2qhts1dscid10512
Note thatcid82 t
0 e2qhts  1ds cid82 t
3116
lim sup
t
0 e2qhs  1ds  L1 since h  L1 Therefore
cid104
eqcid82 t
0 htsdNs
cid105  c
where c  0 as   0 Since it holds for any  we get the desired result
Lemma 17 For any q  0 and T  0
3117
lim sup
t
cid2eqN ttT cid3  0
Therefore for any   0
3118
lim sup
t
N t t  T   t  
Proof By Holders inequality
cid2eqN ttT cid3  EP
3119
0 s hs dscid10512
cid104
ee2q1cid82 tT
cid80
cid104
ee2q1h0N ttT e2q1cid82 t
e2e2q1h0N ttT cid10514 EP
cid104
2 e2q1CT  EP
cid10514
cid104
2 e2q1CT  EP
e2e2q1cid82 t
0 htsdNs
cid10512
0 htsdNs
Choose   q2e2q  1h01 Then
cid2eqN ttT cid334  e
2 e2q1CT  EP
cid104
e2e2q1cid82 t
0 htsdNs
cid10514
3120
Lemma 16 completes the proof
Lemma 18 We have the following superexponential estimates
i For any   0
3121
lim sup
lim sup
t
ii For any   0
3122
lim sup
M
lim sup
t
iii For any   0
3123
lim sup
cid96
lim sup
t
cid18 1
cid90 t
cid19
N 02sds  
cid181
cid90 t
cid19
N 01M sds  
 
 
cid181
cid90 t
cid19
N 0 1N 01cid96sds  
 
Proof i Dene
cid90 t
cid90 t
3124
Ncid96cid480 t 
scid96cid48dNs
Ncid96cid480 t 
scid96cid48dNs
Then N 0 t  Ncid96cid480 t  Ncid96cid480 t and Ncid96cid480 t has compensator cid82 t
and Ncid96cid480 t has compensatorcid82 t
0 sscid96cid48ds Notice that
0 sscid96cid48ds
3125
N 02  Ncid96cid48 02   Ncid96cid48 01
It is clear that Ncid96cid48 is dominated by the usual Poisson process with rate cid96cid48 By
Lemma 19
3126
lim sup
lim sup
t
cid18 1
cid90 t
Ncid96cid48 02sds  
cid19
 
On the other hand
3127
cid90 t
 Ncid96cid48 01sds 
 Ncid96cid48 ss1ds
cid90 t
cid90 t
cid90 t
Ncid96cid48s s  ds
Ncid96cid480 sds  1
 Ncid96cid480 t  N t t  
cid90 t
Ncid96cid480 sds
By Lemma 17 we have
3128
lim sup
t
cid181
N t t    
cid19
 
for any   0 Hence
3129
lim sup
lim sup
t
cid181
N t t    
cid19
 
Finally for some positive hcid96cid48 to be chosen later
cid181
3130
Ncid96cid480 t  
cid19
 Ecid104
 Ecid104
ehcid96cid48 Ncid96cid48 0tcid105
ee2hcid96cid481cid82 t
ethcid96cid484
0 sscid96cid48 dscid10512
ethcid96cid484
z Then f z   as z   Let Zs cid80
Let f z  z
0s hs   Then by
the denition of s and abusing the notation a little bit we see that s  Zs
Since  is increasing its inverse function 1 exists and 1cid96cid48   as cid96cid48  
We have
3131
Ecid104
ee2hcid96cid481cid82 t
0 sscid96cid48 dscid10512  Ecid104
ee2hcid96cid481cid82 t
cid20
e2hcid96cid481cid82 t
0 ZsZs1cid96cid48dscid10512
dscid2112
0 Zs
infzcid96cid48 f 1z
It is clear that limcid96cid48 inf zcid96cid48 f 1z   Choose
3132
hcid96cid48 
cid21
cid20
zcid96cid48 f 1z  1
Then hcid96cid48   as cid96cid48   and
cid20
e2hcid96cid481cid82 t
0 Zs
infzcid96cid48 f 1z
3133
dscid2112
 Ecid104
0 Zsdscid10512
cid82 t
0s hs dscid10512
 Ecid104
cid82 t
cid80
 Ecid2ecid107hcid107L1 Ntcid312
3134
lim sup
cid96cid48
lim sup
lim sup
t
cid181
Ncid96cid480 t  
cid19
 
ii It is easy to see that iii implies ii
iii Observe rst that
3135
N s s  1N ss1cid96  Ncid96cid48s s  1Ncid96cid48 ss1 cid96
 Ncid96cid48s s  1 Ncid96cid48 ss1 cid96
cid96
Ncid96cid48 ss1 cid96
cid96
 Ncid96cid48 ss1 cid96
For the rst term notice that Ncid96cid48 is dominated by a usual Poisson process with
rate cid96cid48 Thus by Lemma 20
3136
lim sup
cid96
lim sup
t
cid181
cid90 t
Ncid96cid48s s  1Ncid96cid48 ss1 cid96
ds  
 
cid19
For the second term Ncid96cid48s s  1 Ncid96cid48 ss1 cid96
 Ncid96cid48s s  1 and
3137
Ncid96cid48s s  1ds  Ncid96cid480 t  N t t  1
cid90 t
By Lemma 17
3138
lim sup
t
cid181
N t t  1  
cid19
 
and by the same argument as in i
3139
lim sup
cid96cid48
lim sup
cid96
lim sup
t
cid181
Ncid96cid480 t  
cid19
 
For the third term notice that
3140
cid96
Ncid96cid48 ss1 cid96
cid90 t
cid90 t
Ncid96cid48s s  1Ncid96cid48 ss1 cid96
ds
So we can get the same superexponential estimate as before Finally for the fourth
3141
cid90 t
cid96
 Ncid96cid48 ss1 cid96
cid90 t
Ncid96cid48s s  1ds
We can get the same superexponential estimate as before
Lemma 19 Assume Nt is a Poisson process with constant rate  Then for any
3142
lim sup
lim sup
t
cid18 1
cid90 t
cid19
N ss2ds  
 
Proof Let f    1
h N 02 where h is to be chosen later By Jensens
inequality and stationarity and independence of increments of the Poisson process
Ecid104
cid82 t
3143
cid21
j0 f sjdscid105
 f sdscid105  Ecid104
cid82 
cid80t
cid201
cid90 
cid80t
j0 f jcid105
 Ecid104
cid80t
 Ecid2ef cid3t1
cid8e1h1  e  e  e  ecid9t1
j0 f sjds
 Mcid48e1h22  1t1
for some Mcid48  0 Choose h  1
Ecid104
cid82 t
log1 Then
 f sdscid105  Mcid48  1t1  eM t
3144
for some M  0 Therefore by Chebychevs inequality
cid18 1
cid90 t
3145
lim sup
t
N ss2ds  
ht
cid19
 M  
which holds for any   0 Letting   0 we get the desired result
Lemma 20 Assume Nt is a Poisson process with constant rate  Then for any
3146
lim sup
cid96
lim sup
t
cid181
cid90 t
cid19
N 0 1N 01cid96sds  
 
Proof Let hcid96 be some function of cid96 to be chosen later Following the same
argument as in the proof of Lemma 19 we have
3147
hcid96
N 0 1N 01cid96sds  hcid96t
cid19
ehcid96t
cid90 t
ehcid96cid82 t
cid18
0 N 01N 01cid96sdscid105
 Ecid104
 Ecid2ehcid96N 01N 01cid96cid3t1
cid40
cid88
cid40
cid81  C2ehcid96cid96logcid96logcid96cid96cid9t1
PN 0 1  cid96 
ehcid96klogklogkk
cid88
kcid96
ehcid96t
ehcid96ke k
kcid96
cid41t1
cid41t1
ehcid96t
ehcid96t
ehcid96t
Choosing hcid96  logcid9612 will do the work
The following Lemma 21 provides us the superexponential estimates that we
need These superexponential estimates have basically been done in Lemma 18
The dierence is that in the statement in Lemma 18 we used  and in Lemma 21
it is changed to t which is what we needed Lemma 21 has three statements Part
i says if you start with a sequence of simple point processes the limiting point
process may not be simple but this has probability that is superexponentially
small Part ii is the usual superexponential we would expect if MS were
equipped with weak topology But since we are using a strengthened weak topology
with the convergence of rst moment as well we will also need Part iii
Lemma 21 We have the following superexponential estimates
i For some g  0 as   0
3148
lim sup
lim sup
t
cid18 1
cid90 t
cid19
N 02stds  g
 
ii For some M   0 as M  
3149
lim sup
M
lim sup
t
iii For some mcid96  0 as cid96  
cid181
cid90 t
cid19
N 01M stds  M 
 
3150
lim sup
cid96
lim sup
t
N 0 1N 01cid96stds  mcid96
cid181
cid90 t
cid19
 
Proof We can replace the  in the statement of Lemma 18 by g M  and mcid96
by a standard analysis argument Here we can also replace the  in Lemma 18
cid90 t
N 02sds
N 02stds 
cid12cid12cid12cid12  2
cid12cid12cid12cid12  2
by t since
3151
3152
3153
cid12cid12cid12cid12cid90 t
cid12cid12cid12cid12cid90 t
cid12cid12cid12cid12cid90 t
cid90 t
cid90 t
cid90 t
N 01M stds 
N 01M sds
N 0 1N 01cid96stds 
cid90 t
N 0 1N 01cid96sds
cid12cid12cid12cid12
N s s  1ds 
N s s  1tds
 N t  1 t  1  N t  1 t  1t
 N t  1 t  1  N t  1 t  N 0 1
By Lemma 17 we have the superexponential estimate for any   0
N t  1 t  1  N t  1 t  N 0 1  
 
cid19
3154
lim sup
t
cid181
Lemma 22 For any  M  0 cid96  0 dene
3155
A  Q  MS  QN 0   2  g 
AM  Q  MS  QN 0 1  M   M  
N 0 1dQ  mcid96
Acid96 
Q  MS 
cid26
cid90
cid27
N 01cid96
where M   0 as M   mcid96  0 as cid96   and g  0 as   0 Let
AMcid96  A  AM  Acid96 and
cid92
j jj
3156
Then An is compact
Proof Observe that for   0 the sets
cid92
3157 K 
  N kk  1  cid96k  N k  1 k  cid96k
are relatively compact in  Let K be the closure of K which is then compact
For any Q  An QN 0 1  M   M  for any M  n We can choose  big
k1 cid96k  0
enough and an increasing sequence cid96k such that cid961  n and  cid80
as    uniformly for Q  An
3158
Qcid0K
ccid1  QK c
cid32 cid91
cid88
cid88
cid88
N kk  1  cid96k  N k  1 k  cid96k
cid33
QN k  1k  cid96  QN k  1 k  cid96k
QN 0 1  cid96k
cid96k  0
as    Therefore An is tight in the weak topology and by Prokhorov theorem
An is precompact in the weak topology In other words for any sequence in An
there exists a subsequence say Qn such that Qn  Q weakly as n   for
some Q By the denition of An Qn are uniformly integrable which implies that
cid82 N 0 1dQn cid82 N 0 1dQ as n   It is also easy to see that An is closed by
j jj is closed That implies that Q  An Finally we need to
checking that each A 1
check that Q is a simple point process Let Ij  j  1 j We have for any
Q  An
3159
Q t  N t t  2  Q
t  k k  N t t  2
cid33
    Ij  2
Q  Ij  2
cid32 cid91
 cid91
cid88
cid88
cid92
kcid91
kcid88
jk1
m mn
m mn
jk1
2kg
Hence An is precompact in our topology Since An is closed it is compact
35 Concluding Remarks
In this chapter we obtained a process-level large deviation principle for a wide
class of simple point processes ie nonlinear Hawkes processes Indeed the meth-
ods and ideas should apply to other simple point processes as well and we should
expect to get the same expression for the rate function HQ For HQ   it
should be of the form
3160
cid90
cid90 1
 s   s  log
cid32  s
cid33
 s
 sdsQd
where  s is the intensity of the underlying simple point process Now it would
be interesting to ask for what conditions for a simple point process would guarantee
the process-level large deviation principle that we obtained in this chapter First
we have to assume that  t is predictable and progressively measurable Second
in our proof of the upper bound in this chapter the key assumption we used about
nonlinear Hawkes process was that limz z
z  0 That is crucial to guarantee
the superexponential estimates we needed for the upper bound If for a simple
point process we have  t  F N t  for some sublinear function F  we
would expect the superexponential estimates still to work for the upper bound
Third it is not enough to have  t  F N t  for sublinear F  to get
the full large deviation principle The reason is that in the proof of lower bound
in particular in Lemma 10 we need to use the fact that any memory in  t
has memory will decay to zero over time For nonlinear Hawkes processes this is
guaranteed by the assumption thatcid82 
0 htdt   which is crucial in the proof of
Lemma 10 Indeed for any simple point process P  if you want to dene P 
probability measure conditional on the past history  to make sense of it you
have to have some regularities to ensure that the memory of the history will decay
to zero eventually over time From this perspective nonlinear Hawkes processes
form a rich and ideal class for which the process-level large deviation principle
Chapter 4
Large Deviations for Markovian
Nonlinear Hawkes Processes
In Chapter 3 we studied the large deviations for Ntt   by proving rst
a process-level ie
level-3 large deviation principle and then applying the con-
traction principle In this chapter we will obtain an alternative expression for the
rate function of the large deviation principle of Ntt   when h is exponential
or sums of exponentials The main idea is that when h is exponential or sums
of exponentials the system is Markovian and we can use Feynman-Kac formula
to obtain an upper bound and some tilting method to get a lower bound The
assumption limz z
z  0 will provide us the compactness in order to apply a
minmax theorem to match the lower bound and the upper bound
41 An Ergodic Lemma
In this section we prove an ergodic theorem for a class of Markovian processes
Let Zit  cid80
with jumps more general than the Markovian nonlinear Hawkes processes
j t aiebitj  1  i  d where bi  0 ai
cid54 0 might be
negative and js are the arrivals of the simple point process with intensity
Z1t  Zdt at time t where   Z  R and Z  R1   Rd is the do-
main for Z1t     Zdt where Ri  R or R depending on whether i  1
or 1 where i  1 if ai  0 and i  1 otherwise If we assume the exciting
i1 aiebit then a Markovian nonlinear Hawkes process is
function to be ht cid80d
a simple point process with intensity of the form cid80d
41 Af   dcid88
The generator A for Z1t     Zdt is given by
 z1     zdf z1  a1     zd  ad  f z1     zd
i1 Zit
We want to prove the existence and uniqueness of the invariant probability
measure for Z1t     Zdt Here the invariance is in time
The lecture notes 47 by Martin Hairer gives the criterion for the existence and
uniqueness of the invariant probability measure for Markov processes
Suppose we have a jump diusion process with generator L If we can nd u
such that u  0 Lu  C1  C2u for some constants C1 C2  0 then there exists
an invariant probability measure We thereby have the following lemma
Lemma 23 Consider ht  cid80d
i  1 if ai  0 Assume z1     zn  cid80d
i  0 1  i  d satisescid80d
i1 aiebit  0 Let i  1 if ai  0 and
i1 izi   where   0 and
i  1 Then there exists a unique invariant
probability measure for Z1t     Zdt
Proof The lecture notes 47 by Martin Hairer gives the criterion for the existence
of an invariant probability measure for Markov processes Suppose we have a jump
diusion process with generator L If we can nd u such that u  0 Lu  C1C2u
for some constants C1 C2  0 then there exists an invariant probability measure
Try uz1     zd cid80d
Au   dcid88
  dcid88
i1 icizi  0 where ci  0 1  i  d Then
dcid88
biicizi  z1     zd
dcid88
izi dcid88
aici  
bicizi 
dcid88
aici
Taking ci  i
 0 we get
Au  
cid32
cid33 dcid88
1  dcid88
cid32
1  dcid88
aii
aii
  min
1id
izi  
cid33
dcid88
dcid88
aii
aii
Next we will prove the uniqueness of the invariant probability measure It is
sucient to prove that for any x y  Zd there exist times T1 T2  0 such that
T  
P xT1 and P yT2 are not mutually singular Here P xT  PZ x
j T aebTj  To see
where Z x
this let us prove by contradiction If there were two distinct invariant probability
T  xebT cid80
T is ZT starting at Z0  x ie Z x
measures 1 and 2 then there exist two disjoints sets E1 and E2 such that 1 
E1  E1 and 2  E2  E2 see for example Varadhan 108 Now we can choose
x1  E1 and x2  E2 so that P x1T1 and P x2T2 are supported on E1 and
E2 respectively for any T1 T2  0 which implies that P x1T1 and P x2T2 are
mutually singular This leads to a contradiction
Consider the simplest case ht  aebt Let us assume that x  y  0
Conditioning on the event that Z x
t have exactly one jump during the time
interval 0 T  respectively the laws of P xT and P yT have positive densities
t and Z y
on the sets
cid0a  xebT  xebT  acid1
cid0a  yebT  yebT  acid1
respectively Choosing T  1
b log xya
 we have
cid0a  xebT  xebT  acid1cid92cid0a  yebT  yebT  acid1 cid54 
which implies that P xT and P yT are not mutually singular
Similarly one can show the uniqueness of the invariant probability measure for
the multidimensional case Indeed it is easy to see that for any x y  Zd Z x
and Z y
hit a common point for some T1 and T2 after possibly dierent number
t   Zd where
 Z x1
j t aiebitj  1  i  d Since P xT1 and P yT2 have
probability densities P xT1 and P yT2 are not mutually singular for some T1
t   Zd and Z y
of jumps Here Z x
t  xiebit cid80
     Z xd
 Z y1
     Z yd
and T2
42 Large Deviations for Markovian Nonlinear
Hawkes Processes with Exponential Exciting
Function
We assume rst that ht  aebt where a b  0 ie the process Zt jumps
upwards an amount a at each point and decays exponentially between points with
rate b In this case Zt is Markovian
Notice rst that Z0  0 and
dZt  bZtdt  adNt
which implies that Nt  1
aZt  b
cid82 t
0 Zsds
We prove rst the existence of the limit of the logarithmic moment generating
function of Nt
Theorem 14 Assume that limz z
z  0 and that  is continuous and
bounded below by some positive constant Then
48   sup
Qe
t
log EeNt  
cid26cid90 b
cid90
zdz 
cid90 cid16
cid27
cid17 dz
log
  dz 
where Qe is dened as
cid110
   Q  A has unique invariant probability measure 
cid111
cid26
     MR
cid90
zdz     L1   0
cid27
where MR denotes the space of probability measures on R and for any  such
that    Q we dene the generator A as
Af z  bz
 zf z  a  f z
for any f  R  R that is C 1 ie continuously dierentiable
Proof By Lemma 24EeNt   for any   R also
EeNt  Ecid104
0 Zsdscid105
aZtbcid82 t
Dene the set
U cid8u  C 1R R  uz  ef z where f  Fcid9 
cid26
f  f z  Kz  gz  L K 
 K L  R
cid27
g is C1 with compact support
Now for any u  U dene
Auz  b
a zuz
M  sup
By Dynkins formula if M   for V z  b
a z we have
Ecid104
0 V Zsdscid105
cid82 t
 uZ0 
cid90 t
Ecid104
cid90 t
Ecid104
0 V Zvdvcid105
cid82 s
AuZs  V ZsuZse
0 V Zvdvcid105
cid82 s
 uZ0  M
which implies by Gronwalls lemma that
Ecid104
0 V Zsdscid105  uZ0eM t  u0eM t
cid82 t
Observe that by the denition of U for any u  U we have uz  c1e 
a z for
some constant c1  0 and therefore by 412 and 417
Ecid2eNtcid3  1
Ecid104
a Zsdscid105  1
cid82 t
u0eM t
log Ecid2eNtcid3  M  sup
lim sup
t
Auz  b
a zuz
which is still true even if M   Since this holds for any u  U
lim sup
t
log Ecid2eNtcid3  inf
Auz  b
a zuz
uU
Dene the tilted probability measure P by
cid12cid12cid12cid12Ft
cid40cid90 t
Zs  Zsds 
cid90 t
cid32 Zs
cid33
cid41
Notice that P dened in 421 is indeed a probability measure by Girsanov for-
mula For the theory of absolute continuity for point processes and their Girsanov
formulas we refer to Lipster and Shiryaev 72
Now by Jensens inequality
lim inf
t
log EeNt
cid34
cid40
cid41cid35
cid12cid12cid12cid12Ft
log E
Nt  log
cid35
cid12cid12cid12cid12Ft
cid34
cid34
 lim inf
t
 lim inf
t
 lim inf
t
Nt  1
Nt  1
cid90 t
Zs  Zsds 
cid90 t
cid32 Zs
cid33
cid35
Since Nt cid82 t
Zsds is a martingale under P we have
cid34cid90 t
cid32 Zs
cid33
cid35
dNs  Zsds
Therefore by the ergodic theorem for a reference see Chapter 164 of Koralov
and Sinai 64 for any    Qe
log EeNt
cid34
cid90 t
lim inf
t
 lim inf
t
cid90 b
Zs  Zsds 
cid90
Nt  1
  dz 
cid90 cid16
log  log
zdz 
cid35
Zsds
cid90 t
cid33
cid32 Zs
cid17 dz
cid27
cid27
log EeNt
cid26cid90 b
lim inf
t
 sup
Qe
z 
cid90
cid90 cid16
   
cid17 
log  log
Recall that
cid26
f  f z  Kz  gz  L K 
 K L  R
We claim that
cid26cid90
cid27
Af zdz
g is C1 with compact support
if    Qe
 if    QQe
0
It is easy to see that for    Qe and g being C1 with compact support
cid82 Ag  0 Next we can nd a sequence fnz  z pointwise under the bound
But by our denition of Qcid82 z   So by the dominated convergence theorem
fnz  z   for some    0 where fnz is C1 with compact support
cid82 Az  0 The nontrivial part is to prove that if for any g  G  gz 
L g is C1 with compact support such that cid82 Ag  0 then    Qe We
For instance G is dense in
can easily check the conditions in Echevrra 32
CR the set of continuous and bounded functions on R with limit that exists
at innity and A satises the minimum principle ie Af z0  0 for any f z0 
inf zR f z This is because at minimum the rst derivative of f vanishes and
z0f z0  a  f z0  0 The other conditions in Echeverra 32 can also
be easily veried Thus Echevrra 32 implies that  is an invariant measure
Now our proof in Lemma 23 shows that  has to be unique as well Therefore
   Qe This implies that if    QQe there exists some g  G such
that cid82 Ag cid54 0 Now any constant multiplier of g still belongs to G and thus
inf gGcid82 Ag   and hence inf fFcid82 Af    if    QQe
cid90
cid90
z  H  
cid26cid90 b
cid26cid90 b
cid27
cid27
Therefore
lim inf
t
Af 
log EeNt  sup
Q
 sup
R
z  H  
Af 
where R        Q and
H  
cid90 cid104
cid17 
cid16
cid105
    log
Dene
F   f  
cid90 b
cid90 b
z  H  
z  H  
cid90
cid90
cid90
Af 
f z  a  f z
Notice that F is linear in f and hence convex in f and also
cid26cid90 cid104f  1  ef 
cid105
cid27
H   sup
fCbR
where CbR denotes the set of bounded functions on R
above it is linear in both  and  Hence H is weakly lower semicontinuous
Inside the bracket
and convex in   Therefore F is concave in   Furthermore for any
f  Kz  g  L  F
F   f  
bz  H  
gz  a  gz  Ka

cid19
cid90 cid18 
cid90
cid90
cid90
cid90
If nn   and n   weakly then since g is C1 with compact support we
cid90
 
cid90
cid90
 
cid90
gz  a  gznn  Ka
gz  a  gz  Ka
cid90
as n   Moreover in general if Pn  P weakly then for any f which is upper
cid82 f dPn cid82 f dP  Since
semicontinuous and bounded from above we have lim supn
cid0 
a  Kcid1 bz is continuous and nonpositive on R we have
cid19
cid19
cid90 cid18 
cid90 cid18 
bzn 
lim sup
n
bz
Hence we conclude that F is upper semicontinuous in the weak topology
In order to switch the supremum and inmum in 429 since we have already
proved that F is concave upper semicontinuous in   and convex in f  it
is sucient to prove the compactness of R to apply Ky Fans minmax theorem
see Fan 37 Indeed Joo developed some level set method and proved that it
is sucient to show the compactness of the level set see Joo 60 and Frenk and
Kassay 40 In other words it suces to prove that for any C  R and f  F
the level set
cid26
is compact
   R  H 
cid90
  b
z  f z  a  f z  C
cid27
Fix any f  Kz  g  L  F where K  
a and g is C1 with compact support
and L is some constant uniformly for any pair   that is in the level set of

cid18
cid19
cid90
K  
cid20
 
c  C2 
cid18
K  
cid19
cid21cid90
z  cid96C2
czcid96
and cid96 large enough so that minz0 log czcid96
z 1C2 
0 where we used the fact that limz z
z  0 and minz z  0 Hence
cid90
z  C3
  C4
czcid96
436 there exists some C1 C2  0 such that
cid18
C1  H 
cid19
cid90
z  C2
K  
cid104
cid90
czcid96
cid90
cid20
     log
cid90
  C2
czcid96
czcid96
cid90
cid105
cid21cid90

 1  C2
cz  cid96
We choose 0  c cid0K  
cid1 b
cid90
Therefore we have
C1  cid96C2
c  C2 cid0K  
cid90
cid1 b
cid90
 
 
cid90
and hence
C1  cid96C2
minz0 log czcid96
z  1  C2
czcid96
czcid96
  C4  c  C3  cid96
H   C1  C2 C4  c  C3  cid96  
Therefore for any nn n  R we get
cid96 sup
n  lim
cid96 sup
cid96
zcid96
zn  lim
cid96
cid96
cid90
cid90
which implies the tightness of n By Prokhorovs Theorem there exists a subse-
quence of n which converges weakly to  We also want to show that there exists
some  such that nn   weakly passing to a subsequence if necessary It
is enough to show that
cid82 nn  
cid82
i supn
ii limcid96 supn
zcid96 nn  0
i and ii will give us tightness of nn and hence implies the weak convergence
for a subsequence
Now let us prove statements i and ii
To prove i notice that
cid90
nn  sup
cid90 b
zn  b
C4  c  C3  cid96  
To prove ii notice that   n  n logn  0 That is because x  1 
log x  0 for any x  0 and hence
     log  
cid104
  1  log
cid105  0
Notice that
cid96 sup
cid90
zcid96
nn  lim
cid96 sup
cid90
cid90
zzcid96
For the rst term since supn
cid96 sup
zzcid96
nn
n
cid96 sup
zzcid96
cid82 zn   and limz z
cid90
nn  lim
cid96 sup
zcid96
zn  0
cid90
cid90
For the second term since lim supz z
cid96 sup
 lim
cid96 sup
zzcid96
n
Hn n
n
zzcid96
  n  n logn
Therefore passing to some subsequence if necessary we have nn   and
n   weakly Since we proved that F is upper semicontinuous in the weak
topology the level set is compact in the weak topology Therefore we can switch
cid27
the supremum and inmum in 429 and get
cid26cid90 b
L1
log Ecid2eNtcid3
cid82 z
cid90 cid20 bz
cid82 z
cid20bz
cid20bzef z
cid26Au
aef z 
lim inf
t
 inf
fF sup
fF sup
 inf
uU
z      log  Af 
 zef zaf z  1  bz
dz
cid21
cid21
cid21
ef z
 zef zaf z  1  bz
cid27
ef z ef za  ef z  bz
We need some justications Dene G    log  Af  The supremum
 0 which implies   ef zaf z Notice that
of G is achieved when G
 
for f  F the optimal   ef zaf z satisescid82    sincecid82    and
cid82 z   This gives us 450 Next let us explain 451 For any probability
measure 
cid90 cid20 bz
cid20bz
 sup
 zef zaf z  1  bz
 zef zaf z  1  bz
cid21
dz
cid21
which implies the right hand side of 450 is less or equal to the right hand side
of 451 To prove the other direction For any f  Kz  g  L  F we have
 zef zaf z  1  bz
cid18 b
cid19
z  zeKagzagz  1  bz
which is continuous in z and also bounded on z  0 since g is C 1 with compact
z  0 Hence there exists some z  0 such
a and limz z
support and K  
 zef zaf z  1  bz
bz
 zef zaf z  1  bz f
cid12cid12cid12cid12zz
Take a sequence of probability measures n such that it has probability density
function n if z  z  1
 Therefore we have
2n and 0 otherwise Then for every ncid82 zndz 
2n  z  1
n
 zef zaf z  1  bz
ndz
 zef zaf z  1  bz
cid20bz
cid90 cid20bz
cid90 z 1
cid20bz
z 1
n n
bz
 zef zaf z  1  bz f
 zef zaf z  1  bz
cid21
cid21
cid12cid12cid12cid12zz
cid21
We conclude that the right hand side of 450 is greater or equal to the right hand
side of 451
Notice that for any f  Kz  g  L  F
 zef zaf z  1  bz
b  Ka
z  zeKagzagz  1  bz
whose supremum is achieved at some nite z  0 since limz z
z  0 K  
and g  C 1 with compact support Hencecid82 z   is satisied for the optimal 
This gives us 451 Finally for any f  F u  ef  U which implies 453
Lemma 24 Assume limz z
z  0 we have EeNt   for any   R
Proof Observe that for any   R
cid26
Nt 
cid27
e  1Zsds
cid90 t
is a martinagle Since limz z
C  0 such that z  C  z for any z  0 Also
z  0 for any   0 there exists a constant
cid90 t
cid90 t
cid90 t
cid90 t
cid90 s
cid20cid90 t
cid20cid90 
hs  uN duds
hs  uds
cid21
cid21
hs  uds
N du  cid107hcid107L1Nt
Therefore for any   0
eNtcid82 t
eNte1cid82 t
0 e1Zsdscid105
0 CZsdscid105
1  Ecid104
 Ecid104
 Ecid2eNte1Cte1cid107hcid107L1 Ntcid3 
For any   0 choose    and  small enough so that   e  1cid107hcid107L1  
Ecid2eNtcid3  ee1Ct  
Now we are ready to prove the large deviations result
Theorem 15 Assume limz z
below by some positive constant Then  Nt
ciple with the rate function I as the Fenchel-Legendre transform of 
z  0 and that  is continuous and bounded
t   satises the large deviation prin-
Ix  sup
x   
Proof If lim supz z
z  0 then the forthcoming Lemma 26 implies that  
 for any  Thus by Gartner-Ellis Theorem we have the upper bound For
Gartner-Ellis Theorem and a general theory of large deviations see for example
30 To prove the lower bound it suces to show that for any x  0   0 we
cid18 Nt
cid19
 Bx
lim inf
t
  sup
x  
where Bx denotes the open ball centered at x with radius  Let P denote
the tilted probability measure with rate  dened in Theorem 14 By Jensens
inequality
cid19
cid18 Nt
cid90
cid18 Nt
cid18 Nt
log P
log P
t Bx
 Bx
dPdP
cid19
 Bx
cid19
 Bx
By the ergodic theorem
cid35
cid35
dP dP
t Bx
t Bx log
cid34
t  Bxcid1cid90
Pcid0 Nt
cid34
Pcid0 Nt
t  Bxcid1  1
cid18 Nt
cid19
 x
 Bx
lim inf
t
cid26cid90
cid90
   
cid27
log
x  inf
Qx
cid26
   Qe 
cid90
cid27
zdz  x
Notice that
  sup
Qe
cid26cid90
Qx
cid90
cid90
 
cid26cid90
cid26cid90 b
Qx
x  x
   
log
cid90
cid90
cid27
cid27
 
   
log
cid90
cid90
zdz 
   
log
cid27
We prove in Lemma 25 that x is convex in x identify it as the convex conjugate
of  and thus conclude the proof
Lemma 25 x in 467 is convex in x
Proof Dene
cid90
cid90
   
H  
log
x  inf
Qx
H 
We want to prove that x1  x2  x1  x2 for any    0 with
    1 For any   0 we can choose k k  Qxk
such that Hk k 
xk  2 for k  1 2 Set
3  1   2
3 
d1
d1   2
1 
d 2
d1   2
Then for any test function f 
cid90
cid90
A1f 1  
A2f 2  0
A3f 3  
which implies 3 3  Qe Furthermore
33  
11  
cid90
cid90
22  x1  x2
cid90
cid90
cid90 cid104
cid90 cid20
cid105
Therefore 3 3  Qx1x2
 Finally since x log x is a convex function and if we
apply Jensens inequality we get
H3 3 
  3  3 log   3 log 3
  3  3 log   
1 log 1  
cid21
2 log 2
  H1 1   H2 2
Therefore
x1  x2  H3 3   H1 1   H2 2  x1  x2  
Lemma 26 If lim supz z
a then for any
cid32
cid33
  log
a lim supz z
 1 
 lim sup
z
we have    If lim supz z
z  0 then    for any   R
Proof For K  
a we have eKz  U and
Agz  b
cid19
bK  b
cid26
cid18
  inf
gU
cid26AeKz
cid27
cid27
a zgz
 sup
z  zeKa  1
Dene the function
F K  K  lim sup
z
 eKa  1
Then F 0  0 F is convex and F K   as K   and its minimum is
attained at
cid32
a lim supz z
cid33
and F K  0 Therefore    for any
cid26
cid32
cid27
cid33
 1 
  a min
K  lim sup
z
 eKa  1
a lim supz z
 lim sup
z
 Ka
If lim supz z
z  0 trying eKz  U for any K  
a we have    for any
43 Large Deviations for Markovian Nonlinear
Hawkes Processes with Sum of Exponentials
Exciting Function
In this section we consider the Markovian nonlinear Hawkes processes with
sum of exponentials exciting functions ie ht cid80d
i1 aiebit Let
cid88
j t ht  j where js are the arrivals of the Hawkes
process with intensity Zt  Z1t    Zdt at time t Observe that
this is a special case of the Markovian processes with jumps studied in Section 41
i1 Zit It is easy to see that
Zit 
aiebitj 
1  i  d
Z1     Zd is Markovian with generator
i1 Zit cid80
and Zt cid80d
with Z1t Z2t  Zdt taking the form cid80d
483 Af   dcid88
the set of bis and ais so that ht cid80d
of this paper In particular h0 cid80d
cid32 dcid88
cid33
 f z1  a1     zd  ad  f z1     zd
Here bi  0 for any 1  i  d and ai can be negative But we restrict ourselves to
i1 aiebit  0 for any t  0 for the rest
i1 ai  0 If ai  0 then Zit  0 almost
surely if ai  0 then Zit  0 almost surely
Theorem 16 Assume limz z
z  0  is continuous and bounded below by
a positive constant Then
t
log EeNt  inf
uU
z1zdZ
cid40Au
cid80d
dcid88
cid41
where Z  z1     zd  aizi  0 1  i  d and
U cid8u  C1Rd R u  ef  f  Fcid9 
cid40
f  g 
cid80d
cid80d
cid41
 L L  R g  G
cid40 dcid88
Kizi  g K  0 g is C1 with compact support
cid41
Proof Notice that
Hence aiNt  Zit  Zi0 cid82 t
cid80d
489 EeNt  E
cid40
cid34
dZit  biZitdt  aidNt
1  i  d
0 biZisds and
cid80d
i1 Zit  Zi0
cid80d
cid90 t
dcid88
cid41cid35
biZisds
Following the same arguments in the proof of Theorem 14 we obtain the upper
lim sup
t
log EeNt  inf
uU
z1zdZ
cid40Au
cid80d
dcid88
cid41
As before we can obtain the lower bound
lim inf
t
 sup
Qe
 sup
Q
log EeNt
cid90 cid104
cid90 cid104
cid90 cid34
cid80d
cid80d
       log
dz1     dzd
       log
cid16
cid17cid105
cid16
cid17
cid105
cid16
cid17
cid35
cid41
cid40 dcid88
Q
i1 bizi
      log
The equality in the last line above holds by taking f  g  L  cid80d
cid80d
g  G where
 F for
Kizi  g K  0 g is C1 with compact support
Here i  aiai 1  i  d Dene
F   f  
cid90 cid34
cid80d
cid80d
i1 bizi
cid35
  H 
F is linear in f and hence convex in f  Also H is weakly lower semicontinuous
and convex in   Therefore F is concave in   Furthermore for any
f  cid80d
cid80d
cid80d
494 F   f  
i1 Kizi  g  L  F
cid35
cid90 cid34
dcid88
cid90
dcid88

cid90
Ag
Kibizi H  
If nn   and n   weakly then since g is C1 with compact support we
dcid88
cid35
nn 
cid90
Agn 
cid90 cid34
dcid88
cid35
 
cid90
Ag
cid90 cid34
Since cid80d
i1 Kibizi is continuous and nonpositive on Z we have
cid35
cid35
cid90 cid34
cid90 cid34
 dcid88
 dcid88
Kibizi
n 
Kibizi
lim sup
n
Hence we conclude that F is upper semicontinuous in the weak topology
In order to apply the minmax theorem we want to prove the compactness in
the weak topology of the level set
cid40
cid90 cid34
cid80d
  
For any f  cid80d
cid80d
cid80d
cid80d
i1 bizi
cid35
 Af
cid41
  H   C
i1 Kizi g L  F where g is C1 with compact support
etc there exist some C1 C2  0 such that
C1  H 
cid90
dcid88
cid90
cid104
zi  C2

i1 cizicid96
cid90
cid80d
cid90
cid80d
z1zdZ log
ci  C2  Kbii
cid20
dcid88
  C2
c1z1    cdzd  cid96
     log
cid90
cid80d
z1    zd
zi  cid96C2
i1 cizicid96
cid90
cid105
cid90
dcid88

i1 cizicid96
 1  C2
cid21cid90
cid80d
i1 cizicid96

If ai  0 then i  0 pick up ci  0 such that ci  C2  Kbii  0 If ai  0 then
i  0 pick up ci such that ci  C2  Kbii  0 Finally choose cid96 big enough such
that the big bracket above is positive Then
cid90
cid90
cid80d
zi  C3
  C4
Hencecid82   C5 and H  C6 We can use the similar method as in the proof of
i1 cizicid96
Theorem 14 to show that
4100
cid96 sup
cid90
zicid96
nn  0
1  i  d
For any nn n  R we can nd a subsequence that converges in the weak
topology by Prokhorovs Theorem Therefore
4101
      log
cid35
cid35
cid16
cid17
cid16
cid17
log EeNt
lim inf
t
 sup
Q
fF sup
z1zdZ
cid90 cid34
cid80d
cid80d
cid90 cid34
cid80d
cid80d
cid80d
cid80d
cid40Au
i1 bizi
i1 bizi
i1 bizi
 inf
uU
z1zdZ
      log
 ef z1a1zdadf z1zd  1  dcid88
cid80d
dcid88
cid41
That is because optimizing over  we get   ef z1a1zdadf z1zd and nally
for each f  F u  ef  U
Theorem 17 Assume limz z
some positive constant Then  Nt
the rate function I as the Fenchel-Legendre transform of 
z  0  is continuous and bounded below by
t   satises the large deviation principle with
4102
4103
Ix  sup
x   
cid90 cid104
       log
cid16
cid17cid105
  sup
Qe
Proof The proof is the same as in the case of exponential h
44 Large Deviations for a Special Class of Non-
linear Hawkes Processes An Approximation
Approach
We already proved in Chapter 3 a large deviation principle of Ntt   for
nonlinear Hawkes process by proving a level-3 large deviation rst and then ap-
plying the contraction principle
In this section we point out that there is an
for general exciting function h we can use sums of
alternative approach ie
exponential functions to approximate h and use the large deviations for the case
when h is a sum of exponentials to obtain the large deviations for general h
The advantage of approximating the general case by the case when h is a sum
of exponentials is that the rate function for the large deviations when h is a sum
of exponentials can be evaluated by an optimization problem which should be
computable by some numerical scheme
Before we proceed let us rst prove that h can be approximated by a sum of
exponentials in both L1 and L norms
Lemma 27 If ht  0cid82 
0 htdt   h  0 and h is continuous then h
can be approximated by a sum of exponentials both in L1 and L norms
Proof The Stone-Weierstrass theorem says that if X is a compact Hausdor space
and suppose A is a subspace of CX with the following properties i If f g  A
then f  g  A
iii If x y  X then we can nd an f  A
such that f x cid54 f y Then A is dense in CX in L norm Consider X 
R    0 and C0 consists of continuous functions vanishing at 
ii 1  A
and the constant function 1
By Stone-Weierstrass theorem the linear combination of 1 et e2t etc
dense in C0 In other words for any continuous function h on C0 we
4104
In fact since h  0 we get a0   Thus
cid12cid12cid12cid12cid12ht  ncid88
cid12cid12cid12cid12cid12ht  ncid88
cid12cid12cid12cid12cid12  
cid12cid12cid12cid12cid12  2
ajejt
ajejt
4105
However cid80n
j1 ajejt may not be positive We can approximate cid112ht rst by
a sum of exponentials and then approximate ht by the square of that sum of
exponentials which is again a sum of exponentials but positive this time
Indeed we can approximate ht by the sum of exponentials in L1 norm as well
Suppose cid107h hncid107L  0 where hn is a sum of exponentials Then by dominated
convergence theorem for any   0 cid82 h  hnetdt  0 as n   Thus we
can nd a sequence n  0 such that n  0 as n   andcid82 h  hnentdt  0
By dominated convergence theorem againcid82 h1  entdt  0 Hence we have
cid82 h  hnentdt  0 as n   where hnent is a sum of exponentials
We will show that hnent converges to h in L as well
4106
cid107h  hnentcid107L  cid107h  hncid107L  cid107hn  hnentcid107L
Notice that 1 enthn  1 entht   Since h  0 there exists some
M  0 such that for t  M  ht   so that 1  enthn  2 for t  M  For
t  M  1  enthn  1  enM cid107hcid107L   which is small if n is small
We have the following results
Theorem 18 Assume that   c for some c  0 limz z
z  0 and  is
Lipschitz with constant L for any   1 We have Ntt   satises the large
deviation principle with the rate function
4107
Ix  sup
x  
Remark 5 The class of nonlinear Hawkes process with general exciting function
h for which we proved the large deviation principle here is unfortunately a bit too
special It works for the rate function like z  logc  z for example but does
not work for  that has sublinear power law growth
We end this chapter with the proof of Theorem 18
process with exciting function hn cid80n
Let Pn denote the probability measure under which Nt follows the Hawkes
i1 aiebit such that hn  h as n   in
both L1 and L norms We can nd such a sequence hn by Lemma 27 Let us
dene
4108
log EPncid2eNtcid3 
n  lim
t
We need the following lemmas to prove Theorem 18
Lemma 28 For any K  0 and 1 2  K K there exists some constant
CK such that for any n
4109
n1  n2  CK1  2
Proof Without loss of generality take 2  1 Then
4110
n1  n2
Q
 sup
Q
cid90
cid90
2  1  1
  H 
2  1  n1
4111
cid26
   Qe 
cid90
cid82   CK for some positive constant CK
  H   n1  1
cid27
cid80n
The key is to prove that supQ
depending only on K Dene u  uz1     zn  e
i1 cizi where
4112
3Kcid80n
1  i  n
Dene V  Au
u such that
ncid88
3Kcid80n
4113
V z1     zn 
Notice thatcid82 Af   0 for any test function f with certain regularities If we try
zi  z1    zne3K  1
 1  i  n we get
4114
cid90
cid90
zi 
  0
1  i  n
Summing over 1  i  n we get
cid90
1cid80n
 
cid90
ncid88
zi
4115
Notice thatcid80n
z  0 andcid80n
i1 zi  0 we have
cid90
cid90
cid90
lim supz z
  K
 
4116
Kcid80n
 cid107hncid107L1 which is approximately cid107hcid107L1 when n is large Since
cid90
ncid88
zi  1
V   C12K
theorem and Jensens inequality
where C12K is some positive constant depending only on K
We claim thatcid82 V z  H for any   Q
4117cid90
log Ecid104
0 V Zsdscid105
cid82 t
Next we will show that u  1 That is equivalent to provingcid80n
 lim sup
t
V z  lim
t
cid90 t
cid201
V Zsds
cid21
 H
 0 Consider
e Let us prove it By the ergodic
the process
cid88
ncid88
ncid88
ebit Notice that gt cid82 
ebitj  
 0 Since Au
4118
where gt cid80n
almost surely andcid80n
cid88
gt  j
t hsds  0 Therefore Yt  0
u  V  0 and u  1 by Feynman-Kac
formula and Dynkins formula
Ecid104
0 V Zsdscid105  Ecid104
cid82 t
4119
0 V Zsdscid105
cid82 t
cid90 t
Ecid104
 uZ0 
0 V Zuducid105
cid82 s
AuZs  V ZsuZse
 uZ0
and thereforecid82 V z  H for any   Q
e Hence
cid90
cid90
  1
V z  C12K  1
H  C12K
4120
Notice that
4121
4122
   n1  1  1
n1  1 
H  1
cid90
cid90
  H  n1  
  1
H  C12K
which implies H  2C12K  n1  1 and so also
cid90
cid90
4123
  1
V 
C12K  1
C12Kn11
C12K
Finally notice that since hn  h in both L1 and L norms we can nd a function
g such that supn hn  g and cid107gcid107L1   and thus
4124
n1  nK  gK
where g denotes the case when the rate function is still  but the exciting
function is g instead of hn Notice that here cid107gcid107L1   but may not be less
than 1 It is still well dened because of the assumption limz z
z  0 Indeed
we can nd z    z that dominates the original  for   0 big enough
gK
and   0 small enough so that cid107gcid107L1  1 Now we have gK  
gK corresponds to the case when z   z Hence
which is nite where 
cid90
  CK
4125
Q
for some CK  0 depending only on K
Lemma 29 Assume that   c for some c  0 limz z
z  0 and  is
Lipschitz with constant L for any   1 Then for any K  0 n is Cauchy
with  uniformly in K K
Proof Let us write Hnt cid80
cid18 Hms
cid90 t
cid26
4126
Hns
j t hnt  j Observe rst that for any q
cid18 Hmsq
cid19
cid19
Hnsq1  Hns
dNs 
cid90 t
cid27
is a martingale under Pn By Holders inequality for any p q  1 with 1
4127
EPmeNt  EPn
 EPn
cid20
cid104
eNt dPm
eNtcid82 t
cid104
epNtpcid82 t
cid21
0 HmsHnsdscid82 t
0 HmsHnsdscid1051p EPn
HmsdNscid105
cid104
eqcid82 t
0 log Hns
Hns dNscid1051q
0 log Hms
By the Cauchy-Schwarz inequality
cid104
eqcid82 t
Hns dNscid1051q  EPn
0 log Hms
cid18
cid82 t
4128
cid35 1
cid19
cid34
cid104
cid104
Hns2q1 Hns
Hms2q
 s hms hns dscid105 1
cid80
cid82 t
c2q1 L2q
c2q1 L2qcid107hmhncid107L1 Ntcid105 1
 EPn
 EPn
We also have
4129
cid104
0 HmsHnsdscid1051p  EPncid2epNtpL1cid107hmhncid107L1 Ntcid31p
epNtpcid82 t
Therefore by Lemma 28 and the fact n0  0 for any n we have
4130
m  n
n p  pL1mn 
 CKL1mn 
 CKL1mn 
cid18 L2qmn
cid19
 L2qmn
c2q1 
 n
c2q1
np  1
CKp  1K
 L2qmn
c2q1 
cid18
n 
cid18
1  1
cid19
1  1
cid19
n
where mn  cid107hm  hncid107L1 Hence
4131
m  n  2
lim sup
mn
cid19
cid18
1  1
which is true for any p  1 Letting p  1 we get the desired result
Remark 6 If   c  0 and limz z
z  0 for any   0 then  is
Lipschitz for any   1 For instance z  logz  c satises the conditions
if   0 and c  1
Theorem 19 Assume that   c for some c  0 limz z
Lipschitz with constant L for any   1
z  0 and  is
4132
t
log EeNt    lim
n n
for any   R
Proof By Lemma 29 n tends to  uniformly on any compact set K K
Since n is Lipschitz by Lemma 28 it is continuous and the limit  is also
continuous Let n  cid107hn  hcid107L1   As in the proof of Lemma 29 for any
  K K p q  1 1
q  1 we get
4133
log EeNt
lim sup
t
 n  CKL1n 
cid19
cid18
1  1
 L2qn
c2q1  2
Letting n   rst and then p  1 we get lim supt 1
Similarly for any pcid48 qcid48  1 with 1
pcid48  1
qcid48  1
t log EeNt  
cid20
cid21
4134
n  lim inf
t
 lim inf
t
 lim inf
t
ppcid48t
log EeppL1nNt  lim inf
t
pqcid48t
log Eeppcid48Nt  lim inf
t
c2q1 Nt
log Eeqcid48pL1nNt
cid20
cid21
c2q1 Nt
Since we can dominate  by the linear function z    z in which case the
limit of logarithmic moment generating function  is continuous in  we may
let n   to obtain
4135
  lim inf
t
ppcid48t
log Eeppcid48Nt
This holds for any  and thus
4136
lim inf
t
log EeNt  ppcid48
cid19
cid18 
ppcid48
Letting p pcid48  1 and using the continuity of  we get the desired result
Finally let us prove Theorem 18
Proof of Theorem 18 For the upper bound apply the Gartner-Ellis Theorem Let
us prove the lower bound Let Bx denote the open ball centered at x with radius
  0 By Holders inequality for any p q  1 with 1
cid18 Nt
cid19
4137
 Bx
Therefore letting t   we have
4138
x  n  lim
t
ppcid48 ppcid48L1n 
2pqcid48 
cid191q
 Bx
cid18 Nt
cid19
 Bx
cid13cid13cid13cid13dPn
cid13cid13cid13cid13LpP
cid18 Nt
cid18 L2pqcid48n
cid19
c2pqcid481
lim inf
t
cid18 Nt
cid19
 Bx
where n  cid107hn  hcid107L1 Hence letting n   see that
4139
lim inf
t
 Bx
 lim sup
n
x  n
cid18 Nt
cid19
Since n   uniformly on any compact set K
4140
x  n  sup
x  
as n   for any such set K Notice that   c  0 and recall that the limit
for the logarithmic moment generating function with parameter  for a Poisson
process with constant rate c is e  1c Hence
4141
lim inf

n
 lim inf

e  1c
 
which implies that supRx  n  supRx   Therefore
4142
lim inf
t
 Bx
 sup
x  
cid18 Nt
cid19
Letting q  1 we get the desired result
Chapter 5
Asymptotics for Nonlinear
Hawkes Processes
In the existing literature of on nonlinear Hawkes processes the usual assump-
tion is that  is -Lipschitz h is integrable and cid107hcid107L1  1 But how about
other regimes How do the asymptotics vary in dierent regimes This is the
question we would try to answer in this chapter
We divide the nonlinear Hawkes process into the following regimes
1 limz z
z  0 This is the sublinear regime In this regime if we assume
that  is -Lipschitz cid107hcid107L1   and cid107hcid107L1  1 then there exists a
unique stationary version of the nonlinear Hawkes process The central limit
theorem and large deviations for this regime are proved in Zhu 114 112
and 113 On the contrary if we assume that cid107hcid107L1   then there is no
stationary version Figure 51 illustrates t in this case We will obtain the
time asymptotics for t in Section 51
2 limz z
z  1 and cid107hcid107L1  1 This is the sub-critical regime
In this
regime if we assume that  is -Lipschitz and cid107hcid107L1  1 then there ex-
ists a unique stationary version of the nonlinear Hawkes process see Bremaud
and Massoulie 14 The central limit theorem is proved in Zhu 114 Figure
53 illustrates t in this case We will summarize some known results about
the limit theorems in Section 52
3 limz z
z  1 and cid107hcid107L1  1 This is the critical regime This regime is
very subtle We will show in Section 53 that in some cases there exists a
T 2 cid82 t
stationary version of the Hawkes process In some other cases it does not
thtdt   we will prove
exist In particular when z    z andcid82 
of t in this case When h has heavy tails ie cid82 
that NtT
T  will
converge to a Polya process as T   Figure 54 illustrates the behavior
thtdt   we will
0 sds where s is a squared Bessel process N T T  t
prove that the time asymptotic behavior is dierent from the light tail case
4 limz z
z  1 and cid107hcid107L1  1 This is the super-critical regime We will
prove in Section 54 that t grows exponentially in t in this regime which is
consistent with what we can see in Figure 55
5 cid80
n   This is the explosive regime In Section 55 we will rst
provide a criterion for the explosion and non-explosion for nonlinear Hawkes
process Then we will study the asymptotic behavior of the explosion time
Figure 56 illustrates the explosion of a nite time
Notice that if cid107hcid107L1   and limz z
54 If cid107hcid107L1   andcid80
critical regime and we will see that t grows exponentially this is discussed Section
n   then one is in the explosive regime to be
z    0 then one is in the super-
discussed in Section 55
We will launch a systematic study of the time asymptoics for Hawkes process in
dierent regimes We will study the sublinear regime sub-critical regime critical
regime and super-critical regime in Sections 51 52 53 54 respectively Finally
in Section 55 we will provide a criterion for explosion and non-explosion for
Hawkes process and obtain some asymptotics for the explosion time
Figure 51 Plot of intensity t for a realization of Hawkes process Here ht 
t  1 1
2 and z  1  z 1
Figure 52 Plot of intensity t for a realization of Hawkes process Here ht 
2  In this case cid107hcid107L1   and  is sublinear and
t13 and z  1  z 1
Lipschitz It will converge to the unique stationary version of the Hawkes process
051015202530024681005101520253002468101
Figure 53 Plot of intensity t for a realization of Hawkes process Here ht 
t13 and z  1z In this case cid107hcid107L1  1
2  1 It is in the sub-critical regime
This is a classical Hawkes process and it will converge to the unique stationary
version of the Hawkes process
51 Sublinear Regime
In this section we are interested in the sublinear case limz z
cid107hcid107L1   and  is -Lipschitz and cid107hcid107L1  1 then as Bremaud and Mas-
soulie 14 proved there exists a unique stationary Hawkes process Recently
Karabash 63 relaxed the Lipschitz condition and proved the stability result for a
wider class of  Let P and E denote the probability measure and expectation
for stationary Hawkes process Then by ergodic theorem we have the law of large
numbers
   EN 0 1
as t  
The central limit theorem and large deviations have already been discussed in
Chapter 2 Chapter 3 and Chapter 4
If cid107hcid107L1   then there is no stationary version of Hawkes process and t
tends to  as t   This is the case we are going to study for the rest of
05101520253002468102
t13 and z  1  z In this case cid107hcid107L1  1cid82 
converges tocid82 
Figure 54 Plot of intensity t for a realization of Hawkes process Here ht 
thtdt   and  is linear
It is therefore in the critical regime From the graph we can see that t grows
linearly in t which will be proved in this chapter Indeed we will prove that NT
0 sds as T   where s is a squared Bessel process
the subsection We are interested the time asymptotic behavior of the nonlinear
Hawkes process in this regime
Let us rst make a simple observation Assume that z   as z  
Then assuming cid107hcid107L1   we have t   as t   as This can be seen by
0 ht  sN ds   as if cid107hcid107L1   where Nt follows from a
noticing thatcid82 t
standard Poisson process with constant rate 0
Let us prove a special case rst
Proposition 1 Assume that h  1 and z    z where    0 and
0    1 Then
in probability as t  
1 1  
1 
051015202530010203040503
Figure 55 Plot of intensity t for a realization of Hawkes process Here ht 
t13 and z  1  z In this case cid107hcid107L1  3
2  1 and it is in the super-critical
regime We expect that t would grow exponentially in this case
Proof For   0
cid104
cid104
cid34cid18
  Nt  1
   Nt  1
    Nt
  
   Nt
cid105
cid19 
cid35
  
cid105
Let   
1  We have
cid90 t
cid20
 1  
s 1
cid21
sds 
cid90 t
cid20
cid21
 1  
s 1
Since t   as as t   by the bounded convergence theorem
 1  
s 1
ds  1  
as t   It is not dicult to see that 1
probability as t   Hence 
 1  
s 1dMs  0 in
 in probability as t  
cid26cid20
cid90 t
cid21
cid27
cid82 t
t  1  
012345670204060801001
Figure 56 Plot of intensity t for a realization of Hawkes process Here ht 
t13 and z  1  z 3
2  This is in the explosive regime The plot is a little bit
cheating because it is impossible to plot explosion Nevertheless you can think
it as an illustration It appears that the process explodes near time t  6
Remark 7 Assume that ht  t  1   1 and z    z where
   0 and 0    1 We conjecture that
as t   as where   1
0 u1  udu
1 
1 B 
t  
1 and B  cid82 1
52 Sub-Critical Regime
In this section we review some known results about the limit theorems in the
sub-critical regime We say the Hawkes process is in the sub-critical regime if
z  1 and cid107hcid107L1  1 If we further assume that  is -Lipschitz and
limz z
cid107hcid107L1  1 then Bremaud and Massoulie 14 proved that there exists a unique
stationary Hawkes process In this regime we also have the law of large numbers
and the central limit theorem just as in Section 51 For the case when  is
nonlinear we refer to the review in Section 51 for the law of large numbers and
01234567020406080100central limit theorem
In particular when z    z and   0 we have explict expressions for the
law of large numbers central limit theorem and large deviation principle They
are well known in the literature
The ergodic theorem implies the following law of large numbers
1  cid107hcid107L1
as t   as
Bordenave and Torrisi 11 proved a large deviation principle for  Nt
t   with the
rate function
cid16
x log
cid17  x  xcid107hcid107L1  
xcid107hcid107L1
if x  0
otherwise
Bacry et al 2 proved a functional central limit theorem stating that
Nt  t
 B
as t  
on D0 1 with Skorokhod topology where
1  cid107hcid107L1
and 2 
1  cid107hcid107L13 
When  is nonlinear and sub-critical the central limit theorem has been
obtained in Chapter 2
53 Critical Regime
In this section we are interested in the critical regime ie
and cid107hcid107L1  1 This regime is very subtle In some cases there exists a stationary
version of Hawkes process whilst in some cases there does not For example
limz z
Bremaud and Massoulie 15 proved that
Proposition 2 Bremaud and Massoulie Assume z  z cid107hcid107L1  1 and
t1ht  R
t t1ht  r
for some nite constants r R  0 and 0    1
2 Then there exists a non-trivial
stationary Hawkes process with nite intensity
Bremaud and Massoulie considered only the linear Hawkes process in their
paper 15 If you allow nonlinear rate function you get a much richer class of
Hawkes processes and in some cases there still exists a stationary Hawkes process
It is much easier to work with the exponential case ie when ht  aeat and
cid107hcid107L1  1
The lecture notes by Hairer 47 provides a sucient condition for which there
exists an invariant probability measure Let L be the generator of a Markov
If there exists V  1 continuous with precompact sublevel sets and
process
some function   R  R strictly concave increasing with 0  0 and
x   as x   and LV  K  V  for some K  0 then there exists an
invariant probability measure
Proposition 3 Assume ht  aeat a  0 and z  z  z   where z
is positive increasing strictly concave and z   and z
z  0 as z   If
also z is strictly positive Then there exists an invarint probability measure
Proof Let V z  z  1 and V   aV   0 Then   R  R
is increasing and strictly concave z   and 0  0 Recall that the
generator is given by
Af z  az
 zf z  a  f z
Hence we have
513 AV  V   za  az  1  a0  a  a1  2a0  a
We can generalize our result to the much wider class of h when h is a
i1 aiebit where bi  0 and ai  0 1  i  d
i1 Zit and Z1t     Zdt is
 t aiebit  Then Zt  cid80d
sum of exponentials ht  cid80d
Write Zit  cid80
514 Af   dcid88
Markovian with the generator
cid32 dcid88
cid33
 f z1  a1     zd  ad  f z1     zd 
We have the following result
Proposition 4 Assume ht cid80d
cid107hcid107L1 cid80d
i1 aiebit bi  0 and ai  0 1  i  d and
 1 Also assume that z  zz where z is positive
z  0 as z   and z is
increasing strictly concave and z   and z
strictly positive Then there exists an invariant probability measure
Proof Let V cid80d
 1 and V   min1id biV   0 Then   R 
R is increasing and strictly concave z   as z   and 0  0 Using
the concavity and monotonicity of  we have
AV  V 
dcid88
cid32
1id
cid32
cid33
cid33
dcid88
cid19
cid32 dcid88
cid32
1id
1id
 20  
 
 
cid18
1id
dcid88
cid33
 0  
cid33
1id
1id
 0  
Remark 8 The following z satises the assumptions in Proposition 4 for suf-
ciently large   0
i z  c1  c2z where c1 c2  0 and 0    1
ii z  logc3  z where c3  1
Prosposition 4 Then we havecid82 
cid16
cid80d
cid17
min1id bi
dz  
Remark 9 Let  be the invariant probability measure for Z1t     Zdt in
Indeed when h may not be exponential or a sum of exponentials we have
the following result
Theorem 20 Assume z    z  z where   R  R satises
limz z   and limz z
z  0 and also z is increasing Also assume
that cid107hcid107L1  1 Then there exists a stationary Hawkes process satisfying the
dynamics 12
Proof The proof uses Poisson embedding and follows the ideas in Bremaud and
Massoulie 14 Consider the canonical space of a point process on R2 in which
t  0 t  R and let N 0 be the point
t  ie N 0   Dene
t  Z 0
recursively the processes n
N is Poisson with intensity 1 Let 0
process counting the points of N below the curve t cid55 0
t and N n n  0 as follows
cid19
cid90 t
t  Z n
ht  sN nds
cid18cid90 t
cid90
N n1C 
N dt  0 n1
 Z n1
 C  BR
ht  sN nds
t  R
By our construction n
14 Since  is increasing the processes n
is an F N
t -intensity of N n see Bremaud and Massoulie
t  Z n
t and N n are increasing in n
Thus the limit processes t Zt N exist Since n
t  Z n
t are stationary in t and
increasing in n we have
0    En
cid90 
htdt  EZ n1
    En1
0  EZ n1
Therefore by Fatous lemma EZ0     Thus Zt is nite as Since
limz z   Zt is nite as and thus t is nite as N  which counts the
number of points of N below the curve t cid55 t admits t as an F N
t -intensity The
monotonicity implies
t  
cid18cid90 t
cid19
ht  sN ds
cid18cid90 t
t  
cid19
ht  sN nds
Letting n   we complete the proof
Remark 10 The following z satises the assumptions in Theorem 20
i z  c1  c2z where c1 c2  0 0    1   c
1 and c1
c2  1
ii z  logc3  z where 1  c3  e
cid107hcid107L11 We also assume that m  cid82 
Next let us consider the critical linear case ie z    z   0 and
thtdt   There is no stationary
Hawkes process in this regime and in the rest of this subsection we will try to
understand its time asymptotics
First let us prove a lemma concerning the expectations of t and Nt
Lemma 30 Assume z    z   0 and cid107hcid107L11 and m cid82 
thtdt  
We have
Proof Since
t
t
t   
cid90 t
ht  sdNs
taking f t  Et we get
f t   
cid90 t
ht  sf sds   
cid90 t
hsf t  sds
Taking the Laplace transform on both sides of the equation it is easy to see that
the Laplace transform f of f is given by
f  
1  h
as   0
since h0  1 by cid107hcid107L1  1 and 1h
see Chapter XIII of Feller 38 we get f t
  hcid480  m By a Tauberian theorem
m as t   Using the simple fact
that ENt cid82 t
t  
0 f sds we complete the proof
Theorem 21 Assume z    z   0 and cid107hcid107L1  1 m cid82 
thtdt  
and h Lipschitz We have the following asymptotics
i As T   on D0 1
cid90 t
T 2 
where t is a squared Bessel process ie
ii limT Ncid2T T  t
tdBt
0  0
cid3  P t where P t is a Polya process with parame-
2m2 and 2m
Remark 11 The fact that a squared Bessel process arises in the limit of a critical
linear Hawkes process is not a surprise It is well known that a critical branching
process after certain scalings will converge to a squared Bessel process in the limit
This was discovered by Wei and Winnicki 105
Remark 12 Before we proceed to the proof of Theorem 21 let us recall that a
Polya process with parameters  and  is a point process dened as the following
Generate a positive random variable  with Gamma distribution of parameters 
shape and  scale Conditional on  P t is a Poisson process with intensity 
The marginal distribution of P t is negative binomial and unlike the usual Poisson
process Polya process has dependent increments The covariance of the increments
can be computed explicitly as CovP t  t  P t P t  t  t  2 Peng and
Kou 92 used Polya process to model clustering eects in the credit markets
Proof of Theorem 21 i Let Ht  cid82 
t hsds Then we have H0  1 and
0 Htdt  cid82 
cid82 
cid82 s
0 hs  uN du   over 0  s  tT  We get
cid90 tT
thtdt  m Let Mt  Nt cid82 t
cid90 tT
cid90 tT
cid90 s
hs  udMuds 
sds 
0 sds Let us integrate s 
cid90 s
hs  uududs  tT
Rearranging the equation and dividing by T  we get
cid20cid90 tT
cid90 tT
cid90 s
sds 
hs  uududs
cid21
cid90 tT
cid90 s
hsudMudst
Fubinis theorem implies that
cid20cid90 tT
cid90 tT
cid18cid90 tTu
udu 
cid19
cid21
cid90 tT
cid18cid90 tTu
cid19
dMu  t
By the denition of H this is equivalent to
T HtT  uT 
 t 
cid90 t
cid18 MuT
cid19
T HtT  uT d
is a martingale and the tightness can be easily established Furthermore we
cid90 t
cid34cid18 MtT
cid192cid35
cid20cid90 tT
cid21
since Et  Ct for some C  0 by Lemma 30 This implies that the limit of MtT
is also a martinagle
T 2 and cid82 t
Moreover NtT
nonnegative we can think of cid0dcid0 NtT
T ds are both tight To see this since Nt and t are
cid1  0  t  1cid1 and cid0 tT
T dt 0  t  1cid1 as two
measures But by Lemma 30 we know that there exist some positive contant
C  0 such that
cid20NT
cid21
cid21
cid20cid90 1
cid1  0  t  1cid1 and cid0 tT
 C and E
uniformly in T  0 Therefore cid0dcid0 NtT
T 2  t and cid82 t
tight in the weak topology Hence their distribution functions NtT
are tight in D0 1 equipped with the Skorohod topology Let us say that MtT
T  t
T 2 are uniformly
T 2 which goes to zero as T   we conclude that t is continuous
T ds  t as T   Since the jumps of NtT
T dt 0  t  1cid1 are
T 2 and cid82 t
bounded by 1
Similarly t and t are continuous Moreover the dierence
T 2 
cid90 t
is a martingale and by Doobs martingale inequality for any   0
cid18
cid12cid12cid12cid12 MtT
cid12cid12cid12cid12  
cid19
0t1
cid21
cid20cid90 tT
andcid82 
as T   Therefore t  t Let us denote T HT  by HT  MT
T ds by T  For any smooth function K supported on R taking the
convolutions of the both sides of 528 we get
K  HT  T  K  MT  K   
K  HT  MT 
Letting T   using the fact thatcid82 
0 Htdt cid82 
cid90 t
cid90 t
Kt  sds 
Kt  ss  sds
thtdt  m we get
Since this is true for any K we get dt
dt  t
t  Finally
cid90 t
cid192 
cid18 MtT
T 2  cid82 t
is a martingale and if we let T   we conclude that 2
t  dt
t  t is a martingale Let
0 sds weakly on D0 1 equipped with
dt  We have proved that NtT
Skorohod topology and t is a squared Bessel process
tdBt
T  has the compensatorcid82 T  t
0  0
sds Observe thatcid82 T  t
ii N T T  t
sds 
T ds  1t as T   where 1 has a Gamma distribution with shape
T 2cid82 1 t
Now let us consider the case when h has heavy tail ie cid82 
2m2 and scale 2m
thtdt  
Let us rst prove the following lemma
Lemma 31 Assume that
cid90 t
hsds 
cid90 
hsds  t
0    1
t    sin 
t
t1 
t
1  2  
Proof The Tauberian theorem of Chapter XIII of Feller 38 says that
1  h  1  
  0
Let Et  f t This implies that
f  
1  h
 1
1  
  0
which again by a Tauberian theorem Theorem 2 of Chapter XIII5 of Feller 38
implies
cid90 t
f sds 
1  2  
t  
cid90 t
Since Et   cid82 t
ENt 
cid90 t
Esds 
f sds 
1  2  
t  
0 ht  sdENs it is easy to check that
Et  f t 
1  1  
t    sin 
 t
t  
We obtain the following law of large numbers
Theorem 22 Assume thatcid82 
t hsds  1
t  0    1 Then
t1 
1  2  
t    sin 
as as t  
Proof Let Xt  Nt  ENt Then Xt satises see Bacry et al 2
where Mt  Nt cid82 t
it is not hard to see that
Xt  Mt 
cid90 t
0 sds and  cid80
cid34cid18 Nt  ENt
cid192cid35
t  sMsds
n hn Then by Doobs maximal inequality
cid20
cid21cid18
t22 t1t2  0
cid192
t  sds
cid90 t
as t   since 0    1 Hence as t  
To show the almost sure convergence we need only to show that 1
t supst Ms  0
1  2  
in L2 as t  
t1 
as as t   Dene Yt cid82 t
1sdMs Then by Lemma 31
1  s2 ds  
cid90 
cid90 t
By the martingale convergence theorem Yt  Y as as t   It follows that
 Yt  1
Ysds  0
as as t   From here it is easy to show that 1
t supst Ms  0 as Finally
since t   cid82 t
0 ht  sN ds we conclude that
t    sin 
as as t  
54 Super-Critical Regime
In this section we are interested in the super-critical regime ie limz z
1 and cid107hcid107L1  1 First let us compute the asymptotics for the expectations Let
0 ethtdt  1  is sometimes
  0 be the unique positive number such thatcid82 
cid90 
referred to as the Malthusian parameter in the literature Let us also dene
ht  htet m 
thtetdt
Clearly under our assumptions 0  m   and cid107hcid107L1  1
Lemma 32 i Assume z    z   0 being a constant Then
t
ii Assume limz z
z  1 and let  be bounded below by a positive con-
stant Then
t
log Et  lim
t
log ENt  
Proof i Let f t  Et We have
cid90 t
ht  sets f s
es ds 
cid90 t
ht  s
es ds
Taking Laplace transform we get
cid92f tet 
1  h
as   0 By the Tauberian theorem we have
t
ii is a direct consequence of i
This is consistent with the exponential case when ht  aebt and a  b We
558 Et   b
a  b
a  b
eabt ENt   bt
a  b
a  b2 eabt  1
Indeed in the exponential case   a  b and
559 dZteabt  eabtdZt  Ztdeabt  aZteabtdt  aeabtdNt
Let Yt  Zteabt We have
dYt  aYtdt  aeabtdNt  aeabtdt  aeabtdMt
If we assume that N  0  0 then Z0  0 and
cid90 t
ab andcid82 t
cid192cid35
cid90 t
cid90 
Clearlycid82 t
cid34cid18cid90 t
aeabsds  a
eabsdMs
0 eabsds  a
0 aeabsdMs is a martingale and
eabsdMs
e2absEsds 
2a  b
2a  b2  
Therefore by the martingale convergence theorem there exists some W in L2P
such that
eabt  a
a  b
as t   The convergence is as and also in L2P
For the general h such that cid107hcid107L1  1 we may even consider the case when
cid107hcid107L1   For instance if we assume that h is decreasing and continuous and
then h is bounded and all the arguments for the case 1  cid107hcid107L1   would
work for the case cid107hcid107L1   as well
Theorem 23 Assume z    z   0 We have
et  
where W cid82 
0 etdMt
as as t  
Proof It is not very hard to observe that
cid90 t
cid90 t
cid90 t
ht  s
ht  sets
ht  sdM s 
cid90 t
cid18 dMs
cid90 t
ht  s
cid19
cid90 t
ht  s
es ds
ht  sets s
es ds
  hcid82 
0 etdM t
  hcid82 
0 etdMt
1  h
Taking Laplace transform we get
cid92tet 
1  h
as   0 where W  cid82 
cid82 t
0 esdMs is a martingale and
cid34cid18cid90 t
esdMs
0 etdMt Notice that W is well dened as because
cid192cid35
cid90 
e2sEsds  
by Lemma 32 Hence by the Tauberian theorem we conclude that as t  
et  
2m  W
m as as t  
et  
Corollary 1 Nt
Proof Let Mt  Nt cid82 t
cid82 t
Esds  Cet for some C  0 it is easy to see that Mt
0 sds Then since Mt is a martingale and EM 2
et  0 as as t   On
the other hand
cid90 t
sds 
cid90 t
cid20 
cid21
ets s
es ds  1
by Theorem 23 Hence we get the desired result
Remark 13 It would be interesting to study the properties of W dened in The-
orem 23 Observe that
Ecid104
ecid82 t
0 esdMs
cid105
 Ecid104
 Ecid104
 Ecid104
0 hsuN duesdscid105
cid82 s
0 esdNscid82 t
cid82 t
s huseuduN dscid105
cid82 t
0 escid82 t
0 esHtsN dscid105
ecid82 t
 1et
 1et
 1et
where Ht cid82 
t hsds Hence
EeW   e
where gts  expcid8 
et esHs cid82 s
0 hs  ugtuducid9  1
t ecid82 t
0 gtsds
55 Explosive Regime
In this section we will provide an explosion non-explosion criterion for non-
linear Hawkes processes together with some asymptotics for the explosion time in
the explosive regime Let cid96  inft  0  t  cid96 The quantity
Pcid96  t  F t  P  t
cid96
is dened as the distribution function of the explosion time   We say there is
no explosion if F  0 otherwise there is explosion For a short introduction to
explosion non-explosion we refer to Varadhan 109
Next we provide an explosion non-explosion criterion for nonlinear Hawkes
processes The proof is based on a well known result for the explosion non-
explosion criterion for a class of point processes which can be found in the book
by Kallenberg 61
Theorem 24 Explosion Non-Explosion Criterion Assume that  is increas-
ing and that h is integrable and decreasing then there is explosion if and only
cid88
Proof Observe that for any T  0
PhT   T   P  T   Ph0  T 
where Ph0 denotes the probability measure for the point process such that initially
the rate function is 0 and after nth jumps the rate function becomes nh0
PhT  is dened similarly It is well known that the point process with intensity
Nt is explosive if and only if
cid88
For the details and proof of the above result we refer to Kallenberg 61 But it is
clear under our assumptions thatcid80
n   if and only ifcid80
cn  
where c  0 is any positive constant Therefore there is explosion if and only if
cid88
Evaluating the exact probability distribution of the explosion time   ie P 
t is hard and almost impossible Nevertheless one can still study its asymptotic
behavior ie
i P  t for large time t
ii P   for small time 
In the rest of this section we will use Proposition 5 to answer i and Proposi-
tion 6 to answer ii
Proposition 5 Under the assumptions of Theorem 24 satisfying the explosion
criterion we have
t
log P
  t  inf
log P
  t  
where 0    
Proof For a nonlinear Hawkes process with empty history ie N  0  0 we
  t  s  P
  t  s  sP
  s  P
  tP
  s
Therefore log P
  t is sub-additive and we know that
t
log P
  t  inf
log P
  t  
exists And we also know that 0     For example it is easy to see that
  0 That is because P
N 0 t  0  e0t To see that
  0 choose M large enough so that P  M   1 and then    1
M log P 
  t  P
M   0
dened in Proposition 5 When ht  aebt Zt  cid80
Remark 14 Indeed in the Markovian case we can say something more about 
 t aebt  is Markovian
and by noticing that
cid26
f Zt  f Z0 
cid90 t
cid27
ef Zsds
is a martingale and that Nt explodes if and only if Zt explodes we have
t
log P
  t  
where  is the principal eigenvalue for
Au  u
u  1
Note that here you have to choose the test function u  1 rather than u  0
Proposition 6 Assume that z  zk   where    0 and k  1 According
to Theorem 24 it is in the explosive regime We have the following asymptotics
for small time 
where Ck cid82 
cid16 ykh0k
cid17
ykh0k1
k1 log P    C
k1  k
k1 
Before we proceed let us rst quote de Bruijns Tauberian theorem from the
book by Bingham Goldie and Teugels 9 which will be used in the proof of
Proposition 6
whose Laplace transform M  cid82 
Theorem 25 de Bruijns Tauberian theorem Let  be a measure on 0
0 exdx converges for all   0 If   0
  R0 ie tt   as t  0 put     R10
then for B  0
if and only if
 log 0 x  B
1x
x  0
 log M   1  
cid19 
cid18 B

  
Here   supt  t   and similarly for 
Proof of Proposition 6 First let us observe that since we are considering the event
   for   0 very small It is sucient to consider the point process with
intensity h0Nt at time t
To apply de Bruijins Tauberian theorem notice that
 log M   
cid88
cid18 ih0
ih0  
cid19
Recall that z  zk   where    0 and k  1 Then
 log M   
 
cid88
cid90 
ikh0k    
cid18 ikh0k  
cid19
cid18 xkh0k  
cid19
cid18 ykh0k  
cid90 
cid19
cid18 ykh0k
cid90 
xkh0k    
11k
ykh0k    
ykh0k  1
 1k
 1k
cid19
as   
Similarly
 log M   
cid90 
Now let Ck cid82 
 1k
cid16 ykh0k
cid17
ykh0k1
cid18 xkh0k  
cid18 ykh0k
cid90 
xkh0k    
ykh0k  1
cid19
cid19
as   
dy t  t1k t  tk and   1  k  0
Then 1  1
k1 and    1
k  To apply the theorem we need to solve
B such that
1  
cid19 
cid18 B
cid19 k1
cid18 B
k  1
for B  k  1Ckk
k1  Therefore
k1 log P    C
k1  k
k1 
Chapter 6
Limit Theorems for Marked
Hawkes Processes
Introduction and Main Results
Introduction
We consider in this chapter a linear Hawkes process with random marks Let
Nt be a simple point process Nt denotes the number of points in the interval 0 t
Let Ft be the natural ltration up to time t We assume that N  0  0 At
time t the point process has Ft-predictable intensity
cid88
ht  i ai
t    Zt Zt 
where   0 the ii1 are arrival times of the points and the aii1 are iid
random marks ai being independent of previous arrival times j j  i Let
us assume that ai has a common distribution qda on a metric space X Here
cid82
h  R  X  R is integrable ie cid82 
cid82 
0 ht adt for any a  X We also assume that
Haqda  1
cid90
X ht aqdadt   Let Ha 
Let Pq denote the probability measure for the ais with the common law qda
Under assumption 62 it is well known that there exists a unique stationary
version of the linear marked Hawkes process satisfying the dynamics 61 and
that by ergodic theorem a law of large numbers holds
t
1  EqHa
This chapter is organized as follows In Section 612 we will introduce the main
results of this paper ie the central limit theorem and the large deviation principle
for linear marked Hawkes processes The proof of the central limit theorem will be
given in Section 62 and the proof of the large deviation principle will be given in
Section 63 Finally we will discuss an application of our results to a risk model
in nance in Section 64
612 Main Results
For a linear marked Hawkes process satisfying the dynamics 61 we have the
following large deviation principle
Theorem 26 Large Deviation Principle Assume the conditions 62 and
x
cid27
cid26cid90
eHaxqda  x
Then Ntt   satises a large deviation principle with rate function
xEqHa    x  x log
xEqHa
log dq
cid16
cid17
 xEqcid104
cid105cid111
cid110
inf q
x  x  1 x  0
x 
x  0
where the inmum of q is taken over MX the space of probability measures on X
such that q is absolutely continuous wrt q Here  and x satisfy the following
Eqhs ads  0
equations
x  Eqcid2ex1Hacid3
  x  x
Eqcid2Haex1Hacid3
Theorem 27 Central Limit Theorem Assume limt t12cid82 
cid19
and that 62 holds Then
cid18
1EqHa
1  VarqHa
1  EqHa3
in distribution as t  
62 Proof of Central Limit Theorem
Proof of Theorem 27 First let us observe that
cid90 t
cid90 t
cid88
cid88
sds  t 
 t 
hs  i aids
Hai  Et
where the error term Et is given by
Therefore
cid90 
hs  i aids
cid88
Nt cid82 t
0 sds
Nt  t cid80
 1  EqHa
it Hai
Nt  t
EqHaNt cid80
it Hai
where  
1EqHa Rearranging the terms in 69 we get
Nt  t
1  EqHa
cid34
Nt cid82 t
cid80
0 sds
itHai  EqHa
cid35
 Et
It is easy to check that Et
notice that Et 
1EqHa uniformly in t Let gt a cid82 
 0 in probability as t   To see this rst
t hs ads We have
Et cid80
it gt  i ai and thus
cid90
cid90 t
EEt 
gt  s aqdaEsds
1  EqHa
1  EqHa
cid90
cid90 t
cid90 t
gt  s aqdads
Eqgs ads
Hence by LHopitals rule
cid90 t
t
Eqgs ads  lim
t
Eqgt a
2t12
cid90 
cid88
t 2t12
Eqhs ads  0
0 sds and M2t cid80
itHai EqHa are
 0 in probability as t  
Hence Et
both martingales
Furthermore M1t  Nt cid82 t
Moreover sincecid82 t
Nt  M2t cid80
0 sds is of nite variation the quadratic variation of M1t 
M2t is the same as the quadratic variation of Nt  M2t And notice that
it1  Hai  EqHa which has quadratic variation
1  Hai  EqHa2
By the standard law of large numbers we have
cid88
1  Hai  EqHa 
cid88
1  EqHa
1  VarqHa
1  EqHa
1  Hai  EqHa2
 Eqcid21  Ha  EqHa2cid3
as as t   By a standard martingale central limit theorem we conclude that
1EqHa
in distribution as t  
cid18
1  VarqHa
1  EqHa3
cid19
63 Proof of Large Deviation Principle
631 Limit of a Logarithmic Moment Generating Function
In this subsection we prove the existence of the limit of the logarithmic moment
t log EeNt and give a variational formula and a more
generating function limt 1
explicit formula for this limit
Theorem 28 The limit  of the logarithmic moment generating function is
  lim
t
log EeNt 
f   1
if    c
otherwise
where f  is the minimal solution to x cid82
cid90
where xc  1 satises the equation xcid82
c   log
X eHax1qda and
HaeHaxc1qda  0
X HaeHax1qda cid82
X eHax1qda
We will break the proof of Theorem 28 into the proof of the lower bound ie
Lemma 34 and the proof of the upper bound ie Lemma 35
Before we proceed let us rst prove Lemma 33 which will be repeatedly used
Lemma 33 Consider a linear marked Hawkes process with intensity
cid88
ht  i ai
t    Zt    
and EqHa  1 where the ai are iid random marks with the common law
qda independent of the previous arrival times then there exists a unique invariant
measure  for Zt such that
cid90
zdz 
1  EqHa
Proof The ergodicity of Zt is well known Let  be the invariant probability
measure for Zt Then
cid90
zdz    
cid90
cid90 
cid90
zdz
ht adtqda
Lemma 34 Lower Bound
f   1
if    c
lim inf
t
log EeNt 
where f  is the minimal solution to x cid82 eHax1qda and c is dened in
otherwise
617
cid80
Proof The intensity at time t is t
 Zt where z    z and Zt 
it ht  i ai We tilt  to  and q to q such that by Girsanov formula the
tilted probability measure P is given by
cid12cid12cid12cid12Ft
cid40cid90 t
Zs  Zsds 
cid90 t
cid32 Zs
cid33
cid18 dq
cid19
cid41
Let Qe be the set of  q  such that the marked Hawkes process with intensity
Zt and random marks distributed as q is ergodic with  as the invariant measure
By the ergodic theorem and Jensens inequality for any  q   Qe
lim inf
t
 lim inf
t
cid90
cid201
log EeNt
Nt  1
cid90
cid90 t
  ds  1
cid90cid90 cid104
cid104
cid90 t
dz 
  dz 
log  logdqdq
cid21
cid105 ds
cid105 qdz
log  logdqdq
Hence
lim inf
t
 sup
qQe
KqQe
log EeNt
cid90
 
log  logdqdq
   
cid90cid90 cid104
cid26cid90
cid90 cid104cid0  Eqlogdqdqcid1        log
cid16
cid17cid105
cid90 cid20cid0  Eqlogdqdqcid1  1  1
cid20cid0  Eqlogdqdqcid1  1  1
cid21
 log K
cid27
cid105 q
cid21

 log K
1  KEqHa
0KEqHa1KqQe
0KEqHa1
where the last equality is obtained by applying Lemma 33 The supremum of q is
taken over MX such that q is absolutely continuous wrt q Optimizing over
K  0 we get
lim inf
t
log EeNt
supq  f   1
if  cid0   Eqcid104
log dq
cid105
 EqHa  1  log EqHacid3
otherwise
where f  is the minimal solution to the equation
cid20
x  eEqlogdqdqEqHax1
 Eq
eHax1 dq
cid21
cid90
eHax1qda
The last inequality is satised by Jensens inequality the equality holds if and only
eHax1
EqeHax1
Optimizing over q we get
lim inf
t
log EeNt 
f   1
if    c
otherwise
where c is some critical value to be determined Let
Gx  e
eHax1qda  x
If   0 then Gx  cid82 eHax1qda  x satises G1  0 G   by
64 and Gcid481  EqHa  1  0 which implies minx1 Gx  0 Hence there
exists some critical c  0 such that minx1 Gx  0 The critical values xc and
c satisfy Gxc  Gcid48xc  0 which implies
c   log
HaeHaxc1qda
where xc  1 satises the equation xcid82 HaeHax1qda cid82 eHax1qda
It is easy to check that indeed for dq  eHax1
EqeHax1 dq
cid90
cid90
cid20
cid21
 EqHa  1  log EqHa   log
cid90
HaeHax1qda
Lemma 35 Upper Bound
f   1
if    c
log EeNt 
lim sup
t
where f  is the minimal solution to x cid82 eHax1qda and c is dened in
otherwise
617
Proof It is well known that a linear Hawkes process has an immigration-birth
representation The immigrants roots arrive via a standard Poisson process
with constant intensity   0 Each immigrant generates children according to
a Galton-Watson tree See for example Hawkes and Oakes 54 and Karabash
63 Consider a random rooted tree with root ie
immigrant at time 0 as-
sociated to the Hawkes process via the Galton-Watson interpretation Note the
root is unmarked at the start of the process so the marking goes into the expec-
tation calculation later Let K be the number of children of the root node and
let S1
     SK
be the number of descendants of roots k-th child that were
born before time t including k-th child if an only if it was born before time t
Let St be the total number of children in tree before time t including root node
FSt  EexpSt
cid88
EexpStK  kPK  k
cid88
cid88
cid88
cid18
 exp
 exp
 exp
cid90
PK  k
Ecid104
cid16
cid34cid18cid90 t
cid90
cid90 t
kcid89
cid17cid105
Ecid104
cid16
cid17cid105k PK  k
hs a
FSt  sds
hs aFSt  s  1ds
cid19k
cid19
cid35
eHa Hak
Now observe that FSt is strictly increasing and hence must approach to the
smaller solution x of the following equation
exp   Hax  1 qda
cid90
Finally since random roots arrive according to a Poisson process with constant
intensity   0 we have
FN t  EexpNt  exp
cid20
cid90 t
cid21
FSt  s  1ds
But since FSs  x as s   we obtain the main result
log FN t  
FSs  1 ds
t x  1
cid20cid90 t
cid21
which proves the desired formula Note that x   when there is no solution to
634 The proof is complete
632 Large Deviation Principle
In this section we prove the main result ie Theorem 26 by using the Gartner-
Ellis theorem for the upper bound and tilting method for the lower bound
Proof of Theorem 26 For the upper bound since we have Theorem 28 we can
simply apply Gartner-Ellis theorem To prove the lower bound it suces to show
that for any x  0   0 we have
lim inf
t
cid18 Nt
cid19
 Bx
  sup
x  
where Bx denotes the open ball centered at x with radius  Let P denote the
tilted probability measure with rate  and marks distributed by qda as dened
in Lemma 34 By Jensens inequality
cid19
cid18Nt
cid90
cid18 Nt
cid18 Nt
t Bx
 Bx
dPdP
cid19
 Bx
cid19
 Bx
log P
log P
cid35
cid35
t Bx
t Bx log
cid34
t  Bxcid1cid90
Pcid0 Nt
cid34
Pcid0 Nt
t  Bxcid1  1
cid19
 Bx
 
H q 
0KEqHa1
KqQx
By the ergodic theorem
lim inf
t
cid18 Nt
where Qx
e is dened by
cid26
 q   Qe 
cid90
cid27
zdz  x
cid90
cid90
cid90cid90
log 
logdqdqq
   
and the relative entropy H is
H q  
By Lemma 33
0KEqHa1x
cid26
cid26
H q 
1KEq Ha
KqQe
cid26 1
cid18
 1  log
xEq Ha
KqQe
EqHa 
cid20
cid19
cid21cid27cid90
cid20
cid19
 1  log K  Eq
xEqHa  
cid18
xEqHa    x  x log
xEqHa  
 xEq

cid21cid27
cid20
cid21cid27
Next let us nd a more explict form for the Legendre-Fenchel transform of 
x    sup
x  f   1
where f   Eqef 1Ha Here
fcid48  Eqcid21  fcid48Haef 1Hacid3 
So the optimal  for 643 would satisfy fcid48  x
 and  and x  f  satisfy
the following equations
x  Eqcid2ex1Hacid3
  x  x
Eqcid2Haex1Hacid3
and supRx    x  x  1
On the other hand letting dq  ex1Ha
Eqex1Ha dq we have
Eqcid2ex1Hacid3
Eq ex1Ha
EqHa 
and Eqlog dq
cid19
cid18 Nt
dq   x  1EqHa  log Eqex1Ha which imply
cid20
cid26
cid20
xEqHa    x  x log
xEqHa  
cid19
cid19
 Bx
 xEq
cid26
cid18
cid18
lim inf
t
  inf
 
xEqHa    x  x log
xEqHa  
 xEq
cid21cid27
cid21cid27
 x  x  1  sup
x  
64 Risk Model with Marked Hawkes Claims Ar-
We consider the following risk model for the surplus process Rt of an insurance
portfolio
Rt  u  t  Ntcid88
where u  0 is the initial reserve   0 is the constant premium and the Cis
are iid positive random variables with the common distribution dC Ci
represents the claim size at the ith arrival time these being independent of Nt a
marked Hawkes process
For u  0 let
u  inft  0  Rt  0
and denote the innite and nite horizon ruin probabilities by
u  Pu   u uz  Pu  uz
u z  0
By the law of large numbers
t
Ntcid88
EC
1  EqHa
Therefore to exclude the trivial case we need to assume that
EC
1  EqHa
xc  1
where the critical values c and xc  f c satisfy
cid82
cid82
xc cid82
1 cid82
some   0 such thatcid82
R eCdC  
X ecCHaxc1qdadC
X HaeHaxc1cCqdadC
Let us rst assume that the claim sizes following light tails ie there exists
Following the proofs of large deviation results in Section 63 we have
C  lim
t
log Ecid104
ecid80Nt
cid105
x  1
if    c
otherwise
where x is the minimal solution to the equation
eCx1HaqdadC
cid90
cid90
Before we proceed let us quote a result from Glynn and Whitt 43 which will
be used in our proof Theorem 30
Theorem 29 Glynn and Whitt 43 Let Sn be random variables u  infn 
Sn  u and u  Pu   Assume that there exist    0 such that
i n  log EeSn is well dened and nite for         
ii lim supn EeSnSn1   for     
iii   limn 1
iv   0 and  is dierentiable at  with 0  cid48  
n n exists and is nite for         
Then limu 1
u log u  
Remark 15 We claim that C   has a unique positive solution   c
Let G  C   Notice that G0  0 G   and that G is convex
1EqHa    0 and Cc c  0 since we assume that
We also have Gcid480 
EC
 Therefore there exists only one solution   0 c of C  
  f c1
Theorem 30 Innite Horizon Assume all the assumptions in Theorem 26 and
in addition 652 we have limu 1
u log u   where   0 c is the
unique positive solution of C  
Proof Take St  cid80Nt
i1 Ci  t and t  log EeSt Then limt 1
C  Consider SnhnN We have limn 1
ing the conditions in Theorem 29 and applying it we get
t t 
n nh  hC h Check-
cid19
cid18
Snh  u
 
u
Finally notice that
St  sup
Snh  sup
St  h
Hence limu 1
u log u  
Theorem 31 Finite Horizon Under the same assumptions as in Theorem 30
we have
u
log u uz  wz
for any z  0
cid0 1
z  cid1
zC
if 0  z 
if z 
cid48
cid48
Cx  supRx  C and   0 c is the unique positive solution of
C   as before
Proof The proof is similar to that in Stabile and Torrisi 102 and we omit it
ie cid82
Next we are interested to study the case when the claim sizes have heavy tails
R eCdC   for any   0
A distribution function B is subexponential ie B  S if
PC1  C2  x
PC1  x
x
where C1 C2 are iid
random variables with distribution function B Let us
cid82 x
denote Bx  PC1  x and let us assume that EC1   and dene B0x 
0 Bydy where F x  1  F x is the complement of any distribution
function F x
Goldie and Resnick 44 showed that if B  S and satises some smoothness
conditions then B belongs to the maximum domain of attraction of either the
Frechet distribution or the Gumbel distribution In the former case B is regularly
varying ie Bx  Lxx1 for some   0 and we write it as B  R 1
  0
We assume that B0  S and either B  R1 or B  G ie the maximum
domain of attraction of Gumbel distribution G includes Weibull and lognormal
distributions
When the arrival process Nt satises a large deviation result the probability
that it deviates away from its mean is exponentially small which is dominated
by subexonential distributions By using the techniques for the asymptotics of
ruin probabilities for risk processes with non-stationary non-renewal arrivals and
subexponential claims from Zhu 118 we have the following innite-horizon and
nite-horizon ruin probability estimates when the claim sizes are subexponential
Theorem 32 Assume the net prot condition   EC1
1EqHa
i Innite-Horizon
u
EC1
1  EqHa  EC1
ii Finite-Horizon For any T  0
u

u uz
EC1
1EqHaEC1
EC1
1EqHaEC1
cid20
cid20
1 cid16
cid16 1EqHaEC1
cid21
1EqHa
cid17cid21
cid17 T
if B  R  1
if B  G
1  e
 1Eq HaEC1
1Eq Ha
65 Examples with Explicit Formulas
In this section we discuss two examples where an explicit formula exists
Example 1 is about the exponential asymptotics of the innite-horizon ruin
probability when Ha and the claim size C are exponentially distributed Example
2 gives an explicit expression for the rate function of the large deviation principle
when Ha is exponentially distributed
Example 1 Recall that x is the minimal solution of
eCx1HaqdadC
cid90
cid90
Now assume that Ha is exponentially distributed with parameter   0 then
we have
x  EeC
  x  1
which implies that
cid110
  1 cid112  12  4EeC
cid111
Now assume that C is exponentially distributed with parameter   0 Then
cid26
cid114
cid27
  1 
  12  4
  
The innite horizon probability satises limu 1
u log u   where  satis-
cid26
cid181
  1 
  
cid114
  12  4
cid27
cid19
  
which implies
and thus
cid115
 1    
2
  12  4
   
2 2 

1      
   

   
Since we are looking for positive  we get the quadratic equation
22  2  1    1    2  0
Since  
671  
EC
1EqHa  
1 we have 1    2  0 Therefore
2  1   cid1122  1  2  421    2
Example 2 Now let Ha be exponentially distributed with parameter   0 We
want an explicit expression for the rate function of the large deviation principle for
Ntt   Notice that
cid110
cid16 1
  1 cid112  12  4e
cid111  1
cid17

cid16 12
cid17
for   log
otherwise
672  
To get Ix  supRx   we optimize over  and consider x  cid48
Evidently
which gives us
  log
4e
2cid112  12  4e
cid322x2  xcid1124x2  2  12
cid33
cid19
cid182x2x
whence

4x2212
cid18
cid26
  1  2x
cid27
cid19
4x2212
if x  0
otherwise
Bibliography
1 Bacry E Dayri K and J F Muzy 2012 Non-parametric kernel estima-
tion for symmetric Hawkes processes Applications to high frequency nancial
data Eur Phys J B 85157
2 Bacry E Delattre S Homann M and J F Muzy Scaling lim-
its for Hawkes processes and application to nancial statistics Preprint
arXiv12020842
3 Bacry E Delattre S Homann M and J F Muzy Modeling microstruc-
ture noise with mutually exciting point processes To appear in Quantitative
Finance arXiv11013422
4 Bacry E and J F Muzy Hawkes model for price and trades high-frequency
dynamics Preprint arXiv13011135
5 Bartlett M S 1963 Statistical estimation of density functions Sankhya
A 25 245-254
6 Bartlett M S 1963 The spectral analysis of point processes J R Statist
Soc B 25 264-296
7 Bauwens L and N Hautsch Modelling nancial high frequency data using
point processes Handbook of Financial Time Series 953-979 2009
8 Billingsley P Convergence of Probability Measures 2nd edition Wiley-
Interscience New York 1999
9 Bingham N H Goldie C M and J L Teugels Regular Variation Cam-
bridge University Press 1989
10 Blundell C Heller K A and J M Beck Modelling reciprocating relation-
ships with Hawkes processes Preprint 2012
11 Bordenave C and G L Torrisi 2007 Large deviations of Poisson cluster
processes Stochastic Models 23 593-625
12 Bormetti G Calcagnile L M Treccani M Corsi F Marmi S and
F Lillo Modelling systemic cojumps with Hawkes factor models Preprint
arXiv13016141
13 Bowsher C G 2007 Modelling security market events in continuous time
intensity based multivariate point process models Journal of Econometrics
141 876-912
14 Bremaud P and L Massoulie 1996 Stability of nonlinear Hawkes pro-
cesses Ann Probab 24 1563-1588
15 Bremaud P Nappo G and G L Torrisi 2002 Rate of convergence to
equilibrium of marked Hawkes processes J Appl Prob 39 123-136
16 Bremaud P and L Massoulie 2001 Hawkes branching point processes
without ancestors J Appl Prob 38 122-135
17 Bremaud P and S Foss 2010 Ergodicity of a stress release point process
seismic model with aftershocks Markov Processes Relat Fields 16 389-408
18 Bremaud P and L Massoulie 2002 Power spectra of general shot noises
and Hawkes point processes with a random excitation Advances in Applied
Probability 34 205-222
19 Bremaud P L Massoulie and A Ridol 2005 Power spectra of random
spike elds and related processes Advances in Applied Probability 37 1116-
20 Brix A and W S Kendall 2002 Simulation of cluster point processes
without edge eects Advances in Applied Probability 34 267-280
21 Carstensen L Sandelin A Winther O and N R Hansen 2010 Mul-
tivariate Hawkes process models of the occurrence of regulatory elements
BMC Bioinformatics 11456
22 Cartea A Jaimungal S and J Ricci Buy low sell high a high frequency
trading perspective SSRN eLibrary 2011
23 Chavez-Demoulin V Davison A C and A J McNeil 2005 Estimating
value-at-risk a point process approach Quantitative Finance 5 227-234
24 Chavez-Demoulin V and J A McGill 2012 High-frequency nancial data
modeling using Hawkes processes Journal of Banking  Finance 36 3415-
25 Chornoboy E S Schramm L P and A F Karr 1988 Maximum likeli-
hood identication of neural point process systems Biol Cybern 59 265-
26 Crane R and D Sornette 2008 Robust dynamic classes revealed by mea-
suring the response function of a social system Proc Nat Acad Sci USA
105 15649
27 Daley D J and D Vere-Jones An Introduction to the Theory of Point
Processes Volume I and II 2nd edition Springer-Verlag New York 2003
28 Dassios A and H Zhao 2011 A dynamic contagion process Advances in
Applied Probability 43 814-846
29 Dassios A and H Zhao 2012 Ruin by dynamic contagion claims Insur-
ance Mathematics and Economics 51 93-106
30 Dembo A and O Zeitouni Large Deviations Techniques and Applications
2nd edition Springer New York 1998
31 Donsker M D and S R S Varadhan 1983 Asymptotic evaluation of
certain Markov process expectations for large time IV Communications of
Pure and Applied Mathematics 36 183-212
32 Echeverra P 1982 A criterion for invariant measures of Markov processes
Probability Theory and Related Fields 61 1-16
33 Egami M Kato Y and T Sawaki An analysis of CDS market liquidity by
the Hawkes process SSRN eLibrary 2013
34 Egesdal M Fathauer C Louie K and J Neuman Statistical and stochas-
tic modelling of gang rivalries in Los Angeles SIAM Undergraduate Research
Online 2010
35 Embrechts P Liniger T and L Lin 2011 Multivariate Hawkes processes
an application to nancial data J Appl Prob Spec Vol 48A 367-378
36 Errais E Giesecke K and L Goldberg 2010 Ane point processes and
portfolio credit risk SIAM J Financial Math 1 642-665
37 Fan K 1953 Minimax theorems Proc Natl Acad Sci USA 39 42-47
38 Feller W An Introduction to Probability Theory and Its Applications Vol-
ume I and Volume II 2nd edition New York 1971
39 Filimonov V and D Sornette 2012 Quantifying reexivity in nancial
markets Toward a prediction of ash crashes Physical Review E 85 056108
40 Frenk J B G and G Kassay The Level Set Method of Joo and Its Use
in Minimax Theory Technical Report EI 2003-03 Econometric Institute
Erasmus University Rotterdam 2003
41 Giesecke K and L Goldberg L and X Ding 2011 A top-down approach
to multi-name credit Operations Research 59 283-300
42 Giesecke K and P Tomecek Dependent events and changes of time Work-
ing paper Cornell University July 2005
43 Glynn P W and W Whitt 1994 Logarithmic asymptotics for steady-
state tail probabilities in a single-server queue J Appl Probab 31 131-156
44 Goldie C M and S Resnick 1988 Distributions that are both subex-
ponential and in the domain of attraction of an extreme value distribution
Adv Appl Probab 20 706-718
45 Grandell J 1977 Point processes and random measures Advances in Ap-
plied Probability 9 502-526
46 Gusto G and S Schbath 2005 FADO a statistical method to detect
favored or avoided distances between occurrences of motifs using the Hawkes
model Stat Appl Genet Mol Biol 4 Article 24
47 Hairer M Convergence of Markov Processes Lecture Notes University of
Warwick available at httpwwwhairerorgnotesConvergencepdf
48 Halpin P F and P De Boeck Modelling dyadic interaction with Hawkes
process Preprint 2012 To appear in Psychometrika
49 Hansen N R Reynaud-Bouret P and V Rivoirard Lasso and probabilistic
inequalities for multivariate point processes Preprint arXiv12080570
50 Hardiman S J Bercot N and J-P Bouchaud Critical reexivity in nan-
cial markets a Hawkes process analysis Preprint arXiv13021405
51 Hawkes A G 1971 Spectra of some self-exciting and mutually exciting
point processes Biometrika 58 83-90
52 Hawkes A G 1971 Point spectra of some mutually exciting point pro-
cesses J Roy Statist Soc Ser B 33 438-443
53 Hawkes A G and L Adamopoulos 1973 Cluster models for earthquakes-
regional comparisons Bull Int Statist Inst 45 454-461
54 Hawkes A G and D Oakes 1974 A cluster process representation of a
self-exciting process J Appl Prob 11 93-503
55 Hegemann R A Lewis E A and A L Bertozzi 2013 An Estimate 
Score Algorithm for simultaneous parameter estimation and reconstruction
of incomplete data on social networks Security Informatics 21
56 Hewlett P Clustering of order arrivals price impact and trade path op-
timisation Workshop on Financial Modeling with Jump processes Ecole
Polytechnique 2006
57 Heyde C C and Scott D J 1973 Invariance principle for the law of the
iterated logarithm for martingales and processes with stationary increments
Ann Probab 1 428-436
58 Jagers P Branching Processes with Biological Applications John Wiley Lon-
don 1975
59 Johnson D H 1996 Point process models of single-neuron discharges J
Computational Neuroscience 3 275-299
60 Joo I 1984 Note on my paper A simple proof for von Neumanns minmax
theorem Acta Math Hung 44 363-365
61 Kallenberg O Foundations of Modern Probability Springer 2nd edition
62 Karabash D and L Zhu Limit theorems for marked Hawkes processes with
application to a risk model Preprint arXiv12114039
63 Karabash D On stability of Hawkes process Preprint arXiv12011573
64 Koralov L B and Ya G Sinai Theory of Probability and Random Processes
Springer 2nd edition 2012
65 Krumin M Reutsky I and S Shoham 2010 Correlation-based analysis
and generation of multiple spike trains using Hawkes models with an exoge-
nous input Frontiers in Computational Neuroscience 4 article 147
66 Kwiecinski A and R Szekli 1996 Some monotonicity and dependence
properties of self-exciting point processes Annals of Applied Probability 6
1211-1231
67 Large J 2007 Measuring the resiliency of an electronic limit order book
Journal of Financial Markets 10 1-25
68 Lewis E and G Mohler A nonparametric EM algorithm for multiscale
Hawkes processes Preprint 2011
69 Lewis E Mohler Brantingham P J and A Bertozzi 2011 Self-exciting
point process of insergency in Iraq Security Journal 25 0955-1662
70 Lewis P A W and G S Shedler 1979 Simulation of nonhomogeneous
Poisson processes by thinning Naval Research Logistics Quarterly 26 403-
71 Liniger T Multivariate Hawkes Processes PhD thesis ETH 2009
72 Lipster R S and A N Shiryaev Statistics of Random Processes II Appli-
cations 2nd edition Springer 2001
73 Marsan D and O Lengline 2008 Extending earthquakes reach through
cascading Science 319 5866 1076
74 Massoulie L 1998 Stability results for a general class of interacting point
processes dynamics and applications Stochastic Processes and their Appli-
cations 75 1-30
75 Mehrdad B Sen S and L Zhu The speed of a biased walk on a Galton-
Watson tree is monotonic with respect to progeny distributions for high
values of bias Preprint arXiv12123004
76 Meyer S Elias J and M Hohle 2012 A space-time conditional intensity
model for invasive meningococcal disease occurence Biometrics 68 607-616
77 Mitchell L and M E Cates 2010 Hawkes process as a model of social
interactions a view on video dynamics Journal of Physics A Mathematical
and Theoretical 43 045101
78 Mohler G O Short M B Brantingham P J Schoenberg F P and G E
Tita 2011 Self-exciting point process modelling of crime Journal of the
American Statistical Association 106 100-108
79 Mller J and J G Rasmussen 2005 Perfect simulation of Hawkes pro-
cesses Advances in Applied Probability 37 629-646
80 Mller J and J G Rasmussen 2006 Approximate simulation of Hawkes
processes Methodology and Computing in Applied Probability 8 53-64
81 Mller J and G L Torrisi 2005 Second order analysis for spatial Hawkes
processes Technical Report R-2005-20 Department of Mathematical Sci-
ences Aalborg University
82 Mller J and G L Torrisi 2007 The pair correlation function of spatial
Hawkes processes Statistics  Probability Letters 77 995-1003
83 Muni Toke I and F Pomponio Modelling trades-through in a limited order
book using Hawkes processes SSRN eLibrary 2011
84 Musmeci F and D Vere-Jones 1992 A space-time clustering model for
historical earthquakes Annals of the Institute of Statistical Mathematics 44
85 Oakes D 1975 The Markovian self-exciting process J Appl Prob 12
86 Ogata Y 1978 The asymptotic behavior of maximum likelihood estimates
for stationary point processes Ann Inst Statist Math 30 243-261
87 Ogata Y 1988 Statistical models for earthquake occurrences and residual
analysis for point processes J Amer Statist Assoc 83 9-27
88 Ogata Y 1998 Space-time point-process models for earthquake occur-
rences Ann Inst Statist Math 50 379-402
89 Ogata Y 1981 On Lewis simulation method for point processes IEEE
Transactions on Information Theory 27 23-31
90 Ogata Y Akaike H and K Katsura 1982 The application of linear in-
tensity models to the investigation of causal relations between a point process
and another stochastic process Annals of the Institute of Statistical Mathe-
matics 34 373-387
91 Ozaki T 1979 Maximum likelihood estimation of Hawkes self-exciting
point processes Ann Inst Statist Math 31 145-155
92 Peng X and S Kou Default Clustering and Valuation of Collateralized Debt
Obligations Working Paper Columbia University January 2009
93 Pernice V Staude B Carndanobile S and S Rotter 2012 How structure
determines correlations in neuronal networks PLoS Computational Biology
85031916
94 Pernice V Staude B Carndanobile S and S Rotter 2011 Recurrent
interactions in spiking networks with arbitrary topology Physical Review E
7e1002059
95 Porter M and G White 2012 Self-exciting hurdle models for terrorist
activity Annals of Applied Statistics 6 106-124
96 Reynaud-Bouret P and S Schbath 2010 Adaptive estimation for Hawkes
processes application to genome analysis Ann Statist 38 2781-2822
97 Reynaud-Bouret P and E Roy 2007 Some non asymptotic tail estimates
for Hawkes processes Bull Belg Math Soc Simon Stevin 13 883-896
98 Reynaud-Bouret P Tuleau-Malot C Rivoirard V and F Grammont
Spike trains as inhomogeneous Poisson processes or Hawkes processes non-
parametric adaptive estimation and goodness-of-t tests Preprint
99 Rubin I 1972 Regular point processes and their detection IEEE Trans-
actions on Information Theory 18 547-557
100 Sen S and L Zhu Large deviations for self-correcting point processes In
Preparation
101 Sornette D and S Utkin 2009 Limits of declustering methods for disen-
tangling exogenous from endogenous events in time series with foreshocks
main shocks and aftershocks Physical Review E 79 6 61110
102 Stabile G and G L Torrisi 2010 Risk processes with non-stationary
Hawkes arrivals Methodol Comput Appl Prob 12 415-429
103 Torrisi G L 2002 A class of interacting marked point processes Rate of
convergence to equilibrium Journal of Applied Probability 39 137-160
104 Wang T Bebbington M and D Harte 2012 Markov-modulated Hawkes
process with stepwise decay Annals of the Institute of Statistical Mathemat-
ics 64 521-544
105 Wei C Z and J Winnicki 1989 Some asymptotic results for the branching
process with immigration Stoch Proc Appl 31 261-282
106 Varadhan S R S 2008 Large deviations Annals of Probability 36 397-
107 Varadhan S R S Large Deviations and Applications SIAM Philadelphia
108 Varadhan S R S Probability Theory Courant Lecture Notes American
Mathematical Society 2007
109 Varadhan S R S Stochastic Processes Courant Lecture Notes American
Mathematical Society 2007
110 Vere-Jones D 1978 Earthquake prediction A statisticians view Journal
of Physics of the Earth 26 129-146
111 Zheng B Roue F and F Abergel Ergodicity and scaling limit of a con-
strained multivariate Hawkes process SSRN eLibrary 2013
112 Zhu L Large deviations for Markovian nonlinear Hawkes processes
Preprint arXiv11082432
113 Zhu L Process-level large deviations for nonlinear Hawkes point processes
To appear in Annales de lInstitut Henri Poincare arXiv11082431
114 Zhu L Central limit theorem for nonlinear Hawkes processes To appear in
Journal of Applied Probability arXiv12041067
115 Zhu L 2013 Moderate deviations for Hawkes processes Statistics  Prob-
ability Letters 83 885-890
116 Zhu L Limit theorems for a Cox-Ingersoll-Ross process with Hawkes jumps
Preprint
117 Zhu L Asymptotics for nonlinear Hawkes processes In Preparation
118 Zhu L Ruin probabilities for risk processes with non-stationary arrivals and
subexponential claims Preprint arXiv13041940
