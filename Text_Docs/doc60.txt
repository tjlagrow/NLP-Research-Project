Limit Theorems for Empirical Renyi Entropy and Divergence with
Applications to Molecular Diversity Analysis
Maciej Pietrzak pietrzak20osuedu1 Grzegorz A Rempala rempala3osuedu12 Micha
Seweryn msewerymathunilodzpl3 and Jacek Wesoowski wesolominipwedupl4
1Division of Biostatistics College of Public Health The Ohio State University Columbus OH USA
2Mathematical Biosciences Institute The Ohio State University Columbus OH USA
3Department of Mathematics and Computer Science University of odz Poland
4Wydzia Matematyki i Nauk Informacyjnych Politechnika Warszawska Warsaw Poland
December 22 2015
Abstract
Quantitative methods for studying biodiversity have been traditionally rooted in the classical theory of nite
frequency tables analysis However with the help of modern experimental tools like high throughput sequencing
we now begin to unlock the outstanding diversity of genomic data in plants and animals reective of the long
evolutionary history of our planet This molecular data often dees the classical frequencycontingency tables
assumptions and seems to require sparse tables with very large number of categories and highly unbalanced cell
counts eg following heavy tailed distributions for instance power laws Motivated by the molecular diversity
studies we propose here a frequency-based framework for biodiversity analysis in the asymptotic regime where
the number of categories grows with sample size an innite contingency table Our approach is rooted in
information theory and based on the Gaussian limit results for the effective number of species the Hill numbers
and the empirical Renyi entropy and divergence We argue that when applied to molecular biodiversity analysis
our methods can properly account for the complicated data frequency patterns on one hand and the practical
sample size limitations on the other We illustrate this principle with two specic RNA sequencing examples a
comparative study of T-cell receptor populations and a validation of some preselected molecular hepatocellular
carcinoma HCC markers
keywords Hill number Central limit theorem Next generation sequencing Triangular arrays T-cell receptors
AMS classication 60F05 60G42 94A17
Introduction
Developing effective methods for quantifying and comparing empirical diversity of various biological populations
is one of the fundamental problems of modern life sciences as it has direct impact on our understanding of the basic
operating principles of our planets ecosystem and its evolution cf eg Berkov et al 2014 In the course of its 35
billion years of evolutionary history nature has developed an outstanding bio- and molecular diversity among the
Earths species of plants and animals Indeed it is estimated that there are currently about 87 million eukaryotic
species on earth both marine and terrestrial 88 of which are still waiting to be described Mora et al 2011
The diversity at the molecular level is perhaps even more spectacular as it occurs at different levels of biological
Research partially supported by US NIH grants R01CA-152158 and U01-GM092655 GAR MS MP as well as US NSF grant DMS-
1106485 GAR
organization within one individual eg through RNA DNA proteins and metabolites between individuals of
the same and related species within and between species and ecosystems as well as throughout evolution see
eg Campbell 2003 For instance the number of different molecular types of human T-cells is estimated at 1018
Janeway 2005 which only slightly less that the currently estimated number of stellar objects in the known universe
the latter believed to be of the order 1021
Whereas the power of modern computing has allowed us to make steady progress towards building ever more
robust empirical measures of biodiversity based on a variety of considerations see eg Presley et al 2014 the most
relevant to our discussion here are the measures borrowed from the eld of information theory They include among
others the Hill number or the effective number of species and the related concept of the Renyi entropy see eg
the recent review Chiu et al 2014 and references therein Although originally proposed for quantifying ecological
diversity in the macro-scale ecosystems Chao et al 2010 the use of the empirical Renyi entropy as a descriptor
of diversity was also adopted for molecular populations in de Andrade and Wang 2011 Since then the Renyi-type
measures were applied to problems of molecular populations ranging from analyzing regulatory variants and testing
genome-wide associations Sun and Hu 2013 Sadee et al 2014 to comparing different T-cell populations Cebula
et al 2013 Rempala and Seweryn 2013 Despite their growing usage in biodiversity studies of both macro- and
molecular- level populations it appears that some important statistical properties of the Renyi-type measures have
not been yet sufciently understood especially in the context of frequency-based analysis and large sample behavior
Currently standard methods of obtaining molecular level data on the transcriptome RNA abundance rely on
the so-called next-generation sequencing NGS technology and especially the high-throughput RNA sequencing or
RNA-seq Wang et al 2009 However the molecular count data from NGS often elude standard statistical analysis
due to the fact that exhaustive sampling of the DNA and RNA fragments for the purpose of sequence reconstruction
is not feasible and that the sequencing errors increase with sampling intensity or sequencing depth ORawe et al
2015 It has been therefore generally conceded Oh et al 2014 that the standard xed-dimension non-parametric
frequencycontingency table analysis see eg Agresti 2002 does not readily apply to the NGS data and that a
different innite-size contingency table framework more reective of the current sequencing technology appears
necessary Due to the nature of the NGS methods such framework should be based on the large sample high-
throughput considerations but at the same time should also account for the increase in the number of sequencing
errors with increasing sample size as well as for the under-sampling bias
Motivated by the questions on comparing biodiversity in molecular data especially arriving from the NGS exper-
iments in the current paper we establish some large sample results for the empirical Renyi entropy and divergence
in order to bridge the gap between current heuristic approaches and a more formal statistical theory of large samples
To this end we derive herein several central limit theorems CLTs which yield approximate condence bounds for
the Renyi entropy-based measures of diversity and similarity in the setting of an innite contingency table Our
CLT results complement both the law of large number theorems in Rempala and Seweryn 2013 as well as the
CLT for the plugin estimates of the Shannon entropy Zhang and Zhang 2012 and the Kullback-Leibler divergence
estimates Paninski 2003 Zhang and Grabchak 2014 Since in the NGS experiments one typically expects to
under-sample the transcriptome we focus here on the Renyi entropy exponent which below is denoted by  less
than one so as to up-weight the contributions of the lower counts and our CLT results are restricted to this case
The extensions to arbitrary exponents are straightforward but not considered here In order to provide examples
of the types of applications motivating the mathematical results we analyze two real biological datasets from two
different types of NGS experiments In the rst experiment described in the study Cebula et al 2013 one compares
multiple T-cell receptors populations taken from mice before and after treatment with antibiotics The goal of the
second experiment is the elucidation of differences in gene expression proles between cancer and control tissues
in individuals with hepatocellular carcinoma as described in Chan et al 2014 In both presented examples the
NGS datasets are analyzed and de-noised by applying a multi-stage process developed on the basis of our theoretical
results
As already indicated above the problem of empirically estimating entropy and divergence has been extensively
studied in the statistical and machine learning literature over past several decades both in the context of discrete
and continuous distributions See for instance the monograph by Pardo 2005 or the review in Krishnamurthy
et al 2014 for more details In the general case of Renyis entropy and closely related Tsallis entropy of a xed
continuos distribution f in Rm a class of consistent estimators was proposed in Leonenko et al 2008 based on
the k-th nearest-neighbor distances computed from the appropriate random samples of size n from f  The idea
was later also extended to the Renyi entropy functionals in Kallberg et al 2012 and it appears that similar results
could be expected to hold in the discrete case as well The main difference between these types of results and
what is considered here is that in our setting the discrete density function f is allowed to change as the sample size n
increases Additionally although in the current and that we only analyze the basic empirical frequency the so-called
plug-in estimates
The paper is organized as follows In the next section Section 2 we outline the relevant mathematical concepts
along with the necessary notation In Section 3 we state the main theoretical results of the paper namely the CLTs
for the Hill number or the Tsallis entropy and the Renyi entropy and divergence in the asymptotic regime when
the diversity of the population ie the number of different types grows with the sample size The results for the
simpler case Theorems 1 and 2 when Renyi entropy statistics admit linear approximations are established via the
intermediate CLT results for the corresponding power sums which are closely related to the CLTs for Hills numbers
and Tsallis entropies These results are also included as parts of formulations of Theorems 1 and 2 In case of
the uniform distribution for the Renyi entropy as well as the equal-marginals bivariate distribution for the Renyi
divergence the power sum CLTs are no longer valid there is no linear approximation available and other methods
are required to establish weak convergence to Gaussian variates under slightly more stringent conditions These
results are presented as Theorems 3 and 4 in Section 3 As it turns out the key ingredient needed to establish
Theorems 3 and 4 is the CLT result for two Pearson-type chi-square statistics in an innite contingency table This
latter result is of interest in itself and is presented as Lemma 2 in Section 3 In the following Section 4 we provide
some simulation-based examples of the asymptotic behavior of estimates from Section 3 in the case relevant for our
applications of power law distributions under various sampling scenarios These examples illustrate in particular
how the CLTs of Section 3 may hold or not depending on the relations between the dimensions of the relevant
contingency tables and the empirical sample sizes In the second part of Section 4 we also discuss in detail the two
biological examples of NGS data analysis and show how the results of Section 3 may be used to analyze biodiversity
of T-cell receptors and to prole the multiple sets of transcriptomes The nal Section 5 offers a summary and brief
conclusions The proofs of all more complicated results are provided in the appendix along with some auxiliary
technical lemmas
2 Power Sums Entropy and Divergence
Consider a triangular array of bivariate row-wise independent random variables Znk for k  1    n which in each
row are equidistributed with the random variable Zn  XnYn such that PXn  iYn  j  pn
for i j  1    mn
Below we suppress the index n when possible writing eg mZkZ pi j etc for simplicity
Let   0 and for any probability distribution ppp  pim
i1 dene
S ppp 
Similarly for any pair of distributions ppp  pim
i1 and qqq  qim
i1 dene
i q1
S pppqqq 
Note that S1  1 The well-known special case of the above is   12 which results in a symmetric index
S12pppqqq  S12qqq ppp often referred to as the Bhattacharyya coefcient see eg Nielsen and Boltz 2011
Recall Renyi 1961 that for a given distribution ppp its Renyi entropy H is dened as
logcid0 p
cid1 
H ppp 
1 
1 
log S ppp
and that for a pair of distributions pppqqq their Renyi divergence D is dened as
D pppqqq 
  1
log S pppqqq
Note that the sign change in the normalizing constant is needed in order to ensure non-negativity of H and D
The special case of D with   12 is referred to as the Bhattacharyya distance and may be expressed in terms of
the Mahalanobis distance see eg Nielsen and Boltz 2011 whereas the linear approximation of H ppp given by
T ppp 
1  S ppp 1
is sometimes referred to as the Tsallis entropy and has important applications in the eld of statistical mechanics
Tsallis 1988 Note that for our current purposes we will only consider the quantities D  H and T for 
satisfying 0    1
In what follows the summation symbol without subscripts  will indicate summation with respect to the index
i1 will typically denote the marginal distributions of the bivariate
i j1 Additionally the uniform distribution on m points
i i  1    m whereas ppp  pim
variable Z  XY  whose distribution is denoted by pi jm
will be denoted by uuu An important relation between the Renyi entropy and the Renyi divergence is
i1 and qqq  qim
H ppp  logm D pppuuu
We note also the following monotonicity property of D and H with respect to the index 
Lemma 1 For 0      1 we have D pppqqq  D pppqqq and thus in view of 24 also H ppp  H ppp
Proof Note that for x  0 the function x  x
inequality
1 is strictly convex for 0      1 Therefore by Jensens
D pppqqq 
  1
  1
log p
  1
i q1
cid18 qi
cid191 
log pi
log pi
 D pppqqq
cid191  1
cid18 qi
Example 21 Hills Number For given 0    1 the measure of diversity of a distribution ppp also known as the
effective number of classes may be dened as see eg Jost 2007 Chao et al 2012 Rempala and Seweryn 2013
ENC ppp  expH ppp  S ppp11 It follows then from Lemma 1 that for any 0      1 we have
ENC ppp  ENC ppp As it turns out this inequality may be in fact extended to arbitrary positive    
21 Low Diversity Condition and Projection Variables
The notion of an innite-dimension contingency table brought up in the introduction may be now formally introduced
i j1 we have m  as n  Throughout the paper let a
simply as a requirement that for n-size sample from pi jm
b denote minab for any real ab and let an  bn resp an  Obn denote anbn  1 resp A  limsupn anbn  B
for some nite AB as n   for any real sequences anbn Throughout the paper we consider only the low diversity
LD schemes in which the marginals pppqqq of Z satisfy the following LD condition
np1  on 
for some
where p  minipi miniqi Note that since p  1m then 25 implies in particular mn  on  As it turns
out for many distributions ppp the two conditions are in fact equivalent as seen in the following
Example 22 Power Law Model Let ppp  qqq and assume that pi  H1 mi li i  1    m where
  0 lx is a non-decreasing slowly varying function see eg Soulier 2009 chapter 1 and H1 m 
i1i li1 is the normalizing constant Note that if 0    1 then H1 m  1 lmm1 and 25
is implied by mn  on  since
  0
pi1  1  1 m lm
nm1lm
 1  1 m
For any 0    1 and a given pair mn let us dene two random variables which will play an important role
in the following section Let W 
be dened as
for i  1    m Similarly dene also V 
cid32
PW 
n   p1
cid191
cid18 qi
 1 
cid19cid33
cid18 p j
for i j  1    m In the following for the reasons discussed below we refer to 26 and 27 as the projection
variables or simply projections
Remark 21 Note that
EW 
n  S ppp
and VarW 
is often referred to as a maximal diversity model or a pure noise model Similarly
n  0 iff pi  1m for all i that is ppp  pi  uuu is a uniform distribution on m support points this case
and it is also easy to see that VarV 
n  0 iff pi  qi for all i that is ppp  qqq
EV 
n  S pppqqq
As it turns out both cases ppp  uuu and ppp  qqq require special consideration in the asymptotic analysis of H and
D In view of the remark above they may be referred to as the cases of degenerate zero variance projections
Example 23 NoiseandSignal and Pure Noise Models A distribution concentrated on m 1 support points such
that p0  0 and pi  1 p0m for 1  i  m may be considered as a simple model of signal contamination Note
that in this case we have PW 
n  m1 1 p01  1 p0 and
  p0 PW 
n   p1
VarW 
n  2
m1 1 p0
cid32
cid18 p0
1 p0
cid1912  p
cid181 p0
cid1912cid332
For the pure noise model p0  0 in which case the support reduces to m points and the above formula is not valid
However as already pointed out before in this case we may show directly that VarW 
3 Limit Theorems
Let N01 denote the standard Gaussian random variable and  denote the usual weak convergence in the space of
probability distributions Dene also the plug-in n-sample estimates of ppp and qqq as respectively ppp   pim
i1 where
k1 IYk  in Here and elsewhere in the paper I denotes
pi  n
the indicator function As it turns out two distinct sets of CLTs may be derived depending on whether the variables
are degenerate that is their respective variances vanish or not For the non-degenerate case the
appropriate CLTs may be established by expanding on the usual projection and Taylors expansion arguments see
eg Shao 2003 chapter 1 This is the simpler case to consider and we discuss it rst
k1 IXk  in and qqq   qim
i1 where qi  n
and V 
31 CLTs for Non-Degenerate Projections
The rst two CLT results for the empirical plug-in Renyi entropy and divergence and their corresponding power
sums are provided in Theorems 1 and 2 below Their respective hypotheses iii may be viewed as complementing
the analogous results established for the Shannon entropy and the Kullback-Leibler divergence Paninski 2003
Zhang and Zhang 2012 Zhang and Grabchak 2014 Note also that S  ENC 1 where the Hill number
ENC is dened in Example 1 The proofs are deferred to the appendix
Recall that for any square integrable random variable X such that EX cid54 0 we dene its coefcient of variation
as C V X  VarX12EX1
Theorem 1 Renyi Entropy CLT Let W 
0 and let
 p1
be a sequence of random variables dened by 26 with infn C V W 
for mn  
12  0
nVarW 
Then under the LD condition 25 as mn  
i S  pppS ppp  1 in probability
nS  ppp S pppVarW 
n 1  1H  ppp H pppC V W 
12  N01
  N01
Remark 31 Note that the rst two assertions of the theorem may be equivalently stated in terms of the convergence
of the Tsallis plug-in entropy dened by 23
Remark 32 Note that the condition 31 is typically stronger than 25 Indeed taking   12 and the power
 1 
law model from Example 2 with 0    1 we obtain  p
 21 m22 1 2    Consequently for some constant C  1
i  1    m1 1    and  p21
for large mn and 31 implies 25 with   12 Similarly possibly for different C  1
and therefore in this case 31 is seen to be actually equivalent to 25 with   12
cid113
cid113
C  p1
n p21
  p
 m
maxi pi1
m1
 m
 p1
n p21
  p
 Cm
mini pi1
m1
Remark 33 Plug-in Bias Note that in view of Jensens inequality applied to the strictly concave function x  x
for x  0 and 0    1 we have ES  pppS ppp  1 This and the assertion i above imply together that under
the assumptions of Theorem 1 the relative bias of S  ppp satises ES  pppS ppp 1  0 as nm   The
standard inequality logx  x 1 valid for x  0 implies then that the bias of the plug-in entropy estimate satises
EH  ppp H ppp  0
as nm  
Unfortunately as may be seen from the proof of Theorem 1 in the appendix a more careful analysis of the tail
events for the plug-in estimate than the one currently performed is needed in order to actually establish a convergence
rate in 32
Turning now to our second result note that the relation 24 suggests that CLT of Theorem 1 could be also
extended to the Renyi divergence The proof is again based on the Taylor expansion method where now the projection
variable 26 is replaced by 27
Theorem 2 Renyi Divergence CLT Let V 
0 and let
be a sequence of random variables dened by 27 with infn C V V 
 qipi1  piqicid17
cid16
nVarV 
12  0 for mn  
Then under the LD condition 25 as mn  
i S  ppp qqqS pppqqq  1 in probability
nS  ppp qqq S pppqqqVarV 
n   1D  ppp qqq D pppqqqC V V 
12  N01
  N01
Remark 34 Plug-in Bias Note that similarly as in Remark 33 we have ES  ppp qqqS pppqqq  1 and by a
similar argument as before Theorem 2i implies
ED  ppp qqq D pppqqq  0
as nm  
Example 31 Symmetric Divergence for Power Laws Consider the symmetric divergence D12pppqqq with inde-
pendent marginals which often is the case of interest in NGS applications Note that in this situation VarV 12
12  
piqi22 Suppose additionally that pi  H11mi1l1i and qi  H12mi2l2i i 
1    m where the notation is as in Example 2 with 0  1 cid54 2  1 Then
cid1121 11 2
n  0 cf also Remark 32 above
and consequently 33 is seen as equivalent to m
2 1  2
VarV 12
With some additional effort the two CLT results of this section may be extended to degenerate projections This
is discussed in the next section
32 CLTs for Degenerate Projections
In case of a degenerate projection the linear term of the power sum Taylors expansion disappears cf formula
B6 in the appendix and the condition 31 is no longer needed However the LD assumption 25 has to be
slightly strengthened in order to establish the asymptotic results for the leading quadratic term of the appropriate
expansion
321 Chi-Square Statistic CLT
The following lemma describing the chi-square statistic CLT may be of independent interest for models of sparse
contingency tables For a recent discussion of a normal approximation to the chi-square statistic in such settings
see eg Horgan and Murphy 2013 Here we apply the chi-square CLT formulated below to obtain weak limits for
the quadratic terms in the entropy and divergence Taylors expansions leading to Theorems 3 and 4 described in the
next subsection To begin consider a pair of distributions pppqqq and a set of positive weights rrr  rim
i1 and dene
the corresponding chi-square 2 distance function as
rrr pppqqq  n pi  qi2
Note that for instance the 2-distance statistic between the empirical marginals  ppp qqq is obtained by setting ri 
pi  qi
rrr  ppp qqq  n  pi  qi2
pi  qi
and the Pearson 2-statistic is obtained by setting ri  pi
ppp  ppp ppp  n  pi  pi2
Below we denote X 2
Lemma 2 Let pi jm
i1 where pi  qi  0 Assume m   as n   and
uuu uuuuuu  X 2
i j1 be the bivariate distribution of Z  XY  with X and Y having marginals pim
i1 and
mn1maxp1
i m1  0
 p2
 B  
Then as n  
ppp  ppp ppp m
and if additionally
 N01
then also
2ppp ppp qqq n
 N01
n  
n  
1 piipi
pi  pii2
1icid54 jm
pi j  p ji2
4pi p j
Remark 35 Note that for X 2
Remark 36 Note that under the assumption 36 we have m2B 2
if pi j  pi p j then n  2
uuu the condition 35 simplies to mn  0
n  m 1
n  mB2 and therefore 2
n  m In particular
The proof of the result may be found in the appendix Its application is discussed next
322 Pure Noise and Equal Marginals CLTs
real a and integer k we denecid0a
cid1  aa 1 a k  1k
The rst result covers the case of Renyi entropy when ppp  uuu The proof is outlined in the appendix Recall that for
Theorem 3 Uniform Entropy CLT Assume m   as n   and m2n  on  for   0 Then
m1S uuu1m
 N01
i n
ii nH uuulogm11log1
Our second CLT result is the following theorem for Renyi divergence when ppp  qqq The proof is again deferred
 N01
to the appendix
Theorem 4 Degenerate Divergence CLT Let pi jm
i1 and qqq  qim
having marginals ppp  pim
as n   and that 36 holds as well as that
cid26
cid27
i j1 be the bivariate distribution of Z  XY  with X and Y
n be given by 37 Assume m  
i1 where pi  qi  0 Let n and 2
nmmin p2
nmin pi
 on 
 N01
i n11S  pppqqq1n
ii nD  pppqqq11 log11 n
Remark 37 Note that for ppp  qqq  uuu the condition 38 reduces to m2n  on  required in Theorem 3
 N01
323 Random Sample Size
When analyzing NGS data some part of the sequences reads is frequently removed for technical reasons for instance
due to poor amplication or reading errors see next section In such cases one effectively deals with a molecular
sample of random size Our CLT results derived earlier may be extended to this case as well with the help of
following simple result described in Theorem 5 below Its various versions have been discussed for instance in the
context of random allocations see eg Kolchin et al 1978
n1 be a sequence of bivariate variables supported on an mn  mn
Theorem 5 Randomized Sample CLT Let Zn
integer lattice with distribution pi jmn
i j1 n  123      be the sequence of the empirical
estimates each based on an iid sample of deterministic size n Suppose that the statistic Gn  Gn pi j satises
bnGn  an  N01 as n   with some non-random anbn Let n
n1 be a sequence of random variables
n1 and following the binomial distributions binnn with 0  infn n  supn n  1 Then also
independent of  Zn
i j1 Let  Zn   pi jmn
bnGn  an  N01
Proof Denote by Gnk the random variable Gk conditional on the event k  nk and by  the distribution function
of the standard normal random variable By assumption for any real x we have PGnk  x  x provided that
nk   as k   Let   0 be sufciently small and dene C k0  nk  kk   nk  kk k  k0 Note
that by the weak law of large numbers Pk  C k0  1 as k0   Therefore
PGk  xk  C k0  
PGnk  xPk  nk
 x   k0Pk  C k0
nkC k0
where  k0  0 as k0   Accordingly as k0   the left-hand side converges to limk PGk  x and the
right-hand side to x and the result follows
4 Examples and NGS Applications
We start by providing some numerical examples illustrating that in general the CLT results discussed above do
not hold without assumptions on the relative rate of m and n Next we show two examples of applicability of our
results to analyzing biodiversity of NGS data The rst one is concerned with comparing the diversity of T-cell
receptor populations in transgenics mice whereas the second one aims at identifying the hepatocellular carcinoma
transcription proles in humans For the purpose of the T-cell receptors example we propose a sequential statistical
procedure of NGS signal ltering based on our CLT results from the previous sections We begin by pointing out to
some subtleties in the CLT results discussed in Section 3
41 Power Law and Pure Noise Models
Consider the power law model from Example 2 in Section 21 with   1 and lx  1 Note that in this case
12  Omlog2 mn12 and therefore the assumptions
nmini pi1  mlogmn as well as  p1
of Theorem 1 are satised as soon as
nVarW 
n1m  0
for some   12 Similarly the assumption 35 of Lemma 2 is satised as soon as
In Figure 1 we illustrate the convergence results of Theorem 1iii and Lemma 2i for this power law model and
  05 The panels of Figure 1 presents the sample vs standard normal quantile QQ plots for the normalized
Renyi entropy statistic and the normalized Pearson statistic 34 based on B  5000 samples from the power law
distribution each with m  1000 and three different values of n  m1   050515 As seen from the
plots in the absence of 41 the CLT result for the Renyi entropy cf Theorem 1iii does not hold Moreover
the middle panel QQ plot indicates that for large mn satisfying n  m32 the discrepancy between distribution of
the entropy function and its plug-in estimate appears in a form of deterministic shift indicating the presence of
substantial asymptotic bias and hence the lack of convergence 32 Similarly when 42 is not satised than the
Pearson statistic CLT given in Lemma 2i fails with the middle panel again indicating that the bias of the estimate
does not vanish when m is too large relative to n
Figure 1 Projection CLTs Normal QQ plots for the normalized Renyi entropy Theorem 1iii lower green
curve and normalized Pearson 2 statistic Lemma 2i upper blue curve for the power law distribution pi  1i
The panels shows quantile plots with different values of n  m1   050515 and m  1000 The solid red
line gives quantiles of the standard normal distribution for reference
For comparison we also considered the uniform distribution pure noise model pi  1m Note that it may be
viewed as a degenerate power law where   0 and lx  1 Recall that according to Theorem 3 ii and Lemma 2
i the sufcient conditions for the respective CLTs are m2n1  0 and mn  0 see Remark 35 for the latter
one The necessity of these conditions is illustrated in the panels of Figure 2 where we again present the normal
QQ plots for the Renyi   05 and the Pearson statistics for the same values of Bn and m as in Figure 1 As seen
from these plots only in the last panel when m2n  0 we get good CLT approximation for both statistics These
results appear consistent with our theoretical results from Theorem 3 and Lemma 2
Figure 2 Degenerate Projection CLTs Normal QQ plots for the normalized uniform Renyi entropy Theo-
rem 3ii represented by the lower green curve and the normalized Pearson 2-statistic Lemma 2 i repre-
sented by the upper blue curve with pi  m1 The panels shows quantile plots with different values of n  m1
  050515 and m  1000 The solid red line gives the quantiles of the standard normal distribution for
reference Note that the normalized Renyi entropy is undened for the rst panel
Although not presented here due to space considerations similar examples based on the bivariate power laws
may be used to illustrate the necessity of the assumptions of type 33 and 38 in the CLT results for divergence in
Theorems 2iii and 4ii
42 Applications to NGS Data
Our CLT results described in Section 3 were originally motivated by questions rising in NGS data analysis Below
we describe two examples which adhere to the following basic framework Denote by 12 two independent noise
distributions each on m support points and assume that a pair pppqqq of marginal distributions may be represented as
pppqqq    ppp qqq  1  12
where  ppp qqq is a pair of marginal distributions having no common support points with 12 and  is the mixing
proportion or prior probability of signal We assume that each  is a simple nite mixture of K uniform distributions
on separate support Note that the noise-and-signal model from Example 23 in Section 21 may be viewed as a
univariate special case of 43 with K  1 In the rst example below we took K  2
Algorithm 1NGS Diversity Analysis with D or S
i Exponent  selection Use problem-specic criteria eg sample coverage see Rempala and Seweryn 2013
to identify the appropriate  value If no prior knowledge exist the value   12 the Bhattacharyya distance
may be often used
ii Noise ltering Identify the number of mixture components K and the cut-off counts km for the support of i in
43 with a sequential starting from the lowest empirical frequency procedure based on Lemma 2i with ppp  i
i  12 The values of  is then estimated as the proportion of a sample falling into the m noise categories
iii Equality testing For a pre-determined value of  test the hypothesis H0  ppp  qqq by comparing the observed
value of D alternatively S with the asymptotic normal distribution in Theorem 4
Antibiotic  ppp
Control qqq
0869005
481 479 482
0971005
464 463 467
12273 12030 12397
10354 10251 10670
0155 0147 0163
Table 1 Results of TCR data analysis The mixture model 43 with heavy-tailed power laws tted to two sets of
TCR counts derived from mouse MLN before and after an antibiotic treatment as described in Cebula et al 2013
The empirical Renyi entropy the Hill number and the Renyi diversity CIs in parenthesis are obtained from the CLT
results of Theorems 1 and 2
iv Difference quantication If H0 is not rejected conclude that D  0 S  1 Otherwise apply Theorem 2 to
obtain condence bounds for D S
421 T-Cell Receptor Populations
In this example we apply Algorithm 1 to measure similarity between a pair of T-cell receptor TCR populations
based on the observed NGS counts of receptor-specic nucleotide sequences With the current NGS technology
the two main difculties in comparing TCR populations are to adjust the under-sampling bias due to unobserved
rare types and the ghost types created due to the sequencing errors Wang et al 2014 The rst problem may be
often alleviated by applying diversity criteria like the Renyi entropy and divergence which allow for the sample-
based up-weighting of rare counts see Rempala and Seweryn 2013 The second one requires typically additional
assumptions in order to perform analysis as outlined in Algorithm 1ii A recent detailed overview of the TCR
diversity analysis methods was presented by Rempala and Seweryn 2013 and earlier on in a more general context
of biodiversity by Hsieh et al 2006 and Magurran 2005 For illustration we analyze here two populations derived
from the mesenteric lymph nodes MLN of a TCR mini-mouse before and after an antibiotic treatment The details
of the experiments and a dataset description are given in Cebula et al 2013 For the current analysis it is important
to note that since the experimental groups consisted of different animals we may consider two experimental groups
as independent The total combined sample size or sequencing depths was n  72030 with initial m0  6336
receptor types After performing step ii of Algorithm 1 m  165 types were identied as signal based on the
cut-off km  17 in both populations The signal population corresponded to the remaining sample size of 38896
or about 54 of the original NGS counts We used D with   12 as the diversity measure in step iii-iv of
Algorithm 1 Based on Theorem 2 the asymptotic P-value for testing H0  ppp  qqq was found to be less than 104 and
hence the hypothesis of equal diversity of the two populations was rejected see Algorithm 1iii
To compare this nding with a more standard parametric analysis we additionally tted with the least squares
method the counts of 165 receptor types in two populations to the power law distributions Since the respective
exponent values for the two tted populations were found to be different with 1  87 for antibiotic treated mice
and 2  97 for untreated the parametric analysis conrmed the ndings of Algorithm 1 For illustration the
plots of the tted power law quantiles versus the empirical ones are presented in Figure 3 Additionally the diversity
of each of the TCR populations in terms of its respective Renyi entropy H12 and the Hill number ENC12 as well as
the diversity difference measured by the Renyi divergence D12 are listed in Table 1 along with the corresponding
asymptotic condence intervals obtained via Theorems 1 and 2 As seen from the values in Table 1 although the
diversity of each of the NGS populations was relatively similar in terms of the two populations count patterns it
Figure 3 Power law t for TCR data QQ plot of the TCR data against quantiles of a power law distribution with
1  087 SE  05 and 2  097 SE  05 values tted via the least squares method
differed in terms of the specic TCR types expressed
422 Gene Expression Proling
Beyond Algorithm 1 the results of Section 3 may be applied to facilitate various other biodiversity analysis for
instance in simultaneous comparison of several pairs of molecular samples We illustrate this with an NGS data
example from the recent hepatocellular carcinoma HCC study in Chan et al 2014 which we obtained through the
gene expression omnibus GEO database The GEO dataset consists of HCC tumor-infected T  and healthy liver
N tissue samples from three individuals denoted below as follows in relation to their original database designations
T 1  HCC448TT 2  HCC473TT 3  HCC510T and N1  HCC448NN2  HCC473NN3  HCC510N For
this dataset one of the questions of research interest was whether the expression proles of genes associated with
regulation of cell proliferation and programmed cell death differ across T and N samples as well as across individuals
cf eg Kong et al 2013 To address this specic question in contrast with the previous TCR example we were
thus only interested in a pre-selected subset of the NGS counts The nal values of m  1332 and n between 12 and
19 million reads 1 were obtained after aligning the pre-selected NGS fragments to the HG19 reference genome with
the Tophat2Bowtie2 software Kim et al 2013 and performing the transcript annotation with the Ensembl genome
browser wwwensemblorg After the nal fragments-to-counts conversion our data analysis was performed in
0  T1  N1  T2  N2  T3  N3 was tested
three steps First the null hypothesis of the tissue homogeneity Hall
and rejected based on the result of Theorem 4 and the corresponding asymptotic p-value obtained from the 23
distribution Next the hypothesis of the across-individuals homogeneity was tested by evaluating three pairwise null
0  D12TiNi  D12TjNj 1  i  j  3 each rejected based on Theorem 4 Finally having
hypothesis Hi j
rejected the homogeneity hypothesis we have used the result of Theorem 2 to quantify the differences between the
three sets of T and N tissue samples The details of the analysis are presented in Table 2 As seen from the numerical
results it seems that despite the large individual differences between patients the set of m  1332 genes associated
with cell proliferation and death may be used to distinguish between T-type and N-type samples in HCC patients
5 Summary and Conclusions
We derived two sets of limit theorems for the Renyi entropy and divergence statistics The rst set of results holds
for lineralizeable statistics their rst order Taylor approximations exist whereas the second one holds in the de-
1Based on these values the empirical versions of the conditions for the relevant theorems in Section 3 were considered satised
Hypothesis
Statistic
D12 Value CI
P-value
wiD12i i2  0001
D121 D122  001 D1210553 0551 0555
D122 D123
D1220292 0291 0294
D123 D121
D123 0346 0345 0348
Table 2 The 95 condence intervals for the pairwise symmetric Renyi Divergence D12 between the tumor and
control healthy tissues from three individuals based on the prole of expression of pre-selected m  1332 transcripts
related to cell proliferation Here D12i denotes D12TiNi
generate case when the rst order approximations vanish and requires analyzing the quadratic terms in the Taylor
expansions Our Renyi entropy limit theorems complement those obtained elsewhere for the Shannon entropy and
divergence
Based on the CLT results we have proposed here a new framework for analyzing molecular diversity of molecular
especially NGS data based on the idea of analyzing the frequencycontingency tables where cell counts are highly
unbalanced for instance as arriving from mixtures of heavy tailed power-law type and uniform distributions and
the number of cells or equivalently the counts distribution support size m increases with the sample size n For
analyzing such tables we suggested using the empirical Renyi entropy and divergence as the statistical measures of
respectively diversity and pairwise similarity of different molecular sub-populations
In the two examples of NGS analysis we have shown how the Renyi entropy methods may be used for ltering
out low frequency noise and for establishing valid condence bounds in pairwise divergence analysis for pre-selected
transcripts However it was also seen that in order to apply our CLT results the number of transcripts had to be small
relative to the sequencing depth For the special class of heavy-tailed power law distributions our results in particular
indicate that the appropriate entropy CLTs are valid and thus so is our proposed analysis framework when roughly
n  0 and not otherwise As such restriction may be often limiting in very high diversity NGS data
speaking m
other statistics beyond those discussed here and not requiring such condition could be also of interest We hope to
pursuing this matter further in our future work
References
Agresti A 2002 Categorical Data Analysis 2nd edn Wiley Series in Probability and Statistics Wiley
de Andrade M Wang X 2011 Entropy based genetic association tests and gene-gene interaction tests Statistical
Applications in Genetics and Molecular Biology 101 DOI 1022021544-61151719
Berkov S Mutafova B Christen P 2014 Molecular biodiversity and recent analytical developments a marriage of
convenience Biotechnological Advances 326110210 DOI 101016jbiotechadv201404005
Campbell AK 2003 Save those molecules molecular biodiversity and life Journal of Applied Ecology 402193
Cebula A Seweryn M Rempala GA Pabla SS McIndoe RA Denning TL Bry L Kraj P Kisielow P Igna-
towicz L 2013 Thymus-derived regulatory T-cells contribute to tolerance to commensal microbiota Nature
497744825862 DOI 101038nature12079
Chan THM Lin CH Qi L Fei J Li Y Yong KJ Liu M Song Y Chow RKK Ng VHE Yuan YF Tenen DG Guan
XY Chen L 2014 A disrupted RNA editing balance mediated by adars adenosine deaminases that act on RNA
in human hepatocellular carcinoma Gut 63583243 DOI 101136gutjnl-2012-304037
Chao A Chiu CH Jost L 2010 Phylogenetic diversity measures based on Hill numbers Philosophical Transactions
of Royal Society B Biological Sciences 36515583599609 DOI 101098rstb20100272
Chao A Chiu CH Hsieh TC 2012 Proposing a resolution to debates on diversity partitioning Ecology 9392037
Chiu CH Jost L Chao A 2014 Phylogenetic beta diversity similarity and differentiation measures based on Hill
numbers Ecological Monographs 8412144
Horgan D Murphy CC 2013 On the convergence of the chi-square and noncentral chi-square distributions to the
normal distribution IEEE Communications Letters 171222332237
Hsieh CS Zheng Y Liang Y Fontenot JD Rudensky AY 2006 An intersection between the self-reactive regulatory
and nonregulatory T-cell receptor repertoires Nature Immunology 7440110 DOI 101038ni1318
Janeway Cea 2005 Immunobiology The Immune System in Health And Disease 6th edition Garland Science
New York
Jost L 2007 Partitioning diversity into independent alpha and beta components Ecology 881024272439
Kallberg D Leonenko N Seleznjev O 2012 Statistical inference for Renyi entropy functionals In Conceptual
Modelling and Its Theoretical Foundations Springer pp 3651
Kim D Pertea G Trapnell C Pimentel H Kelley R Salzberg SL 2013 Tophat2 accurate alignment of
transcriptomes in the presence of insertions deletions and gene fusions Genome Biology 144R36 DOI
101186gb-2013-14-4-r36
Knoblauch A 2008 Closed-form expressions for the moments of the binomial probability distribution SIAM Jour-
nal on Applied Mathematics 691197204
Kolchin VF Sevast yanov BA Chistyakov VP 1978 Random allocations translated from the Russian Translation
edited by Av Balakrishnan Scripta series in mathematics VH Winston  Sons Washington DC distributed by
Halsted Press John Wiley  Sons New York-Toronto Ont-London
Kong D Chen H Chen W Liu S Wang H Wu T Lu H Kong Q Huang X Lu Z 2013 Gene expression
proling analysis of hepatocellular carcinoma European Journal of Medical Research 1844 DOI 101186
2047-783X-18-44
Koroljuk VS Borovskich YV 1994 Theory of U-statistics Mathematics and Its Applications Springer Dordrecht
Krishnamurthy A Kandasamy K Poczos B Wasserman L 2014 Nonparametric Estimation of Renyi Divergence
and Friends In Proceedings of the 31st International Conference on Machine Learning ICML 2014 URL
httpresearchmicrosoftcomappspubsdefaultaspxid256257
Leonenko N Pronzato L Savani V et al 2008 A class of Renyi information estimators for multidimensional
densities Annals of Statistics 36521532182 Corrections Annals of Statistics 2010 386 38373838
Magurran AE 2005 Biological diversity Current Biology 154R1168 DOI 101016jcub200502006
Mora C Tittensor DP Adl S Simpson AGB Worm B 2011 How many species are there on earth and in the ocean
PLoS Biology 98e1001127 DOI 101371journalpbio1001127
Nielsen F Boltz S 2011 The Burbea-Rao and Bhattacharyya centroids IEEE Transactions on Information Theory
57854555466
Oh S Song S Dasgupta N Grabowski G 2014 The analytical landscape of static and temporal dynamics in tran-
scriptome data Frontiers Genetics 535 DOI 103389fgene201400035
ORawe JA Ferson S Lyon GJ 2015 Accounting for uncertainty in dna sequencing data Trends in Genetics DOI
101016jtig201412002
Paninski L 2003 Estimation of entropy and mutual information Neural Computation 15611911253
Pardo L 2005 Statistical inference based on divergence measures CRC Press
Presley SJ Scheiner SM Willig MR 2014 Evaluation of an integrated framework for biodiversity with a new
metric for functional dispersion PLoS One 98e105818 DOI 101371journalpone0105818
Rempala GA Seweryn M 2013 Methods for diversity and overlap analysis in t-cell receptor populations Journal
of Mathematical Biology 676-7133968 DOI 101007s00285-012-0589-7
Renyi A 1961 On measures of entropy and information In Fourth Berkeley Symposium on Mathematical Statistics
and Probability pp 547561
Sadee W Hartmann K Seweryn M Pietrzak M Handelman SK Rempala GA 2014 Missing heritability of
common diseases and treatments outside the protein-coding exome Human Genetics 133101199215 DOI
101007s00439-014-1476-7
Shao J 2003 Mathematical Statistics Springer Texts in Statistics Springer URL httpbooksgooglecom
booksidcyqTPotl7QcC
Soulier P 2009 Some applications of regular variation in probability and statistics Escuela Venezolana de
Matematicas URL httpevmivicgobveLibroSoulierpdf
Sun W Hu Y 2013 EQTL mapping using RNA-seq data Statistical Biosciences 51198219 DOI 101007
s12561-012-9068-3
Tsallis C 1988 Possible generalization of Boltzmann-Gibbs statistics Journal of Statistical Physics 521-2479
Wang C Gong B Bushel PR Thierry-Mieg J Thierry-Mieg D Xu J Fang H Hong H Shen J Su Z Meehan J Li X
Yang L Li H abaj PP Kreil DP Megherbi D Gaj S Caiment F van Delft J Kleinjans J Scherer A Devanarayan
V Wang J Yang Y Qian HR Lancashire LJ Bessarabova M Nikolsky Y Furlanello C Chierici M Albanese D
Jurman G Riccadonna S Filosi M Visintainer R Zhang KK Li J Hsieh JH Svoboda DL Fuscoe JC Deng Y
Shi L Paules RS Auerbach SS Tong W 2014 The concordance between rna-seq and microarray data depends
on chemical treatment and transcript abundance Nature Biotechnology 32992632 DOI 101038nbt3001
Wang Z Gerstein M Snyder M 2009 RNA-seq a revolutionary tool for transcriptomics Nature Review Genetics
1015763 DOI 101038nrg2484
Zhang Z Grabchak M 2014 Nonparametric estimation of Kullback-Leibler divergence Neural Computation
261125702593
Zhang Z Zhang X 2012 A normal law for the plug-in estimator of entropy IEEE Transactions on Information
Theory 58527452747
Appendix
A Proofs for Non-Degenerate Projections Section 31
Auxiliary Results
First we establish the following simple result on binomial moments
Lemma 3 Binomial moment bound Let x denote the largest integer smaller or equal to x and let pn be an
empirical binomial proportion from n independent Bernoulli trials with the success probability 0  pn  1 Assume
npn   as n   Then for any integer d  1 and sufciently large n
E  pnn pnnd   Cd npnd2
for some universal n free constant Cd
Proof Let X be a binomial Binn pn random variable and set   npn Then see eg Knoblauch 2008
EX  d 
diEX i 
di
wherecid8i
cid9 denotes a Stirling number of the second kind ie the number of ways to partition a set of i objects into k
non-empty subsets and nk  nn 1 n k  1 Let
cid18d
cid19
cid18d
cid19cid26
cid18d
cid19
cid27
cid26i
cid27
cid18d
cid19cid26d  i
cid27
1di
idk
i d  k
1i
denote the coefcient at k in the expression for EX  d Then for 1  k  d
cd1k  d cd1k1  k cdk
Indeed
d cd1k1  k cdk
1i
1i
1i
cid18d
1i
cid18d  1
cid18 d
cid19
cid19cid18
cid18d
cid18cid18d  1
k i 1
cid19cid26d  i 1
cid27
cid26d  i 1
cid27
cid27
cid26d  i
cid26 d  i
cid19cid19cid26d  i  1
cid18 d
k i 1
k i 1
k i
i  1
cid19
1i
cid27cid19
cid27
cid19cid26d  i
cid27
cid19cid26d  i
cid18d
cid27
cid27
cid26d
 k1
cid26 d
cid27
cid26d  1
1i
cid26d
cid27
cid18d
cid27
and using the recursions for the Stirling numbers and the binomial coefcients
 k1
1i
1i
cid19cid26 d  i
cid18d
k i 1
cid27
cid19cid26 d  i
cid27
k i 1
 cd1k  0
Let us argue that for any d  1 we have
cdk  0 for k such that d2  k  d
The proof of A2 is by induction with respect to d  1 Note that the statement is true for d  1 due to cdd  0 for
d  1 but c00  1 Now if k  d  12 then k 1  d  12 and k  d2 and thus A1 implies cd1k  0 for
k  d  12 since the induction assumption implies cd1k1  cdk  0 Hence A2 holds and consequently the
highest power of  in the expansion of EX  d cannot exceed d2 This yields the assertion of the lemma
Lemma 4 Set W 
n  W 
n  EW 
VarW 
0 E W 
2I W 
n  0
is satised Consequently
ni  N01
W 
12 Under the assumptions of Theorem 1 the Lindeberg condi-
n  
equidistributed with W 
 Moreover the result remains true if we replace above
by V 
with n iid random variables W 
under the assumptions of Theorem 2
Proof We shall only prove the statement for W 
n  VarW 
 n  EW 
and Wn  W 
n  p1
Note that Wn  1
vector with parameters p1     pm For any   0
n  22
 22
n I Wn  
E W 2
 as the proof for V 
 In view of 31 we have as n  
is similar For notational convenience set
  p
  p1
i  pi where the vector 1    m represents a single trial multinomial random
n E p1
n E p
i  pi2I Wn  
i 2 i p21
I Wn  
Since by A4 n  on 2
n 12 then by the denition of i for sufciently large n we have
   Wn  
n    1
n  p1
i  pi  
   i  1 for i such that p1
   i  1 for i such that  p1
   i  1 for i  Jn
i  n  
where the last equality denes the set of indices Jn Note that the size of the set Jn satises Jn  0 as n   due to
nn  0 as n   which is implied by 31 This and A5 give therefore at least for large n
max1imn p1
E W 2
n  2
n I Wn  
n  2 p21
p21
 2nn2 p
  nn2 
nn  2
n  2
n  1 
pi  22
p21
n   2
n   0
as n   since supnnn2   by the assumptions of Theorem 1 and 2  p21
gence assertion follows now by the Lindeberg central limit theorem see eg Shao 2003 Chapter 1
n   2
n  The weak conver-
Proof of Theorem 1
Let us rst establish part ii Note that 31 implies that
n  nVarW 
n  
cid19
in view of
which yields an  nVarW 
Rn  
Fixing   012 for any   0 we have
Rn  max
PRn    P
n  1
 pi  pi  Rn
for some random i  01
cid19cid12cid12cid12cid12  
cid12cid12cid12cid12i
cid18 pi
cid19cid12cid12cid12cid12  
cid19
 I  II
i   p1
cid192
cid18
cid19
cid18
cid19
n  2a2
Rn  max
cid18 pi  pi
n p1
n p21
12 p1
1 By Taylors expansion
S  ppp S ppp   p
i  p
cid19
cid192cid18
cid18 pi
cid18
cid19
cid12cid12cid12cid12i
cid19cid12cid12cid12cid12  
cid18 pi
cid18
cid12cid12cid12cid12i
cid19cid12cid12cid12cid12  
cid18
cid18 pi
cid19cid12cid12cid12cid12  
cid18
cid19
cid12cid12cid12cid12p12d
cid18 pi
cid18C1an
cid19cid12cid12cid12cid12  
cid19
cid12cid12cid12cid12i
cid18
cid18 pi
 p
cid19
cid19
cid18
II  P
Rn  max
cid18 pi
cid12cid12cid12cid12i
cid192
cid18 pi  pi
  C2 p1
 2d nd pd
 2d n  p1
First note
I  1
Now recall the condition 25 and consider d  1 large enough so that d  1 and hence npd  n1 for
sufciently large n Applying Bools subadditivity inequality bound and Lemma 3 to the 2d-th central moments of
the pis we get
1  2  C1
 n  p1
where C1C2C3 are constants independent of n and pi with C2 being C2d of Lemma 3 Therefore for any   0 and
the numerical sequence an  an  nVarW 
12   cf A6 as well as a possibly different set of constants
C1C2C3
PanRn    max
 p1
n  C3an p1
n  0
ni n with iid random variables W 
as n   due to 31 Note that the random variable   p1
EW 
Since Lemma 4 ensures that Wn  EWnVarWn12  N01 the result follows
 pi pi has the same distribution as Wn  W 
ni distributed as 26 and that due to A8 anRn  RnVarWn12  op1
i  2 and by A6
Finally we show part iii Consider arbitrary   01 and note that on the events S  pppS ppp 1   
12   Consequently part i follows immediately from part ii
To argue part i note that from the denition of 26 we have EW 
n  2S ppp  2  p
an  nS ppp2VarW 
by Taylors expansion for x  1 we have
log1  x  x
21  x2 
where   01 and hence
1 H  ppp H ppp  log
cid18 S  ppp
cid19
S ppp
cid16 S  ppp
S ppp  1
cid172
S ppp  12
S  ppp
21   
 1
S  ppp
S ppp
S  ppp S ppp
S ppp
where the last equation denes Tn By applying again the expansion argument used in the proof of part ii with
12  
S  pppS ppp in place of S  ppp and RnS ppp in place of Rn and the sequence an  nS ppp2VarW 
we see that
anS  pppS ppp 1 
S  ppp S ppp
VarW 
 N01
as n   Note that for any   0
P anTn  S  pppS ppp 1     P
cid19
P anTn    PS  pppS ppp 1     Pcid0 anS  pppS ppp 1  21  2cid1 
S  pppS ppp 1
21  2
 
cid18
and therefore
In view of i and A11 denoting the absolute value of N01 by N A12 yields
P anTn    0  PN  21  2 
By taking   0 to be sufciently small we get
P anTn    
for arbitrary   0 and therefore limsupn P anTn    0 Thus for any x we have
S  ppp S ppp
VarW 
cid32
n 1 H  ppp H ppp
cid32
 C V W 
cid33
cid33
 op1
and the result follows from part ii
Proof of Theorem 2
The proof follows closely that of Theorem 1 with some obvious modications For illustration we shall only argue
part ii Let us rst note that in parallel with A6 bn  nVarV 
12   Indeed since
EV 
2i j pi j
therefore
cid1721
cid20cid16 qi
cid16 p j
cid172cid21 
cid171
cid16 qi
cid17 
cid16 pi
2bn 
cid17  
cid16 qi
cid171
nVarV 
cid16 pi
cid32
due to 33 Next we show that the limiting distribution is determined by the projection V 
Taylor expansion one obtains
 By the bivariate
bnS  ppp qqq S pppqqq  bn
qipi1  pi  pi  1 
piqi  qi  qi
cid33
Rn  
klkl0kl2
i q1
 2 p
 k pi l qi
cid12cid12cid12cid12cid12 pi qipiqii pipi qiqi
 pi  pik qi  qil
and i  1 for all i Since for the mixed derivatives term by virtue of the elementary inequality 2ab  a2 b2 with
a   pi  pi pi and b  1  qi  qi qi we have
21  p1
q
 pi  pi qi  qi  2 p2
i q1
 qi  qi2
Clearly it sufces now to show only that bnRi
one follows similarly Analogously as in the proof of Theorem 1 taking some small   0 we have
n  op1 for i  12 We only prove the second relation the other
bnRn  2bnR1
therefore
n  
i q1
n  
i q1
cid18
cid18
cid18 pi
cid18 pi
cid19
cid19
cid18
cid18
PbnR2
n    P
n  max
cid26cid12cid12cid12cid12i
cid18 pi
 I  II
Apropos I for some universal n-free and  -free constant C we have
by 33 Apropos II we have
I  bn1
i q1
cid18
1    1  
1 E
cid12cid12cid12cid12cid18 pi
cid19cid12cid12cid12cid12   2
cid19
II  P
cid19
cid19
q1
n  R2
cid192cid18
cid19cid18
 pi  pi2  1 2 p
cid192
cid191cid18 pi  pi
cid18 qi
cid191cid18 qi  qi
cid192
cid18 qi
cid26cid12cid12cid12cid12i
cid19cid12cid12cid12cid12 
cid19cid12cid12cid12cid12cid27
cid12cid12cid12cid12i
cid18 pi
cid18 qi
cid19cid12cid12cid12cid12 
cid19cid12cid12cid12cid12cid27
cid12cid12cid12cid12i
cid18 qi
cid192  C1 p
cid18 qi  qi
i q
cid12cid12cid12cid12cid18 qi
cid19cid12cid12cid12cid12   2
cid18
cid19
cid19
cid19
 IIa  IIb
i nVarV 
12  0
Note that for d large enough so that d  1 in view of 25 and the Boole inequality bound combined with the result
of Lemma 3
IIa  P
cid192d
cid32
cid18 2
cid32
cid40cid18 pi
cid19 
cid34cid18 pi
cid19
cid40cid18 pi
cid19 
cid12cid12cid12cid12cid12max
cid12cid12cid12cid12cid12max
n1
2d cid41cid18 pi
cid19 1
cid18 qi
cid191cid35
cid18 2
cid18 qi
2d cid41cid18 qi
cid19 1
cid18 qi
cid33
cid19cid12cid12cid12cid12cid12   2
cid192d
bnn1
cid19cid12cid12cid12cid12cid12   2
cid33
cid18 2
cid34cid18 pi
cid18 2
cid192d
cid19
cid192d
cid40cid18 pi
cid191cid35
cid34cid18 pi
cid18 qi
bnn1
cid19
cid18 qi
by A13 and 33 Similarly
IIb  P
cid191cid41
npid
cid19
cid18 qi
cid191cid35
n  op1 and by a similar argument bnR1
and therefore bnR2
the distribution of  iqipi1  pi  pi  1 ipiqi  qi  qi is equal to that of n
where V n
are independent and distributed according to V 
n  op1 Consequently bnRn  op1 Finally since
given in 27 the result follows by Lemma 4
k  EV n
k1V n
B Proofs for Degenerate Projections Section 32
Auxiliary Results
The following lemma is cited after Koroljuk and Borovskich 1994 Theorem 473 page 162
Lemma 5 Degenerate U-statistic CLT Let X1    Xn be a sequence of iid random elements and let
cid18n
cid191
UnX1    Xn 
1kln
hnXkXl
be a U-statistic of order two with a symmetric real-valued kernel hnxy which depends on n and satises EhnXy 
0 Denote also nyz  EhnXyhnXz Assume that Eh4
n  0
n If the conditions
n   and set  2
n  Eh2
are satised then
n  0
n14
2n  N01
Proof of Lemma 2
We start by showing i To this end let Xk for k  1    n be iid single trial multinomial variables with parameter
ppp and denote IXk  i  iXk Note the identity
ppp  ppp ppp m  1  n p1
 n1 p1
 n1 
kcid54l
 n 1U 1
iXk pi2  m  1
i n1
iXkiXl  n1 p1
kcid54l
i iXkiXl 1  n1
 p1
n  R1
iXk n m  1
i iXk m
 p1
is the U-statistic with order-two kernel hnX1X2  i p1
Here U 1
satises EhnX1x2  0 The remaining term R1
V such that PV  p1
i   pi We will argue that
IX1  X2  i 1 which is degenerate ie
n  n1 kVk  EVk where Vk are iid equidistributed with say
n cid1122m 1  N01
n 1U 1
m  op1 The second relation follows easily since m1VarR1
and R1
m2  0 by assumption 35
n  nm1VarV  nm1 p1
The convergence B3 will follow from Lemma 5 and Slutskys theorem upon checking the conditions B1 and
n  Var hn  m1 since VarhnX1X2  EhnX1X22 
IX1  i  m 1 Similarly Eh4
B2 To this end note that in the notation of Lemma 5  2
 piEp1
i 14  p2
IX1  i 12   piEp2
IX1  i  1 2p1
n   piEp1
i  4p1
i   6m 3 Therefore
n  p2
n1Eh4
i  4p1
i   6m 3
nm 12
 Cn1 p2
i m2  0
due to 35 and thus B1 follows In order to verify B2 consider rst nxy  EhnX1xhnX1y  p1
y1 Since E2
nX1X2 4
and B2 follows as well Hence B3 follows and yields the assertion i
IX1  i12  m1 then we have E2
nX1i   piEp1
nX1X2   piE2
x Ix 
n  0
Now consider part ii In parallel to part i dene cf Section 2 Zk  XkYk for k  1    n as a sequence of
independent bivariate random variables distributed according to Z  XY  Additionally for i  1    m as before
let iXk  IXk  i as well as iYk  IYk  i Set also iZk  iXkYk  iXk iYk Note that for
given i the iZks for k  1    n are independent variables distributed according to
0
iZ 
with prob 1 2pi  pii
with prob pi  pii
1 with prob pi  pii
In particular EiZ  0 and E2
i Z  2pi  pii Recall that n  1 piipi and consider
iZk2  n
2ppp ppp qqq n  n12pi1
 n1 
kcid54l
 n 1U 2
2pi1iZkiZl  n1
n  R2
2pi12
i Zk 2pi  pii
which parallels the representation in part i Regarding R2
pendent variables with variance
n note that it is as before the zero mean sum of inde-
Var R2
n  Varn1
2pi12
i Zk  n1Var
cid02pi1  2p j1cid12 pi j  2n1 
2pi1iX iY 2
cid02pi2  2p j2cid1 pi j
icid54 j
 n1 
icid54 j
 n1 p1
where the rst inequality above is obtained by applying the second moment bound and noticing that the inner sum
consists of either two or zero summands according to X cid54 Y or X  Y  The condition 35 implies that
m  op1
n  note that it is a U-statistic in bivariate variables Zk with second order degenerate kernel given by
n  Eh2
i Z12 icid54 j2pi12p j1EiZ1 jZ12 Since we have E2
Regarding U 2
hnZ1Z2  2pi1iZ1iZ2 Hence in the notation of Lemma 5  2
2pi2E2
EIX1  iY1  j  IX1  jY1  i  pi j  p ji it follows that  2
m  1 and thus B4 implies R1
that under our assumptions n
n given in 37 Recall Remark 36
i Z1  2pi pii and EiZ1 jZ1 
n  2
n n  op1
nZ1Z2  Ecid22pi1iZ1iZ2cid32
Now in order to complete the proof as in part i we only need to show that the conditions B1 and B2 are
satised for U 2
n  since then by Lemma 5 the statement similar to B3 holds for part ii namely
2n  N01
To this end note rst that by the denition of  variables iZ  2p1
ger p  1 Additionally since Z is bivariate for any distinct indices i jkl we have EiZ jZ2
EiZ jZkZlZ  0 Consequently
i Z for any inte-
kZ 
n 1U 2
i Z  2p
Z and 2
i Z14
i Z2
i E4
i Z22
i Z2 jZ1 jZ2  0
j E2
i Z12
n  E2pi1iZ1iZ24  24 p4
jZ12
icid54 j
icid54 j
i p2
i p1
i Z13
 24 p4
i 4pi  pii2  6
i p2
icid54 j
i 4pi  pii2 
 24 p4
i p2
6p2
icid54 j
j E3
j pi j  p ji2  4
icid54 j
j  4p3
i p1
j pi j  p ji2
i p1
j pi j  p ji2
In view of the condition 36 and Remark 36 as well 35
2nm 2B2 p2
i  mB2  B2 p1
i   C
nm2  p2
i  0
for some universal C  0 and hence B1 holds In order to argue B2 set z1  x1y1 and z2  x2y2 Then
nz1z2  EhnZz1hnZz2
 E2px11x1X x1Y  2py11y1X y1Y 
2px21x2X x2Y  2py21y2X y2Y 
It follows that
nz1z2  4px1 px212px1Ix1  x2 px1x2  px2x1
 4py1 py212py1Iy1  y2 py1y2  py2y1
 4px1 py212px1Ix1  y2 px1y2  py2x1
 4py1 px212py1Iy1  x2 py1x2  px2y1
 Rx1x2  Ry1y2 Rx1y2 Ry1x2
where the last equality is the denition Now consider
nZ1Z2  ER2X1X2  ER2Y1Y2  ER2X1Y2  ER2Y1X2
 2ERX1X2RY1Y2 2ERX1X2RX1Y2
 2ERX1X2RY1X2 2ERY1Y2RX1Y2
 2ERY1Y2RY1X2  2ERX1Y2RY1X2
 4ER2X1X2  ER2Y1Y2  ER2X1Y2  ER2Y1X2
where the last inequality follows by applying the inequality 2ab  a2  b2 to the integrants in the cross-product
terms To show that the quadratic terms above are of order Om recall the assumption 36 and note that we have
ER2X1X2  
 
px1 px2
px1 px2
2px1Ix1  x2 px1x2  px2x12
x1Ix1  x2  
px1 px2
4B2px1 px22  m  B2
and via a similar argument it is easy to see that this bound applies also to the remaining quadratic terms Thus
recalling Remark 36
nZ1Z2 4
n  4m  B2m 2B2  0
Therefore both B1 and B2 are satised and consequently B5 holds In view of B4 the proof of part ii is
completed
Proof of Theorem 3
Consider rst part i By Taylors expansion note that the rst term vanishes
S uuu S uuu   u
i  m1  0  m1n1
Rn  m ui  m12 m ui  1 i m ui  1  13
Since by Lemma 2 and Remark 35 the properly normalized variable X 2
sumptions it only sufces to show that Rn  nRn
m  op1
Fixing   012 for any   0 we have
cid18
cid19
uuu  m1
cid19
cid18
for some random i  01
uuu is asymptotically normal under our as-
cid19
cid18
cid19
cid18
 Rn  max
i m ui  1  
 Rn  max
i m ui  1  
i m ui  1  
 Rn  max
i m ui  1  
cid19
P Rn    P
 I  II
cid18
cid18
cid18
cid19
cid19
cid18
cid19
Note that Lemma 3 and the Boole inequality imply for d large enough so as d  1
I  P
m ui  1  
 C2d  m 2nd  C2d2dmnd  0
by assumption Regarding II note that   12 and on the events   maxim ui  1   we have the bound
 Rn   Cn
m m ui  m12 for some universal ie n and  free constant C so that
cid12cid12cid12cid12 n
cid18
cid19
cid18 Cn
m m ui  m12  1n
cid12cid12X 2
uuu  mncid12cid12  2
cid19
cid12cid12cid12cid12  2
 m2C2dm2nd
II  P
m ui  1
m  2
Consequently from the above considerations and Lemma 2 denoting as before a standard normal variable by N it
follows that
P Rn    limsup
II  PN  2C 1  
I  limsup
for any small   0 with  sufciently small Therefore limsupn P Rn    0 which completes the proof of i
Consider now the assertion ii The argument here is very similar to that of part iii in Theorem 1 and we only
sketch it out for the sake of brevity Denote cn  1 cid0
cid1 m
n S uuuS uuu 1  c1
n  It follows from i that
n m ui m 1  op1
cid3
cid2H uuu logm 1 1 logcn
cid112m2
1 cn
cid20m ui
cid21
Hence by virtue of the Taylor expansion A9
where Tn stands now for the scaled quadratic term in the log expansion A9 Note that the assertion ii fol-
lows as soon as we show that Tn  op1 Similarly as in the proof of i above it follows that on the events
c1
and a universal free of n and   as above constant C Therefore for any   0
cid2c1
n m ui m 1cid32 for sufciently large n
n S uuuS uuu 1   for 0    12 we have Tn  Cn
PTn    PTn  c1
 PTn  c1
cid18 Cn
cid12cid12c1
n m ui m 1cid12cid12  
cid19
n S uuuS uuu 1     PTn  c1
n S uuuS uuu 1     Pc1
n S uuuS uuu 1   
n S uuuS uuu 1   
 o1  o1
using part i and the fact that cn  1 and   0 may be arbitrarily small The result follows
Proof of Theorem 4
We shall only prove part i since part ii then follows similarly as in Theorems 1 and 2 and part ii of Theorem 3
klkl0kl3
  1
S  ppp qqq 1 
2ppp ppp qqq  Rn
cid12cid12cid12cid12cid12 pi qipiqii pipi qiqi
i q1
 2 p
cid19
 k pi l qi
cid19cid181 
cid18
 pi  pik qi  qil
klkl0kl3
Rnkl
and for all i i  1 Due to 36 and Remark 36 as well as Lemma 2 ii it sufces to show that Rnkl 
m  op1 for k  0 l  0 such that k  l  3 Due to the invariance of Rn under swapping p
i and q1
nRnkl
it sufces to show the above only for the pairs k  3l  0 and k  2l  1 To this end note
Rn30  n
cid18
m p3
1  i
q1
qi  qi
 pi  pi3
cid191cid18
1  i
pi  pi
cid193
cid19
cid18 pi
i  pi  pi2
and i  1 for all i For 0    12 and   0 let An     max pipi  1   or max qiqi  1  
P Rn30    P Rn30   An   P Rn30   Ac
n 
 PAn   P Rn30   Ac
n 
Note that with large n PAn    for arbitrarily small   0 due to
PAn   Pmax pipi  1     Pmax qiqi  1     2  2
which follows by Lemma 3 and the application of Booles bound as before Recall from Lemma 2 that n 
1 piipi Then
P Rn30   Ac
cid18 n
cid18 2n
cid18 2n
n   P
1   1
1  3 max pipi  1 pi  pi2pi  
cid12cid12 pi  pi2pi  nncid12cid12  2
cid19
max pipi  1  2
 Ia  Ib
cid19
cid19
Note that 38 implies in particular 35 and therefore due to the CLT result in i of Lemma 2 we have Ia  2
for arbitrarily small   0 with n large enough whereas for Ib
Ib  Pcid0
mmax pipi  1  cid1  Cm
cid18 m
nmin pi
cid19d  Cmnd  2
for sufciently large d due to 38 the Boole inequality and Lemma 3 cf previous proof Consequently for
arbitrarily small  and large n
P Rn30    2
For the term Rn21 note
Rn21  n
cid18
m p2
1  i
 q
qi  qi
cid19cid18
i  pi  pi2 qi  qi
pi  pi
1  i
cid192
cid19
cid18 qi
i  pi  pi2
The argument as above then applies also to bounding from above the probability P Rn21   with the obvious
modication that
P Rn21   Ac
n   P
cid18 n
cid18 2n
m 1  2 max qiqi  1 pi  pi2pi  
cid12cid12 pi  pi2pi  nncid12cid12  2
cid18 2n
max qiqi  1  2
 IIa  IIb
cid19
cid19
cid19
for sufciently small   0 One may then show that IIa  2 and IIb  2 and thus P Rn21    2
and part ii follows
