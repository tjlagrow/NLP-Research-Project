PROCESS-LEVEL LARGE DEVIATIONS FOR NONLINEAR
HAWKES POINT PROCESSES
LINGJIONG ZHU
Abstract In this paper we prove a process-level also known as level-3 large
deviation principle for a very general class of simple point processes ie non-
linear Hawkes process with a rate function given by the process-level entropy
which has an explicit formula
1 Introduction and Main Results
In this paper we study the process-level large deviations for a very general class
of point processes ie nonlinear Hawkes processes The rate function is given by
the process-level entropy which has an explicit formula via the Girsanov theorem
for two absolutely continuous point processes Our methods and ideas should work
for some other point processes as well and we would expect the same expression for
the rate function
Let N be a simple point process on R and let F 
 t be an increasing family of -algebras Any nonnegative F 
measurable process t with
 N C C  BR C 
-progressively
Ecid2N a bF 
cid3  EZ b
sdscid12cid12F 
for all intervals a b is called an F 
-intensity of N  We use the notation
Nt  N 0 t to denote the number of points in the interval 0 t A point process
Q is simple if Qt  N t t  2  0
intensity
A general Hawkes process is a simple point process N admitting an F 
t  cid18Z t
ht  sN dscid19 
0 htdt   In 12 R t
where   R  R is locally integrable left continuous h  R  R and we
always assume that khkL1  R 
 ht  sN ds stands
forRt ht sN ds P t ht   where  are the occurences of the points
before time t Since we assume that  is left continuous the intensity t is
predictable
Date 9 August 2011 Revised 13 October 2012
2000 Mathematics Subject Classication 60G55 60F10
Key words and phrases Large deviations rare events point processes Hawkes processes self-
exciting processes
This research was supported partially by a grant from the National Science Foundation DMS-
0904701 DARPA grant and MacCracken Fellowship at NYU
LINGJIONG ZHU
rate function respectively
In the literatures h and  are usually referred to as exciting function and
A Hawkes process is linear if  is linear and it is nonlinear otherwise The
linear Hawkes process was introduced in Hawkes 8 and the nonlinear Hawkes
process was introduced in Bremaud and Massoulie 3
The Hawkes process captures both the self-exciting property and the clustering
eect You can think of the arrival times  as bad events which can be the
arrivals of claims in insurance literature or the time of defaults of big rms in
the real world Hawkes process has many applications in nance It is used for
the calculation of conditional risk measures ruin probabilities and credit default
modeling For a list of references to the applications in nance see Liniger 9
Hawkes processes may also have applications in cosmology ecology epidemiol-
ogy seismological applications neuroscience applications and DNA modeling For
a list of references to these applications see Bordenave and Torrisi 2
For a short history of Hawkes processes we refer to Liniger 9
When  is nonlinear Bremaud and Massoulie 3 proves that under certain
conditions there exists a unique stationary version of the nonlinear Hawkes process
and Bremaud and Massoulie 3 also proves the convergence to equilibrium of a
nonstationary version both in distribution and in variation
Throughout this paper we assume that
 The exciting function ht is positive continuous and decreasing for t  0
and ht  0 for any t  0 We also assume that R 
 The rate function   0  R is increasing and limz
z  0 We
also assume that  is Lipschitz with constant   0 ie x  y 
x  y for any x y  0
0 htdt  
Because of the exibility of  and h this will give us a very wide class of
simple point processes Later if you go through the proofs of the process-level large
deviation principle in our paper you can see that if for any simple point process
you want to obtain a process-level large deviation principle it has to satisfy some
regularities like the assumptions in our paper We refer to Section 5 for detailed
discussions
Let  be the set of countable locally nite subsets of R and for any    and
A  R and write A    A For any t  R we write t  t Let
N A    A denote the number of points in the set A for any A  R We also
use the notation Nt to denote N 0 t the number of points up to time t starting
from time 0 We dene the shift operator t by ts  t  s We equip the
sample space  with the topology in which the convergence n   as n   is
dened by
X n
f    X 
f  
for any continuous f with compact support
This topology is equivalent to the vague topology for random measures For a
discussion on vague topology random measures and point processes see for example
Grandell 7 One can equip the space of locally nite random measures with the
vague topology The subspace of integer valued random measures is then the space
of point processes A simple point processes is a point process without multiple
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
jumps The space of point processes is closed But the space of simple point
processes is not closed
Denote F s
t  s t for any s  t ie the -algebra generated by all the
possible congurations of points in the interval s t Denote M the space of
probability measures on  We also dene MS as the space of simple point
processes that are invariant with respect to t with bounded rst moment ie for
any Q  MS EQN 0 1   Dene ME as the set of ergodic simple
point processes in MS We dene the topology of MS as the following For
a sequence Qn in MS and Q  MS we say Qn  Q as n   if and only
Z f dQn Z f dQ
as n   for any continuous and bounded f and
Z N 0 1Qnd Z N 0 1Qd
as n   In other words the topology is the strengthened weak topology with
the convergence of the rst moment of N 0 1 For any Q1 Q2 in MS one can
dene the metric d by
where dp is the usual Prokhorov metric Because this is an unusual topology
the compactness is dierent from that in the usual weak topology and also later
when we prove the exponential tightness we need to take some extra care See
Lemma 25 and iii of Lemma 24
EQ1 N 0 1  EQ2 N 0 1cid12cid12 
dQ1 Q2  dpQ1 Q2 cid12cid12
We denote by C the set of real-valued continous functions on  We simi-
 the set of all bounded F 
larly dene C  R We also denote by BF 
progressively measurable and F 
Before we proceed recall that a sequence PnnN of probability measures on a
topological space X satises the large deviation principle LDP with rate function
I  X  R if I is non-negative lower semicontinuous and for any measurable set
predictable functions
 inf
Ix  lim inf
n
log PnA  lim sup
n
log PnA   inf
Here Ao is the interior of A and A is its closure See Dembo and Zeitouni 5 or
Varadhan 12 for general background regarding large deviations and their applica-
tions Also Varadhan 13 has an excellent survey article on this subject
Let us have a brief review on what is known about large deviations for Hawkes
processes
When  is linear say z    z then one can use immigration-birth repre-
sentation also known as Galton-Watson theory to study it Under the immigration-
birth representation if the immigrants are distributed as Poisson process with in-
tensity  and each immigrant generates a cluster whose number of points is denoted
by S then Nt is the total number of points generated in the clusters up to time t
If the process is ergodic we have
t
 ES
LINGJIONG ZHU
In particular for linear Hawkes process with rate function z   z and exciting
function h such that khkL1  1 we have
as where  
t
1  khkL1
Recently Bacry et al
1 proved a functional central limit theorem for linear
multivariate Hawkes processes under certain assumptions That includes the linear
Hawkes process as a special case and they proved that
Nt  t
t  B
as t  
where B is a standard Brownian motion The convergence is weak convergence on
D0 1 the space of cadlag functions on 0 1 equipped with Skorokhod topology
Bordenave and Torrisi 2 proves that if 0 R 
thtdt  
then cid0 Nt
t  cid1 satises the large deviation principle with the good rate function
0 htdt  1 andR 
if x  0
otherwise
xkhkL1cid17  x  xkhkL1  
Ix x logcid16
When  is linear Zhu 14 gives an alternative proof for the large deviation
principle for Ntt  
Once the LDP forcid0 Nt
t  cid1 is established it is easy to study the ruin probability
Stabile and Torrisi 11 considered risk processes with non-stationary Hawkes claims
arrivals and studied the asymptotic behavior of innite and nite horizon ruin
probabilities under light-tailed conditions on the claims
When  is nonlinear Bremaud and Massoulie 3 studied the stability results
and once you have ergodicity the ergodic theorem automatically implies the law
of large numbers Recently Zhu 15 proved a functional central limit theorem for
nonlinear Hawkes process
For the LDP for nonlinear Hawkes processes 14 obtained the large deviation
results for Ntt   for some special cases He proved the case when h is
exponential rst then generalizes the proof to the case when h is a sum of
exponentials and nally uses that to prove the LDP for a special class of general
Hawkes processes The Hawkes process is interesting partly because it is not
Markovian unless h is exponential or sum of exponentials The methods in Zhu
14 relies on proving the LDP for Markovian case rst and then approximate the
general case ie general h using the Markovian case But it is very dicult to
do so Indeed Zhu 14 can only prove LDP for general h when limz
z  0
for any   0 Therefore it is natural in our paper to consider proving the level-3
large deviation principle rst and then use the contraction principle to obtain the
LDP for Ntt   We also want to point out that in the case when  is linear
even if h is general the LDP for Ntt   can still be established because the
linear case can be explicitly computed which is not the case when  is nonlinear
In the pioneering work by Donsker and Varadhan 6 they obtained a level-3
large deviation result for certain stationary Markov processes
We would like to prove the large deviation principle for general Hawkes processes
by proving a process-level also known as level-3 large deviation principle rst We
can then use the contraction principle to obtain the level-1 large deviation principle
for Ntt  
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
Let us dene the empirical measure for the process as
RtA 
Astds
for any A where ts  s for 0  s  t and tst  ts for any s Donsker
and Varadhan 6 proved that in the case when  is a space of cadlag functions
 on   t   endowed with Skorohod topology and taking values in a
Polish space X under certain conditions P 0xRt   satises a large deviation
principle where P 0x is a Markov process on 0
 with initial value x  X The
rate function HQ is some entropy function
Let h  be the relative entropy of  with respect to  restricted to the
be the regular conditional probability
-algebra  For any Q  MS let Q
distribution of Q Similarly we dene P 
Let us dene the entropy function HQ as
HQ  EQhQ
 P 
Notice that P 
is the Hawkes process conditional on the past history  It has
rate P 0s hs  at time 0  s  1 which is well dened for almost ev-
ery  under Q if EQN 0 1   since EQP  h   khkL1 EQN 0 1 
 implies P  hs    P  h    for all 0  s  1
When HQ   hQ
   for ae  under Q which implies that
1  By the theory of absolute continuity of point processes see
for example Chapter 19 of Lipster and Shiryaev 10 or Chapter 13 of Daley and
Vere-Jones 4 the compensator of Q
it has some
density  say such that by the Girsanov formula
is absolutely continuous ie
 P 
 P 
HQ ZZ cid20Z 1
ZZ 1
0 cid16  cid17 ds Z 1
 s   s  log   s
logdNscid21 dQ
 s ds Qd
Qd
where   cid16P 0s hs   cid17 Both  and  are F 
0  s  1 For the equality in 114 we used the fact that Nt R t
a martingale under Q and for any f  s which is bounded F 
measurable and predictable we have
-predictable for
 sds is
progressively
ZZ 1
f  sdNsQd ZZ 1
We will use the above fact repeatedly in our paper
The following theorem is the main result of this paper
f  s sdsQd
Theorem 1 For any open set G  MS
lim inf
t
log P Rt  G   inf
and for any closed set C  MS
lim sup
t
log P Rt  C   inf
LINGJIONG ZHU
We will prove the lower bound in Section 2 the upper bound in Section 3 and
the superexponential estimates that are needed in the proof of the upper bound in
Section 4
Once we establish the level-3 large deviation result we can obtain the large
deviation principle for Ntt   directly by using the contraction principle
Theorem 2 Ntt   satises a large deviation principle with the rate function
I given by
QMS EQN 01x
Proof Since Q 7 EQN 0 1 is continuous R N 0 1dRt satises a large de-
viation principle with the rate function I by the contraction principle For a
discussion on contraction principle see for example Varadhan 12
N 0 1dRt 
Notice that
t Z t1
N 0 1stds
N s s  1ds 
N s s  1tds
N s s  1tds 
N t  1 t  N 0 1
For the lower bound for any open ball Bx centered at x with radius   0
 P cid18 N t  1 t
N 0 1dRt  B2xcid19
4cid19  P cid18 N1
For the upper bound for any closed set C and C SxC Bx
4cid19 
log P cid18 N1
N 0 1dRt  Ccid19
t  Ccid19  Pcid18Z
log P cid18 N t  1 t
 Pcid18 N t  1 t
4cid19  Pcid18 N1
Pcid18 Nt
lim sup
t
Finally by Lemma 20 we have the following superexponential estimates
4cid19 
4cid19  
Hence for the lower bound we have
lim inf
t
log P cid18 Nt
t
4cid19  lim sup
t  Bxcid19  Ix
t Z t1
N s s  1ds 
N t  1 t  N1
t R t1
0 N s s  1ds  Nt1N1
Z
t  Bxcid19  Pcid18Z
Pcid18 Nt
t cid20Z t
Nsds Z 1
t  N t1tN1
N 0 1dRt 
Nsdscid21 
 Hence
N t  1 t  N1
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
and for the upper bound we have
lim sup
t
log P cid18 Nt
t  Ccid19   inf
xC 
which holds for any   0 Letting   0 we get the desired result
cid3
2 Lower Bound
Lemma 3 For any    0      log  0
Proof Write      log  h  1  logi Thus it is sucient
to show that F x  x  1  log x  0 for any x  0 Note that F 0  F   0
and F x  1  1
x  0 when 0  x  1 and F x  0 when x  1 and nally
F 1  0 Hence F x  0 for any x  0
Lemma 4 Assume HQ   Then
EQN 0 1  C1  C2HQ
where C1 C2  0 are some constants independent of Q
Proof If HQ   then hQ
  for ae  under Q which implies
that Q
and thus At  At where At and At are the compensators of Nt
under Q
respectively For the theory of absolute continuity of point
processes and Girsanov formula see for example Lipster and Shiryaev 10 or Daley
 sds for some
 P 
and P 
 P 
cid3
 By the Girsanov formula
and Vere-Jones 4 Since At  R t
HQ  EQcid20Z 1
0  sds we have At  R t
    logcid16cid17 dscid21 
Notice that EQN 0 1 R R 1
dsdQ  Z Z 1
dsdQ
0 X s
hs   dsdQ  C
 Z h0N 0 1dQ  Z X 0
 h0  khkL1EQN 0 1  C
 h0  khkL1Z Z 1
dsdQ  C
h dQ  C
Therefore we have
On the other hand by Lemma 3
dsdQ  KC
  1KdsdQ  Kh0  khkL1Z Z 1
HQ Z Z 1
0 h     logi  1KdsdQ
 log K  1Z Z 1
  1KdsdQ
LINGJIONG ZHU
dsdQ  Kh0  khkL1Z Z 1
dsdQ  KC 
log K  1
Choose K  e and  
Kh0khkL1   We get
EQN 0 1 
1  Kh0  khkL1
log K  1Kh0  khkL1
cid3
Lemma 5 We have the following alternative expression for HQ
f sBF 
28 HQ 
CR0s1
EQcid20Z 1
Proof EQN 0 1   implies that EQ
N 0 1   for almost every  under
Q also P  h    since EQP  h   khkL1 EQN 0 1  
1  ef ds Z 1
f dNscid21 
EP 
N 0 1  EP  
 X 0s
 C  h0EP 
N 0 1   X 
hs   
 ds
h   
h0  we have EP 
Pick up   1
N 0 1  
ter 13 of Daley and Vere-Jones 4 if EQ
the compensators of Nt under Q
By the theory of absolute continuity of point processes see for example Chap-
N 0 1   then
0   sds are
respectively If thats the case we can
N 0 1 EP 
dQ
and P 
  sds for some  and there is Girsanov formula
if and only if At  At where At and At  R t
dP cid12cid12cid12cid12F 0
HQ  EQcid20Z 1
    logcid16cid17 dscid21 
  ds Z 1
logcid16cid17 dNs
 P 
write At R t
which implies that
For any f  f  1  ef    log     and equality is achieved when
f  log Thus clearly we have
f sBF 
CR0s1
EQcid20Z 1
1  ef ds Z 1
f dNscid21  HQ
On the other hand we can always nd a sequence fn convergent to log and
by Fatous lemma we get the other direction
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
Now assume that we do not have Q
for ae  under Q That
implies that HQ   We want to show that
EQcid20Z 1
CR0s1
f sBF 
 P 
1  ef ds Z 1
f dNscid21  
Let us assume that
f sBF 
CR0s1
EQcid20Z 1
1  ef ds Z 1
f dNscid21  
Let P 
We want to prove that HQ  
At  At   At and Q
 P 
For any f 
be the point process on 0 1 with compensator At   At Clearly
EQcid20Z 1
1  ef dAs   As  f d Ascid21
 EQcid20Z 1
1  ef f 0dAs   As  f f 0d Ascid21
 EQcid20Z 1
1  ef f 0dAs   As  f f 0d Ascid21
 EQcid20Z 1
dAs   Ascid21  EQcid20Z 1
 EQcid20Z 1
dAs   Ascid21  EQcid20Z 1
 C  h0  khkL1EQN 0 1
EQcid20Z 1
CR0s1
1  ef f 0dAs  f f 0d Ascid21
1  ef f 0dAs  f f 0d Ascid21
1  ef ds Z 1
f sBF 
f dNscid21  
Therefore
  lim inf
 lim inf
f sBF 
f sBF 
CR0s1
CR0s1
EQcid20Z 1
1  ef dAs   As  f d Ascid21
0  1  ef  f 
dAs   As dAs   As
 lim inf
EQhQ
 P 
 EQhQ
 P 
  HQ
by lower semicontinuity of the relative entropy h Fatous lemma and the fact
that P 
weakly as   0 Hence HQ  
  P 
cid3
Lemma 6 HQ is lower semicontinuous and convex in Q
LINGJIONG ZHU
Proof By Lemma 5 we can rewrite HQ as
f sBF 
CR0s1
EQcid20Z 1
EQcid20Z 1
1  ef   f dscid21
1  ef ds Z 1
f sBF 
CR0s1
f dNscid21 
If Qn  Q then EQn N 0 1  EQN 0 1 and Qn  Q weakly Since f  s 
C  R  BF 
0 f  sdNs is continuous on  and since f is uniformly
bounded R 1
0 f  sdNs  kfkLN 0 1 Hence
f  sdNscid21  EQcid20Z 1
EQncid20Z 1
as n   Next notice that
f  sdNscid21 
Let M  cid0P s hM s   cid1 where hM s  hssM  Then M  s 
0 M 1  ef sds  C Also R 1
C  R and thus R 1
0 M 1  ef sds 
K1  ekf kL N M 1 where K  0 is some constant Therefore
EQncid20Z 1
M 1  ef sdscid21  EQcid20Z 1
EQcid20Z 1
M 1  ef sdscid21  EQcid20Z 1
cid12cid12cid12cid12
 EQ1  ekf kL EQN 0 1Z 
n cid12cid12cid12cid12
EQncid20Z 1
EQncid20Z 1
 s1  ef sdscid21  EQcid20Z 1
M 1  ef sdscid21
1  ef sdscid21cid12cid12cid12cid12
1  ef sdscid21cid12cid12cid12cid12
 s1  ef sdscid21 
M 1  ef sdscid21  EQncid20Z 1
as M   Similarly we have
hsds  0
lim sup
M
The supremum is taken over a linear functional of Q which is continuous in Q
therefore the supremum over these linear functionals will be lower semicontinuous
Similarly since in the variational formula expression of HQ in Lemma 5 the
supremum is taken over a linear functional of Q HQ is convex in Q
cid3
lim sup
Lemma 7 HQ is linear in Q
0 measurable and a F 
Proof It is in general true that the process-level entropy function HQ is linear
in Q Following the arguments in Donsker and Varadhan 6 there exists a subset
0 measurable map Q  0  ME
0   which is F 
such that Q0  1 for all Q  MS and Q  Q  Q  1 for all Q  ME
Therefore there exists a universal version say Q
independent of Q such that
R Q
it also holds for
Q  MS Hence
Qd  Q Since that is true for all Q  ME
 P 
 P 
HQ  EQhhQ
1i  EQhh Q
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
ie HQ is linear in Q
cid3
In our paper we are proving the large deviation principle for Hawkes processes
started with empty history ie with probability measure P  But when time
elapses by t the Hawkes process generates points and that create a new history up
to time t We need to understand how the history that was created would aect
the future What we want to prove is some uniform estimates that if given the past
history which is well controlled then the new history will also be well controlled
This is essentially what the following Lemma 9 says Consider the conguration of
points starting from time 0 up to time t We shift it by t and denote that by wt
such that wt   where  is  restricted to R These notations will be used
in Lemma 9
Remark 8 At the very beginning of the paper we dened t It should not be
confused with wt in this section
Lemma 9 For any Q  ME such that HQ   and any open neighborhood
N of Q there exists some K 
   1 as    and
 and QK 
 such that   K 
log P w0Rt  N wt  K 
w0K
   HQ
lim inf
t
Proof Let us abuse the notations a bit by dening
  
 X  0s
hs   
For any t  0 since   c  0 and  is Lipschitz with constant  we have
dP 
dP w0cid12cid12cid12cid12F 0
Dene
w0  ds Z t
0 w0  ds Z t
hs   ds Z t
 X w0
w0cid19 dNs
logcid18 
logcid181  w0  
c X w0
hs   dNs
cid19 dNs
    N t 0  1  tt  0 
By the maximal ergodic theorem letting t denote the largest integer less or equal
to t we have
QK 
 c  Qcid18sup
 Qcid18sup
 Qcid18 sup
n1nN
EQN 0 1
 cid19
N t 0
N t  1 0
 cid19
 cid19
t  1
N n 0
LINGJIONG ZHU
as    Thus QK 
shows that
Fix any s  0 and   K 
   1 as   
  Since h is decreasing h  0 integration by parts
X 
hs  dN  0
hs    Z 
 Z 
 Z 
 hs  Z 
 hs  Hs
N  0hs  d
1  hs  d
hs  d
t hsds
where Ht R 
Therefore uniformly for  w0  K 
 X w0
hs   ds  2khkL1  2ut
0 Hsds and
where ut R t
c X w0
hs   dNs 
hs  HsdNs
Dene
t cid26 
Then uniformly in t  0
hs  HsdNs  2khkL1  utcid27 
2EQN 0 1
tc 
c  
t  1 as   
as    Thus inf t0 QK 
Hence uniformly for  w0  K 
 and   K 
dP 
dP w0cid12cid12cid12cid12F 0
 2khkL1  2ut  2khkL1  ut
 C1  C2ut
where C1  2khkL1  2khkL1 and C2  2  2
Observe that
Let Dt  Rt  N wt  K 
t
lim sup
 lim sup
t
Hsds  0
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
Uniformly for w0  K 
dP 
P w0 Dt
 etHQC1C2ut
 QDt  1
dQcid12cid12cid12cid12F 0
 etHQC1C2ut
 QDt  1
 C1  C2ut
 HQ   log
dQcid12cid12cid12cid12F 0
dP 
dP 
dP w0cid12cid12cid12cid12F 0
 HQ    K 
t  K 
  
Since Q  ME by ergodic theorem
t
QRt  N   1
and since  t  log dQ
satises
dP cid12cid12F 0
 t  s   t  t s EQ t  tHQ
for almost every  under Q
t
 HQ
dP 
dQcid12cid12cid12cid12F 0
   QK 
Since Q is stationary Qwt  K 
inf t0 QK 
big enough we conclude that
t  1 as    Remember that lim supt
   1 as    Also QK 
t 
t  0 By choosing 
lim inf
t
w0K
log P w0 Rt  N wt  K 
   HQ  
Since it holds for any   0 we get the desired result
cid3
Theorem 10 Lower Bound For any open set G
lim inf
t
log P Rt  G   inf
Proof It is sucent to prove that for any Q  MS HQ   for any
t log P Rt  N   HQ Since for every
neighborhood N of Q lim inf t
invariant measure P  MS there exists a probability measure P on the space ME
of ergodic measures such that P  RME
QP dQ for any Q  MS such that
HQ   without loss of generality we can assume that Q P
j1 jQj where
j  0 1  j   and P
j1 j  1 By linearity of H HQ P
j1 jHQj
Divide the interval 0 t into subintervals of length jt let tj 1  j   be the
right hand endpoints of these subintervals and let t0  0 For each Qj take K 
in Lemma 9 We have min1j QjK 
M   1 as M   Choose neighborhoods
LINGJIONG ZHU
Nj of Qj 1  j   such that S
P Rt  N   P Rt1  N1 wt1  K 
j1 jNj  N  We have
w0K
tj1 tj2
P w0 Rtj tj1  Nj wtj tj1  K 
Now applying Lemma 9 and the linearity of H
log P Rt  N   
lim inf
t
jHQj  HQ
cid3
3 Upper Bound
Remark 11 By following the same argument as in Donsker and Varadhan 6 if
 7 P 
is weakly continuous then
lim sup
t
log P Rt  A   inf
for any compact A If the Hawkes process has nite range of memory ie h has
compact support and is continuous then for any a  b if 
n   we have

cid12cid12cid12cid12cid12
n   sds Z b
a cid12cid12cid12cid12cid12cid12
 Z b
X 
hs     X 
n  P 
  sdscid12cid12cid12cid12cid12
hs   cid12cid12cid12cid12cid12cid12
ds  
as n   which implies that P 
If the Hawkes process does not have nite range of memory then we should use
the specic features of the Hawkes process to obtain the upper bound
Before we proceed let us prove an easy but very useful lemma that we will use
progressively measurable and predictable Then
repeatedly in the proofs of the estimates in this paper
Lemma 12 Let f  s be F 
0 f sdNsi  EheR t
Proof Since expnR t
0 2f  sdNs R t
Cauchy-Schwarz inequality
0 e2f s1sdsi12
0 e2f s  1 sdso is a martingale by
0 f sdNsi  Ehe
 EheR t
0 e2f s1sdsi12
0 2f sdNs 1
0 e2f s 1sds 1
0 e2f s 1sdsi
cid3
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
Let us dene CT as
CT cid26F  Z T
f  sdNs Z T
ef s  1 sds
f  s  BF 0
s   C  Rcid27
progressively measurable and predictable and f  s  BF 0
s progressively measurable predictable and also bounded
Here  s is F 
CR means that f is F 0
and continuous
Lemma 13 For any T  0 and F  CT  we have for any t  0
0 F sdsi  1
Proof For any t  0 writing s PkskT t F skT 
0 sdsi
EP hesi ds  1
EP he
0 F sdsi  EP he
EP he
by Jensens inequality and the fact that EP cid2escid3  1 by iteratively conditioning
since EP 
cid2eF cid3  1 for any 
Remark 14 Under P  the F 
progressively measurable rate function  is well
dened since it only creates a history between time 0 and time t Similary in
the proof in Lemma 13 EP 
the expectation is 1 given any history created between time 0 and t which is well
dened
cid3
0 F sds
0 F stds and 1
cid2eF cid3  1 for any  should be interpreted as
log EP cid20expcid26qcid12cid12cid12cid12
F stds 
cid27cid21  0
Lemma 15 For any q  0 T  0 and F  CT 
lim sup
Next we need to compare 1
t
F sdscid12cid12cid12cid12
f u sdNuds 
cid12cid12cid12cid12
F stds 
cid12cid12cid12cid12cid12
cid12cid12cid12cid12
ef us  1s ududs
It is easy to see that R T
0 f u sdNuds is F s
f u sdNuds Z T
f u stdNuds
F sdscid12cid12cid12cid12
f u stdNudscid12cid12cid12cid12cid12
ef ust  1st ududscid12cid12cid12cid12
sT -measurable and that
LINGJIONG ZHU
for any 0  s  t  T  Hence
cid12cid12cid12cid12cid12
f u sdNuds 
f u stdNudscid12cid12cid12cid12cid12
tT Z T
f u sdNuds 
N s s  T ds  kfkL
tT Z T
 kfkL
 kfkL
N t  T t  T   N t  T t  T t
 kfkL
N t  T t  T   N t  T T   N 0 T  
f u stdNuds
N s s  T tds
By Holders inequality and Lemma 20 we have
lim sup
t
log EP he 1
log EP he
 lim sup
t
0 f usdNuds 1
0 f ustdNudsi
kf kL
N tTtT N tTT N 0T i  0
Furthermore
cid12cid12cid12cid12cid12
ef us  1s ududs 
ef ust  1st ududscid12cid12cid12cid12cid12
s ududs
cid12cid12cid12
ef us  ef ustcid12cid12cid12
ef ust  1st u  s u duds
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
For the rst term
2ekf kL
2ekf kL
s ududs
s ududs
s ududs
cid12cid12cid12
ef us  ef ustcid12cid12cid12
tT Z T
cid12cid12cid12
ef us  ef ustcid12cid12cid12
tT Z T
tT Z T
 2ekf kL T C 
 X 0us
tT Z T
tT Z T
 2ekf kL T C 
 2ekf kL T C  2ekf kL Z t
 2ekf kL T C  2ekf kL T N 0 t  N t t  T h0
hu  s   
0 X 0us
 duds
N 0 s  T h0ds
2ekf kL
2ekf kL
N 0 u  sh0duds
hu  s   duds
Therefore
lim sup
t
log EP he
0 ef us ef us t sududsi  c
where c  0 as   0 Since it is bounded above for any c it is bounded
above by 0
For the second term
ef ust  1st u  s u duds
ekf kL  1
ekf kL  1
ekf kL  1
ekf kL  1
hu  s   cid12cid12cid12cid12cid12cid12
hu  s     X 0us
cid12cid12cid12cid12cid12cid12
X t0ust
tT Z T
 X t0us
tT Z T
 X 0us
 X t
hu  s   duds
hu  s   duds
hu  s   duds
LINGJIONG ZHU
Assume that h is decreasing and limz
ity twice we can estimate the second term above
z  0 By applying Jensens inequal-
ekf kL 1
tT R T
0 R us
husvdNvdudscid21
EP cid20e
T 2 Z t
T 2 Z t
0 R us
husvdNvdui ds
EP heekf kL 1 R T
tT Z T
EP heekf kL 1T R us
tT Z T
EP heR us
tT Z T
CThvdvi12
EP heCThN 0ush0i12
husvdNvi duds
eCThC
 eCThC EP heCThN 0tT h0i12
where C T h  exp2ekf kL  1T h0  1 Thus
lim sup
0 R us
kf kL 1
tT R T
log EP cid20e
t
Similarly we can estimate the rst term
For the third term by Jensens inequality we have
husvdNv dudscid21  0
0  P t  hus dudscid21
EP heexpkf kL 1 R t
0 P t  hus dsi du
kf kL 1
EP cid20e
 EP heexpkf kL 1 R t
 EP heexpkf kL 1 R t
0 P t  hs dsi
k0 hskttudNudsi
Since we assume that h is decreasing R k1t
hs  kt  t  u  hs  t  u 
Let C f   expkfkL  1 and Ht R 
hsds  thk  1t Thus
t Z 
stu
hvdv
t hsds Then
0  Cf 
EP heexpkf kL 1 R t
 EP heCf  R t
 EP heR t
EP heR t
0  Cf 
Notice that
k0 hskttudNudsi
t HstudNudsCf  R t
0 HstudsdNuR t
0 HstudsdNui  EP he Cf 
0 hstudsdNui
0 Cf hstudsdNui 
0 HsdsNti 
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
0 Hsds  0 as t   which implies that
0  Cf 
lim sup
t
log EP heR t
0 HsudsdNui  0
where Cf 
Moreover
0 eR t
2 C R t
2 C R t
0 e2 R t
0 e2 R t
0 Cf hstudsdNui
0 Cf hstuds 1udui12
0 Cf hstuds 1duEP heR t
EP heR t
 EP heR t
Notice that it holds for any   0 and 1
which implies that
0 2Cf hstuds 1 P u hu dui12
L1 1 P u hu dui12
0 e2Cf Htu 1duEP heR t
L1 1khkL1 Nti12
0 e2Cf Hu 1duEP hee2Cf khk
0 e2Cf Hu  1du  0 as t  
0 Cf hstudsdNui  0
log EP heR t
Putting all these thing together and applying Holders inequality several times
0 e2Cf khk
lim sup
2 C R t
t
we get for any q  0 T  0 and F  CT 
lim sup
t
log EP cid20expcid26qcid12cid12cid12cid12
F CT Z
T 
Lemma 16 We have
F stds 
cid27cid21  0
F sdscid12cid12cid12cid12
cid3
F Qd  HQ
Proof Assume HQ   For any   0 there exists some f such that
EQcid20Z 1
fdNs Z 1
We can nd a sequence fT  Bcid16F T 1
ef  1dscid21  HQ  
cid17 C R  f as T   By Fatous
lim inf
T 
F Qd
T 
 lim inf
efT  1dscid21  HQ  
If HQ   then for any M  0 there exists some fM such that
fT dNs Z 1
fM dNs Z 1
efM  1dscid21  M
Repeat the same argument as in the case that HQ  
F CTZ
EQcid20Z 1
EQcid20Z 1
cid3
LINGJIONG ZHU
Lemma 17 For any compact set A
lim sup
t
log P Rt  A   inf
Proof Notice that
EP heN 0ti  EP hee21 R t
0 sdsi12
By choosing   0 small enough we have EP 
C  0 Therefore
 EP hee21h0N 0tCe21i12
eN 0t  eCt for some constant
lim sup
lim sup

t
log P  N 0 t  t  
which implies by comparingR N 0 1dRt and N 0 tt and the superexponential
estimates in Lemma 20
lim sup
lim sup

t
log P cid18Z
N 0 1dRt  cid19  
Therefore we need only to consider compact sets A such that for any Q  A
EQN 0 1  
Now for any A compact consisting of Q with EQN 0 1   and for any F  CT
and for any p q  1 1
q  1 by Holders inequality Chebychevs inequality and
Lemma 13
P Rt  A
 EP he
 EP he
 EP he
pT R t
By Lemma 15 we have
lim sup
t
0 F stdsi  expcid26
0 F sdsi1p
EP he
pT R t
 expcid26
0 F sdsi1q
log P Rt  A  
0 F stdsR t
QAZ
 expcid26
QAZ
F Qdcid27
0 F stdsR t
0 F sdsi1q
F Qdcid27
QAZ
F Qd
F Qdcid27
Since it holds for any p  1 we get
lim sup
t
For any compact A given Q  A and   0 by Lemma 16 there exists TQ  0
and FQ  CTQ such that 1
2  Since the linear
integral is a continuous functional of Q see the proof of Lemma 6 there exists
a neighborhood GQ of Q such that
log P Rt  A   inf
TQ R FQQd  inf AQ HQ  1
F Qd
Q  GQ Since A is compact there exists GQ1      GQ such that A  S
TQ R FQQd  inf AQ HQ   for all
F Qd  inf
HQ  
j1 GQj 
1j
F CT
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
Note that for any A B
lim sup
t
log P Rt  A  B
 maxcid26lim sup
t
log P Rt  A lim sup
t
log P Rt  Bcid27 
j1 Gj
Thus for A S
lim sup
t
log P Rt  A   inf
1j
F CT
T Z F Qd
Hence lim supt
t log P Rt  A   infQA HQ for any compact A
cid3
Theorem 18 Upper Bound For any closed set C
lim sup
t
log P Rt  C   inf
Proof For any closed set C and compact An which is dened in Lemma 25 we
lim sup
t
log P Rt  C
 maxcid26lim sup
t
log P Rt  C  An lim sup
t
log P Rt  Anccid27 
Since C  An is compact by Lemma 17
lim sup
log P Rt  C  An   inf
QCAn
HQ   inf
t
Furthermore by Lemma 24 we have
t
t
lim sup
 lim sup
 max
log P Rt  Anc
log P 
j jj
Rt 
log P cid18 1
N 01jstds  jcid19 
maxcid26 lim sup
log P cid18 1
N 01j2stds  1jg1jcid19 
log P cid18 1
N 0 1N 01stds  mcid19cid27  
as n   Hence we have
lim sup
lim sup
lim sup
t
t
t
t
log P Rt  C   inf
cid3
LINGJIONG ZHU
4 Superexponential Estimates
In order to get the full large deviation principle we need the upper bound in-
equality valid for any closed set instead of for any compact set which requires some
superexponential estimates
Lemma 19 For any q  0
EP heq R t
0 htsdNsi  EP heR t
lim sup
t
log EP heq R t
0 htsdNsi  0
0 e2qhts 1P0 s hs dsi12
0 e2qhts 1dsi12
 EP heCh0Nt R t
0 e2qhs  1ds  L1 since h  L1 Therefore
log EP heq R t
0 htsdNsi  c
Note that R t
0 e2qhts  1ds R t
lim sup
t
where c  0 as   0 Since it holds for any  we get the desired result
Lemma 20 For any q  0 and T  0
cid3
lim sup
t
Therefore for any   0
log EP heqN ttT i  0
lim sup
t
log P  N t t  T   t  
Proof By Holders inequality
EP heqN ttT i  EP hee2q1 R tT
P0 s hs dsi12
2 e2q 1CT  EP hee2q1h0N ttT e2q1 R t
2 e2q 1CT  EP he2e2q1h0N ttT i14
0 htsdNsi14
2 e2q 1CT  EP he2e2q1 R t
he2e2q1 R t
Choose   q2e2q  1h01 Then
EP heqN ttT i34
By Lemma 19 we get the desired result
0 htsdNsi12
0 htsdNsi14
cid3
Lemma 21 We have the following superexponential estimates
i For any   0
lim sup
lim sup
t
log Pcid18 1
N 02sds  cid19  
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
ii For any   0
lim sup
M
lim sup
t
iii For any   0
lim sup
lim sup

t
Proof i Let us dene
log P cid18 1
N 01M sds  cid19  
log P cid18 1
N 0 1N 01sds  cid19  
N0 t Z t
s dNs
s dNs
N 0 t Z t
Then N 0 t  N0 t  N0 t and N0 t has compensator R t
and N0 t has compensator R t
0 ss ds Notice that
N 02  N 02   N 01
0 ss ds
It is clear that N is dominated by the usual Poisson process with rate  By
Lemma 22
lim sup
lim sup
t
On the other hand
log P cid18 1
N 02sds 
2cid19  
 N 01sds 
 N ss1ds
Ns s  ds
 Z t
N0 sds 
 N 0 t  N t t  
N0 sds
By Lemma 20 we have
lim sup
t
log P cid18 1
N t t   
4cid19  
for any   0 Hence
lim sup
lim sup
t
log P cid18 1
N t t   
4cid19  
Finally for some positive h to be chosen later
P cid18 1
N0 t 
4cid19  Eheh N 0ti eth4
 Ehee2h 1 R t
0 ss dsi12
eth4
Let f z  z
the denition of s and abusing the notation a little bit we see that s  Zs
z  Then f z   as z   Let Zs P 0s hs   Then by
LINGJIONG ZHU
Since  is increasing its inverse function 1 exists and 1   as   
We have
Ehee2h 1 R t
0 ss dsi12
 Ecid20ee2h 1 R t
 Ee
e2h 1 R t
0 ZsZs 1 dscid2112
z f 1 z
0 Zs
f Zs 
h 
Then h   as    and
It is clear that lim inf z f 1z   Choose
f 1z  1cid21 
logcid20 inf
e2h 1 R t
z f 1 z
0 Zs
z
f Zs 
0 Zsdsi12
0 P 0s hs dsi12
 EheR t
 EheR t
 EhekhkL1 Nti12
4cid19  
N0 t 
lim sup

lim sup
lim sup
t
log P cid18 1
ii It is easy to see that iii implies ii
iii Observe rst that
N s s  1N ss1  Ns s  1N ss1 
 Ns s  1 N ss1 
N ss1 
 N ss1 
For the rst term notice that N is dominated by a usual Poisson process with
rate  Thus by Lemma 23
424 lim sup
lim sup

t
log P cid18 1
Ns s  1N ss1 
ds 
4cid19  
For the second term Ns s  1 N ss1 
2  Ns s  1 and
By Lemma 20
Ns s  1ds  N0 t  N t t  1
lim sup
t
log P cid18 1
N t t  1 
8cid19  
and by the same argument as in i
lim sup

lim sup
lim sup

t
log P cid18 1
N0 t 
8cid19  
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
For the third term notice that
N ss1 
ds Z t
N s s  1N ss1 
ds
We can get the same superexponential estimate as before Finally for the fourth
 N ss1 
ds Z t
Ns s  1ds
We can get the same superexponential estimate as before
cid3
Lemma 22 Assume Nt is a usual Poisson process with constant rate  Then
for any   0
lim sup
lim sup
t
log Pcid18 1
N ss2ds  cid19  
Proof Let f    1
h N 02 where h is to be chosen later By Jensens
inequality and stationarity and independence of increments of Poisson process we
 R 
0 Pt
ePt
j0 f sjdsi
j0 f sjds
 f sdsi  Ehe
 E 1
 Z 
 EhePt
j0 f ji
 Ehef it1
ne1h1  e  e  e  eot1
 M e1h22  1t1
for some M   0 Choose h 
log1  Thus
lim sup
t
for some M  0 Therefore by Chebychevs inequality
 f sdsi  M   1t1  eMt
htZ t
N ss2ds 
log Pcid18 1
hcid19  M 
which holds for any   0 Letting   0 we get the desired result
Lemma 23 Assume Nt is a usual Poisson process with constant rate  Then
for any   0
cid3
lim sup
lim sup

t
log P cid18 1
N 0 1N 01sds  cid19  
LINGJIONG ZHU
Proof Let h be some function of  to be chosen later Following the same
argument as in the proof of Lemma 22 we have
eht
N 0 1N 01sds  htcid19
0 N 01N 01sdsi eht
Pcid18hZ t
 Eheh R t
 EhehN 01N 01it1
PN 0 1   
1  C1
n1  C2ehloglogot1
kt1
ehklogklogkkt1
ehke k
eht
eht
eht
cid3
Choosing h  log12 will do the work
The following Lemma 24 provides us the superexponential estimates that we
need These superexponential estimates have basically been done in Lemma 21
The dierence is that in the statement in Lemma 21 we used  and in Lemma 24 it
is changed to t which is what we needed Lemma 24 has three statements Part i
says if you start with a sequence of simple point processes the limiting point process
may not be simple but that has probability that is superexponentially small Part
ii is the usual superexponential we would expect if MS were equipped with
weak topology But since we are using a strengthened weak topology with the
convergence of rst moment as well we will also need Part iii
Lemma 24 We have the following superexponential estimates
t
lim sup
lim sup
N 02stds  gcid19  
i For some g  0 as   0
log Pcid18 1
ii For some M   0 as M  
log Pcid18 1
iii For some m  0 as   
log P cid18 1
N 0 1N 01stds  mcid19  
N 01M stds  M cid19  
lim sup
M
lim sup
lim sup
lim sup

t
t
Proof We can replace the  in the statement of Lemma 21 by g M  and m
by a standard analysis argument We can also replace the  in Lemma 21 by t
here since
N 02stds Z t
cid12cid12cid12cid12
N 01M stds Z t
cid12cid12cid12cid12
N 02sdscid12cid12cid12cid12
N 01M sdscid12cid12cid12cid12
 2
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
N 0 1N 01stds Z t
N s s  1ds Z t
cid12cid12cid12cid12
 N t  1 t  1  N t  1 t  1t
 N t  1 t  1  N t  1 t  N 0 1
N 0 1N 01sdscid12cid12cid12cid12
N s s  1tds
By Lemma 20 we have the superexponential estimate for any   0
lim sup
t
log P cid18 1
t N t  1 t  1  N t  1 t  N 0 1  cid19  
cid3
Lemma 25 For any  M  0   0 dene
A  Q  MS  QN 0   2  g 
AM  Q  MS  QN 0 1  M   M  
N 0 1dQ  m 
A Q  MS ZN 01
where M   0 as M   m  0 as    and g  0 as   0 Let
AM  A  AM  A and
j jj
Then An is compact
Proof Observe that for   0
445 K 
  N kk  1  k  N k  1 k  k
are relatively compact sets in  Let K be the closure of K which is then
compact
For any Q  An QN 0 1  M   M  for any M  n We can choose  big
enough and an increasing sequence k such that 1  n and  P
k1 k  0
LINGJIONG ZHU
as    uniformly for Q  An
Qcid16K
N kk  1  k  N k  1 k  k
ccid17  QK c
 Q  
QN k  1k    QN k  1 k  k
k  0
QN 0 1  k
as    Therefore An is tight in the weak topology and by Prokhorov theorem
An is precompact in the weak topology In other words for any sequence in An
there exists a subsequence say Qn such that Qn  Q weakly as n   for
some Q By the denition of An Qn are uniformly integrable which implies that
R N 0 1dQn R N 0 1dQ as n   It is also easy to see that An is closed by
j jj is closed That implies that Q  An Finally we need to
checking that each A 1
check that Q is a simple point process Let Ij  j  1 j We have for any
Q  An
t  k k  N t t  2
Q t  N t t  2  Q  
k1 0
jk1
Xjk1
m mn2kg
m mn
    Ij  2
Q  Ij  2
Hence An is precompact in our topology Since An is closed it is compact
cid3
5 Concluding Remarks
In this paper we obtained a process-level large deviation principle for a wide
class of simple point processes ie nonlinear Hawkes process Indeed the methods
and ideas should apply to some other simple point processes as well and we should
expect to get the same expression for the rate function HQ For HQ   it
PROCESS-LEVEL LDP FOR NONLINEAR HAWKES POINT PROCESSES
should satisfy
HQ ZZ 1
 s   s  log   s
 s  sdsQd
where  s is the intensity of the underlying simple point process Now it would
be interesting to ask for what conditions for a simple point process would guarantee
the process-level large deviation principle that we obtained in our paper First we
have to assume that  t is predictable and progressively measurable Second
from the proof of the upper bound in our paper the key assumption we used
about nonlinear Hawkes processes was that limz
z  0 That is crucial to
guarantee the superexponential estimates we needed for the upper bound If for a
simple point process we have  t  F N t  for some sublinear function F 
we would expect the superexponential estimates still works for the upper bound
Third it is not enough to have  t  F N t  for sublinear F  to get the
full large deviation principle The reason is that in the proof of lower bound in
particular in Lemma 9 we need to use the fact that if  t has memory the
memory will decay to zero eventually over time For nonlinear Hawkes process
0 htdt   which is crucial in the
proof of Lemma 9 Indeed for any simple point process P  if you want to dene
P 
 the probability measure conditional on the past history  to make sense
of it you have to have some regularities to ensure that the memory of the history
will decay to zero eventually over time From this perspective nonlinear Hawkes
processes form a rich and ideal class for which the process-level large deviation
principle holds
this is guaranteed by the assumption that R 
Acknowledgements
The author is enormously grateful to his advisor Professor S R S Varadhan
for suggesting this topic and for his superb guidance understanding patience
and generosity The author also wishes to thank an anonymous referee for helpful
suggestions The author is supported by NSF grant DMS-0904701 DARPA grant
and MacCracken Fellowship at NYU
References
1 E Bacry S Delattre M Homann and J F Muzy Scaling limits for Hawkes processes and
application to nancial statistics Preprint 2011
2 C Bordenave and G L Torrisi Large Deviations of Poisson Cluster Processes Stochastic
Models 23 2007 593-625
3 P Bremaud and L Massoulie Stability of nonlinear Hawkes processes Annals of Probability
24 1996 1563-1588
4 D J Daley and D Vere-Jones An Introduction to the Theory of Point Processes 1st Edition
Springer-Verlag New York 1988
5 A Dembo and O Zeitouni Large Deviations Techniques and Applications 2nd Edition
Springer New York 1998
6 M D Donsker and S R S Varadhan Asymptotic evaluation of certain Markov process
expectations for large time IV Communications of Pure and Applied Mathematics 36 1983
183-212
7 J Grandell Point processes and random measures Advances in Applied Probability 9 1977
502-526
8 A G Hawkes Spectra of some self-exciting and mutually exciting point processes Biometrika
58 1971 83-90
9 T Liniger Multivariate Hawkes processes PhD thesis ETH 2009
LINGJIONG ZHU
10 R S Lipster and A N Shiryaev Statistics of Random Processes II Applications 2nd Edi-
tion Springer 2001
11 G Stabile and G L Torrisi Risk processes with non-stationary Hawkes arrivals Methodol
Comput Appl Prob 12 2010 415-429
12 S R S Varadhan Special invited paper large deviations Annals of Probability 36 2008
397-419
13 S R S Varadhan Large Deviations and Applications SIAM 1984
14 L Zhu Large deviations for Markovian nonlinear Hawkes processes to appear in Annals of
Applied Probability
15 L Zhu Central limit theorem for nonlinear Hawkes processes Journal of Applied Probability
50 2013 760-771
Courant Institute of Mathematical Sciences
New York University
251 Mercer Street
New York NY-10012
United States of America
E-mail address lingcimsnyuedu
