N-Body Simulations of Collective Eects in Spiral and
Barred Galaxies
Xiaolei Zhang
School of Physics Astronomy and Computational Sciences George Mason University
4400 University Drive Fairfax VA 22030 USA xzhang5gmuedu
Abstract
We present gravitational N-body simulations of the secular morphological
evolution of disk galaxies induced by density wave modes In particular we
address the demands collective eects place on the choice of simulation pa-
rameters and show that the common practice of the use of a large gravity
softening parameter was responsible for the failure of past simulations to
correctly model the secular evolution process in galaxies We also demon-
strate that the secular evolution rates measured in our improved simulations
agree to an impressive degree with the corresponding rates predicted by the
recently-advanced theories of dynamically-driven secular evolution of galax-
ies The results of the current work besides having direct implications on
the cosmological evolution of galaxies also shed light on the general question
of how irreversibility emerges from a nominally reversible physical system
Keywords galaxies evolution galaxies structure galaxies spiral
1 INTRODUCTION
11 Self-Organization in Nonequilibrium Systems
Understanding the self-organization behavior of nonlinear far from equi-
librium systems is among the most challenging of problems of contemporary
research This multi-disciplinary study is relevant to answering many key
questions in condensed matter physics biological and life sciences social
sciences as well as the processes of structure formation in the universe
Several leading scientists of the 20th century considered the exploration
of collective behaviors or the processes of morphogenesis to be of central im-
portance to the future advancement of science More than half a century ago
Preprint submitted to Astronomy and Computing
February 25 2016
Richard Feynman closed volume II of The Feynman Lectures on Physics by
declaring The next great era of awakening of human intellect may well pro-
duce a method of understanding the qualitative content of equations Today
we cannot Today we cannot see that the water ow equations contain such
things as the barber pole structure of turbulence that one sees between rotat-
ing cylinders Today we cannot see whether Schrodingers equation contains
frogs musical composers or morality  or whether it does not Feynman
Leighton  Sands 1964 PW Anderson a noted condensed matter physi-
cist penned an inuential article for Science entitled More is dierent
Anderson 1972 in which he called attention to the hierarchical organiza-
tion of physical systems and the ability of many-degrees-of-freedom systems
to form emergent structures and dynamics which break the symmetries of
equations describing the underlying micro-dynamics
Among the studies on morphogenesis one of the most prophetic is that
of Ilya Prigogine
In his theory of dissipative structures Prigogine em-
phasized the entropy-production-enhancing function of self-organized global
patterns in far-from-equilibrium systems as well as the constructive role of
dissipation in maintaining these patterns Prigogine 1980 To paraphrase
this theory most of the self-organized structures in nature come in roughly
two types 1 equilibrium structures which are formed through equilibrium
phase transitions The examples of equilibrium structure formation include
the phase transition of water to form ice when the temperature is lowered
to zero degree Celsius as well as the formation of minerals of a specic
crystal structure when the environmental temperature and pressure satisfy
a range of conditions ie
the formation of diamond crystal from carbon
in a high pressure environment 2 nonequilibrium structures which are
formed in systems far from equilibrium and which in addition to sharing
some common features with structures formed in equilibrium phase transi-
tions have the added feature that these self-organized structures are gener-
ally in a dynamical equilibrium state meaning they are sustained through
the competition of growth and decay tendencies as highlighted by the well-
known uctuation-dissipation theorem proved mostly at close-to-equilibrium
regimes but is also valid at far-from-equilibrium situations for self-organized
dissipative structures There is in general also a continuous ux of energy
and entropy through the system to maintain the nonequilibrium uctuation
The formation of self-organized dissipative structures in nonequilibrium sys-
tems often serves the important function of greatly accelerating the speed of
entropy evolution of the parent systems Prigogine 19801
The hierarchy of self-organization processes in a nonequilibrium system
often leads to a series of eective singularities in the dynamics which allow
emergent new dynamics to form that cannot be deductively derived from the
dierential formulation one starts the analysis with A synthetic approach
uniting the various local aspects to achieve global self-consistency will need
to be adopted The correlations among the uctuations of the individual
degrees of freedom of the many-body system are shown to play a crucial
constructive role at the juncture of nonequilibrium phase transitions
Although the mechanism for the generation of new dynamics through so-
called spontaneous breaking of gauge symmetry had been routinely pro-
posed in high energy physics it was mostly used in a model context rather
than derived from rst principles in a self-consistent fashion Quoting once
again condensed matter physicist PW Anderson  the concept of bro-
ken symmetry has been borrowed by the elementary particle physicists but
their use of the term is strictly an analogy whether a deep or a specious one
remaining to be understood Anderson 1972 On the other hand the fact
that as of now there have been very few examples of self-organized dissipa-
tive systems being analysed from rst principles in Prigogines work chem-
ical clock was used as one prominent example is partly due to the intrinsic
complexities of such problems ie the many degrees of freedom of the com-
ponents and the correlations among the components which invalidate many
basic assumptions underlying the usual kinetic theory approach for treat-
ing many-particle systems One of the most important assumptions used in
the derivation of the Boltzmann kinetic equation is the so-called molecular
chaos assumption see eg Kreuzer 1981 for a detailed description of the
BBGKY procedure for the derivation of the collisional Boltzmann equation
or the assumption that particle collisions are uncorrelated This assumption
is crucial to Boltzmanns arriving at his famous H-theorem or that entropy
1The transportation of entropy to its environment is the chief reason a dissipative struc-
ture can maintain a low or constant entropy state despite it being a very ecient engine
at the local production of entropy This aspect also resolves the paradox of how nature
can generate complex biological entities such as human being as a result of nonequilibrium
evolution despite being governed by the second law of thermodynamics universally The
study of nonequilibrium dissipative structures tells us that entropy increasing evolution
does not always mean the rush towards homogeneity everywhere at least not for open
many degree-of-freedom far-from-equilibrium systems
never decreases in nonequilibrium processes The inter-particle correlations
however are the necessary ingredient for obtaining self-organized behavior
and their re-introduction into the study of nonequilibrium dynamics allows
local-entropy-decreasing processes to be admitted into the analyses
N-body simulations of self-gravitating systems in our case the simulation
of disk galaxies containing self-organized density wave patterns oer a rare
chance to observe at close range the modication of dierential dynamics
to arrive at new ie emergent meta-laws thus oer clues to the common
features of spontaneous symmetry breaking processes in many-degrees-of-
freedom dynamics In this case an added advantage is that a parallel the-
oretical development has also been accomplished in the past few decades
which can serve as standards of comparison with the simulation results
12 Secular Evolution of Galaxies in the Context of Nonequilibrium Phase
Transition
The striking coherence of spiral and bar patterns in disk galaxies has long
captured our awe and fascination but it was only since the advent of density
wave theory Lindblad 1963 Lin  Shu 1964 Kalnajs 1965 that these pat-
terns were understood as propagating waves of over-density in dierentially
rotating galaxy disks2
As the study of density waves in galaxies progressed over the past few
decades the propagating wave picture of the initial studies further evolved
into a modal view in which the oppositely-propagating trains of density wave
in the radial direction superpose to form growing density wave modes Lin 
Lau 1979 and the references therein Bertin et al 1989ab In this formula-
tion the so-called grand-design spirals and bars observed in nearby galaxies
were regarded as spontaneously growing modes in a galactic resonant cav-
ity whose properties are characterized by the axisymmetric distributions of
disk-mass surface density stellar and gaseous velocity dispersions as well as
the overall gravitational potential eld which include contributions not only
from the disk mass but also from the more spherically distributed luminous
2The publication of the rst round of density wave papers followed shortly after the
appearance of the rst volume of The Feynman Lectures on Physics in which Feynman
suggested to the freshman and sophomore physics students in his class Incidentally if
you are looking for a good problem the exact details of how the arms are formed and what
determines the shapes of these galaxies has not been worked out Feynman Leighton 
Sands 1963
and dark halos as well as the galactic bulge which together form the so-
called basic state of the galactic disk upon which the wave modes grow as
unstable harmonic perturbations3
During the early decades of density wave study the basic state of the
galactic disk was treated as a stationary background from which the unstable
trains and modes of density waves were calculated to varying orders of ap-
proximation according to the orderings of either the degree of non-linearity
or else the degree of locality in the successive WKBJ approximations The
prospect of the secular evolution of the mass distribution of the basic state
itself was never seriously considered apart from phenomenological inferences
of the possible role of gas accretion Kormendy 1979 As we know gaseous
mass in galaxies forms only a small percentage of the total disk mass and
the disk mass in most intermediate- and early-type galaxies was dominated
by stellar mass Therefore a signicant transformation of the Hubble type of
a galaxy during its lifetime will necessarily involve the secular redistribution
of the stellar mass in conjunction with the redistribution of the gas mass
The long-held view that the stellar disks of galaxies remain mostly un-
changed throughout a galaxys lifetime is partly a result of the belief that
stars behave adiabatically during their orbital motion and do not dissi-
pate their orbital energy when interacting with a stationary density wave
except at the waveparticle resonances Lynden-Bell  kalnajs 1972  a be-
havior summarized by the well-known conservation of the Jacobi integral
of a single stars orbit in the rotating frame of a stationary wave pertur-
bation Binney  Tremaine 2008 Another often-used phrase to describe
this quasi-stability of the stellar orbit is the so-called angular momentum
barrier to secular redistribution of stellar mass in a disk galaxy
Observationally there is growing evidence that galaxy morphology does
evolve signicantly throughout the cosmic history in general following the
trend from a disk-dominated late-Hubble-type to a bulge-dominated earlier-
Hubble-type Zhang 2003 Kormendy  Kennicutt 2004 as well as the ref-
erences therein Though galaxy mergers had previously been proposed as
responsible for a large fraction of galaxy Hubble-type evolution there are
strong dynamical reasons why mergers cannot be responsible for most of the
observed morphological evolution of disky galaxies Zhang 2003 2008 as well
3The basic state of the galactic disk is formally equivalent to the so-called boundary
condition in an electromagnetic resonant cavity
as the references therein Boxy early-type disk galaxies and especially the
massive cD-type galaxies in the central regions of dense clusters are the only
prime candidates for the merger mechanism of disk-galaxy morphological
evolution
How then could stars in disk galaxies overcome the angular momentum
barrier break the constraint of the conservation of the Jacobi and initiate
signicant redistribution of stellar mass during the lifetime of a galaxy As
it turned out the answer had much to do with the dynamics of the self-
organization process which formed the global density wave patterns in the
rst place as well as with the theory of dissipative structures Zhang 1996
1998 1999 hereafter Z96 Z98 Z99 respectively showed that stars in galaxy
disks possessing spontaneously-formed nonaxisymmetric density wave modes
such as spirals and bars are able to display dissipation-like behavior just like
their gaseous counterpart4 as long as the collective mutual interactions of the
stars are taken into account The conservation of the Jacobi integral for a
single stars orbit is shown to be purely a consequence of having treated such
an orbit as passively responding to an applied potential eld which ignored
the mutual interactions of stars in a self-sustained density wave mode The
passive treatment does not incorporate the graininess eect of the spiral and
bar potential which reects the inherent correlations among the orbits of the
stars as well as gas clouds
The detailed analyses of the workings of collective eects in spiral and
barred galaxies were previously presented in Z96 and Z98 For a quick re-
hash we look into the dynamical processes in galaxies from both the global
and the local points of view  and ultimately these two views need to give
consistent results for spontaneously-formed and self-sustained density wave
modes Globally modal formation is due to the fact a galaxy disk con-
taining a density wave mode is generally more energetically favorable than
the axisymmetric basic state from which the mode emerges Therefore the
marginally axisymmetrically stable galactic disk formed from the primor-
dial collapse and dissipation of the gas clouds is unstable to the formation
4In fact as it turned out gas also achieves ecient secular mass redistribution through
the same gravitational torque mechanism as stars Z98 since its participation in the
interaction with the density wave is mostly through the scattering of clouds The micro-
scopic viscosity in the cloud medium can be shown to be entirely insignicant compared
to cloud scattering which has much greater mean-free-path to the secular redistribution
of gas mass in a galaxy disk environment
of nonaxisymmetric spiral or bar modes From another perspective modal
growth is due to the fact that the galactic resonant cavity for propagating
density waves has a positive gain for the wave amplitude during each round
trip of the wave-train propagation between the corotation circle and the inner
galaxy The wave amplication happens mostly near the corotation region
through the so-called over-reection of the outward propagating wave train
to become an inward propagating wave train of higher amplitude and the
accompanying transmission of angular momentum across the corotation ra-
dius to a third wave branch which propagates to the outer disk to dissipate
the energy and angular momentum to the environment5
Figure 1 shows a schematic of the wave amplication process Mark 1976
Toomre 1981 The over-reection mechanism at corotation removes angu-
lar momentum from the waves inside corotation and delivers it to outside
corotation to be dissipated in the outer disk Due to the change of sign of
wave angular momentum density across the corotation radius this angular
momentum redistribution process through the wave propagation and over-
reection at corotation causes the wave branches both inside and outside
corotation to grow indenitely if no nonlinear and dissipative mechanism
are present to counter the growth tendency
The global spontaneous growth tendency of the unstable mode in realistic
galaxy disks is counter-acted by the local dissipation at the spiral or bar arm
locations since each time as disk material crosses the arm density wave crest
during its circum-galactic rotation it loses angular momentum to the wave
potential eld through the mediation of a collisionless shock Z96 for matter
inside the corotation radius The sense of angular momentum transmission
is reversed ie
from the wave to the disk matter for the orbiting matter
outside corotation This angular momentum exchange between the wave and
the basic state disk matter is of the correct sense both inside and outside
corotation to lead to the damping of the growing wave amplitude since
the wave has negative angular momentum density with respect to the basic
state upon receiving angular momentum from the disk matter its amplitude
5Note that an idealized density wave mode rotates in the azimuthal direction with a
xed pattern speed and since the galaxy disk itself possesses dierential rotation the
disk matter rotates faster than the density wave inside the corotation radius and thus
overtakes the density wave and vice versa outside corotation The wave thus have nega-
tive angular momentum density inside corotation relative to the basic state and positive
angular momentum density relative to the basic state outside corotation
Figure 1 Schematic of the wave propagation and amplication in the galactic resonant
cavity to form innitely-growing density wave modes The symbols  and p denote the
galaxy or disk matter circularangular speed and density wave pattern speed respec-
tively Inside the corotation radius the stars overtake the wave during their circulation
around the galaxy and vice versa outside corotation Here the circle with radius rco is
the corotation circle The numbers next to the arrows indicate the normalized amount
of wave angular momentum relative to the basic state for the respective segment of the
outward propagating incoming and inward propagating over-reected wave trains in-
side corotation as well as the outward propagating transmitted wave train outside the
corotation radius Note that the over-reection process conserves angular momentum
which we can check by summing the two numbers after the over-reection process -2
and 1 and compare the result with the number before the over-reection process -1
The feedback loop is completed by an inner Q-barrier usually identied with the galactic
bulge region where the inward-propagating wave train gets turned around to become the
outward propagating wave train for the next cycle of over-reection at corotation This il-
lustration is for the milder version of the over-reection mechanism WASER Mark 1976
For the SWING mechanism Toomre 1981 the over-reection factor can be signicantly
bigger than the factor of 2 illustrated here The SWING and WASER mechanisms dier
by whether the incoming wave train towards corotation is that of the leading or the trail-
ing type respectively produced in turn by either the inward-propagating trailing wave
tunneling through the central region of the galaxy when no Q-barrier exists and emerging
as a leading wave or else by the inward-propagating trailing wave being reected by the
Q-barrier when one exists which produces an outward-propagating trailing wave The
SWING mechanism tends to produce bar-like modes and the WASER mechanism spiral
decreases Similarly the sense of angular momentum exchange and the sign
of angular momentum density of the wave outside corotation lead to the
damping of the wave outside corotation as well Eventually at suciently
nonlinear amplitude the wave mode achieves a quasi-steady amplitude and
the galaxy settles into a dynamical equilibrium state Z98
This equilibrium is called dynamical because it is maintained through the
competition of opposing tendencies of wave-mode growth and damping and
is maintained also at the expense of dissipative secular evolution of the basic
state mass distribution the disk matter inside corotation upon giving an-
gular momentum to the wave at each arm crossing spirals slightly inward
and the matter outside corotation spirals slightly outward after each arm
crossing The dissipative secular evolution of the basic state allows the ac-
complishment of another mission of dissipative structures that of enhanced
entropy production and export by these structures As is well known the
direction of entropy evolution for a self-gravitating system is towards ever
increasing central concentration together with the buildup of an extended
outer envelope Antonov 1962 Lynden-Bell  Wood 1968 This direction
of entropy evolution for self-gravitating systems is the same as that of the
galaxy morphological evolution along the Hubble sequence from the late to
the early Hubble types
The angular momentum exchange between the wave and the basic state
is made possible through a collisionless gravitational shock at the density
wave crest Z96 similar in nature to the well-known plasma collisionless
shocks Balogh  Treumann 2013 and the references therein The correlated
interactions of the orbiting stars which can also be viewed as mediated by the
correlation between the grainy potential eld of the wave and the individual
particles motion scatter the stars mildly each time they cross an arm to
allow just the right amount of angular momentum exchange between that
contributing to the stellar orbital motion and that contributing the wave
motion in order to counter the growth tendency of the wave mode as well as
to initiate the secular orbital decay inside corotation or increase outside
corotation at the quasi-steady state of the wave mode
The meeting point between the local and global points of view is the
global self-consistency requirement ie since the dissipative density wave
mode is self-sustaining and self-limiting the combined eects of various dy-
namical processes on the wave and the basic state should be globally balanced
and quasi-steady The fact that this global self-consistency is achievable in
galaxies is due both to the long-range nature of gravitational interaction as
well as to the dependence of wave amplication and damping eciencies on
the nonlinearity of the density wave pattern Z96 Z98
The long-range nature of gravitational interaction as manifested through
the form of the Poisson integral means that the density and its associated
potential eld do not always coincide in space
In the case of a skewed
density wave mode this nonlocality of potential manifests as a character-
istic radial distribution of the azimuthal potential-density phase shift As
shown schematically in Figure 2 the radial distribution of the potential-
density phase shift for an unstable spiral or bar mode is such that the spiral
perturbation potential lags the perturbation density inside the corotation
and vice versa outside the corotation This characteristic distribution of the
potential-density phase shift is admitted by both the Poisson integral and by
the equations-of-motion for the particular set of solutions of disk-mass and
particle-velocity distributions that support a spontaneously-formed density
wave mode Z96 see especially the Appendices there
At the quasi-steady state of the wave mode the characteristic phase shift
distribution represented in Figure 2 implies a secular torque action by the
wave potential on the basic state disk matter which leads to secular angular
momentum exchange between the wave and the basic state both inside and
outside corotation This secular torque action can be shown to be responsible
both for the spontaneous emergence of the wave mode in the linear regime
as well as for the maintenance of the mode to a quasi-steady amplitude at
the expense of dissipative basic state evolution Z98
The characteristic phase shift distribution represented in Figure 2 is both
the symptom as well as the driving dynamical mechanism for the underlying
secular dissipative process For example the existence of this phase shift is
one of reasons that collisionless shock at the spiral arm crossing can form
to initiate dissipation since the streaming disk matter while marginally
gravitationally stable before arm crossing experiences added compression
due to the nonlocal gravitational potential contributed by the rest of the disk
matter which drives the streaming matter below their instability threshold
and thus enabling the collisionless shock Z96 On the other hand secular
angular momentum exchange between the density wave potential and the
underlying disk mass distribution as needed for wave damping and basic
state evolution necessarily leads to an azimuthal potential-density phase
shift a fact already hinted at in Kalnajs 1972 though there it was the
interaction between a non-self-consistent gaseous density wave and a driving
stellar potential wave that was the subject of study ie the exploration of
Figure 2 Schematic of the radial distribution of the azimuthal potential-density phase
shift for a self-sustained density wave mode in a galaxy disk The solid line indicates the
locus of the peaks of the density spiral and the dotted line indicates the locus of the
troughs of the potential spiral The circle indicates the corotation circle where the density
wave pattern speed and the basic state matters circular speed are the same It is also
where the potential-density phase shift is zero for a spontaneously formed density wave
mode Z96 Zhang  Buta 2007 Buta  Zhang 2009
using gaseous wave as a candidate for the damping of stellar wave rather
than the self-interaction of spontaneously-formed density wave mode
As valid for all collective or cooperative eects here we witness in spi-
ral and barred galaxies a seeming miracle of all the diverse components of
the system cooperate to accomplish a central goal to accelerate the entropy
evolution of the nonequilibrium system These coordinated interactions are
accomplished through a global instability pattern here the density wave
modal pattern which spontaneously emerge in far-from-equilibrium sys-
tems Their longevity is one of the reasons we observe them in nature there
are no lack of systems that self-destruct not long after emergence and thus
have short lifetime Even for spiral galaxies themselves there are constant
appearance of transient noise as well as slow-growing modal components
that die out in the competition with the most unstable modes  which is
one reason why dissipation is so important in the operation of these systems
In suciently nonlinear regime all uctuations receive damping but only
the dominant modal components receive sucient amplication to oset the
damping So the seeming miracle of cooperation among the components of
self-organized systems is partly a result of a natural selection process though
this selection happens on much shorter timescale as fraction of the lifetime
of a single dynamical system than biological natural selection which hap-
pens through many generations of individual members We can instead call
this rapid natural selection process in self-organized systems a winner takes
all process ie in the case of a galaxy the dominant mode rapidly solic-
its all resources of a disk galaxys mass distribution to modal activity and
after a few dynamical timescales little is left for the slower-growing modes
and noise which all receive additional damping through the local dissipation
mechanism at the density wave crest Other examples of such dissipative
structures in nature include the hexagonal convection cells in the well-known
Benard problem of atmospheric heat ow as well as human beings who are
capable of the most ecient entropy production and export In some sense
dissipative structures are the tools nature manufactures to accomplish the
task of accelerated evolution in nonequilibrium systems
13 N-body Simulations of The Secular Evolution of Disk Galaxies
N-body simulation of self-gravitating systems has had a long history see
for example Sellwood 1987 and Hockney  Eastwood 1988 for reviews of
the early decades work For the modeling of disk galaxies N-body simu-
lations were often carried out in a two-dimensional 2D conguration em-
ulating the thin disks in observed galaxies with the spherical bulge and
halo modeled as inert and time-independent To save computation time 2D
galaxy-disk simulations often employed a particle-mesh approach with the
force calculation performed on a regularly-spaced mesh and then interpolated
to the individual disk particles rather than being performed directly
After assigning usually constant mass to the simulation particles each
has many solar masses depending on the total number of particles used in
a given simulation and the total disk mass with the particles distributed
according to a given galaxys disk surface density the particle masses are
further groupedassigned onto the corresponding grid points Grid poten-
tial or force are calculated using the Poisson integral aided by Fourier
transform techniques whenever possible and then interpolated back onto
individual super-particles usually through the same algorithm as the mass
assignment algorithm in order to conserve momentum These forces are
used to calculate accelerations on the individual particles and the particle
trajectories are advanced through a standard nite dierence algorithm such
as leap frog Then the cycle starts anew Time step and spatial grid spacings
are selected to ensure stability and accuracy and special treatments at the
inner and outer boundaries of the disks are needed to take care of in-spilled
and out-spilled particles leaving the computation grid
Earlier N-body simulations of disk galaxies containing density wave pat-
terns focused on the emergence phase of the patterns and checked the growth
rates against linear density wave theory predictions and derived pattern
speeds and other related density wave parameters Sellwood 1987 and the
references therein Donner  Thomasson 1994 rst explored the longevity
of density wave modes in N-body disk simulations They found initial ev-
idence of the mass inowoutow behavior for stars inside and outside of
corotation respectively but did not attribute a dynamical mechanism to it
Starting from her PhD dissertation work Zhang 1992 the current au-
thor had carried out a systematic study of the dynamical mechanisms un-
derlying the secular morphological evolution of disk galaxies enabled by the
self-organized density wave modes Building on the numerical algorithms for
N-body simulation of Thomasson 1989 which was a direct decendent of
polar-grid code originally developed by Miller 1976 Z96  Z98 explored
the signature of collisionless shock in spiral galaxies the potential-density
phase shift distribution as well as the secular evolution of the basic state
mass distribution in the simulated galactic disks and compared these with
the theoretical predictions
Despite the conrmation of theoretically-derived mass ow rates in the
accompanying N-body simulations Z98 which established the viability of
the analytical approach the simulated mass ow rates were found to be small
far from being adequate to lead to signicant morphological transformation
of a galaxy within a Hubble time This small mass ow rate was traced back
to the small amplitudes of the spiral patterns formed in the simulations
which are far short of the extremely-nonlinear wave amplitudes observed in
physical galaxies This feature of the small wave amplitude applies to all the
disk galaxy simulations performed in the past few decades and its cause was
barely addressed
In order to circumvent the diculty with simulations Zhang  Buta
2007 2015 used near-and-mid-infrared images of galaxies and applied the
analytical mass ow rate equation of Z96  Z98 see also equation 8 in
Appendix A of the current paper directly to the derived mass surface density
of physical galaxies In these studies it was found that mass ow rates from
a few M per year to over one hundred M per year were typical depending
the density wave amplitudes and pitch angles of galaxies These derived mass
ow rates for physical galaxies far exceeded those obtained from past N-body
simulations mainly as a result of the fact that mass ow rate is proportional
to the wave amplitude squared Appendix A and the amplitudes in physical
galaxies are oftentimes a factor of 3-10 times higher than those obtained in
N-body simulations implying a dierence in mass ow rates of a factor of 10
- 100 between physical and previously-simulated galaxies
Given the importance of understanding secular evolution processes in
physical galaxies one could not help but wonder what exactly were the fac-
tors that prohibited the simulated disk galaxies from achieving the range
of density wave amplitudes and the level of mass inow rates in observed
galaxies It is to this question that the current paper addresses We show
that an articial parameter inserted into the numerical equation for calculat-
ing gravitational potential ie the so-called softening parameter underlies
much of the discrepancy between the simulated and observed wave ampli-
tudes Softening was introduced to represent both the nite thickness eect
of realistic galaxy disks in 2D simulations and to restrain the articial relax-
ation eect that is more pronounced in simulated disks which have a much
smaller number of particles compared to observed galaxies When properly
chosen it was found in the past that the exact values of softening parameter
does not impact signicantly the morphology of the simulated density wave
patterns On the other hand as we will show in this paper when our goal is
to model the quantitative characteristics of the self-organized density wave
modes especially the nonlinear equilibrium amplitude of the quasi-steady
wave modes which in turn determines the rate of the secular evolution of
the basic state mass distribution the role of softening turns out to be more
subtle due to the fact that the spontaneously formed modes are stabilized
through the dynamical balancing act of global amplication and local dissi-
pation Both the modal amplication process which is sensitively dependent
on the self-gravity of the disk especially near the corotation region and the
local dissipation of the wave through the collisionless shock enabled by the
mutual interactions of local matter within the arm instability region depend
on the exact form of the force law or the departure of this law from the orig-
inal Newtonian form as a result of softening The net eect is that smaller
softening leads to equilibrium wave-mode amplitude and the resulting sec-
ular mass ow rates much closer to what we had measured from observed
galaxies Zhang  Buta 2007 2015
Besides impacting the equilibrium wave amplitude we show that small
softening leads to easier attainment of quasi-steady modes The wave pat-
terns obtained in small softening runs though locally often appearing more
noisy are in fact globally closer to pure modal forms as borne out from
power spectrum analyses Even the noisier local mass distribution itself in
the small softening simulations is in fact closer to how observed galaxy mass
is really distributed ie an average galaxy disk is often populated by stellar
clusters globular clusters giant molecular cloud complexes and other spiral
arm inhomogeniety
In the face of all the inhomogeneities in mass distri-
bution the grand-design density wave modal patterns are nonetheless often
obtained among observed galaxies It is thus reassuring that the robustness
of observed density wave modes6 can be reproduced in the simulations using
small softening parameters This shows that self-organized nonequilibrium
patterns possess so-called asymptotic stability and are unaected by the
incidentals of the noisy background If anything the noisy mass distribution
provides the necessary initial seeds for the rapid spontaneous growth of the
instability pattern
2 THE EFFECTS OF SOFTENING IN N-BODY SIMULATIONS
OF DISK GALAXIES
In this section we motivate the study in the main body of this paper
sections 3-4 by giving the historic context and rationales for the intro-
duction of the softening parameter in N-body simulations of disk galaxies as
well as the potential limitations when softening is used in modeling the long-
term secular evolution behavior of disk galaxies containing self-organized
density wave patterns We also present a rst set of simulations showing
the dependence of the rate of disk mass redistribution on the choice of the
softening parameter as well as on other parameters of the simulation
21 Background
In essentially all of the gravitational N-body simulations of galaxies a so-
called softening parameter is used to control the articial relaxation eects
due to the smaller number of particles used in these simulations compared
to that in physical galaxies The softened force law can take various ana-
lytical forms In the often employed Plummer-sphere softening scheme the
gravitational potential due to a point mass m at a distance r is calculated as
6See also Zhang  Buta 2015 In the cases of M51 and NGC 3627 analyzed there
the intrinsic modal features of these galaxies were shown to be preserved even after strong
tidal interactions with companion galaxies
r 
pr2  asof t
where asof t is the softening parameter and G is the gravitational constant
A choice of asof t  0 corresponds to the original Newtonian force law A
nite softening parameter reduces the amount of unrealistic close encoun-
ters which occur more frequently for small N N here denotes the number
of particles used in N-body simulations systems and thus reduces the level
of articial relaxation in such systems Furthermore in the particle-mesh
approach commonly adopted in simulating disk galaxies the mesh size it-
self provides additional softening eect The hope is that a collisionless
conguration would result from a well-matched N and an eective softening
parameter which takes into account both particle and grid softening eects
In the context of 2D disk galaxy simulations both particle and mesh soften-
ing also emulate the realistic physical conguration of nite disk thickness
2D simulation incorporating softening has been shown to be able to model
the realistic macroscopic properties of disk galaxies containing density wave
patterns with 103  107 less number of particles than that present in physical
galaxies
One of the rationales for introducing the softening parameter is to achieve
an eectively collisionless environment for the duration of the simulation run
so that only long-range interactions determine the formation of density wave
patterns in their parent disks However with the realization that galaxies
which possess global density wave modes always involve partly-local collec-
tive dissipation processes one soon faces the fact that it is impossible to
completely avoid collision-like behavior in the simulation of unstable density
wave modes no matter how large a particle number N is used whether in
real galaxies or in simulations After all collective eects in these systems
depend on the near-collision or small-angle scattering of particles in the global
instabilities ie density wave modes to set up long-range correlations in
order to achieve self-organization and to induce secular evolution of the basic
state of the disk Z96 In some sense these galactic systems are in a forced
relaxation conguration with the forcing accomplished by the density wave
collisionless shocks The eective local instability parameter Qef f in the spi-
ral arms is thus always less than one to enable interparticle correlation A
true collisionless conguration will never be able to support self-organization
behavior
The custom choice of large softening in the past N-body simulations of
disk galaxies however reduces the very interparticle interaction that is the
backbone support of collective eects and thus can be responsible for re-
ducing density wave amplitudes in simulated galaxies as had already been
noticed early on Sellwood 1987 Despite perhaps subconsciously knowing
the correlation between the choice of softening parameter and the simulated
wave amplitude by some researchers the practice of using large softening
ie using a value comparable to the smallest grid size continued almost
universally partly because these earlier N-body simulations were mainly in-
terested in obtaining a comparable appearance of density wave morphology
as that in observed galaxies They are not geared towards the study of sec-
ular evolution eects induced by the collective density wave modes which
will require the accurate simulation both of the morphology as well as the
amplitude of these density wave modes
In a series of papers Romeo 1994 1997 1998 conducted systematic
studies of softening on the quality of N-body simulations and advocated
against using large particle softening in N-body simulation Furthermore he
pointed out that A delicate aspect of the relaxation problem that has not
been considered in the previous discussion concerns the eects of collective
interactions between particles and self-consistent uctuations on the dynam-
ical evolution of the system eg Romeo 1990 and the references therein
Weinberg 1993 Z96 A thorough treatment of collective eects would de-
mand titanic eorts even in simpler models cf Weinberg 1993 Romeo
19977
It is indeed to these aspects of the collective interactions of particles as
well as the self-consistent uctuations in galaxy dynamics that the work of
Z96 Z98 Z99 and Zhang  Buta 2007 2015 were devoted The current
paper is a continuation of this line of work focusing in particular on factors
that produced the dierence between the simulated and observed galaxy
characteristics We highlight below that overly-softened gravity modies the
Newtonian force into a more sluggishly-interacting one that hampers the
proper operation of collective eects This might not be a serious concern
if ones interest is in obtaining a coherent modal morphology that mimics
7Weinberg 1993 treated the eects of collective interaction on the relaxation processes
in symmetric and periodic systems These systems did not contain self-organized density
wave patterns thus are passive systems
the observed galaxy morphology eg Donner  Thomasson 1994 hereafter
DT94 However it can be detrimental to the determination of realistic
secular mass ow rates that are relevant to physical galaxies
22 Softening and Its Eect on Secular Mass Flow Rates
In Figure 3 we present a set of N-body simulations of the density-wave-
induced secular evolution of disk galaxy mass distribution using the basic
state specication similar to that rst explored in DT94 and subsequently
used for the study of collective eects and secular evolution in Z96 Z98 Z99
The details of the basic state properties mass distrubition rotation curve
and velocity dispersion distribution are given in Appendix B of the current
paper while the dynamical mechanism which induced the secular evolution
of the basic state mass distribution is summarized in Appendix A In the
current section we will only present the signatures of radial mass ow while
leaving the quantitative comparison to previously derived analytical mass
ow rates to 3 see especially 36
All the simulations in the current paper are performed in a two-dimension
2D conguration using a particle-mesh approach on a polar grid Miller
1976 The polar codes used in the current paper were written by the author
based on algorithms described in Thomasson 1989 These codes have been
used extensively in the development of the secular evolution theory in Z96
Z98 Z99 and many results were cross-checked with that presented in DT94
More details of the simulation grid and simulation procedure are given in
Appendix C of the current paper N1 million active disk particles are used
in this rst set of simulations presented in Figure 3
The polar grid used has 220 radial rings and 256 azimuthal spokes The
distribution of the radial spacing is exponential and the azimuthal spokes
have equal spacings The time step is chosen such that 1256 time steps rep-
resent one rotation period at r20 The gravitational constant G is renor-
malized to accommodate this choice of spatial and temporal normalization
and resolution see further details in Appendix C These grid and time step
resolutions are used in the rest of the simulations presented in this paper as
well except for the grid-resolution tests presented in Appendix D3 and only
the particle numbers N and the softening parameters asof t are changed and
will be noted in each case
Incidentally if one does not feel comfortable with the normalized units
used here which was originally introduced in Thomasson 1989 and Donner
 Thomasson 1994 one can attach a kpc to the normalized length unit
Figure 3 Evolution of enclosed disk mass within central r35 radius of a set of 2D N-
body simulations with dierent softening parameter asof t Solid asof t  15 Dashed
asof t  075 Dottedi asof t  025 N1 million particles are used to represent the active
a 1011M to the normalized mass unit and can scale the time steps to the
unit of 1256 steps for one rotation period at r20 for the results presented
in the main body of the paper and half as many steps per rotation period
for results presented in Appendix D3 for a coarser grid and a larger eective
time step choice to aid in the intuitive comparison with physical galaxy
properties
The curves in Figure 3 are for the evolution of enclosed disk mass within
the central r  35 region in the scale of this disk which has corotation
radius in the approximate range of 18-30 depending on the softening length
used and on the epoch of secular evolution the disk region within r  35
corresponds roughly to the central bulge region The three curves from
bottom to top correspond to softening parameter values of 15 as used in
DT94 and Z98 075 and 025 in the unit of the radius of the innermost
grid ring or inner computation boundary size of 1 As can be seen from the
gure the choice of softening of 15 which is a common choice by N-body
simulators produced a barely noticeable mass inow in the duration of the
simulation run which results in a central mass growth of 65 over roughly 25
rotation periods which is obviously quite inadequate in transforming galaxy
morphology in a Hubble time Gradually reducing softening as shown in
Figure 3 is seen to systematically increase the mass inow rate
Figure 4 Enclosed mass within central r35 of the N-body disk for runs with dierent
number N of active disk particles and a constant asof t  01 Solid N1 million particles
Dashed N10 million particles Dotted N20 million particles Dash-Dotted N40
million particles
The price one pays for reduced softening in small-N simulations is the
increase in relaxation heating rate and the formation of local instability
clumps see later among the morphological plots in 31 To compensate for
the unrealistic degree of relaxation in small-softening simulations one needs
to use a correspondingly increased number of particles How much the par-
ticle number needs to be increased for a given choice of softening parameter
can in fact be obtained empirically For 2D simulations we found that for a
factor of f reduction in the particle softening parameter an increase of f 2 is
needed in the number of particles to keep the heating eect in check This
scaling behavior had also been found in previous studies by other authors
eg Thomasson Donner  Elmegreen 1991
In Figure 4 we show a set of simulations with changing particle numbers
while holding the softening parameter asof t  01 the smallest softening
choice that will be explored in the current paper For the small particle-
number runs the rapid mass inow is seen to saturate at an earlier time
step which corresponds to the time as revealed from the morphological
plots when the spiral activity is damped by the excess heating due to the
insucient number of particles especially in the outer disk region where
the surface density is low the grid size is large and the particle numbers are
small For large particle number runs the rapid mass inow is seen to remain
Figure 5 Basic state surface densities at the beginning solid and the end of four N-
Body runs with dierent number of particles Dashed end surface density for 1 million
particles Dotted end surface density for 10 million particles Dash-and-Single-Dotted
end surface density for 20 million particles Dash-and-Triple-Dotted end surface density
for 40 million particles asof t  01
at a constant rate all the way until the end of the run which corresponds
to 25 galactic rotations at the reference radius r20 This indicates that the
increased particle number 20 million100000200 is adequate in osetting
the reduction in softening f150115 conforming to the f 2 scaling law
mentioned in the previous paragraph
Furthermore we note that the maximum mass inow rate observed here
from the near constant slope of the large particle-number runs with asof t 
01 corresponds to about 60 increase in enclosed mass within r35 the
bulge region over 10 rotation periods or roughly 15 of a Hubble type This
level of mass accretion is more than sucient to transform the Hubble type
of a galaxy by several stages in a Hubble time consistent with the level of
mass ow rates derived for physical galaxies Zhang  Buta 2007 2015
In Figure 5 we show the disk surface density at the beginning of the
run and at the end of the four runs with dierent numbers of particles as
presented in Figure 4 but here with dierent line styles from Figure 4 for
each case due to the need to represent the before surface density It can
be seen that the large mass inow of the large-particle-number runs indeed
builds a more substantial bulge However the 20 million particle run in fact
produced more substantial bulge-building than the 40 million particle run
This is consistent with the trend observed in Figure 4 where it is seen that
the 40 million particle run has somewhat reduced mass inow rate near the
end of the run This saturation of the mass ow rate at a specic level of
particle number matched to the decrease of softening length is reassuring
since we expect the collective eects to be relatively independent of particle
number once the excess relaxation eect is held under control by the use of
sucient number of simulation particles
3 FOUR SETS OF VARIABLE-SOFTENING N-BODY RUNS
The initial tests of the last section show that by signicantly decreasing
the amount of particle softening and simultaneously increasing both the
number of simulation particles used as well as the degree of grid resolution
we can achieve increased radial mass ow rates to levels comparable to that
needed for a signicant change of galaxy morphological types over a Hubble
time as indicated in observational studies Zhang  Buta 2007 2015
A natural question arrives as to whether this observed increase in radial
mass ow rate is a true physical eect or else is a numerical artifact due to
noise brought about by the small softening and the corresponding increased
collisional relaxation To answer this question in this section we present
detailed correlations of density wave modal characteristics and the observed
mass ow behavior in the N-body simulations Softening will be shown to
change the equilibrium amplitude of the modes formed but it hardly changes
the level of agreement between the mass ow rate predicted using the modal
parameters found in the simulations and the corresponding mass ow rate
measured in the same simulations ie smaller equilibrium wave amplitudes
are found to correspond to smaller measured mass ow rates given precisely
by the theoretical predictions using the corresponding wave amplitudes
In what follows we will rst establish the modal nature of the density
wave patterns formed from originally featureless axisymmetric basic state
of the galactic disk After presenting the modal characteristics we will go on
to demonstrate the presence of the potential-density phase shift distribution
which leads to the secular torque interaction between the basic state mass
distribution and the wave-mode potential eld This torque interaction leads
to the angular momentum exchange between the basic state and the density
wave which further leads to the radial mass ow behavior We demonstrate
that both the qualitative and quantitative mass ow behavior observed in
these simulations are consistent solely with the modebasic-state interaction
picture and are inconsistent with either the transient-wave- or noise-induced
mass ow behavior
Four sets of 2D N-body simulations are performed utilizing the same
polar grid 220 radial grid cells 256 azimuthal grid cells the same number
of particles 20 million the same duration of simulation run 32768 steps
corresponding to roughly 25 galactic rotation periods at radius 20 and the
same time resolution of 1256 time steps per galaxy rotation period time at
r20 but with the particle softening parameter having the values of asof t 
15 075 025 01 respectively in the Plummer softening scheme equation
All the runs have the same basic state specication as that of Z98 see
also Appendix B of the current paper which was also the basic state used
in the previous section 2 This basic state specication allows the setup of
a galactic resonant cavity between the inner bulge region and the corotation
radius in the mid-disk and thus the formation of unstable density wave
mode The resulting corotation radius range from rco  28 for asof t  15
to rco  23 for asof t  01 at the initial emergence stage of the mode and
the corotation radius tends to decrease in the late stages as the secular mass
inow leads to a more centrally concentrated mass distribution
31 Morphological Evolution
In Figure 6 to Figure 9 we present the morphological evolution of the
density wave pattern with basic state and numerical grid specications given
in Appendix BC and with particle softening parameter asof t  15 075 025
and 01 respectively The initial disk mass assignment is an axisymmetric
modied exponential disk and the rotation curve is nearly constant at a
value vc  01 in the normalized unit The velocity dispersion assignment
corresponds to the instability parameter QT  1 across the disk
A coherent spiral-bar pattern spontaneously emerges from the originally
featureless disk in each case The morphology of the m2 two-armed domi-
nant mode will be shown later in Figure 14 during its initial emergence phase
The mode in fact emerges at progressively earlier time steps as softening de-
creases this will be shown more clearly later during detailed analyses This
is mainly due to the larger seed of noise present for modal amplication in
the smaller softening cases
The patterns in various cases contain other contaminants besides the m2
mode for example the asof t  15 case has some m3 component and the
Figure 6 N-body morphology of a spiralbar mode at dierent time steps The rotation
period at r20 is about 1256 steps The softening parameter is asof t  15
Figure 7 N-body morphology of a spiralbar mode at dierent time steps The rotation
period at r20 is about 1256 steps The softening parameter is asof t  075
Figure 8 N-body morphology of a spiralbar mode at dierent time steps The rotation
period at r20 is about 1256 steps The softening parameter is asof t  025
Figure 9 N-body morphology of a spiralbar mode at dierent time steps The rotation
period at r20 is about 1256 steps The softening parameter is asof t  01
two small-softening cases asof t  025 asof t  01 are seen to have local in-
stability clumps formed in the outer region of the simulation disk The small
softening cases also tend to have higher heating eect which submerges the
nonlinear pattern within noise at the later stages of the simulation though
the underlying m2 mode can be shown to be persistently present in ev-
ery case for the entire duration of the simulation run corresponding to 25
rotation periods at radius 20
In the small softening case of asof t  01 the pattern is seen to have
evolved from a spiral-like morphology in the early stage of the simulation to
a bar-like morphology in the later stage partly due to the rapic mass inow
in this small softening case The increased central concentration of mass then
favors a bar mode
32 Phase Evolution
In Figure 10 we plot the time evolution of the azimuthal phase of the m2
two-armed perturbation-potential component from the above four runs at
a series of radii across the simulation disk
The rst thing we notice from this plot is the coherent approximately
linear evolution of the phase at the various radial locations for all softening
choices indicating that the patterns involved are rotating at nearly constant
angular speed at each radius though the pattern speed may change across
the dierent radii indicating the winding up of the pattern especially for
inner galaxy disk and for large softening cases This shows that the patterns
that spontaneously emerged are likely to be unstable modes of the disk rather
than random transient waves with the latter not expected to have a coherent
phase evolution over the lifetime of a galaxy
Furthermore we observe that while the phase evolution curves for the
large softening runs diverge at the dierent radial locations indicating a
change of pattern speed for the dierent portions of the spiral arms or the
wrapping up of the pattern with time the run with the smallest softening
length asof t  01 case shows an extremely constant pattern speed between
r10 and r30 ie between the inner Lindblad resonance and slightly be-
yond corotation radius As a matter of fact two of the 6 curves nearly
overlap that is why there appears to be only 5 curves
Note also that in all cases the more rapid phase advance between r5
and r10 locations is likely to be due to a nuclear pattern with a separate
pattern speed since the outer main pattern has its inner Lindblad resonance
at around r10
Figure 10 Phase evolution of the m2 potential at radial locations from top to bottom
r51015202530 respectively using four dierent softening parameters
33 Pitch Angles of the Patterns
In Figure 11 we plot the m2 potential phase-versus-radius at dierent
time steps for the four runs in order to study the variation of pitch angle of
the spiral-bar pattern versus radius
For most plots it can be seen that the slopes of the m2 phase-versus-
radius starting from r10 which is close to the inner Lindblad resonance
location of the dominant mode to r40 which is close to the outer Lind-
blad resonance or the outer limit of the mode are within a narrow range
especially if we exclude the step n8000 solid lines which may be contam-
inated by the noisy features during the mode emergence phase This near
constancy of the slopes of the phase-versus-r curves indicates the presence
of logarithmic spirals or else skewed-bars with nearly constant pitch angle
Some of the regional bumps on the curves could be due to contamination
from local instability clumps or noise
Of particular interest is the plot for asof t  01 which as we had pre-
viously shown harbors a pronounced bar pattern in the later stage of the
run The evidence of the spiral-to-bar morphological change can be seen
here from the phase-versus-radius plot At the earlier stages of the run step
8000 and earlier there is a more steep gradient for the phase versus radius
curves indicating the presence of a skewed spiral pattern whereas for the
later stage of the run the phase versus radius curves atten out reecting
the reduced skewness of the bar However a comparison with the asof t  01
Figure 11 Phase versus radius of the m2 potential at time steps 8000 solid 16000
dashed 24000 dotted 32000 dash-dotted for runs with four dierent softening length
choices
phase-versus-time plot Figure 10 shows that between r10 to r30 the
phase-versus-time curves have nearly constant slope throughout the simu-
lation run indicating a constant pattern speed throughout both the spiral
and bar phases for this evolving mode This constant pattern speed during
the modal morphological evolution is also supported by the time-segmented
power spectrum analysis of Figure 13 which we will present next These re-
sults thus corroborating one another to show that the spiral and bar modes
are from the same modal family ie the spiral evolves smoothly to a bar
rather than spiral disappearing and a bar of a dierent pattern speed later
appearing Therefore even with the modal shape evolving from spiral to
bar we are still led to the quasi-steady modal picture rather than a transient
and recurrent pattern picture8
8In essentially all the numerical simulations of spontaneously-formed density waves
in disk galaxies the unstable bar modes were obtained from initially going through a
spiral phase see for example Sparke  Sellwood 1987 This is because the formation of
density wave modes requires the removal of angular momentum from across the inner disk
within corotation and the deposit of angular momentum to the outer disk region ourside
corotation and this removal and deposition of angular momentum in turn depends on the
Figure 12 Contour plot showing comparison of the power spectra from m2 potentials at
dierent radii during indicated time intervals for the four dierent softening parameters
and with 20 million particles The solid line indicates galactic rotation speed  the two
dashed lines are   2 where  is the epicycle frequency
34 Power Spectra
In Figure 12 we present the contour plots of the power spectra of the m2
potential perturbations from the above four runs with diering softening
parameters during selected time intervals and over the galactic radial range
where the dominant mode is expected to have signicant amplitude The
solid line in each gure indicates the galactic rotation curve in angular speed
the dashes curves delineate the range where modal amplication within the
galactic resonant cavity is most likely to occur Bertin et al 1989ab
presence of potential-density phase shift of the pattern involved Z98 and the phase shift
value is smaller for bars than for spirals since bars generally are less skewed than spirals
Therefore a bar mode employs a spiral modal shape during its youthful developmental
stage to remove angular momentum needed for its growth until it reaches the adequate
amplitude and modal shape to become its mature self This process incidentally lends
support to many of the so-called super-fast bars found in the Zhang  Buta 2007 and
Buta  Zhang 2009 samples which have the bar corotation radius located intermediate
in the bar rather then at the bar end as dictated by conventional wisdom from passive
orbit analysis If all bars are formed through an initial spiral phase and if the corotation
radius during spiral phase are located midway in the spiral arms then we should not be
surprise to nd a fraction of bars to have this property as well since the transition stage
between spirals and bars can appear as either an open spiral or a skewed bar
Figure 13 Power spectra from m2 potential at dierent radii for the 20 million particle
and asof t  01 run Top step  0 - 16384 or the spiral-dominated phase Bottom step
 16385 - 32768 or the bar-dominated phase The solid line indicates galactic rotation
speed  the two dashed lines are   2
Note that for the larger softening runs asof t  15 075 025 we have
only plotted during the time interval where the rst dominant mode emerges
and reaches quasi-steady state This mode will further evolve and change
pattern speed in the general trend of increasing pattern speed as the disk
mass becomes more centrally concentrated during the remainder of the sim-
ulation run9 Later in the text Figure 33 - 36 we will present further
evidence of modal evolution with time Note also that the pattern speed for
the asof t  075 case varies slightly with radius ie the power spectrum has
a nonzero slope indicating the tendency for the winding up of the pattern
with time for this softening run
Cross-comparison with the phase-versus-timephase-versus-radius plots
of the previous two sub-sections shows that changes in pattern speed and
spiral winding angle appear continuously both in time as well as in space
throughout the simulation run rather than appear as random uctuations
that a transient spiral pattern would produce
For the small softening length a  01 run despite the transition from
spiral-shaped to bar-shaped morphology the pattern speed of the mode is
9This is the reason we have only plotted the mode for limited time range so as to avoid
pattern-speed smearing The end of the above plotting range does NOT indicate the end
of the modal activity
seen to remain constant This can be seen especially clearly if we break up
the time duration of the power spectrum calculation into two segments as
shown in Figure 13 It can be seen here that the main power spectrum speak
stayed at nearly the same vertical scale indicating the same pattern speed
for both time segments The conclusion of the constancy of the pattern speed
throughout the spiral-to-bar morphological evolution during the asof t  01
run is further conrmed when we re-examine the m2 phase-versus-time plot
Figure 10 This shows that with the choice of small particle softening and
in physical galaxies the zero eective particle softening in the Newtonian
force law and with the thickness of the disk here partly represented by grid
softening allow self-organization and global-self-consistency of the galaxy
density wave mode to be accomplished and maintained during both the spiral
and bar evolution phases
35 Potential-Density Phase Shift and Radial Mass Flow
Having established the modal characteristics for the simulated density
wave patterns we now look into the issue of radial mass ow in the parent
disk galaxies containing these patterns
In Figure 14 we present the contour plots of the morphologies of the
m2 modal density and potential with the potential negated so as to ease
the comparison with density for the four runs at a progressively decreasing
time step for each case corresponding to the initial emergence period of the
mode for the particular softening-parameter choice We can see that a spiral-
like morphology is present in all cases this morphology will later evolve into
a more bar-like morphology for the asof t  01 run Furthermore we see
that the potential patterns display a more open appearance than their cor-
responding density patterns which are more tightly-wound This dierence
in the winding of the density and potential patterns reveals the radial distri-
bution of the azimuthal potential-density phase shift which we had plotted
schematically in Figure 2 and which we will analyze quantitatively below
Formal denition of the equivalent azimuthal phase shift between the pertur-
bation potential and density patterns in disk galaxies is given in Appendix
A of the current paper equation 3
The existence of the quasi-steady azimuthal phase shift distribution with
potential lagging density within the corotation radius and potential leading
density outside corotation means that there is a secular torque applied by
the perturbation potential on the basic state mass distribution thus a re-
sulting secular angular momentum exchange between the wave and the basic
Figure 14 Morphology of the density left frames and negative potential right frames
of the m2 modal component for the four runs at the respective time steps 10000 8000
6000 4000 as indicated on the gure Only positive contours are plotted The circle in
each case corresponds to the approximate location of the corotation resonance for that
particular choice of the softening
state at the quasi-steady state of the wave mode This in turn leads to the
inow of basic state mass inside corotation and the outow of matter outside
corotation
In Figures 15 16 17 and 18 we plot the results of the radial dependence
of the azimuthal potential-density phase shift as well as the corresponding
instantaneous mass ow rate calculated using the perturbation density 1
and perturbation potential V1 at each radius according to the expressions
given in Appendix A equations 3 8 at a progressively decreasing time step
for each of the four softening choices of 15 075 025 and 01 respectively
The time step for plotting is chosen near the peak of the rst emerged density
wave mode in the respective run
Note that if the density-wave modal surface-density and kinematic dis-
tributions are truly globally self-consistent and quasi-stationary and if the
galaxy admits only one dominant mode the phase shift as well as mass
ow rate distribution will experience zero-crossing exactly at one corotation
radius The radial distribution of the phase shift would be a positive hump
followed by a negative hump with the transition between the two humps
occurring at the unique corotation radius
In our simulations we observe
secondary oscillations in the phase shift curve in the central region of the
disk as well as in the outer region These have various causes 1 Noise in
the perturbation density and potential used especially near the region where
and when the perturbation quantities themselves are small 2 Outer disk
truncation eect in a nite-domain simulation Z98 3 Non-steady nature
of the modes formed 4 the formation of nested patterns inside the primary
pattern
From the derivation expressions given in Appendix A we see that the
mass ow pattern has exactly the same zero crossings as the phase shift pat-
tern yet dierent radial amplitude prole due to the fact that for the mass
ow rate expression the local surface density the fractional density-wave am-
plitude and the galactic rotation curve also play a role in addition to the
phase-shift or normalized torque-integral contribution Thus the appearance
of large-value multiply-oscillating phase shift features near the galactic cen-
tral or outer region does not necessarily signal their importance if the wave
amplitude there is small and the phase shift oscillations are mainly due to
noise This point is made self-evident from comparison of the left and right
frames in Figures 15 - 18
Figure 15 Potential-density phase shift left frame and mass ow rate right frame
versus r at time step 12800 for asof t  15 run These two gures have identical zero
crossings though dierent amplitude distributions
Figure 16 Potential-density phase shift left frame and mass ow rate right frame
versus r at time step 10400 for asof t  075 run These two gures have identical zero
crossings though dierent amplitude distributions
Figure 17 Potential-density phase shift left frame and mass ow rate right frame
versus r at time step 5600 for asof t  025 run These two gures have identical zero
crossings though dierent amplitude distributions
Figure 18 Potential-density phase shift left frame and mass ow rate right frame versus
r at time step 8000 for asof t  01 run These two gures have identical zero crossings
though dierent amplitude distributions
36 Comparison of Analytical and Numerical Accretion Rates
The evidence we have presented so far supports the view that the spi-
ral and bar patterns obtained in these N-body simulations were intrinsic
modes of the basic state of the disk and they emerege spontaneously out
of originally featureless axisymmetric disks beyond the threshold for non-
axisymmetric instabilities These instabilities display long-range correlation
and are self-organized That natural laws implicitly allow such organiza-
tion to spontaneously appear is part of the reason the universe displays the
observed complexity and hierarchical organization starting from the very
simple set of fundamental laws and nearly homogeneous initial conditions of
the Big Bang
In what follows we present an another set of analyses of N-body results
specically to check whether the radial mass ow rates obtained in these
simulations responsible for bulge building as well as for the spreading out
of the outer disk agree with the analytical prediction equation 8 in Ap-
pendix A using the parameters of the global density wave modes in the
same simulations An agreement between the two lends support both to the
analytical formalism as well as to the relevance of using N-body simulations
to characterize the self-organized density wave modes
In Figure 19 we plot the time evolution of enclosed mass at two dierent
radii one inside and one outside corotation after subtracting their respec-
tive values at the beginning of the simulation for each time step represented
for the previous simulation run using softening length asof t  15 We ob-
serve a general trend of mass inow inside corotation resonance CR radius
and mass outow outside CR Note that the CR radius for this large soft-
ening choice is between 25-30 with larger value towards the earlier part of
the simulation run We therefore choose to plot the outside-CR mass ow
curve at radius 325 For progressive smaller softening choices the CR radius
reduces accordingly So for later plots asof t  075 025 01 we will choose
to plot the outside-CR mass ow curves at radius 275
In Figure 20 we plot the expected mass increase within the above two
radii by integrating in time of the instantaneous mass inow rate predicted
by equation 8 using the density-wave modal characteristics ie the per-
turbation potential and density distributions as well as galaxy parameters
obtained in the same simulation run
Note that the time resolution for data points in Figures 19 and 20 as
well as for subsequent similar pairs of gures are slightly dierent Figure
20 and similar gures below are obtained from instantaneous mass ow rates
Figure 19 Time evolution of the enclosed mass for a typical radius inside corotation and
a typical radius outside corotation relative to the initial time step n0 mass at the same
respective radius for the softening length asof t  15 run
Figure 20 Predicted integrated mass evolution according to equation 8 within the two
dierent radii for softening length asof t  15 run
calculated at every step of the simulation and these are only recorded at
selected radii Figure 19 and similar gures on the other hand are obtained
using the whole disk surface mass maps written out at selected time inter-
vals t  800 time steps in this case so the time resolution is coarser
Nonetheless the gross features of these two kinds of plots can be compared
without losing crucial information
We observe from the comparison of Figure 19 and Figure 20 that at the
location inside CR r85 the observed mass increase rate is about 3 times
as large as the analytically predicted rate though the trends of the mass
increase are similar between the two This large quantitative discrepancy
is particular to the asof t  15 run likely related to the prohibition of the
growth of the dominant m2 intrinsic instability by the large softening With
the suppression of the growth rate of the dominant m2 mode some 3-armed
as well as other noisy patterns are seen to emerge These non-modal patterns
can produced radial mass ow yet may not enter into the analytical mass ow
prediction
The mass ow behavior outside corotation likewise shows disagreement
between the two plots The actually measured mass increase in Figure 19
shows a consistent outow pattern as betting its location outside corota-
tion whereas the expected mass ow calculated using the torque equation
showed initially a mass inow and only afterward changed to outow This
shows that the nonlinear modal organization does not exactly reproduce the
quiescent linear modal picture of the smooth launching of the mass ow ac-
tivity Also once again the magnitude of the actually measured outow rate
is signicantly higher than predicted for this case
We had performed another simulation run with asof t  15 but with the
potential calculation keeping only the even azimuthal harmonics during the
Fourier transform process to obtain the grid potential to reect the fact that
observed spiral and bar patterns show predominant bi-symmetric patterns
The results for the observed and predicted mass accumulations inside and
outside CR are shown in Figures 21 and 22 Here the predicted and measured
mass ow rates within CR are seen to be in better agreement apparently
due to the fact that the enforcement of even-harmonics-only coerced a much
more eective growth of the collective instability which has bi-symmetry It
is now clear that as long as the global instability has accomplished its growth
potential implicit in the modebasic-state correspondence through either the
tinkering of symmetry as shown here or through the reduction of softening
as shown below the agreement between the theoretical prediction and the
Figure 21 Time evolution of the enclosed mass for a typical location inside corotation
and a typical location outside corotation relative to the initial n0 mass at the same
respective radius for the softening length asof t  15 run using only the even harmonics
in potential calculation throughout the N-body simulation
Figure 22 Predicted integrated mass evolution according to equation 8 within the two
dierent radii for softening length asof t  15 run using only the even harmonics in
potential calculation throughout the N-body simulation
actual measurement in N-body simulations will tend to be good
The even harmonics enforcement is most eective in encouraging larger
wave amplitude for the asof t  15 choice For the other smaller softening
choices we will present next asof t  075  01 the even harmonics enforce-
ment in fact hampers the wave amplitude growth in the later stages of the
calculation because there is the natural tendency in the small asof t runs to
form local instability clumps in the outer disk and through the enforcement
of bi-symmetry these would-be local clumps were seeen to morph into diused
noise which tend to heat the outer disk and inhibit larger wave amplitude to
be maintained Still tests show that even for asof t  075 the enforcement of
even harmonics encouraged a more vigorous modal growth during the rst
13 of the simulation run and as a result the mass ow rate for that duration
of time has better agreement between the predicted and measured values
In Figure 23 we plot the actually measured enclosed mass evolution com-
pared to its value at the beginning of the simulation for asof t  075 run
with the left frame shows the typical mass ow trend inside CR and the
right frame is typical of the behavior outside CR In Figure 24 we plot
the expected accumulation of mass within the two radii by integrating the
instantaneous mass inow rate according to equation 8
We see that at r85 the trend of mass accumulation with time between
these two gures are extremely similar Furthermore the value of analyti-
cally inferred rates is only about 30-40 smaller than the actual observed
rates This is a much better agreement than the case we had shown before
for the asof t  15 run using all harmonics This shows that decreasing soft-
ening does make a signicant dierence in our ability to correctly model the
collective eects As we have commented before enforcing by-symmetry in
the potential calculation will lead to further improved agreement between the
predicted and measured mass ow rates for the initial 13 of the simulation
duration before the heating eect sets in
In the asof t  075 run the predicted mass accretion for r275 has
some large uctuations due to the contamination of multi-armed patterns
We therefore chose to use only even harmonics in the accretion calculation
for the r275 location even though the N-body simulation itself was run
with the full harmonics set This procedure in the analysis helps to lter
out eect of the transient features and leads to better agreement between
the measured and predicted mass accumulation rate at r275 though some
residual uctuations still exist Once again the magnitude of the outow is
smaller for the predicted than the measured for this run as for asof t  15
Figure 23 Time evolution of the enclosed mass for a typical location inside corotation
and a typical location outside corotation relative to the initial n0 mass at the same
respective radius for the softening length asof t  075 run
Figure 24 Predicted integrated mass evolution according to equation 8 within the two
dierent radii for softening length asof t  075 run The second frame for r275 used
only even harmonics in the mass ow calculation
In Figure 25 we plot the actually measured enclosed mass evolution at the
two dierent radii compared to its value at the beginning of the simulation
for the asof t  025 run In Figure 26 we plot the predicted accumulation of
mass within the two radii by integrating the theoretical instantaneous mass
inow rate equation 8
For this run for the location r85 the measured enclosed mass evolution
curve has similar prole as that predicted Furthermore we see that the
numerical values of analytically inferred and actually-measured mass accu-
mulation rates are nearly identical This shows that reducing the softening
length to asof t  025 allows the inter-particle interactions to fully represent
the collective eect implicit in the global modal characteristics
The predicted mass accumulation curve outside CR r275 was more
noisy than the inner region behavior due to the formation of several local
instability clumps at the outer region of the computation domain So we have
once again used only the even harmonics for the mass accretion calculation
for the r275 location not for the N-body simulation itself which was
performed using full harmonics which ltered out the contamination of the
local transients Here we witness that the numerical value for the predicted
and measured outow rates are in better agreement than for the previous
two larger-softening cases
In Figure 27 we plot the actually measured enclosed-mass evolution at
the two dierent radii compared to their values at the beginning of the
simulation for the softening choice of asof t  01 as the most extreme case
of softening parameter tests
Note that the inection of the curves near time step 5000 for the asof t 
01 run inside CR is linked to the launch of spiral to bar modal shape
transition The spiral phase is seen to lead to higher rate of mass inow
compared to the bar phase due to the more signicant skewness and thus the
resulting larger potential-density phase shift of the spiral pattern as compared
to the bar pattern This higher mass ow rate for the spirals as compared to
bars was also conrmed in the physical galaxy samples analyzed in Zhang 
Buta 2007 2015
The mass ow curves outside CR for asof t  01 have similar trends
though the predicted rate once again is smaller in magnitude
In Figure 28 we plot the expected mass accumulation of mass within the
two dierent radii for the asof t  01 run by integrating the instantaneous
mass inow rate equation 8 We see that the observed and predicted mass
ow curves within the r85 region are quite comparable with the predicted
Figure 25 Time evolution of the enclosed mass for a typical location inside corotation
and a typical location outside corotation relative to the initial n0 mass at the same
respective radius for the softening length asof t  025 run
Figure 26 Predicted integrated mass evolution according to equation 8 within two
dierent radii for softening length asof t  025 run The second frame for r275 used
only even harmonics for mass ow calculation
Figure 27 Time evolution of the enclosed mass for a typical location inside corotation
and a typical location outside corotation relative to the initial n0 mass at the same
respective radius for the softening length asof t  01 run
Figure 28 Predicted integrated mass evolution according to equation 8 within the two
dierent radii for softening length asof t  01 run
rates smaller than the actual rates by about 30 Here the dierence is ob-
viously not due to the suppression of collective eects because the softening
length used is even smaller than in the asof t  025 case The likely cause
for this residual discrepancy may be attributed to the viscosity-induced ac-
cretion eect or dynamical friction not accounted for by the density-wave
torque calculation
Reexamine all of the outside-CR curves for the previous runs we see
that they share the same feature of a more pronounced drop in measured
enclosed mass at the beginning of the run signaling a rapid mass outow
episode as the self-organization of the mode begins to take place that was
not reected in the corresponding predicted mass outow this large drop
in measured enclosed mass was seen to be the main reason of the dierence
in magnitudes of the measured and predicted outows in each case because
after this initial drop the slopes of the outows are seen to be quite compara-
ble between the measured and predicted This common discrepany may be
partly a result of the fact that the outer disk has very low surface density and
the density wave is poorly represented there so the self-organization process
may depart more signicantly from the smooth modal-emergence picture
We also note from the above runs that the net amount of mass increase
within r85 does not have as substantial a dierence between the dierent
softening runs apart from the extreme case of asof t  01 compared to that
given in Figure 3 and Figure 4 for r35 This dierence is partly accounted
for by the shape of the modied exponential surface density for the choice of
basic state and as the secular evolution proceeds the entire curve squeezed
inwardly as opposed to a surface density increase at every radius as a result
of mass inow see below the surface density evolution in Figure 30
We choose this larger radius r85 to conrm the analytical mass ow
equation because near the very central region the presence of nested res-
onances complicate the analysis Even r85 itself is ocially within the
inner Lindblad resonance of the outer mode10 A location further out in ra-
dius turned out to exhibit even earlier saturation of the accretion behavior
because the disk surface density is depleted as a result of the accretion pro-
10The resonance itself is shielded from being active to the wave by the rapid increase
in velocity dispersion in this region which forms the so-called Q-barrier that allows the
inwardly propagating short trailing density wave train to be reected to become outward
propagating long trailing wave train towards corotation region to complete the feedback
loop and to form growing modes Mark 1976
Figure 29 Evolution of the fractional wave amplitude for the four softening choices at
radius r85 Solid asof t  01 Dashed asof t  025 Dotted asof t  075 Dash-
Dotted asof t  15
cess see Figure 30 below thus becomes unable to support the full amount
of mass inow required by the density wave mode
That r85 location can still be a good representative of the accretion ow
due to the outer mode is seen also in the m2 morphology plot we presented
earlier Figure 14 There we see that the dominant mode does penetrate
to within the central r8 region the nuclear nested mode is well within the
central r5 region so the mass inow predictions calculated for r85 are
still those for the outer dominant mode This dilemma of the simulation
can be avoided in physical galaxies through the vertical accretion of cold
gas onto the galaxy disk followed by its inward channeling to replenish the
depleted surface density of the disk and to support continued mass accretion
throughout the lifetime of a galaxy
In Figure 29 we plot the evolution of the fractional wave amplitude de-
ned as the geometric mean of the density- and potential-wave fractional
amplitudes during the simulation run for the four softening choices and
at the radius r85 Note the progressive delayed emergence of the wave
mode as well as the decrease of equilibrium amplitude as the softening pa-
rameter is increased Note also that for asof t  01 case the amplitude is
re-invigorated towards the end of the simulation run due to the strength-
ening of the central bar as a result of previous mass inow  this fact can
also be discerned from Figures 27 and 28 as the steepening of the enclosed
Figure 30 Comparison of the surface density evolution of the N-body runs using four
dierent softening parameters and all with 20 million particles The dierent curves in
each gure are for time steps of 0 solid 16384 dashed and 32768 dotted respectively
Note that the last frame for asof t  01 has a dierent vertical scale than the other three
frames
mass slope in the last quarter of the run as compared to the corresponding
gures for asof t  075 Figures 23 24 and for asof t  025 Figures 25
26 where the enclosed mass attens out towards the end of the simulation
indicating the slowing down of accretion behavior which is matched by their
respective decreased wave amplitudes as shown in Figure 29 Of course the
mass ow rate is determined not only by the fractional wave amplitude but
also by the potential-density phase shift as well as by other wave and basic
state parameters Appendix A equation 9 all of them working in concert
to produce the nal radial mass ow rate
In Figure 30 we plot the surface density evolution of the above four
runs This plot corroborates what we had found before from the plots of
mass inow within the central r35 and r85 radius as well as outside the
corotation radius The asof t  01 choice is seen to be the most eective in
producing enhanced mass ow rates due to its larger wave amplitude and
most persistent density wave activity
4 ANALYSES AND DISCUSSION
41 On the Modal and Quasi-Steady State Hypotheses of Density Waves in
Physical and Simulated Disk Galaxies
411 Previous Work
The mass ow rate equation used in the last section is exact when the den-
sity wave pattern involved is a spontaneously formed mode that has achieved
quasi-steady state Z98 When this state is achieved the rate of global wave
amplication through over-reection at corotation is balanced by the local
dissipation at the spiral-arm collisionless shock The wave amplitude as well
as its shape are unchanged at least on the timescale of local dynamical
time or galaxy rotation period and the only measurable secular change is
the slow redistribution of disk matter both inside and outside corotation as
well as the heating of disk stars and the energy injection into interstellar
medium ISM The quasi-stationary spiral structure QSSS hypothesis had
been used in the past few decades by many workers to explain the grand-
design spiral structures in galaxies Bertin et al 1989ab and the references
therein though in these previous analyses the mechanisms for wave damping
and for secular evolution of the basic state were not properly identied
How good are the modal and QSSS hypotheses Are there any objec-
tive ways we can judge these Earlier workers for example Elmegreen 
Elmegreen 19831989 employed statistical arguments to support the QSSS
hypothesis and N-body simulations provided support to the modal and QSSS
hypotheses to varying degrees Donner  Thomasson 1994 Z98 Zhang 
Buta 2007 2015 Buta  Zhang 2009 used near- and mid-infrared im-
ages of galaxies to show that for nearby grand-design galaxies the level of
quasi-steady state for the density wave patterns involved can be judged from
the coherence of the potential-density phase shift curves and from the level
of agreement between the phase-shift positive-to-negative zero-crossing pre-
dictions for the corotation resonance CR radii and the actual resonance
features in galaxies
Independent studies have conrmed the accuracy of
the potential-density phase shift method for determining the CRs in grand
design galaxies ie Haan et al 2009 who compared several methods for
CR determination previously published in the literature and stated For our
galaxies the phase-shift method appears to be the most precise method with
uncertainties of 5-10  as well as Martinez-Garcia et al
20091011
who used a color gradient method to determine CR and among their sam-
ple galaxies which overlapped with that of Zhang  Buta 2007 or Buta 
Zhang 2009 there is good agreement in the CR locations determined by
these two independent approaches
412 Analogy with Fully-Developed Turbulence
In what follows we demonstrate another eective approach for determin-
ing the quasi-steady state QSS of the modes11 in addition to our previ-
ous approach of comparing the phase shift zero crossings with the resonant
features on the galaxy images This time instead of using just the radial
distribution of the potential-density phase shift we will actually make use
of the mass-ow-rate curve even though the two curves have the same zero
crossings because as it turns out the magnitude of the mass ow rate curve
provides crucial information about the quasi-steady modal status as well
In Figure 31 we present the comparison of radial mass ow rates of
six galaxies calculated using the torque equation 8 rst using only the
m2 Fourier components dashed curves for the perturbation density and
potential and subsequently using the full set of Fourier components solid
curves The solid curves had previously been published in Zhang  Buta
2015 We see immediately that apart from minor dierences the agreement
between the m2 calculation and mfull short-hand for using all Fourier
components calculation agree to a high degree In particular slightly larger
disagreements were obtained for the two galaxies NGC 5194 or M51 and
NGC 3627 which is part of the Leo Triplet interacting galaxy group that
are known to be undergoing tidal interactions We also notice that along
the trend of Hubble type evolution from late to early left to right top to
bottom for these six galaxies in Figure 31 the agreement between the m2
and mfull mass ow rates gets progressively better
In Figure 32 we present similar comparison of m2 and mfull mass
ow rates for galaxy NGC 1530 rst analyzed in Zhang  Buta 2007
This galaxy has exceptionally high mass ow rate even though it is in a rela-
tively isolated environment We observe that the mfull mass ow rate was
11We use QSS in the following instead of the original QSSS abbreviation here because
we are considering the quasi-steady state of both the spiral and bar modes Note that
in order for the phase shift and torque relation to be applicable the quasi-steady state
for the wave mode only need to be maintained on the order of local dynamical time scale
ie galaxy rotation period so the secular changes in the modal shape due to the secular
changes of the basic state does not hamper the applicability of the phase-shiftvolume-
torque calculation approach
Figure 31 Radial mass ow rates for the six sample galaxies of Zhang  Buta 2015
The solid lines are calculated using the full Fourier spectra of density and potential and
the dashed lines using only the m2 components
signicantly higher than the m2 mass ow rate though the zero-crossings
of the two curves are similar indicating that the amplitude of the mode is
yet to settle into its quasi-steady value even though the modal density pro-
le appears to be stabilized The amplitude of the mode is obviously on the
In Z98 we have demonstrated that the growth rate of the mode g due
to global amplication and feedback cycle is positively correlated with the
fraction of m2 sinusoidal modal component in the density wave composition
since only the m2 modal component has the correct phase relation between
the over-reected wave train from corotation and the incoming wave train
in order to form growing mode whereas the higher harmonic components
cancel out due to their lack of correct phase relations On the other hand
the eective dissipation rate d of the mode once the wave has acquired
sucient nonlinear amplitude is approximately independent of the exact
nonlinear distortions of the wave prole since d is determined mainly by
the potential density phase shift pattern for a wave with a given amplitude
and the phase shift was shown to be relatively independent of the degree
of nonlinearity in the azimuthal density prole of the mode Figure 5 and
Figure 6 of Z98 Therefore for high-amplitude very nonlinear density
wave mode such as present in NGC 1530 the mode is able to manipulate the
degree of nonlinearity of its azimuthal prole to boost up the damping rate
as compared to the growth rate in order to evolve towards a quasi-steady
equilibrium amplitude
The results shown above that at quasi-steady state of the wave mode the
m2 and mfull contribution to radial mass ow are approximately equal
might appear at rst sight to be surprising ie how could something that
is supposed to be only a part of the whole be equal to the whole Here
we need to realize the specialness of a self-organized density wave mode that
has achieved quasi-steady state The mode had gone through many cycles
of ne adjustments among its various physical processes so that global the
self-consistency condition is achieved Among these processes one of them is
the randomization of the orbital energy of the basic state matter during the
energy and angular momentum exchange between the wave mode and the
basic state through the mediation of the collisionless shock at spiral arms
This randomization process happens both for the stellar and for the ISM
components of the galaxy disk mass and there are in fact two aspect to it
Z99 one aspect is the randomization of the orbital energy corresponding
to p  Lwave where p is the pattern speed of the wave and Lwave is the
Figure 32 Radial mass ow rate for NGC 1530 rst analyzed in Zhang  Buta 2007
The solid line is calculated using the full Fourier spectra of density and potential and the
dashed line using only the m2 components
angular momentum density of the wave this contributes to the damping
of the wave and the secular decay of the mean stellar orbit the second
aspect is the randomization of the residual orbital energy corresponding to
  p  Lwave for matter inside corotation There is a corresponding
sign change for matter outside corotation This second aspect results in the
secular heating of the disk stars which produces the age-velocity dispersion
relation of the solar neighborhood stars Z99 as well as the energy injection
into the interstellar medium to fuel a cascade process akin to the driven
turbulence in uid dynamics which produces the Larson-Law size-line-width
correlation of the interstellar clouds See Larons 1981 Zhang et al 2001
Zhang 2002 Falceta-Goncalves et al 2015
Stars appear to accomplish the randomization of the orbital energy also
through a kind of cascaderandomization process from the large to the pro-
gressively smaller scales The smaller scale nonlinear exchange is nothing
more than the cascaded-down version of the large-scale exchange and does
not create a new term in the energy balance equation Another way to look
at this matter is that at the QSS the growth rate of the m2 mode is equal
to the growth rate of the full nonlinear mode since the nonlinear mode does
not have an independent global amplication mechanism other than the cas-
cading of energy from the m2 component Therefore at the QSS the m2
mode dissipation rate or the m2 torque integral is formally equal to the
m2 growth rate12 with the m 6 2 components formally have zero growth
rate as well as zero dissipation rate even through in reality the m2 mode
cannot accomplish energy dissipation without going through the cascade into
nonlinear components
This aspect of local interactions in density waves is in essence the same
as what Kolmogorov had hypothesized for the energy cascade process of
fully-developed uid turbulence in the inertial range Frisch 1995 The fact
that galaxies can randomize the originally coherent orbital velocityenergy
is due to the global-self-consistency constraint of the spontaneously-formed
density wave mode at the quasi-steady state which produced both the lo-
cal instabilitycollisionless shock condition at the spiral arms as well as the
detailed correlation between kinematic and positional distributions of disk
matter that enable both wave growth and damping accompanied by dissi-
pative basic state evolution
In what follows we present similar m2 versus mfull mass ow rate
comparison calculated using the surface density and potential obtained in
our previous set of four N-body simulations In Figures 33 34 35 and 36
we show the respectively calculated m2 and mfull mass ow rates for the
four runs at six dierent time steps and for a duration of 3000 steps which
correspond to about two and a half galactic rotation periods at radius 20
during the emergence and stabilization of the rst dominant mode in each
From these four gures we can tell that for every softening choice when
the modal shape and kinematics have achieved quasi-steady state the agree-
ment between the m2 and mfull mass ow rates are very good just as
what we had observed for physical galaxies Note that the QSS state can be
short-lived even after its initial acquirement because the disk surface den-
sity and modal shape continue to evolve throughout the simulation run for
each case Still exploration into further time period of the modal evolution
12We say formally here because the torque integral acquires its meaning as corresponding
to the dissipative angular momentum exchange between the wave and basic-state matter
only for the overall full nonlinear set of components at the QSS For each m component
individually or for waves not at the QSS the torque integral does not uniquely predict
anything since it is a spatial average of time-dependent quantities In other words the
torque integral when used to predict the wavebasic-state angular momentum exchange
is a form of closure relation enforced through the consideration of global energy balance
at the QSS of the wave mode
Figure 33 Radial mass ow rates for the N-body spiral mode with asof t  15 at six
dierent time steps using the full or m2 Fourier components
Figure 34 Radial mass ow rates for the N-body spiral mode with asof t  075 at six
dierent time steps using the full or m2 Fourier components
Figure 35 Radial mass ow rates for the N-body spiral mode with asof t  025 at six
dierent time steps using the full or m2 Fourier components
Figure 36 Radial mass ow rates for the N-body spiral mode with asof t  01 at six
dierent time steps using the full or m2 Fourier components Note the contribution
of a local instability clump in the last two frames which have poor m2 and mfull
agreement as to be expected of this non-modal feature
not shown here because of the space constraint show that a new QSS phase
can once again be achieved signied by good agreement between m2 and
mfull mass ow curves after its temporary loss as a result of the basic state
evolution In particular the asof t  01 run showed a most robust correlation
of m2 and mfull mass ow curves throughout the simulation duration 25
galactic rotation periods at radius 20 likely a result of the fact that small
softening allowed eective inter-particle correlations to quickly re-establish
each new global-self-consistency state as the basic state continuely to evolve
42 Accuracy and Implications of the Secular Radial Mass Flow Rates Ob-
tained in N-Body Simulations
In Appendix D we present detailed analyses of the eect of the choice
of softening parameter on the accuracy of particle-mesh N-body simulations
particularly for the polar-grid conguration We saw there that grid noise
can be of concern for small-softening large-grid-size simulations see also
Efstathiou et al 1985 Figure 1 For simulation parameter combinations
where asof t is small the grid used is coarse and for outer disk region where
the cell size is large grid noise has a signicant impact on the accuracy of
individual stars orbit  if the accuracy of individual orbit is what we are
after in the simulation eort
However as we have shown in this paper when simulating global density
wave modes in galactic disks grid noise does not appear to have a detrimental
eect on the macroscopic properties of the modes as well as on the correlation
of modal parameters and their associated basic state evolution rates
This positive outcome becomes easier to understand if we recall that in a
disk system possessing collective instabilities individual simulated orbits had
long been known to diverge exponentially from true orbits in the presence of
random noise especially for simulations dealing with collective instabilities
see eg Miller 1971 Pfenniger 1986 Romeo 1990 Weinberg 1993
This exponential divergence between the simulated individual orbits and their
true counterparts in globally unstable systems is present even when large
softening length is used
On the other hand the collective behaviors of the modes being mod-
elled were found not to be impacted by the microscopic inaccuracies of the
simulated individual orbits  otherwise NONE of the previously published
N-body simulations of galaxies containing unstable density wave patterns
can be trusted This delity of simulated global pattern in the face of drastic
exponential individual orbit inaccuracy comes about because self-organized
global structures such as spiral and bar modes are dissipative structures
in the sense of Prigogine and coworkers Prigogine 1980 or else strange
attractors in the sense used in nonlinear dynamical systems Wiggins 2003
and the references therein These systems automatically seek their attrac-
tormodal solutions even if perturbed from corresponding nonequilibrium
steady states This property is the well-known asymptotic stability of the
dissipative nonequilibrium quasi-steady state In the case of galaxies pos-
sessing density wave modes the eective collisionscattering processes at
the crest of density wave patterns re-establish the correlations needed for the
self-organization and collective dissipation processes even if microscopically
these orbits are not exactly what they would be for an innite-precision cal-
culation From this perspective it also becomes clear why a smaller-softening
choice which allows the proper establishment of correlations among particles
in a simulated galaxy disk is more important than the accurate modeling
of a large-softening disk which lacks the proper correlation among particles
the near-collision or the scattering condition allowed by small softening or
ecient inter-particle interaction is what establishes the correlations among
particles to allow the collective instability to successfully operate
As we have seen macroscopic properties of the evolution of the global
density wave patterns as well as the evolution of the basic state are not
impacted by the inaccuracies in the behavior of the individual particles or-
bits Furthermore if the noise in individual stellar orbits had mattered even
in physical galaxies we should not have been able to observe the beautifully
organized grand-design density wave structures since in these galaxies the
stellar orbits are perturbed by chance encounters with the Giant Molecular
Cloud Complexes the tidal companion galaxies as well as the formation of
disk open- and globular star clusters The stability of the global pattern char-
acteristics against random uctuation is indeed what allowed these patterns
to emerge as a predominant form of organization in disk galaxies and to have
the modal characteristics correlate with that of the basic state13 rather than
with the chance elements of internal and external random perturbations
One question that may arise from examining the results of this work is
that since the dierent softening-parameter runs gave dierent mass ow
13We recall that one of the criteria of the Hubble classication scheme is the empirically
observed correlation of spiral pitch angle with the degree of prominence of the bulge This
correlation has been reproduced in the modal picture of the galactic density waves Bertin
et al 1989ab
rates what magnitude of the mass ow should we associate with the secular
morphological evolution of physical galaxies
We note that the aim of these simulations is not to derive an absolute
mass ow rate and claim that it corresponds to that in all physical galaxies
but rather to demonstrate the correlation between the N-body simulated
mass ow rate and the rate predicted by the volume-torquemass-ow-rate
equation ie equation 8 A conrmation of this correlation shows that
the analytical equation predicts the correct mass ow rates for all ranges of
the wave and basic state parameters then the rate equation can be used in
physical galaxies with the actually measured paremeters for the wave and
the basic state
In the simulation results presented in this section we had indeed shown
that once the collective eects are allowed to be fully represented either
by the use of suciently small asof t or else by the enforcement of special
bi-symmetry condition all of the measured mass ow rates in N-body simu-
lations at a wide range of softening lengths have the correct correspondence
with the respective analytical predictions especially for the radial range in-
side corotation which is our main interest in the secular evolution studies
Therefore these pattern morphologies and mass ow rates can all nd cor-
respondence with physical galaxies of varying Hubble types In fact a little
contemplation will show that the larger softening choices correspond to the
thicker inner disk scale heights and smaller secular mass ow rates of the ear-
lier Hubble type galaxies whereas the smaller softening choices correspond
to the thinner disk and the larger secular mass ow rates of later Hubble
type galaxies Zhang  Buta 2007 2015
43 Irreversibility and Singularity-Hierarchy in Natural Systems
Returning to some of the questions we posed in the introduction section
we note that accompanying the emergence of global patterns in an originally
featureless system past its instability threshold there is also the spontaneous
emergence of new meta-laws The torque-integralmass-ow rate equation
we have conrmed using N-body simulations in this work is an example of
emergent meta-law The original derivation of this law required the assump-
tion of global self-consistency between the various physical processes in the
galaxy ie the compatibility of the energetics of the wave mode versus the
energetics of the basic state which is essentially the requirement for global
energy and angular momentum conservation as well as the assumption of
quasi-steady state of the wave mode which is an empirically well-supported
hypothesis
Given these two very reasonable basic assumptions the outcome of the
secular evolution of the basic state of the galactic disk is inevitable given
that the patterns matter distribution and kinematics naturally lead to the
characteristic potential-density phase shift pattern which implies a secular
torque action by the wave mode on the basic state and thus secular en-
ergy and angular momentum exchange between the two components The
operation of this exchange process is necessarily dissipative as there is the
irreversible conversion of stellar orbital energy into random motion energy
of stars Furthermore the working of the dissipation mechanism requires
the presence of collisionless shock at the wave crest or a temporary local
gravitational instability at the spiral arms Z96 This further implies that
the location of the spiral arms is an eective singularity of the underlying
dierential uid formulation the arguments for the inevitability of the for-
mation of this singularity or collisionless shock through the azimuthal steep-
ening of the spiral wave solution using an Eulerian equation set was given
in Z96 based on the earlier work of Lubow Balbus  Cowie 1986 Z98
Z99 showed that the breakdown of the dierential form of the Poisson equa-
tion at the density wave crest the site of local instability and collisionless
shock is a necessary ingredient for the global self-consistency of the govern-
ing equations to be achieved The integral form of the Poisson equation is
what we use to obtain the global phase shifted perturbation potential from
the perturbation density This should come as no surprise since we know
that across any hydrodynamic shock the dierential formulation invariably
breaks down see for example Shu 1992 and the properties of the shock-
jumps are established by enforcing global conservation relations just as what
we have done in this work by enforcing global self-consistency requirement
between the kinematics and mass distribution of the density wave mode and
between the energetics of the wave mode and the basic state of the disk Z96
Generalizing what we have learned in this work we realize that in nature
irreversibility may be the rule rather than the exception even though the
dierential forms of governing equations that we commonly employ are all
time-reversible We now realize that these dierential laws are likely to be
idealizations and their origins may be emergent under the general boundary
conditions of the evolving universe
In this sense laws and meta-laws or
fundamental laws and emergent laws have no clear distinction It all depends
on the scale we conduct our observations and analyses in
We also realize that eective singularity hierarchies as reected for ex-
ample in the spontaneous emergence of density wave modes and the attain-
ment of new closure relations at the QSS may be the general mechanism
nature employs to separate the dierent domains of physical and biological
sciences Within a given hierarchy deductive approach may be used to ar-
rive at new inferences However when we are crossing the boundary of a
given hierarchy such as in the study of the emergence and maintenance of
global spiral modes as well as the secular evolution of the basic state as
a result of the interaction with these modes we need to rely on empirical
evidence such as the QSS hypothesis of the mode meta-principles such
as the second law of thermodynamics and the theory of dissipative struc-
tures as well as reasonable global closure relations such as global energy
and angular momentum balance considerations in order to establish a new
axiomatic structure for the subsequent analyses
With the guidance of these general principles we can then explore the
detailed workings of the various facets of the proposed new paradigm in the
case of spiral galaxies this involves the discoveries of the mechanisms of wave
mode amplication through over-reection and feedback wave stabilization
through damping by the basic state energy and angular momentum input
the realization of local mechanisms of dissipation or energy cascade by the
action of collisionless shocks the demonstration of the presence of potential-
density phase shift in a self-sustained density wave mode by both the integral
form of the Poisson equation and the equations-of-motion of disk matter
We now also have a tentative answer to the one question that Feynman
raised that we had quoted in the Introduction of this paper Schrodingers
equation most likely does not directly predict the existence of frog musical
composers and morality Since the physical universe is organized in a hierar-
chical fashion with eective singularities separating the dierent hierarchies
and since emergent laws governing the higher level phenomena cannot be
deductively derived from the lower level fundamental laws the claim that
complex phenomena of the universe can be logically derived from a simple
set of fundamental equations is unfounded Instead the dierential forms of
equations governing given regimes of physics are expected to be idealizations
that have limited range of applicability and will break down at instabil-
itysingularity front of the next emerging hierarchy In such cases guided
by empirical evidence and physical intuition new global-self-consistency or
closure relations and new meta laws formulated perhaps as a new set of dif-
ferential equations with their new range of applicability need to be obtained
to guide the analyses
The universe since the Big Bang is in a process of irreversible evolution
If we take into account the subtleties of quantum mechanics no process is
truly reversible ie no physical system can become truly isolated Yet we
have learned in this work that some processes are more irreversible than oth-
ers ie those that involve self-organized structures that drastically increase
the rate of entropy production generate levels of irreversibility exponentially
faster than processes that are passive Dissipation is an important element of
the formation of nonequilibrium self-organized structure because it helps to
stabilize the dynamical equilibrium state as highlighted by the uctuation-
dissipation theorem by damping out random noise uctuations
5 CONCLUSIONS
The low radial mass rates found in the past N-body simulations of disk
galaxies had cast doubts on the eectiveness of secular evolution as an im-
portant dynamical process for the morphological transformation of galaxies
along the Hubble sequence In this work it is shown that such low numerical
mass ow rates were chiey the result of the articial softening of gravity
which is a common practice in galaxy simulations to avoid the rapid relax-
ations caused by the used of smaller number of particles compared to that
in physical galaxies By decreasing the amount of softening and simultane-
ously increasing the number of simulation particles as well as increasing the
grid and time resolution realistic levels of mass inow comparable to those
obtained for physical galaxies are now achievable in N-body simulations and
these mass ow rates are shown to agree with theoretical predictions using
the density wave parameters obtained in the same simulations The results
of this study thus support the importance of secular evolution in particular
radial stellar mass accretion as an extremely relevant dynamical process in
transforming the morphologies of galaxies during the past Hubble time The
exploration of the process of the emergence and maintenance of density wave
modes as an example of dissipative structures also sheds light on more
general questions regarding the emergence and the role of ordered hierarchy
of structures and laws in the evolution of the universe
REFERENCES
Anderson PW 1972 Science 177 393
Antonov VA 1962 Vest Leningr Gos Univ 7 135
Balogh A Treumann RA 2013 Physics of Collision Shocks New York
Springer
Bertin G Lin C C Lowe S A  Thurstans R P 1989a ApJ 338
Bertin G Lin C C Lowe S A  Thurstans R P 1989b ApJ 338
Binney J  Tremaine S Galactic Dynamics Princeton PUP
Buta R  Zhang X 2009 ApJS 182 559
Donner KJ  Thomasson M 1994 AA 290 785 DT94
Efstathiou G David M Frenk CS  White SDM 1985 ApJS 57
Elmegreen BG  Elmegreen DM 1983 ApJ 267 31
Elmegreen BG  Elmegreen DM 1989 in Evolutionary Phenomena
in Galaxies eds JE Beckman  BEJ Pagel Cambridge CUP 83
Feynman RP Leighton RB  Sands M 1963 The Feynman Lectures
on Physics vol I 7-7
Feynman RP Leighton RB  Sands M 1964 The Feynman Lectures
on Physics vol II 41-12
Falceta-Goncalves D Bonnell I Kowal G Lepine JRD  Braga
CAS 2015 MNRAS 446 973
Frisch U 1995 Turbulence The Legacy of AN Kolmogorov Cambridge
Haan S et al 2009 ApJ 692 1623
Hockney RW  Eastwood JW 1988 Computer Simulation Using
Particles
Kalnajs AJ 1965 PhD thesis Harvard Univ
Kalnajs A J 1972 Astrop Lett 11 41
Kormendy J 1979 ApJ 227 714
Kormendy J  Kennicutt R 2004 ARAA 42 603
Kreuzer HJ 1981 Nonequilibrium Thermodynamics and its Statistical
Foundations Oxford OUP
Larson RB 1981 MNRAS 194 809
Lin C C  Lau Y Y 1979 Stu Appl Math 60 p 97
Lin C C  Shu F H 1964 ApJ 140 646
Lindblad B 1963 Stockholms Obs Ann 22 5
Lynden-Bell D  Kalnajs A 1972 MNRAS 157 1
Lubow S H Balbus S A  Cowie L L 1986 ApJ 309 496
Lynden-Bell D  Wood R 1968 MNRAS 138 495
Mark JW-K 1976 ApJ 205 363
Martinez-Garcia EE Gonzalez-Lopezlira RA  Bruzuel AG 2009
ApJ 694 512
Martinez-Garcia EE Gonzalez-Lopezlira RA  Bruzuel AG 2011
ApJ 734 122
Miller RH 1971 J Comp Phys 73 90
Miller RH 1976 J Comp Phys 21 400
Pfenniger D 1986 AA 165 74
Prigogine I 1980 From Being to Becoming New York Freeman
Romeo A 1990 PhD Thesis ISAS
Romeo A 1994 AA 286 799
Romeo A 1997 AA 324 523
Romeo A 1998 AA 335 922
Rybicki GB 1971 ApSS 14 15
Sellwood JA 1987 ARAA 25 151
Shu FS 1992 The Physics of Astrophysics vol 2 Mill Valley Univ
Sci Books
Sparke LS  Sellwood JA 1987 MNRAS 225 653
Thomasson M 1989 Research Report No 162 Dept Radio and Space
Science with Onsala Space Observatory Chalmers Univ of Techn Goteborg
Thomasson M Donner KJ  Elmegreen BG 1991 AA 250 316
Toomre A 1981 in Structure and Dynamics of Normal Galaxies eds
SM Fall  D Lynden-Bell Cambridge CUP 111
Weinberg M 1993 ApJ 410 543
White RL 1988 ApJ 330 26
Wiggins S 2003 Introduction to Applied Nonlinear Dynamical Systems
and Chaos 2nd ed New York Springer
Zhang X 1996 ApJ 457 125 Z96
Zhang X 1998 ApJ 499 93 Z98
Zhang X 1999 ApJ 518 613 Z99
Zhang X 2002 ApSS 281 281
Zhang X 2003 Journal of the Korean Astronomical Society 36 223
Zhang X 2008 PASP 120 121
Zhang X  Buta R 2007 AJ 133 2584
Zhang X  Buta R 2015 NewA 34 65
Zhang X Lee Y Bolatto A  Stark A A 2001 ApJ 553 274
APPENDIX A POTENTIAL-DENSITY PHASE SHIFTS AND
RADIAL MASS FLOW RATES
The original derivation of the collective dissipation mechanism responsible
for the secular redistribution of galaxy disk mass can be found in Z96 Z98
Z99 Here we give a brief summary of the analytical results used in the main
text of the current paper
For a disk galaxy with non-axisymmetric density and potential pertur-
bations of 1 and V1 respectively the z-component torque applied by the
total potential on the material at a unit-width annular ring at a galactic dis-
tance R which at the quasi-steady state of the density wave mode is equal
to the averaged rate of angular momentum ow from the wave to the disk
material is
T R  RZ 2
1R 
V1R 
d  2R
where L is the angular momentum density of the disk material It can be
shown that the only way for this torque and angular momentum exchange
expression to be non-zero is to have the potential perturbation phase-shifted
in azimuth from the density perturbation which is naturally satised by a
spontaneously formed skewed density wave mode Z96 For such a mode
the phase shift distribution versus galactic radius is of a characteristic two-
humped shape positive inside corotation and negative outside with the zero-
crossing of phase shift versus galactic radius curve happen at corotation ra-
Based on the above torque expression the equivalent phase shift 0 be-
tween two nonlinear wave forms is dened as 1998
sin1
 d
1 dqR 2
where m is the number of spiral arms and the sign of the phase shift is dened
such that the phase shift is positive when the potential lags the density in
the direction of galactic rotation The equivalent phase shift is the amount
of phase shift which would be present between two sinusoidal wave forms if
each is endowed with the same energy as the corresponding nonlinear wave
form and which would lead to the same value for the torque integral as would
the nonlinear waveforms Note that in the above expression the perturbation
waveforms must have their azimuthal mean values subtracted
The inward radial mass accretion rate at a galactic radius R is related
to the mean orbital decay rate dRdt of an average star through
2R0R
where 0R is the mean surface density of the basic state of the disk at
radius R
We also know that the mean orbital increase rate of a single star dRdt
is related to its angular momentum gain rate dLdt through
 VcM
where Vc is the mean circular velocity at radius R and M the mass of the
relevant star
Now we have also
where dL
per unit area at radius R
dt R is the angular momentum gain rate of the basic state disk matter
R  
Z96 we have nally
2 Z 2
Vc Z 2
where the subscript 1 denotes the perturbation quantities This result even
though derived through the stellar orbital decay rate is in fact general and
can be applied to the mass accretion rate of both stars and gas as long as
the relevant perturbation surface density is used The perturbation potential
eld used in the calculations needs to be the total potential ie stars plus
gas however We see also from the expressions of mass ow equation 8
and phase shift equation 3 that they share the same zero crossings that of
the zero crossings in the torque integral expression but have dierent radial
amplitude modulations
From the above equation it can be also shown that for waves with mod-
erate pitch angles the mass ow rate can be further written in terms of the
parameters of the wave and basic state Z98 51
 F 2RVc tani sinm00
where F is the fractional amplitude of the wave dened as the geometric
mean of the fractional potential wave amplitude and fractional density wave
amplitude i is the pitch angle of the wave m is the number of arms usually
taken to be 2 0 is the azimuthal potential-density phase shift and 0 is
the local surface density of the basic state mass distribution
For the phase shift distribution of a spontaneously formed spiral or bar
mode the direction of torque or the sign of phase shift leads to mass inow
inside corotation and outow outside corotation Z96 Z98 The existence
of the phase shift distribution across the galactic radius for a spontaneously
formed density wave mode thus serves as the natural engine for the secular
evolution of galaxies The role of the density wave pattern is functional as
well as structural and the most important function of it is to accelerate
the entropy evolution of the parent system as is the case for all dissipative
structures Prigogine 1980
APPENDIX B CHOICE OF BASIC STATE PARAMETERS
We have chosen to use normalized units in the N-body calculations for
In these
this work similar to that used in Donner  Thomasson 1994
units the total mass of the disk including the active disk mass md the inert
halo mass mh and the inert bulge mass mb sums to 1 ie
mtotal  md  mh  mb  1
Z96 used the set of mass ratios md  mh  mb  05  04  01 the same as
used in Donner  Thomasson 1994 whereas Z98 Z99 used an alternative
set of md  mh  mb  04  05  01 which is what is used for the basic state
in the current paper This slightly diering choice in the second set allows a
more long lasting dominant mode to be present during the simulation run
The disk surface density used in the simulations is in the form of a modi-
ed exponential which is an exponential with a central hole accounting for
the fact that the active disk mass decreases in the center and the mass in
the central region is dominated by the bulge mass
dr  d0erRd  e2rRd
where we have chosen Rd  10 for the disk scale length in the normalized
unit and d0 is a constant chosen to make the total disk mass of the correct
amount md in the normalized unit The curve for this basic state mass
distribution can be found in Figure 5 and Figure 30 as the initial surface
density distribution solid line
An inactive bulge and a rigid halo ie used purely for their gravitational
eect on the disk particles while their own mass distributions are not recom-
puted as a response to the disk evolution are also used which are assumed
to be of the regular exponential shape
hr  h0erRh
br  b0erRb
The scale lengths are Rh  5 and Rb  1 for the rigid halo and bulge
component respectively These choices of the three mass components result
in a nearly constant rotation curve with velocity vc  01 in the normalized
unit for the simulation parameter choice of the main body of the paper and
double that for the grid softening test presented in Appendix D3
The choice for the initial radial velocity dispersion for the galaxy simula-
tions in this work leads to an initial instability parameter Q of 10 throughout
the disk
This particular choice of the basic state allows a resonant cavity to be set
up between the corotation region around r  30 in the normalized unit for
largest softening run and r  20 for the smallest softening run and the inner
bulge region which serves as a Q-barrier to reect the inwardly-propagating
wave train to complete the feedback cycle so a normal mode of the galactic
disk can spontaneously emerge
APPENDIX C CHOICE OF SIMULATION PARAMETERS AND
DESCRIPTION OF NUMERICAL PROCEDURES
The simulation grid of this work is a polar grid similar to the original one
used by Miller 1976 with radial grid rings distributed in an exponential
fashion and the azimuthal grid spokes distributed in a uniform fashion ie
r  Leu
  v
where u has integer values that range from 0 to nu  1 and v has integer
values that range from 1 to nv L is the constant length scale factor usually
chosen to be 1 in the normalized unit and   2nv nv is usually selected
to have a power of two so as to allow the use of the FFT algorithm for
force calculation in the azimuthal direction The exponentially spaced radial
grid and uniformly spaced azimuthal grid with compatible choice of nu and
nv ensure that the grid shape remains roughly square throughout the radial
range of a galaxy disk one of the main reasons for adopting an exponentially
spaced radial grid This choice of grid spacings also naturally matches the
mass density distribution in disk galaxies which has higher density and more
nely-resolved density wave patterns in the inner disk
Donner  Thomasson 1995 selected a grid of nu  50 radial grid cells
and nv  64 for the azimuthal grid cells together with 50000 active disk
particles These parameters have been slightly changed in the simulations
of Z96 to 110 128 and in Z96 Z98 to 55 64 The grid used in current
paper for all the simulations in the main text used a simulation grid of 220
256 and that in Appendix D3 used a grid of size 110 128
The active disk particles were initially assigned on rings with constant
particle number per ring nring  2  nv2  1 but variable ring spacings
to represent the changing disk surface density with galactic radius The
cloud-in-cell CIC interpolation approach see eg Hockney  Eastwood
1988 Chapter 5 is employed for grid mass assignment from the disk particle
mass distribution Fast Fourier Transform FFT approach was employed
for grid potential calculation based on grid mass and forces on grid points
were calculated using nite dierence of the grid potential The forces on
disk particles are then calculated once more through the CIC method from
grid force and these disk particles are subsequently moved around using a
time-centered leap-frog scheme Sucient time step resolution is chosen to
ensure stability and accuracy
The length of the time step is chosen through a parameter called the
number of time steps per crossing time Sstpcrt at a given radius usually
chosen to be Rd  20 which is within or close to the corotation radius
This number is dened as the time steps it takes for a particle to cross the
specied disk radius Rd ie
t  Sstpcrt 
where t  1 is the normalized unit of time step and Vc is the rotation
curve value In the original Donner  Thomasson 1994 simulation Sstpcrt
was chosen to be 50 which corresponds to 314 time steps per rotation period
at radius 20 The same value was chosen also in Z98 Z99 though Z96
chose Sstpcrt  100 to correspond to the doubling of the time resolution
for that particular set of simulation We have chosen Sstpcrt  200 for the
simulations in the main body of the text and this corresponds to 1256 steps
per rotation period and Sstpcrt  100 for the simulation in Appendix D3
all at radius r20 These Sstpcrt choices are made in order guarantee the
numerical stability of the computation algorithm
After Sstpcrt is determined a renormalized gravitational constant Gnew is
computed and is used to replace the Gold in the usual Newtonian equations
The new and old gravitational constants are related through
t2S 2
where Vd Vh Vb are the rotation velocity contribution of the dierent mass
components to the total rotation curve of the galaxy ie
d  mhV 2
h  mbV 2
b  mtotalV 2
c  V 2
since mtotal  1 in the normalized units With these choices of t and Gnew
the desired Sstpcrt will be achieved
Further details of the numerical procedure can be found in Miller 1976
Thomasson 1991 Donner  Thomasson 1994 as well as in Z96 Z98 Z99
APPENDIX D GRID NOISE ASSOCIATED WITH THE USE
OF SMALL PARTICLE SOFTENING PARAMETER
In this appendix we address the issue of whether the quality of the sim-
ulation results presented in this paper is negatively aected by the use of
small particle-softening parameter asof t We will show that the eective disk
thickness in these 2D simulations is maintained mainly by the nite size
of the grid whereas the eective inter-particle interaction which allows the
operation of collective instability is enhanced by the choice of small particle
softening paremater asof t The combined eects of the two coupled with suf-
cient number of simulation particles and ner grid allows the macroscopic
features of the modes to be faithfully reproduced despite of the increased
noise on individual particles orbit
D1 The Diering Roles of Grid and Particle Softening
In the simulations described in the main body of this paper while the
particle softening parameter asof t had been drastically reduced in some cases
the corresponding grid softening had not been reduced to a similar extent
the newer grid is only about a factor of 4 ner in linear resolution compared
to that used in Z98 whereas the particle softening is reduced by a factor of 15
for the extreme choice of asof t  01 It thus appears that particle softening
is the main inhibitor to obtaining higher mass ow rates the grid softening
has only marginal eect the new simulation maintaining asof t  15 but with
4 times the linear resolution compared to Z98 did not seem to aect the mass
ow rate by much whereas decreasing asof t clearly allowed the radial mass
ow rate to increase even starting with a factor of 2 asof t reduction as seen
in Figure 3 especially for the very central region where enough mass supply
both from the local mass surface density as well as from the mass inow
from the outer disk was available to support the continued mass inow and
bulge building
Finite amount of grid softening on the other hand helps to maintain the
desirable nite disk thickness eect in these 2D simulations The eective
disk thickness is the geometric mean of the particle and grid softening lengths
The nite disk thickness in our simulations manifests both in the particle-
number dependence of the noise performance Figure 5  since relaxation
in a razor-thin disk should have showed no particle-number dependence Ry-
bicki 1971 as well as in the longevity of the spiral-bar patterns formed 
since a razor-thin disk is known to have relaxation time scale on the order
of a mean orbital period Rybicki 1971 whereas the patterns in our simu-
lations especially the underlying m2 component using sucient number
of particles were shown to last more than 25 orbital periods
In fact Rybicki 1971 already pointed out the role of nite grid size
on mimicking a nite-thickness disk Basing his analyses on the cumulative
eect of short and long-range interactions Rybicki 1971 derived that for
a numerical disk which has grid size of h the relaxation time tR can be
expressed as
3NhtM
where  is the ratio of random velocity  to circular velocity V  ie  
V   1 and tM is the orbital crossing time ie tM  RV where R is the
disk radius
The above expression of Rybickis is nearly equivalent to another expres-
sion derived in White 1988
where  is the surface density of the disk and G is the gravitational constant
and m is the mass of the particle Whites expression can be shown to be
equivalent to Rybickis if we replace the factor of 5 in the denominator of
Whites expression by a factor of 2 in Rybickis or  if the crossing time
is dened using the diameter instead of the radius of the system Rybicki
1971 stated that the factor h is either the particle softening length asof t or
the grid size h whichever is greater Donner  Thomasson 1994 on the
other hand argued that the eective softening length is the geometric mean
of particle and grid softening ie h  qs2  a2
sof t where s is the local grid
Our current worked showed that nite grid size can indeed simulate a
nite-thickness disk in terms of inhibiting the unwanted fast relaxation as
Rybicki had suggested yet it does not seem to signicantly diminish the
desired collective dissipation eect as the choice of large particle softening
length does This is likely to due to the fact that grid softening is im-
plemented in an anisotropic fashion ie the mass and force assignments
are through the same Cloud-in-Cell or CIC interpolation scheme which
apparently helped to retain the correlated angular inhomogeneities of the
particle positions and kinematics in addition to conserving momentum in
eect achieving sub-grid resolution On the other hand particle softening
is an isotropic scheme that uniformly evens out the uctuations in the force
from all directions thus has a more detrimental eect on suppressing the
correlated collective interactions
Figure 37 gives the relaxation time for our previous 20 million particle
asof t  01 simulation calculated using the White 1988 expression above
with h the geometric mean of the particle and grid softening The straight
line in the gure shows the maximum time step duration 32768 used in
the majority of the simulations presented in this paper It can be seen that
over most of the radial range of the simulation disk except for the very
central region the relaxation time is much longer than the duration of the
simulation so two-body relaxation eect should be minimum as was also
borne out by the consistently vigorous spiralbar activity shown in the main
body of the paper
D2 Grid Noise in Particle Mesh Simulations
By choosing to use grid size larger than the particle softening parameter
we do pay a price that of increased grid noise This manifests as uctuations
of the interpolated forces on individual particles as we traverse grid bound-
aries which can also be attributed to aliasing eect in the Fourier transform
domain Hockney  Eastwood 1988 5-6-3 and 5-6-4 Grid noise is more
pronounced for the smallest softening choices asof t  01 and it is also
more pronounced in the outer disk region than in the inner disk for the polar
grid used here since the grid spacings in the outer disk are exponentially
larger than in the inner disk therefore for all the past polar-grid simula-
tions presented in the literature grid noise issue was already present since
Figure 37 Relaxation time in the asof t  01 20 million particle simulation The straight
line in the lower part of the gure indicates the maximum calculation duration used in the
simulations here
even when the particle softening parameter was chosen to be of the order of
the grid size in the inner disk for the outer disk region the grid size is much
larger than the particle softening parameter due to the exponential growth
in grid size in polar grid design
In what follows the results of Monte Carlo calculations are presented to
characterize the magnitude of the grid noise for the simulation parameters
we have used in this paper A source particle is placed at a select radial
location in the disk here we choose two radius values roughly corresponding
to the inner Lindblad resonance and the corotation resonance of the mode
which give approximately the best-case and the worst-case error bounds for a
modal resonant cavity between the inner disk and the corotation radius and
100 test particles are placed at EACH of a range of distances from the source
particles Analytical results from the Newtonian equation with softening
are compared with that obtained in the N-body interpolated grid force
calculation scheme averaged for the 100 test particles for each distance at
a particular choice of asof t
In Figures 38 39 and 40 we plot the noise
performance of the Plummer softening scheme for the choices of softening
parameters and grid sizes used in this study Note that even though the
larger softening case asof t  15 has its CR closer to 30 this large softening
case has relatively small grid noise so the extent of the noise performance in
that case plotted only up to radius of 20 but can be easily extrapolated up
Figure 38 Grid noise estimates for N-body particle-mesh simulations using Plummer
sphere softening with asof t  01 top left asof t  025 top right asof t  075 bottom
left and asof t  15 bottom right respectively All the calculations start with a point-
mass source particle at r10 and with 100 test particles at an average distance d varying
from near zero to about 5 in the normalized unit of the disk from the source particle
randomly placed within the computational grid of 220 exponentially spaced radial sections
and 256 equally spaced azimuthal sections Solid lines are expected N-body performance
with 1  rms uctuations and dashed lines are the corresponding theoretical softened
forces
to 30 is no worse than the worse case scenario for asof t  01 represented
in these gures The trend of increasing grid noise with decreasing softening
with increasing galactic radius and thus grid size and with overall grid-
coarseness are evident in these plots
In the main text we have shown that despite the uctuations of the forces
caused by the increased grid noise for small softening runs the azimuthally
averaged torques and mass ow rates converge to theoretical expectations
for the simulation of the self-organized density wave modes Beside the ar-
guments presented in the main text based on the asymptotic stability of
the patterns amidst noise we can also regard the mass assignment onto grid
as a kind of cluster clump formation in real galaxies Even though the
Figure 39 Grid noise estimates for N-body particle-mesh simulations using Plummer-
sphere softening with asof t  01 top left asof t  025 top right asof t  075 bottom
left and asof t  15 bottom right respectively All the calculations start with a point-
mass source particle at r20 and with 100 test particles at an average distance d varying
from near zero to about 5 in the normalized unit of the disk from the source particle
randomly placed within the computational grid of 220 exponentially spaced radial sections
and 256 equally spaced azimuthal sections Solid lines are expected N-body performance
with 1  rms uctuations and dashed lines are the corresponding theoretical softened
forces
Figure 40 Grid noise estimates for N-body particle-mesh simulations using Plummer-
sphere softening with asof t  075 All the calculations start with a point-mass source
particle at r10 left or r20 right and with 100 test particles at an average distance d
varying from near zero to about 5 in the normalized unit of the disk from the source par-
ticle randomly placed with the computational grid of nr110 exponentially spaced radial
sections and 128 equally spaced azimuthal sections Solid lines are N-body performance
with 1  rms uctuations and dashed lines are the corresponding theoretical softened
forces
forces are of error with respect to the smooth disk model we started with
the forces are in fact exact with respect to the clustered mass distribution
And we know in physical galaxies star cluster formation had no fundamen-
tal impact on a galaxys ability to form grand design density wave patterns
Thus the errors caused by grid mass assignment should not impact modal
pattern in simulated galaxies either apart from the heating eect it caused
which impacts the longevity of the mode as we have conrmed from the
simulation results in this paper
D3 Eects of Grid Size and Grid Noise to Mass Flow Rates In N-Body
Simulations
In this section we demonstrate further that the increased mass ow rates
in less-softened N-body runs are due to the collective instabilities brought
about by the decreased softening and not due to increased grid noise brought
about by the same softening reduction
The rst hint for this conclusion can already be found in the previous sim-
ulation result shown in Figure 4 It was seen there that when an insucient
number of particles are used for a given asof t which generally increases the
few-particle relaxation eect or increases the noise the mass inow tapers
o at an earlier time step Whereas for very large particle numbers which
generally decreases the few-particle relaxation eect or decreases the noise
Figure 41 Time evolution of the enclosed mass for a typical location inside corotation
and a typical location outside corotation relative to the initial n0 mass at the same
respective radius for the softening length asof t  075 run with a coarser mesh 110
radial sections 128 azimuthal sections and twice as coarse a time resolution as before
both the spiralbar activity and the mass inow continues until the end of
the run This positive correlation between the number of simulation particles
and the longevity of ecient mass inow shows that noise is unlikely to be
the cause of the increased mass ow rate Instead the survivability of the
density wave modes appears to be the key to the continued mass inow
In Figures 41 and 42 we plot the same mass ow evolution as previ-
ously simulated in Figures 23 and 24 for the softening parameter choice of
asof t  075 this time reducing the grid linear resolution by one half and
time resolution by one half correspondingly ie 16384 steps here cover the
same time duration in terms of pattern rotation periods as 32768 steps be-
fore Decreasing grid resolution by one half should signicantly increase the
grid noise from the result we presented above Yet the results here show
comparable mass ow rates compared to that obtained from the higher grid
resolution ones the slight decrease in mass ow rate is to the contribution
of grid-softening eect to mass ow which is apparently not as prominent
as particle softening yet even this decrease is in the opposite direction to
what one would expect if grid noise is the main contributor to the increase
in mass ow rate in simulated galaxies especially for the rst one-half of
the duration of the simulation run when the heating due to noise has not
clamped the amplitude of the pattern for this coarser-grid run This shows
that we are indeed revealing the role of increased collective eects brought
about by decreased particle softening and the increased mass ow rate is
Figure 42 Predicted integrated mass evolution according to equation 8 within the two
dierent radii for softening length asof t  075 run but with a smaller grid 110 radial
sections 128 azimuthal sections and twice as coarse a time resolution as before The
second frame for r275 used only even harmonics in the mass ow calculation
not due to increased grid noise if anything increased grid noise and the
resulting increased heating of disk particles slightly hamper the mass ow
rates in the later half of the simulation period as evidenced by the attening
of the mass-increase curves in both Figures 41 and 42
Therefore we conclude that as long as our interests are in the compari-
son of macroscopic characteristics of the mode equilibrium amplitude pitch
angle potential-density phase shift and torque in the simulations with that
in theoretical predictions as well as with that in observed galaxies the grid
noise present in simulations with smaller softening as in the current paper
is not a debilitating inconvenience
