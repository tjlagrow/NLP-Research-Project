April1420162316Preprint002THESTATISTICALSIGNIFICANCEOFMULTIVARIATEHAWKESPROCESSESFITTEDTOLIMITORDERBOOKDATAROGERMARTINSDIETERHENDRICKSSchoolofComputerScienceandAppliedMathematicsUniversityoftheWitwatersrandJohannesburgWITS2050SouthAfricaVersion11Received14April2016HawkesprocesseshaveseenanumberofapplicationsinnanceduetotheirabilitytocaptureeventclusteringbehaviourtypicallyobservedinnancialsystemsGivenacalibratedHawkesprocessofconcernisthestatisticalttoempiricaldataparticu-larlyfortheaccuratequanticationofself-andmutual-excitationeectsWeinvestigatetheapplicationofamultivariateHawkesprocesswithasum-of-exponentialskernelandpiecewise-linearexogeneityfactorsttedtoliquiditydemandandreplenishmenteventsextractedfromlimitorderbookdataWeconsiderone-two-andthree-exponentialker-nelsapplyingvariousteststoascertaingoodness-of-tandstationarityofresidualsaswellasstabilityofthecalibrationprocedureInlinewithpriorresearchitisfoundthatperformanceacrossalltestsimprovesasthenumberofexponentialsisincreasedwithasum-of-three-exponentialsyieldingthebestttothegivensetofcoupledpointprocessesKeywordsHawkesprocessmultivariatepointprocessexponentialkernelorderbookresilience1IntroductionHawkes1971introducedaclassofmultivariatepointprocesseswithastochasticintensityvectorincorporatingevent-occurrenceclusteringbehaviourinacoupledsystemInitialapplicationsusedcalibratedHawkesprocessestomeasurethecon-ditionalintensitiesofearthquakesandaftershocksbasedonrecordeddataVere-Jones1970Ogata19881999InnancialmarketsempiricalstudiesofmarketmicrostructurehavehighlightedapparentclusteringoflimitorderbookeventsattickscalewithsomeeventintensitiesexhibitingdependentbehaviourBiaisetal1995Gouldetal2013Abergeletal2015ThesimplestHawkesprocessesareunivariateconsideringasingleeventtypeanditstemporaldependenceonprioreventsThesemodelscontainanexogenousorbaselineintensitycomponentwhichcorrespondstotheintensityofeventsthatisnotinuencedbytheoccurrenceofprioreventsandanendogenousintensitycomponentwhichcorrespondstotheincreasedintensityofchildeventsthatoccursCorrespondingauthordieterhendricksstudentswitsacza1April1420162316Preprint0022RMartinsDHendricksafteranexogenousparenteventthuscapturingtheclusteringofeventsthatoneoftenexpectsinnancialdataAmultivariateHawkesprocessthenextendsthistoincludemultipleeventtypeswherewefurtherdeneself-excitationofoneeventtypeinuencingmoreofitsowntypeofeventandmutual-orcross-excitationofoneeventprecipitatingtheoccurrenceofothertypesofeventsDenition11MultivariateHawkesprocessConsiderapointprocessNtsuchthatP4Nt1Nsstt4to4tandP4Nt1Nssto4tForamultivariatepointprocessNtNrtr1RtherthintensityfunctionoftheR-variatemutually-excitingHawkesprocessisgivenbyrtrttZRXr1ritudNiuwherertisthetime-dependentbaselineintensityforthertheventtyperitisthekernelfunctionwhichencodesthedependencyonprioreventsoftypeiandsatisesthefollowingconditionsBacryetal20151Component-wisepositiveierit0foreach1riR2Component-wisecausalieift0thenrit0foreach1riR3EachcomponentbelongstothespaceofL1-integrablefunctionsThepointprocessNtandintensityvectorttogethercharacterisetheHawkesprocessBacryetal2015provideacomprehensivereviewarticlehighlightingthemanyapplicationsofHawkesprocessesinnanceBowsher2005consideredoneoftherstapplicationswhereabivariatepointprocessofthetimingofastockstradepriceandmid-quotechangeswasusedtomodelvolatilityclusteringontheNewYorkStockExchangeAkeyphenomenoninvestigatedusingHawkesprocessesisendogeneityinnancialmarketsFilimonovandSornette20122013Hardimanetal2013HardimanandBouchaud2014EmpiricalobservationrevealsthatincertaininstancesmarketpriceschangetooquicklytobestrictlyattributedtotheowofpertinentinformationandthusevadeexplanationinclassiceconomictheoryBowsher2005Byconsideringtheratioofexogenousparenteventstoen-dogenouseventsitispossibletoobtainameasureofmarketreexivityFilimonovandSornette2012Degryseetal2005Large2007BacryandMuzy2014ausedamultivari-ateHawkesprocesstoquantifytheresiliencyofalimitorderbookLOBviztheApril1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata3propensityforquotereplenishmentfollowingaliquiditydemandeventBycharac-terisingandextractingkeyliquiditydemandandreplenishmenteventsfromalimitorderbookandusinganappropriatechoiceofkerneltoencodetemporaldepen-denceofeventsLarge2007claimsitispossibletouseacalibratedHawkesprocesstocalculatetheprobabilityandexpectedhalf-lifeofquotereplenishmentfollowingaliquiditydemandeventWeidentifykeyaggressiveliquiditydemandandreplenishmenteventsenumer-atingempiricaleventpointprocessesformodelcalibrationandquanticationofLOBresiliencyTheprimaryinvestigationinthispaperistondakernelforthemultivariateHawkesprocesswhichprovidesasignicantttotheempiricaldataextractedfromtheJohannesburgStockExchangeJSEWenotethatthisworkisverymuchinthesamespiritasLallouacheandChallet2016howeverwearedeterminingthestatisticalsignicanceofmultivariateHawkesprocessesttedtoLOBeventdataThispaperproceedsasfollowsSection2describesthekeyliquiditydemandandreplenishmentpointprocessesextractedfromthelimitorderbookdatawhichwereusedforcalibratingtheHawkesprocessesSection3highlightssomecandidatekernelswhichcanbeusedtoencodetemporaldependenceamongstsystemeventsSection4discussesthederivationofthelikelihoodfunctionwhenusingthesum-of-expenentialskernelusedinthisanalysisSection5discussesthemodelcalibrationprocedureandimplementationSection6discussesthedistributionandstationaritytestsfortheresidualstoassesseachmodelsgoodness-of-ttotheprovideddataSection7discussesthedataandresultsforthisanalysisandSection8providessomeconcludingremarks2EnumeratingempiricaleventpointprocessesusingtickdataTypicallimitorderbookLOBeventsincludetradesnewquotesquotemodica-tionsandquotecancellationsAbergeletal2015FollowingthesuggestionsbyLarge2007andBiaisetal1995andtakingintoaccountthenatureofourdatawedene4keyaggressiveliquiditydemandandreplenishmenteventtypeswhichwillbeusedtocharacteriseorderbookresiliencyType1AbuytradethatmovestheoerTherstofthetwoliquiditydemandeventswedeneanaggressivebuytradeasonewherethetradepriceisgreaterthanthebestoerpriceoritisequaltothebestoerbutthevolumeisgreaterthanthatavailableatthecurrentbestoerSuchtradesareconsideredaggressivesincetheymateriallyaltertheshapeofthelimitorderbookpushingthebestoerpricehigherwideningthespreadandremovingliquidityFormallywithPrepresentingthetradepriceAtheprevailingbestoerandVPVAtherespectivevolumesweexpressthiseventtypeasthefollowingsubsetofApril1420162316Preprint0024RMartinsDHendrickslimitorderbookeventsPAcid2PAVPVAcid3Type2AselltradethatmovesthebidThesecondofthetwoliquiditydemandeventsistheaggressiveselltradewherethetradepriceislowerthanthecurrentbestbidpriceoritisequaltothebestbidpricebutthevolumeofthetradeisgreaterthanthatavailableatthebestbidSimilarlythistradeisconsideredaggressivesinceitaltersthestructureofthelimitorderbookbypushingthebestbiddownwideningthespreadandremovingliquidityReferringtotheaforementionednotationonlyaddingthatBreferstothebestavailablebidpriceweformallycharacteriseaggressiveselltradesasthefollowingsubsetPBcid2PBVPVBcid3Type3AbidbetweenthequotesTherstofthetworesiliencyeventstheaggressivebidisabidbetweenthecurrentbestbidandoerItisconsideredaggressivesinceitaltersthestructureofthelimitorderbookpushingupthebestbidreducingthespreadandprovidingliquiditythroughmorecompetitivepricesandaddedvolumeWithBbeingtheincomingbidquoteandBptheprevailingbestbidweformallycharacterisetheaggressivebidusingsimilarnotationtobeforeasthefollowingsubsetBBpType4AnoerbetweenthequotesThesecondofthetworesiliencyeventsanaggressiveoerisdenedasanoerquotebetweenthecurrentbestbidandoerconsideredaggres-sivesinceitnarrowsthegapbetweentheprevailingbestbidandoerprovidingliquidityWithAbeingtheincomingoerquoteandAptheprevailingbestoerweformallycharacterisetheaggressiveoerquotesasthefollowingsubsetAApWhilenotcriticalforourstudyofLOBresiliencywealsoidentifyandclassifythefollowingpassiveeventtypesforcompletenessType5PassivebuytradeThesearebuytradeswhichdonotnegativelyaectLOBliquidityastheydonotaecttheprevailingspreadIfPisthetradepriceAtheprevailingoerquoteandVPandVAtheirrespectivevolumespassivebuytradeswillbeclassiedascid2PAVPVAcid3April1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata5Type6PassiveselltradeTheseareselltradeswhichdonotnegativelyaectLOBliquidityastheydonotaecttheprevailingspreadIfPisthetradepriceBtheprevailingbidquoteandVPandVBtheirrespectivevolumespassiveselltradeswillbeclassiedascid2PBVPVBcid3Type7PassivebidquoteThesearebidquoteswhichentertheLOBatalevelhigherthanlevel-1andhencedonotaecttheprevailingspreadIfBistheincomingbidquoteandBpistheprevailingbidquotepassivebidquoteswillbeclassiedasBBpType8PassivesellquoteTheseareoerquoteswhichentertheLOBatalevelhigherthanlevel-1andhencedonotaecttheprevailingspreadIfAistheincomingoerquoteandApistheprevailingoerquotepassiveoerquoteswillbeclassiedasAApFigures12and3illustratethemeasuredempiricalintensitiesforthe4keyeventtypesdemonstratingeventclusteringandmutual-excitationovertypicalmorningmiddayandafternoonperiods093009451000101510301012345NormalisedintensityforSBKJJon25-Sep-2013binwidth5minNormalisedintensityTimeType1eventType2eventType3eventType4eventFig1EmpiricaleventintensitiesforSBKofeachofthe4keyeventtypesoveramorningperioddemonstratingeventclusteringandmutual-excitationThedotsshowthearrivaltimesoftheeventsandthelinesshowthe5-minuteeventintensitiesApril1420162316Preprint0026RMartinsDHendricks13001315133013451400101234567NormalisedintensityforSBKJJon25-Sep-2013binwidth5minNormalisedintensityTimeType1eventType2eventType3eventType4eventFig2EmpiricaleventintensitiesforSBKofeachofthe4keyeventtypesoveramiddayperioddemonstratingeventclusteringandmutual-excitationThedotsshowthearrivaltimesoftheeventsandthelinesshowthe5-minuteeventintensities150015151530154516001050051152253354NormalisedintensityforSBKJJon25-Sep-2013binwidth5minNormalisedintensityTimeType1eventType2eventType3eventType4eventFig3EmpiricaleventintensitiesforSBKofeachofthe4keyeventtypesoveranafternoonperioddemonstratingeventclusteringandmutual-excitationThedotsshowthearrivaltimesoftheeventsandthelinesshowthe5-minuteeventintensities3CandidatekernelsforencodingtemporaldependenceAnumberofkernelshavebeenproposedtomodeltemporaldependenceofeventsinformedbytheapplicationorthedynamicsofthedatabeingmodelledHardimanandBouchaud2014WhileinprincipleanykernelsatisfyingtheconditionsinDenition11canbeusedfourcandidatekernelshavetypicallybeenconsideredfornancialapplicationsLarge2007Bacryetal2015LallouacheandChallet2016April1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata7Sum-of-exponentialsMtMXi1ietiwhereMisthenumberofexponentialsiistheamplitudeoftheithkernelandiisthetimescaleoftheithkernelThebranchingratioiscalculatedasnMPi1iiApproximatepowerlawMtnZM1Xi1a1ietaiwhereai0miMistherangeofapproximationandmitsprecisionZisdenedsuchthatR0Mtdtnnisthebranchingratioisthetailexponentand0isthesmallesttimescaleApproximatepowerlawwithshortlagcut-oHardimanetal2013MtnZcid16M1Xi1a1ietaiSeta1cid17wherethedenitionisthesameastheapproximatepowerlawwiththeadditionofasmoothexponentialdropforlagsshortedthan0SisdenedsuchthatM00Lallouache-ChalletpowerlawandexponentialLallouacheandChallet2016MtnZcid16M1Xi1a1ietaibetcid17whichistheapproximatepowerlawwithanadditionalexponentialtermwithfreeparametersbandThispermitsgreaterfreedominthestructureoftimescalesWewillconsiderthesum-of-exponentialskernelasthiswillallowustoquantifylimitorderbookLOBresiliencybymeasuringthebranchingratioforparticu-larliquiditydemandreplenishmenteventpairsaswellastheexpectedhalf-lifeofreplenishmentLarge2007madeuseofa2-exponentialkerneltoquantifyLOBre-siliencyhoweveritisunclearwhethertwoexponentialsisappropriateforoureventsdatasetWewillthusinvestigatethegoodness-of-tforM12and3todeter-minetheappropriateformofthekernelgiventheeventprocessesenumeratedfromourdatasetWenotethatrecentstudieshaveconsideredecientnon-parametriccalibrationproceduresforestimatingthebranchingratioofasymmetricHawkesprocessBacryetal2012BacryandMuzy2014bWhilewehavetakenmea-surestopromotestabilityinourcalibrationprocedurediscussedinSection5April1420162316Preprint0028RMartinsDHendricksfurtherstudiesshouldconsidertheapplicationofthesenon-parametricestimatorsandtheirabilitytocaptureresultsofthefullmodelwhenappliedtodataextractedfromtheJSELOB4Derivingamaximumlikelihoodestimatorwiththesum-of-exponentialskernelWewillconsidertheexpositionshowninLallouacheandChallet2016andextendittothemultivariatecaseThesum-of-exponentialskernelisdenedasMtMXi1ietiTheMtermreferstothenumberofexponentialstobesummedforeacheventtypeistheindividualexponentialsunscaledintensityreferstotheparticulartimescaleassociatedtotheintensityofoneexponentialincontrasttothecommonlypresentedthatreferstothemultiplicativeinverseofbeingthedecayImpor-tantlywenotethatthebranchingrationofaparticulareventtypeisexpressedasnMXi1ii41ThisbranchingratiocorrespondstothenumberofchildreneventsaparenteventisexpectedtohaveAbranchingratiogreaterthanonesuper-criticalwillquicklyexplodewitheventsabranchingratioequaltoonecriticalisaspecialcasewhereafamilywillliveindenitelywithoutexplodingaslongas0andabranchingratiolessthanonesub-criticalreferstoaprocesswhereeachfamilyofclusteredeventswilleventuallydieoutTocalculatethehalf-lifeofagivenintensityeectiwesolve12eti12iti12iln242withthetotalhalf-lifegivenbyt12MXi1iln243Thesum-of-exponentialskernelthusyieldsthefollowingintensityfunctionMtZt0MXi1ietuidNuInparticularweareconsideringthefour-variatecasesinceweareinterestedinkeyaggressiveliquiditydemandandreplenishmenteventstoquantifyresiliencyApril1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata9seeSection2belowWithr1234referringtotheeventtypeofinterestrandassumingatime-dependentbaselineintensitywehaverMtrtZt04Xr1MXi1rieturidNru44Werefertotheknownlog-likelihoodfunctionforHawkesprocesseswithexpo-nentialorpower-lawkernelsOzaki1979lnLcid0t1tncid12cid12cid1ZT0tdtZT0lntdNtnotingthatZt0hsdNsXtithtiThuswederivethelog-likelihoodaslnLrZT0rtdt4Xr1MXi1ririXtjTcid181eTtjricid19XtjTlnrtj4Xr1MXi1riXtj0tjetjtj0riUsingthefollowingrecursiverelationshipsOzaki1979assumingthatr1R1ijetjtj11icid01R1ij1cid1andformutualeventtypesr234lettingksupk0tk0tjRrijetjtj1riRrij1Xk0tj1tk0tjetjtk0riThussubstitutingbackintothelog-likelihoodfunctionweobtainlnLrZT0rtdt4Xr1MXi1ririXtjTcid181eTtjricid19XtjTlnrtj4Xr1MXi1riRrij45Thelog-likelihoodfunctioninEquation45willbeimplementedforparametercal-ibrationApril1420162316Preprint00210RMartinsDHendricks5CalibrationofmodelparametersToquantifyLOBresiliencywerequirethecalibrationoftheandparametersinEquation45WeusedMATLABtodevelopanon-linearconstrainedoptimisationroutinetondtheparameterswhichmaximisethelikelihoodfunctionspeciedinEquation45InparticularweusedasequentialquadraticprogrammingalgorithmtoiterativelyadjustcandidateparametervaluesuntilabestapproximationtothemaximumlikelihoodestimatorisfoundwithinagiventoleranceTopromotendingaglobalsolutionandstabilityinalgorithmresultsweuseageneticalgorithmwithEquation45astheobjectivefunctiontondfeasibleparametervaluestoinitialisetheoptimisationroutineThisallowsustonarrowthesearchspacebeforeusingtheoptimisationtorenethecalibrationWhiletheunivariateHawkesprocesscanexploittherecursiverelationshipforthelog-likelihoodcalculationreducingthecomputationalcomplexityfromON2toONOzaki1979LallouacheandChallet2016thisadvantagedoesnottranslatetothemultivariatecaseWemadeuseofanumberofvectorisationen-hancementstoimprovethecomputationaleciencyoftheimplementedalgorithmasshowninFigure4Theseindicatethatourimplementationscaleswellasafunc-tionofbothnumberofeventsandnumberofexponentialsinthechosenkernelcomparedtoanavefor-loopimplementationThedetailsofthefullimplementa-tioncanbefoundinastudybyMartins2015anumberofeventsbnumberofexponentialsFig4Computationtimeinminutesvectorisationvsfor-loopShowsaveragecompu-tationtimeasafunctionofthenumberofeacheventtypeaswellasnumberofexponentialsinthekernelOncetheparametershavebeencalibratedtotheeventsdatawecanobtainvaluesforthebranchingratioEquation41andhalf-lifeEquation43andtheparticularexpressionofEquation44thatdenestheintensityoftheHawkespro-cesswhichcaninturnbeusedtocalculatetheresidualsfortestingApril1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata11BeforeanyinferencesweremadefromcalibratedparametervaluesweveriedtheaccuracyofourimplementedcalibrationschemeTodothisweperformedex-tensivesimulationsofmultivariateHawkesprocesseswithknowninducedparam-etersusingtheintensity-basedapproachpromotedbyLewisandShedler1979DassiosandZhao2013generatingasetofeventsdataThecalibrationschemewasthenusedtorecovertheinducedparametersThesuccessfulrecoveryofinducedparametersfromsimulateddataveriedthecalibrationschemeDetailsofthiscanbefoundinastudybyMazibuko20146OnthechoiceofMnumberofexponentialsInordertodeterminetheappropriatenumberofexponentialsinourkernelweper-formedanumberofgoodness-of-ttestsforM12and3followingcalibrationstoourdatasetofeventsWeutilisetheresultinTheorem61toconvertourcali-bratedHawkesprocessesintotime-deformedcompensatorfunctionsvizsequencesofresidualswhichareexponentiallydistributedwithmean1Theorem61MultivariaterandomtimechangeConsidertheRsequencesofgeneralisedresidualserir1RwhereeriZtri1trirsds61theintegrandistheintensityfortypereventsandtritri1isintervalbetweenadjacenttypereventsWhenisthesetoftrueparameterseachsequenceeriisanindependentlydis-tributedexponentialrandomvariablewithmean1ProofSeeBowsher2005foradetaileddiscussionandproofWecanthenusestatisticalteststodeterminewhethertheresidualsareinfactindependentandexponentiallydistributedwithmean1wherethekerneloeringthebesttwillbeusedintheanalysesthatfollowWeusedfourcandidateteststoassessthedistributionandstationarityoftheresidualsLarge2007Hardimanetal2013LallouacheandChallet20161Kolmogorov-SmirnovKStestKolmogorov1933Smirnov1948Thistestcomparestheempiricaldistributionofresidualstocumulativedistributionofanexponentialwithmean1AnacceptanceofthenullhypothesisH0indicatesempiricalresidualsareexponentiallydistributedatthespeciedsignicancelevel2ExcessDispersionEDtestEngleandRussell1998Thistestconrmswhethertheresidualshaveunitvarianceaswouldbeexpectediftheyfollowedanexponentialwithmean1AnacceptanceofthenullhypothesisH0indicatesthevarianceofempiricalresidualsis1atthespeciedsignicancelevelApril1420162316Preprint00212RMartinsDHendricks3Ljung-BoxQLBQtestLjungandBox1978Thistestforstationarityconrmsindependenceofincrementswhereagainacceptanceofthenullhy-pothesisH0indicatestheresidualsarestationary4Kwiatkowski-Phillips-Schmidt-ShinKPSStestKwiatowskietal1992ThisisasecondarytestforstationarityforconrmationoftheLBQresultswhereacceptanceofthenullhypothesisH0indicatestheresidualsarestation-aryTheKSEDandLBQstatisticaltestswereperformedata1signicancelevelwhiletheKPSStestwasperformedatthe5signicancelevel7DataandResults71DataThedataforouranalysisconsistedoftransactionsandmarketdepthquotesfortwostockslistedontheJohannesburgStockExchangeJSEsourcedfromThomsonReutersTickHistoryTRTHThemethodologydescribedinSection2wasusedtoextracteventpointprocessesformodelcalibrationStandardBankSBKStabilitytestswereperformedonStandardBanktickdatafrom05March2012to09March2012Forthefoureventsofinterestthisdatasetcontainedatotalof13213eventsoverallvedaysAdditionalstatisticspertainingtothedatasetarepresentedinthefollowingtablerecallingthatalleventtypesareaggressiveEventTypeTotalinSetMeanperDaySDperDayBuyType115833166353808SellType215113022537513BidType35173103462269324AskType4494698923686227Table1StandardBank05March2012to09March2012GrowthpointPropertiesLimitedGRTDailycalibrationswereperformedontwosetsofGrowthpointdataonefrom01September2013to27September2013withatotalof39347eventsover19daysandtheotherfrom30September2013to31October2013with31090eventsover24daysApril1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata13EventTypeTotalinSetMeanperDaySDperDayBuyType1533228063161023139SellType2496226115791152380BidType31323769668422486008AskType41581683242114832089Table2GrowthpointPropertiesLimited01September2013to27September2013EventTypeTotalinSetMeanperDaySDperDayBuyType140191674583655054SellType244891870417563417BidType31043143462501403644AskType41215150629172000264Table3GrowthpointPropertiesLimited30September2013to31October201372ResultsGiventheonerouscalibrationprocedureandhighnumberofmodelparameterswerstperformedastabilitytesttoassesstheconsistencyofourimplementationThiswasperformedonarelativelysmalldatasetofSBKpointprocessesTable1wherethecalibrationandsubsequentstatisticaltestswereperformed100timesonthesamedataFollowingconrmationofthestabilityofthecalibrationprocedurewethenmovedontothegoodness-of-ttestswhereweassessthemodelsunderthe3candidatekernelsandexaminetheresidualswhenappliedtotheGRTpointprocessesTables2and3HereeachdayistreatedasanindependentrealisationofthemultivariatepointprocesshencethemodelsarecalibratedeachdaywithsummaryresultsshownWeseparatetheanalysisintotwocalendarmonthperiods01September2013to27September2013and30September2013to31October2013astherewasasignicantchangeinthefeestructureontheJSEon30September2013Harveyetal2016whichmayhaveaectedprevailingLOBdynamics721StabilitytestsTable4andFigure5summarisetheresultsofthestabilitytestsTheysuggestpositivetestperformanceacrossthethreekernelswiththeexceptionofthesingleexponentialsstationaritytestswhereboththeLBQandKPSStestsfailedmoreoftencomparedtotheothertwokernelsWeobservethatasthenumberofexpo-nentialsincreasesmoretestsarepassedwiththesumofthreeexponentialspassingthemajorityofitstestsCuriouslyweseethatthemeanp-valuefortheKStestsdecreaseswiththenumberofexponentialsinthisparticularsetofresultsbutthetestpassratein-April1420162316Preprint00214RMartinsDHendricksMKSH0KSpEDH0EDpLBQH0LBQpKPSSH0KPSSp109750016600950036850520004359050000067820982500839099005571088180443708900009273099750067109950625809460045380960000972Table4StabilityteststatisticsbykernelH0columnspresentpercentageofnullhypothesesacceptedpcolumnspresentmeanp-valuesoveralltestsforgivenkernelNumber of Exponentials123Test Pass Rate00102030405060708091Kolmogorov-SmirnovExcess DispersionLjung-BoxKwiatkowski-Phillips-Schmidt-ShinFig5StabilitytestpassratebykernelStackedbarsrepresentthepercentageofpassesforeachstatisticaltestasachievedbythenumberofexponentialssummedinthekernelofinterestTestswereperformedon100calibrationsofthesameSBKdatasetcreasesFigure6demonstratesthatdespitescoringhighp-valuesforsomeeventsthesingleexponentialhasthelowestp-valuesandmostfailuresinevent1bringingitsoverallpassratedown722Goodness-of-ttestsTables5and6andFigure7showthegoodness-of-tresultsforempiricaleventprocessesofacandidatestockGRTover2dierentperiodsforM12and3WehaveusedtodenitionsinSection2toextractkeyaggressiveliquiditydemandandreplenishmentprocessesfromtheLOBdataEachdayisconsideredasanindependentrealisationofthemultivariatepointprocessthusaseparatecalibrationisperformedforthesetofeventsassociatedwitheachdayinthedatasetThisallowsustoconstructadistributionofnullhypothesisacceptancesandp-valuesforeachtestandforeachMForexamplecolumnKSH0indicatestheproportionofKStestswhichconrmedresidualswereexponentiallydistributedwithunitmeanwhereascolumnKSp-valueshowstheaveragep-valueforthesetestsWeseefromApril1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata15Sample Member102030405060708090100p-value0000500100150020025003M  1M  2M  3Fig6StabilitytestKolmogorov-Smirnovp-valuesComparisonofKStestp-valuesobtainedbykernelswithMexponentialsoverthe100calibrationstheseresultsthatthe3-exponentialkerneloersabetterttoempiricaldatathanthe1-and2-exponentialkernelThisisconrmedbythehighestnumberofnullhypothesisacceptancesandhighestp-valuesacrossallstatisticaltestsWewillthususethe3-exponentialkernelinourstudyofLOBresiliencyMKSH0KSpEDH0EDpLBQH0LBQpKPSSH0KPSSp103421003320250000628070000248405658006192056580097804342013110718402902053950058930618401384057890172007326029450552600604Table5Dailygoodness-of-tteststatisticsbykernelGRT01September2013to27Septem-ber2013MKSH0KSpEDH0EDpLBQH0LBQpKPSSH0KPSSp105000008840395800928074750273305729006272067710171205938017840778302790061460064330791702599072920265808133029960625000669Table6Dailygoodness-of-tteststatisticsbykernelGRT30September2013to31October2013April1420162316Preprint00216RMartinsDHendricksNumber of Exponentials123Test Pass Rate00102030405060708091Kolmogorov-SmirnovExcess DispersionLjung-BoxKwiatkowski-Phillips-Schmidt-ShinFig7DailyTestPassRateByKernelTestswereperformedoncalibrationsofeachdayoftheGRTdatasetThisgurecombinesthedistributionsoftestpassratesacrossbothperiods723DiscussiononcalibratedparametersInadditiontothestatisticaltestingtoestablishmodelaccuracythisanalysisin-cludesadiscussionoftheinterpretationofcalibratedparametersandwhetherornotthecalibratedparameterspresentreasonablevaluesMotivatinguseoftime-dependentbaselineintensityTomotivatetheuseofatime-dependentbaselineintensityinourspecicationinEquation44weexam-inedtheaveragehourlyintensityofourmeasuredempiricaleventprocessesFigure8showstheaverageintensityofalleventsforacandidatestockGRTforeachhourofthetradingdayaveragedoveralldaysintherespectivedatasetsBothdatasetsindicateadistinctU-shapeforaverageintensitieswhichaconstantbaselineinten-sitywillfailtocaptureFigure9illustratestheeectofdierentkernelswhenassuminga3-periodpiece-wiselinearbaselineintensityWeseethatasimplemorningnoonandafternoondistinctionyieldscalibratedintensitieswhichmatchtheexpectedU-shapeexhib-itedintheempiricaldatainFigure8TheshapesofthesecurvesaresimilaracrossallthreekernelsalthoughwenotethatasthenumberofexponentialsisincreasedweseeadeclineintheboththemeanandvariationoftheexogeneityThissug-geststhatthehighernumberofexponentialspermitsmoreexplanatorypowerforcross-excitingeectsofeventsratherthanabsorbingtheseeectsintothebaselineintensityCombinedwiththegoodness-of-ttestsinSection6thisconrmsthatthedriversofobservedeventintensitiesinourdataappeartohaveahigherattri-butiontoself-andcross-excitingeectsascapturedbythe3-exponentialkernelthanthatsuggestedbyfewerexponentialsApril1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata179am10am11amNoon1pm2pm3pm4pm0001002003004Period Starting TimeBaseline IntensityGRT 01Sep2013 to 27Sep20139am10am11amNoon1pm2pm3pm4pm0001002003004Period Starting TimeBaseline IntensityGRT 30Sep2013 to 31Oct2013Fig8AveragehourlybaselineintensityforalleventsBluelineindicatesaverageforagivenhourwiththeerrorbarsreectingthevariationoverthedaysinthesample9amNoon2pm9amNoon2pm9amNoon2pm0001002003004Period Starting TimeBaseline IntensityGRT 01Sep2013 to 27Sep2013  M  1M  2M  39amNoon2pm9amNoon2pm9amNoon2pm0000500100150020025Period Starting TimeBaseline IntensityGRT 30Sep2013 to 31Oct2013Fig9BaselineintensitybykernelThetradingdayisdividedinto3periodsmorningnoonafternoonwithpiecewiselinearintensityColouredlinescorrespondtomeanexogenousintensitiesforthegivenperiodscalibratedforeachkernelwiththeerrorbarsreectingdailyvariationApril1420162316Preprint00218RMartinsDHendricksBranchingRatiosRecallingthedenitionofthebranchingratiogivenbyEqua-tion41weobservetheself-excitingbranchingratioscalculatedfromthecalibratedparametersinFigure10withtheirsummarystatisticspresentedinTables7and8IntuitivelythebranchingratiosarehigherforthebidsandoersforwhichtherearefarmoreeventsperdayineitherdatasetthantherearetradesAswiththeexogenousintensitiesweseethattheseconddatasethaslowerbranchingratioscorrespondingtothelowereventratesCuriouslyweobservethatincontrasttotheexogenousintensitiesthatdeclinewiththenumberofexponentialsthebranchingratiosactuallyincreaseasweincreasethenumberofexponentialsfromthisweconjecturethatincreasingthenumberofexponentialsinthemodelallowsustocapturemoreoftheindividualself-andmutual-excitationeectsleavinglessoftheeectiveintensityabsorbedbytheexogenousfactorEvent1Event2Event3Event4MMeanStdMeanStdMeanStdMeanStd102158008260170300626039900093904377014892029110097202430007530417901212047560141630305500863028010074004320011840493801347Table7BranchingRatioStatisticsGRT01September2013to27September2013ShowsthemeanandstandarddeviationstdofthedistributionofbranchingratiosforeacheventcomputedforeachdayinthedatasetEvent1Event2Event3Event4MMeanStdMeanStdMeanStdMeanStd101705009850200300744032120118603413012232023460113501941007200372401130038970104830282101080025200096503860009960425601102Table8BranchingRatioStatisticsGRT30September2013to31October2013ShowsthemeanandstandarddeviationstdofthedistributionofbranchingratiosforeacheventcomputedforeachdayinthedatasetApril1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata1900102030405060708Buy TradeSell TradeBidOfferAggressive Event TypeBranching Ratio  M  1M  2M  3aGRT01September2013to27Septem-ber20130010203040506Buy TradeSell TradeBidOfferAggressive Event TypeBranching Ratio  M  1M  2M  3bGRT30September2013to31October2013Fig10BoxandwhiskerplotofbranchingratiosbykernelHorizontalblacklinesrepresentmediansboxedgesthequartileswhiskersthefurthestnon-outlyingdatapointsandredcirclestheoutliersHalf-LivesRecallingthedenitionofthehalf-lifegivenbyEquation43weob-servethehalf-livescalculatedfromthecalibratedparametersinFigure11withtheirsummarystatisticsalsopresentedinTables9and10Wenotethatthecal-culatedhalf-livesappeartoincreaseasthenumberofkernelsisincreasedineachdatasetGiventhesuperiortofthe3-exponentialkerneldemonstratedinSection722thissuggeststhatthepersistenceofself-andmutual-excitationeectsmaybelongerthanisapparentunderothermodelformulationsIfwecomparethetwodatasetsinTables9and10wenotethatthereweresignicantlyhigherhalf-livesacrossalleventtypesinthesecondperiodwithahighervariabilityWenotethaton30September2013therewasasignicantchangeinthetradingfeestructureattheJohannesburgStockExchangewhereapreviouscostooronexchange-relatedtradingcostwasreplacedwithavalue-basedcostreducingtheeectivecostofsmall-valuetradesJSE2013ab2014Thisappearstohavesignicantlychangedtheactivityofthevariouseventtypesinthelimitorderbookespeciallythedecaytimeofself-andmutual-excitationeectsLongertermstudiesshouldinvestigatethedriversofobservedchangesinlimitorderbookdynamicsfromaresiliencyperspectiveApril1420162316Preprint00220RMartinsDHendricksEvent1Event2Event3Event4MMeanStdMeanStdMeanStdMeanStd118904494760476515974215062170121929370942164678243440790239512973177577931067771017563221760274824164143149053151500100538183472111086Table9Half-lifeStatisticsGRT01September2013to27September2013Showsthemeanandstandarddeviationstdofthedistributionofhalf-livesinsecondsforeacheventcomputedforeachdayinthedatasetEvent1Event2Event3Event4MMeanStdMeanStdMeanStdMeanStd10561209662130432551812565142631995134089238179914920492406444341133515199383135566175231356099910439574363181252765282081367412358443647057Table10Half-lifeStatisticsGRT30September2013to31October2013Showsthemeanandstandarddeviationstdofthedistributionofhalf-livesinsecondsforeacheventcomputedforeachdayinthedataset01020304050607080Buy TradeSell TradeBidOfferAggressive Event TypeHalfLife  M  1M  2M  3aGRT01September2013to27Septem-ber2013020406080100120140160Buy TradeSell TradeBidOfferAggressive Event TypeHalfLife  M  1M  2M  3bGRT30September2013to31October2013Fig11Boxandwhiskerplotofhalf-livesbykernelHorizontalblacklinesrepresentme-diansboxedgesthequartileswhiskersthefurthestnon-outlyingdatapointsandredcirclestheoutliers8ConclusionThekeyinvestigationinthispaperistodeterminethestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdataobtainedfromtheJo-hannesburgStockExchangeJSEGivenmodelspecicationswhichusepiecewise-linearexogeneityfactorsandone-two-andthree-exponentialkernelstogovernApril1420162316Preprint002ThestatisticalsignicanceofmultivariateHawkesprocessesttedtolimitorderbookdata21endogeneityoftheintensitywetestedtheresidualsofcalibratedmodelstoassesstheirdistributionandstationarityWefoundthatthesum-of-three-exponentialskerneloersthebestttoafour-variateHawkesprocesscalibratedtokeyliquid-itydemandandreplenishmenteventsextractedfromJSElimitorderbookdataThisoersamoreaccuratequanticationoforderbookresiliencyusingcalibratedamplitudeandtime-scaleparametersofliquidityreplenishmentintensitiesAcknowledgmentsThisworkisbasedontheresearchsupportedinpartbytheNationalResearchFoundationofSouthAfricaGrantnumber89250TheconclusionshereinareduetotheauthorsandtheNRFacceptsnoliabilityinthisregardTheauthorsthankDianeWilcoxandTimGebbiefortheircommentsandsuggestionsReferencesAbergelFAnaneMChakrabortiAJedidiATokeI2015LimitorderbooksWorkingpaperURLhttpquantmasecpfrwp-contentuploads201510Limit-Order-Book-modellingpdfBacryEDayriKMuzyJ2012Non-parametrickernelestimationforsymmetrichawkesprocessesapplicationtohighfrequencynancialdataTheEuropeanPhysicalJournalB85157BacryEMastromatteoIMuzyJ2015HawkesprocessesinnanceMarketMi-crostructureandLiquidity11BacryEMuzyJ2014aHawkesmodelforpriceandtradeshigh-frequencydynamicsQuantitativeFinance14711471166BacryEMuzyJ2014bSecondorderstatisticscharacterizationofhawkesprocessesandnon-parametricestimationWorkingpaperURLhttparxivorgpdf14010903pdfBiaisBHillionPSpattC1995AnempiricalanalysisofthelimitorderbookandtheorderowintheparisbourseJournalofFinance5016551689BowsherC2005ModellingsecuritymarketeventsincontinuoustimeIntensity-basedmultivariatepointprocessmodelsJournalofEconometrics1412876912DassiosAZhaoH2013Exactsimulationofhawkesprocesswithexponentiallydecay-ingintensityElectronicCommunicationsinProbability1862113DegryseHdeJongFRavenswaaijMWuytsG2005AggressiveordersandtheresiliencyofalimitordermarketReviewofFinance92201242EngleRRussellJ1998AutoregressiveconditionaldurationAnewmodelforirregu-larlyspacedtransactiondataEconometrica6611271162FilimonovVSornetteD2012QuantifyingreexivityinnancialmarketsTowardapredictionofashcrashesPhysicalReviewE85510651073FilimonovVSornetteD2013Apparentcriticalityandcalibrationissuesinthehawkesself-excitedpointprocessmodelapplicationtohigh-frequencynancialdataWorkingpaperURLhttparxivorgabs13086756GouldMPorterMWilliamsSMcDonaldMFennDHowisonS2013LimitorderbooksWorkingpaperURLhttparxivorgabs10120349April1420162316Preprint00222RMartinsDHendricksHardimanSBercotNBouchaudJ2013CriticalreexivityinnancialmarketsahawkesprocessanalysisTheEuropeanPhysicaJournalB861019HardimanSBouchaudJ2014Branchingratioapproximationfortheself-excitinghawkesprocessWorkingpaperURLhttparxivorgabs14035227HarveyMHendricksDGebbieTWilcoxD2016DeviationsinexpectedpriceimpactforsmalltransactionvolumesunderfeerestructuringWorkingpaperURLhttparxivorgabs160204950HawkesA1971Spectraofsomeself-excitingandmutually-excitingpointprocessesBiometrika5818390JSE2013aEquitymarketpricelistretrieved01022016URLhttptinyurlcomgqya25yJSE2013bJseequitymarkettransactionbillingmodelmethodologychangenoticejsemarketnoticeno136retrieved01022016URLhttptinyurlcomhvht39jJSE2014Equitymarketpricelist2014v11retrieved01022016URLhttptinyurlcomjdlt38xKolmogorovA1933SulladeterminazioneempiricadiunaleggedidistribuzioneGIstItalAttuari48391KwiatowskiDPhillipsPSchmidtPShinY1992TestingthenullhypothesisofstationarityagainstthealternativeofaunitrootJournalofEconometrics541-3159178LallouacheMChalletD2016ThelimitsofstatisticalsignicanceofhawkesprocessesttedtonancialdataQuantitativeFinance161111LargeJ2007MeasuringtheresiliencyofanelectroniclimitorderbookJournalofFinancialMarkets10125LewisPShedlerG1979SimulationofnonhomogeneouspoissonprocessesbythinningNavalResearchLogisticsQuarterly263403413LjungGBoxG1978OnameasureofalackoftintimeseriesmodelsBiometrika652297303MartinsR2015Thestatisticalsignicanceofmutually-excitinghawkesprocessesttedtojsedataAMFHonoursProjectUniversityoftheWitwatersrandSupervisedbyDHendricksMazibukoK2014QuantifyingresiliencyofthejselimitorderbookfollowinglargetradesAMFHonoursProjectUniversityoftheWitwatersrandSupervisedbyDHendricksOgataY1988StatisticalmodelsforearthquakeoccurencesandresidualanalysisforpointprocessesJournaloftheAmericanStatisticalAssociation83401927OgataY1999SeismicityanalysisthroughpointprocessmodellingareviewPureandAppliedGeophysics1552471507OzakiT1979Maximumlikelihoodestimationofhawkesself-excitingpointprocessAn-nalsoftheInstituteofStatisticalMathematics311145155SmirnovN1948TableforestimatingthegoodnessoftofempiricaldistributionsAnnalsofMathematicalStatistics19279281Vere-JonesD1970StochasticmodelsforearthquakeoccurenceJournaloftheRoyalStatisticalSocietySeriesBMethodological321162